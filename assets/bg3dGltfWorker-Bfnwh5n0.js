var Fe=(d,m)=>()=>(m||d((m={exports:{}}).exports,m),m.exports);var Le=Fe((exports,module)=>{var PixelFormatSrc=(d=>(d[d.GL_UNSIGNED_SHORT_1_5_5_5_REV=33638]="GL_UNSIGNED_SHORT_1_5_5_5_REV",d[d.GL_RGB=6407]="GL_RGB",d[d.GL_RGBA=6408]="GL_RGBA",d))(PixelFormatSrc||{}),PixelFormatDst=(d=>(d[d.GL_UNSIGNED_SHORT_5_5_5_1=32855]="GL_UNSIGNED_SHORT_5_5_5_1",d))(PixelFormatDst||{});function getPixelFormatSrcName(d){switch(d){case 33686:return"GL_UNSIGNED_SHORT_1_5_5_5_REV (33686)";case 6407:return"GL_RGB (6407)";default:return`Unknown (${d})`}}function getPixelFormatDstName(d){switch(d){case 32855:return"GL_UNSIGNED_SHORT_5_5_5_1 (32855)";default:return`Unknown (${d})`}}var BG3DTagType=(d=>(d[d.MATERIALFLAGS=0]="MATERIALFLAGS",d[d.MATERIALDIFFUSECOLOR=1]="MATERIALDIFFUSECOLOR",d[d.TEXTUREMAP=2]="TEXTUREMAP",d[d.GROUPSTART=3]="GROUPSTART",d[d.GROUPEND=4]="GROUPEND",d[d.GEOMETRY=5]="GEOMETRY",d[d.VERTEXARRAY=6]="VERTEXARRAY",d[d.NORMALARRAY=7]="NORMALARRAY",d[d.UVARRAY=8]="UVARRAY",d[d.COLORARRAY=9]="COLORARRAY",d[d.TRIANGLEARRAY=10]="TRIANGLEARRAY",d[d.ENDFILE=11]="ENDFILE",d[d.BOUNDINGBOX=12]="BOUNDINGBOX",d[d.JPEGTEXTURE=13]="JPEGTEXTURE",d))(BG3DTagType||{});function parseBG3D(d,m){const g=new DataView(d);let w=0;if(String.fromCharCode(g.getUint8(w++),g.getUint8(w++),g.getUint8(w++),g.getUint8(w++))!=="BG3D")throw new Error("Not a BG3D file");w+=16;const P=[],F=[{children:[]}];let D=!1;const U=[F[0]];let Z=F[0],$=null,j=null;for(;!D&&w<d.byteLength&&!(w+4>d.byteLength);){const W=w,Q=g.getUint32(w,!1);switch(console.log(`[parseBG3D] Read tag ${BG3DTagType[Q]??Q} (value: ${Q}) at offset ${W}`),w+=4,Q){case 0:{const K=g.getUint32(w,!1);w+=4,j={flags:K,diffuseColor:[1,1,1,1],textures:[]},P.push(j);break}case 1:{if(!j)throw new Error("No current material for diffuse color");const K=g.getFloat32(w,!1);w+=4;const q=g.getFloat32(w,!1);w+=4;const et=g.getFloat32(w,!1);w+=4;const X=g.getFloat32(w,!1);w+=4,j.diffuseColor=[K,q,et,X];break}case 2:{if(!j)throw new Error("No current material for texture");const K=g.getUint32(w,!1);w+=4;const q=g.getUint32(w,!1);w+=4;const et=g.getUint32(w,!1);w+=4;const X=g.getUint32(w,!1);w+=4;const tt=g.getUint32(w,!1);w+=4,w+=16;const rt=new Uint8Array(d,w,tt);w+=tt,console.log(`SrcFormat: ${et}, DstFormat: ${X}`),console.log(`Texture src format: ${getPixelFormatSrcName(et)}, dst format: ${getPixelFormatDstName(X)}`),j.textures.push({width:K,height:q,srcPixelFormat:et,dstPixelFormat:X,bufferSize:tt,pixels:rt});break}case 3:{const K={children:[]};Z.children.push(K),U.push(K),Z=K;break}case 4:{if(U.length===0)throw new Error(`GROUPEND tag found with no open group at offset ${W}`);if(U.length>0)U.pop(),Z=U[U.length-1];else throw new Error("GROUPEND tag found with no open group");break}case 5:{if(!Z)throw new Error(`GEOMETRY tag found outside of a group at offset ${W}`);const K=g.getUint32(w,!1);w+=4;const q=g.getUint32(w,!1);w+=4;const et=[g.getUint32(w,!1),g.getUint32(w+4,!1),g.getUint32(w+8,!1),g.getUint32(w+12,!1)];w+=16;const X=g.getUint32(w,!1);w+=4;const tt=g.getUint32(w,!1);w+=4;const rt=g.getUint32(w,!1);w+=4;const ot={type:K,numMaterials:q,layerMaterialNum:et,flags:X,numPoints:tt,numTriangles:rt};Z.children.push(ot),$=ot,w+=16;break}case 6:{if(!$)throw new Error("No geometry for vertex array");const K=$.numPoints,q=[];for(let et=0;et<K;et++){const X=g.getFloat32(w,!1);w+=4;const tt=g.getFloat32(w,!1);w+=4;const rt=g.getFloat32(w,!1);w+=4,q.push([X,tt,rt])}$.vertices=q;break}case 7:{if(!$)throw new Error("No geometry for normal array");const K=$.numPoints,q=[];for(let et=0;et<K;et++){const X=g.getFloat32(w,!1);w+=4;const tt=g.getFloat32(w,!1);w+=4;const rt=g.getFloat32(w,!1);w+=4,q.push([X,tt,rt])}$.normals=q;break}case 8:{if(!$)throw new Error("No geometry for uv array");const K=$.numPoints,q=[];for(let et=0;et<K;et++){const X=g.getFloat32(w,!1);w+=4;const tt=g.getFloat32(w,!1);w+=4,q.push([X,tt])}$.uvs=q;break}case 9:{if(!$)throw new Error("No geometry for color array");const K=$.numPoints,q=[];for(let et=0;et<K;et++){const X=g.getUint8(w++),tt=g.getUint8(w++),rt=g.getUint8(w++),ot=g.getUint8(w++);q.push([X,tt,rt,ot])}$.colors=q;break}case 10:{if(!$)throw new Error("No geometry for triangle array");const K=$.numTriangles,q=[];for(let et=0;et<K;et++){const X=g.getUint32(w,!1);w+=4;const tt=g.getUint32(w,!1);w+=4;const rt=g.getUint32(w,!1);w+=4,q.push([X,tt,rt])}$.triangles=q,$=null;break}case 12:{w+=24;break}case 11:{D=!0;break}default:throw new Error(`Unknown BG3D tag: ${Q} at offset ${w-4}`)}}if(U.length!==1)throw new Error(`Unbalanced group tags: ${U.length} group(s) at end of file`);function H(W){for(const V of W.children)if(isBG3DGroup(V)&&Array.isArray(V.children))H(V);else{const Q=V;if(Q.layerMaterialNum)for(let K=0;K<Q.numMaterials;K++){const q=Q.layerMaterialNum[K];if(q<0||q>=P.length)throw new Error(`Geometry references invalid material index ${q} (materials length: ${P.length}) in group validation`)}}}for(const W of F)H(W);if(F.length===0)throw new Error("No groups found in BG3D file");if(P.length===0)throw new Error("No materials found in BG3D file");return{materials:P,groups:F,skeleton:m?convertSkeletonResourceToBG3D(m):void 0}}function convertSkeletonResourceToBG3D(d){const g=Object.values(d.Hedr)[0]?.obj||{version:0,numAnims:0,numJoints:0,num3DMFLimbs:0},w=[],I=Object.entries(d.Bone||{});I.sort(([,D],[,U])=>D.order-U.order),I.forEach(([D,U])=>{const Z=U.obj;console.log(`Bone ${D} raw obj:`,Z),console.log(`Bone ${D} full entry:`,U),console.log(`Bone ${D} raw data keys:`,Object.keys(Z||{}));const $=[],j=d.BonP?.[D];j&&$.push(...j.obj.map(V=>V.pointIndex));const H=[],W=d.BonN?.[D];W&&H.push(...W.obj.map(V=>V.normal)),w.push({parentBone:Z.parentBone,name:Z.name,coordX:Z.coordX,coordY:Z.coordY,coordZ:Z.coordZ,numPointsAttachedToBone:Z.numPointsAttachedToBone,numNormalsAttachedToBone:Z.numNormalsAttachedToBone,pointIndices:$,normalIndices:H})});const P=[],F=Object.entries(d.AnHd||{});return F.sort(([D],[U])=>parseInt(D,10)-parseInt(U,10)),F.forEach(([D,U],Z)=>{const $=U.obj,H=parseInt(D,10)-1e3,W=[],V=d.Evnt?.[D];V&&V.obj.forEach(q=>{W.push({time:q.time,type:q.type,value:q.value})});const Q={};for(let q=0;q<w.length;q++)Q[q]=[];Z===0&&(console.log(`Animation mapping debug: AnHd ID ${D} maps to animation index ${H}`),console.log("Available KeyF resources:",Object.keys(d.KeyF||{}).length));for(let q=0;q<w.length;q++){const et=(1e3+H*100+q).toString(),X=d.KeyF?.[et];if(Z<3&&console.log(`Animation ${H} (${$.animName}), bone ${q}: KeyF resource ID ${et}, found: ${!!X}`),X&&X.obj&&Array.isArray(X.obj)){if(Z<3&&(console.log(`  Found ${X.obj.length} keyframes for bone ${q} in animation ${H}`),X.obj.length>0)){const tt=X.obj[0],rt=X.obj[X.obj.length-1];console.log(`  First keyframe: tick=${tt.tick}, coord=[${tt.coordX}, ${tt.coordY}, ${tt.coordZ}]`),console.log(`  Last keyframe: tick=${rt.tick}, coord=[${rt.coordX}, ${rt.coordY}, ${rt.coordZ}]`)}X.obj.forEach(tt=>{Q[q].push({tick:tt.tick,accelerationMode:tt.accelerationMode,coordX:tt.coordX,coordY:tt.coordY,coordZ:tt.coordZ,rotationX:tt.rotationX,rotationY:tt.rotationY,rotationZ:tt.rotationZ,scaleX:tt.scaleX,scaleY:tt.scaleY,scaleZ:tt.scaleZ})})}else if(Z<3){const tt=X?.obj?`obj type: ${typeof X.obj}, is array: ${Array.isArray(X.obj)}, length: ${X.obj.length||"N/A"}`:"no obj";console.log(`  KeyF resource ${et} is ${X?`present but: ${tt}`:"missing"}`),X?.obj&&!Array.isArray(X.obj)&&console.log("  KeyF obj structure:",X.obj)}}const K=Object.values(Q).reduce((q,et)=>q+et.length,0);console.log(`Animation ${H} (${$.animName}): ${K} total keyframes across ${w.length} bones`),P.push({name:$.animName,numAnimEvents:$.numAnimEvents,events:W,keyframes:Q})}),{version:g.version,numAnims:g.numAnims,numJoints:g.numJoints,num3DMFLimbs:g.num3DMFLimbs,bones:w,animations:P}}function bg3dParsedToBG3D(d){let m=0;const g=1024*1024*10,w=new ArrayBuffer(g),I=new DataView(w);I.setUint8(m++,66),I.setUint8(m++,71),I.setUint8(m++,51),I.setUint8(m++,68);for(let P=0;P<16;P++)I.setUint8(m++,0);console.log("Writing header at offset",m);for(const P of d.materials){console.log(`[bg3dParsedToBG3D] Write MATERIALFLAGS at offset ${m}`),I.setUint32(m,0,!1),m+=4,I.setUint32(m,P.flags,!1),m+=4,console.log(`[bg3dParsedToBG3D] Write MATERIALDIFFUSECOLOR at offset ${m}`),I.setUint32(m,1,!1),m+=4;for(let F=0;F<4;F++)I.setFloat32(m,P.diffuseColor[F],!1),m+=4;for(const F of P.textures){console.log(`[bg3dParsedToBG3D] Write TEXTUREMAP at offset ${m}`),I.setUint32(m,2,!1),m+=4,I.setUint32(m,F.width,!1),m+=4,I.setUint32(m,F.height,!1),m+=4,I.setUint32(m,F.srcPixelFormat,!1),m+=4,I.setUint32(m,F.dstPixelFormat,!1),m+=4,I.setUint32(m,F.bufferSize,!1),m+=4;for(let D=0;D<4;D++)I.setUint32(m,0,!1),m+=4;new Uint8Array(w,m,F.bufferSize).set(F.pixels),m+=F.bufferSize}}return console.log("NUM PARSED GROUPS:",d.groups.length),d.groups.forEach(P=>{m=writeGroup(I,w,P,m,!0)}),console.log("Writing ENDFILE at offset",m),I.setUint32(m,11,!1),m+=4,w.slice(0,m)}function writeGroup(d,m,g,w,I){let P=w;I||(console.log(`[bg3dParsedToBG3D] Write GROUPSTART at offset ${P}`),d.setUint32(P,3,!1),P+=4);for(const F of g.children)if(isBG3DGroup(F))P=writeGroup(d,m,F,P,!1);else{const D=F;console.log(`[bg3dParsedToBG3D] Write GEOMETRY at offset ${P}`),d.setUint32(P,5,!1),P+=4,d.setUint32(P,D.type,!1),P+=4,d.setInt32(P,D.numMaterials,!1),P+=4;for(let U=0;U<4;U++)d.setUint32(P,D.layerMaterialNum?.[U]??0,!1),P+=4;console.log("numMaterials:",D.numMaterials),console.log("layerMaterialNum:",D.layerMaterialNum),d.setUint32(P,D.flags,!1),P+=4,d.setUint32(P,D.numPoints,!1),P+=4,d.setUint32(P,D.numTriangles,!1),P+=4;for(let U=0;U<4;U++)d.setUint32(P,0,!1),P+=4;if(D.vertices){console.log(`[bg3dParsedToBG3D] Write VERTEXARRAY at offset ${P}`),d.setUint32(P,6,!1),P+=4;for(const[U,Z,$]of D.vertices)d.setFloat32(P,U,!1),P+=4,d.setFloat32(P,Z,!1),P+=4,d.setFloat32(P,$,!1),P+=4}if(D.normals){console.log(`[bg3dParsedToBG3D] Write NORMALARRAY at offset ${P}`),d.setUint32(P,7,!1),P+=4;for(const[U,Z,$]of D.normals)d.setFloat32(P,U,!1),P+=4,d.setFloat32(P,Z,!1),P+=4,d.setFloat32(P,$,!1),P+=4}if(D.uvs){console.log(`[bg3dParsedToBG3D] Write UVARRAY at offset ${P}`),d.setUint32(P,8,!1),P+=4;for(const[U,Z]of D.uvs)d.setFloat32(P,U,!1),P+=4,d.setFloat32(P,Z,!1),P+=4}if(D.colors){console.log(`[bg3dParsedToBG3D] Write COLORARRAY at offset ${P}`),d.setUint32(P,9,!1),P+=4;for(const[U,Z,$,j]of D.colors)d.setUint8(P++,U),d.setUint8(P++,Z),d.setUint8(P++,$),d.setUint8(P++,j)}if(D.triangles){console.log(`[bg3dParsedToBG3D] Write TRIANGLEARRAY at offset ${P}`),d.setUint32(P,10,!1),P+=4;for(const[U,Z,$]of D.triangles)d.setUint32(P,U,!1),P+=4,d.setUint32(P,Z,!1),P+=4,d.setUint32(P,$,!1),P+=4}}return I||(console.log(`[bg3dParsedToBG3D] Write GROUPEND at offset ${P}`),d.setUint32(P,4,!1),P+=4),P}function isBG3DGroup(d){return d!==null&&typeof d=="object"&&"children"in d&&Array.isArray(d.children)}var commonjsGlobal$1=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function commonjsRequire$1(d){throw new Error('Could not dynamically require "'+d+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var browser$2={exports:{}};(function(d,m){(function(g){d.exports=g()})(function(){return function(){function g(w,I,P){function F(Z,$){if(!I[Z]){if(!w[Z]){var j=typeof commonjsRequire$1=="function"&&commonjsRequire$1;if(!$&&j)return j(Z,!0);if(D)return D(Z,!0);var H=new Error("Cannot find module '"+Z+"'");throw H.code="MODULE_NOT_FOUND",H}var W=I[Z]={exports:{}};w[Z][0].call(W.exports,function(V){var Q=w[Z][1][V];return F(Q||V)},W,W.exports,g,w,I,P)}return I[Z].exports}for(var D=typeof commonjsRequire$1=="function"&&commonjsRequire$1,U=0;U<P.length;U++)F(P[U]);return F}return g}()({1:[function(g,w,I){(function(P){(function(){let F=g("./interlace"),D=[function(){},function(H,W,V,Q){if(Q===W.length)throw new Error("Ran out of data");let K=W[Q];H[V]=K,H[V+1]=K,H[V+2]=K,H[V+3]=255},function(H,W,V,Q){if(Q+1>=W.length)throw new Error("Ran out of data");let K=W[Q];H[V]=K,H[V+1]=K,H[V+2]=K,H[V+3]=W[Q+1]},function(H,W,V,Q){if(Q+2>=W.length)throw new Error("Ran out of data");H[V]=W[Q],H[V+1]=W[Q+1],H[V+2]=W[Q+2],H[V+3]=255},function(H,W,V,Q){if(Q+3>=W.length)throw new Error("Ran out of data");H[V]=W[Q],H[V+1]=W[Q+1],H[V+2]=W[Q+2],H[V+3]=W[Q+3]}],U=[function(){},function(H,W,V,Q){let K=W[0];H[V]=K,H[V+1]=K,H[V+2]=K,H[V+3]=Q},function(H,W,V){let Q=W[0];H[V]=Q,H[V+1]=Q,H[V+2]=Q,H[V+3]=W[1]},function(H,W,V,Q){H[V]=W[0],H[V+1]=W[1],H[V+2]=W[2],H[V+3]=Q},function(H,W,V){H[V]=W[0],H[V+1]=W[1],H[V+2]=W[2],H[V+3]=W[3]}];function Z(H,W){let V=[],Q=0;function K(){if(Q===H.length)throw new Error("Ran out of data");let q=H[Q];Q++;let et,X,tt,rt,ot,J,lt,st;switch(W){default:throw new Error("unrecognised depth");case 16:lt=H[Q],Q++,V.push((q<<8)+lt);break;case 4:lt=q&15,st=q>>4,V.push(st,lt);break;case 2:ot=q&3,J=q>>2&3,lt=q>>4&3,st=q>>6&3,V.push(st,lt,J,ot);break;case 1:et=q&1,X=q>>1&1,tt=q>>2&1,rt=q>>3&1,ot=q>>4&1,J=q>>5&1,lt=q>>6&1,st=q>>7&1,V.push(st,lt,J,ot,rt,tt,X,et);break}}return{get:function(q){for(;V.length<q;)K();let et=V.slice(0,q);return V=V.slice(q),et},resetAfterLine:function(){V.length=0},end:function(){if(Q!==H.length)throw new Error("extra data found")}}}function $(H,W,V,Q,K,q){let et=H.width,X=H.height,tt=H.index;for(let rt=0;rt<X;rt++)for(let ot=0;ot<et;ot++){let J=V(ot,rt,tt);D[Q](W,K,J,q),q+=Q}return q}function j(H,W,V,Q,K,q){let et=H.width,X=H.height,tt=H.index;for(let rt=0;rt<X;rt++){for(let ot=0;ot<et;ot++){let J=K.get(Q),lt=V(ot,rt,tt);U[Q](W,J,lt,q)}K.resetAfterLine()}}I.dataToBitMap=function(H,W){let V=W.width,Q=W.height,K=W.depth,q=W.bpp,et=W.interlace,X;K!==8&&(X=Z(H,K));let tt;K<=8?tt=P.alloc(V*Q*4):tt=new Uint16Array(V*Q*4);let rt=Math.pow(2,K)-1,ot=0,J,lt;if(et)J=F.getImagePasses(V,Q),lt=F.getInterlaceIterator(V,Q);else{let st=0;lt=function(){let ut=st;return st+=4,ut},J=[{width:V,height:Q}]}for(let st=0;st<J.length;st++)K===8?ot=$(J[st],tt,lt,q,H,ot):j(J[st],tt,lt,q,X,rt);if(K===8){if(ot!==H.length)throw new Error("extra data found")}else X.end();return tt}}).call(this)}).call(this,g("buffer").Buffer)},{"./interlace":11,buffer:32}],2:[function(g,w,I){(function(P){(function(){let F=g("./constants");w.exports=function(D,U,Z,$){let j=[F.COLORTYPE_COLOR_ALPHA,F.COLORTYPE_ALPHA].indexOf($.colorType)!==-1;if($.colorType===$.inputColorType){let rt=function(){let ot=new ArrayBuffer(2);return new DataView(ot).setInt16(0,256,!0),new Int16Array(ot)[0]!==256}();if($.bitDepth===8||$.bitDepth===16&&rt)return D}let H=$.bitDepth!==16?D:new Uint16Array(D.buffer),W=255,V=F.COLORTYPE_TO_BPP_MAP[$.inputColorType];V===4&&!$.inputHasAlpha&&(V=3);let Q=F.COLORTYPE_TO_BPP_MAP[$.colorType];$.bitDepth===16&&(W=65535,Q*=2);let K=P.alloc(U*Z*Q),q=0,et=0,X=$.bgColor||{};X.red===void 0&&(X.red=W),X.green===void 0&&(X.green=W),X.blue===void 0&&(X.blue=W);function tt(){let rt,ot,J,lt=W;switch($.inputColorType){case F.COLORTYPE_COLOR_ALPHA:lt=H[q+3],rt=H[q],ot=H[q+1],J=H[q+2];break;case F.COLORTYPE_COLOR:rt=H[q],ot=H[q+1],J=H[q+2];break;case F.COLORTYPE_ALPHA:lt=H[q+1],rt=H[q],ot=rt,J=rt;break;case F.COLORTYPE_GRAYSCALE:rt=H[q],ot=rt,J=rt;break;default:throw new Error("input color type:"+$.inputColorType+" is not supported at present")}return $.inputHasAlpha&&(j||(lt/=W,rt=Math.min(Math.max(Math.round((1-lt)*X.red+lt*rt),0),W),ot=Math.min(Math.max(Math.round((1-lt)*X.green+lt*ot),0),W),J=Math.min(Math.max(Math.round((1-lt)*X.blue+lt*J),0),W))),{red:rt,green:ot,blue:J,alpha:lt}}for(let rt=0;rt<Z;rt++)for(let ot=0;ot<U;ot++){let J=tt();switch($.colorType){case F.COLORTYPE_COLOR_ALPHA:case F.COLORTYPE_COLOR:$.bitDepth===8?(K[et]=J.red,K[et+1]=J.green,K[et+2]=J.blue,j&&(K[et+3]=J.alpha)):(K.writeUInt16BE(J.red,et),K.writeUInt16BE(J.green,et+2),K.writeUInt16BE(J.blue,et+4),j&&K.writeUInt16BE(J.alpha,et+6));break;case F.COLORTYPE_ALPHA:case F.COLORTYPE_GRAYSCALE:{let lt=(J.red+J.green+J.blue)/3;$.bitDepth===8?(K[et]=lt,j&&(K[et+1]=J.alpha)):(K.writeUInt16BE(lt,et),j&&K.writeUInt16BE(J.alpha,et+2));break}default:throw new Error("unrecognised color Type "+$.colorType)}q+=V,et+=Q}return K}}).call(this)}).call(this,g("buffer").Buffer)},{"./constants":4,buffer:32}],3:[function(g,w,I){(function(P,F){(function(){let D=g("util"),U=g("stream"),Z=w.exports=function(){U.call(this),this._buffers=[],this._buffered=0,this._reads=[],this._paused=!1,this._encoding="utf8",this.writable=!0};D.inherits(Z,U),Z.prototype.read=function($,j){this._reads.push({length:Math.abs($),allowLess:$<0,func:j}),P.nextTick(function(){this._process(),this._paused&&this._reads&&this._reads.length>0&&(this._paused=!1,this.emit("drain"))}.bind(this))},Z.prototype.write=function($,j){if(!this.writable)return this.emit("error",new Error("Stream not writable")),!1;let H;return F.isBuffer($)?H=$:H=F.from($,j||this._encoding),this._buffers.push(H),this._buffered+=H.length,this._process(),this._reads&&this._reads.length===0&&(this._paused=!0),this.writable&&!this._paused},Z.prototype.end=function($,j){$&&this.write($,j),this.writable=!1,this._buffers&&(this._buffers.length===0?this._end():(this._buffers.push(null),this._process()))},Z.prototype.destroySoon=Z.prototype.end,Z.prototype._end=function(){this._reads.length>0&&this.emit("error",new Error("Unexpected end of input")),this.destroy()},Z.prototype.destroy=function(){this._buffers&&(this.writable=!1,this._reads=null,this._buffers=null,this.emit("close"))},Z.prototype._processReadAllowingLess=function($){this._reads.shift();let j=this._buffers[0];j.length>$.length?(this._buffered-=$.length,this._buffers[0]=j.slice($.length),$.func.call(this,j.slice(0,$.length))):(this._buffered-=j.length,this._buffers.shift(),$.func.call(this,j))},Z.prototype._processRead=function($){this._reads.shift();let j=0,H=0,W=F.alloc($.length);for(;j<$.length;){let V=this._buffers[H++],Q=Math.min(V.length,$.length-j);V.copy(W,j,0,Q),j+=Q,Q!==V.length&&(this._buffers[--H]=V.slice(Q))}H>0&&this._buffers.splice(0,H),this._buffered-=$.length,$.func.call(this,W)},Z.prototype._process=function(){try{for(;this._buffered>0&&this._reads&&this._reads.length>0;){let $=this._reads[0];if($.allowLess)this._processReadAllowingLess($);else if(this._buffered>=$.length)this._processRead($);else break}this._buffers&&!this.writable&&this._end()}catch($){this.emit("error",$)}}}).call(this)}).call(this,g("_process"),g("buffer").Buffer)},{_process:63,buffer:32,stream:65,util:84}],4:[function(g,w,I){w.exports={PNG_SIGNATURE:[137,80,78,71,13,10,26,10],TYPE_IHDR:1229472850,TYPE_IEND:1229278788,TYPE_IDAT:1229209940,TYPE_PLTE:1347179589,TYPE_tRNS:1951551059,TYPE_gAMA:1732332865,COLORTYPE_GRAYSCALE:0,COLORTYPE_PALETTE:1,COLORTYPE_COLOR:2,COLORTYPE_ALPHA:4,COLORTYPE_PALETTE_COLOR:3,COLORTYPE_COLOR_ALPHA:6,COLORTYPE_TO_BPP_MAP:{0:1,2:3,3:1,4:2,6:4},GAMMA_DIVISION:1e5}},{}],5:[function(g,w,I){let P=[];(function(){for(let D=0;D<256;D++){let U=D;for(let Z=0;Z<8;Z++)U&1?U=3988292384^U>>>1:U=U>>>1;P[D]=U}})();let F=w.exports=function(){this._crc=-1};F.prototype.write=function(D){for(let U=0;U<D.length;U++)this._crc=P[(this._crc^D[U])&255]^this._crc>>>8;return!0},F.prototype.crc32=function(){return this._crc^-1},F.crc32=function(D){let U=-1;for(let Z=0;Z<D.length;Z++)U=P[(U^D[Z])&255]^U>>>8;return U^-1}},{}],6:[function(g,w,I){(function(P){(function(){let F=g("./paeth-predictor");function D(X,tt,rt,ot,J){for(let lt=0;lt<rt;lt++)ot[J+lt]=X[tt+lt]}function U(X,tt,rt){let ot=0,J=tt+rt;for(let lt=tt;lt<J;lt++)ot+=Math.abs(X[lt]);return ot}function Z(X,tt,rt,ot,J,lt){for(let st=0;st<rt;st++){let ut=st>=lt?X[tt+st-lt]:0,it=X[tt+st]-ut;ot[J+st]=it}}function $(X,tt,rt,ot){let J=0;for(let lt=0;lt<rt;lt++){let st=lt>=ot?X[tt+lt-ot]:0,ut=X[tt+lt]-st;J+=Math.abs(ut)}return J}function j(X,tt,rt,ot,J){for(let lt=0;lt<rt;lt++){let st=tt>0?X[tt+lt-rt]:0,ut=X[tt+lt]-st;ot[J+lt]=ut}}function H(X,tt,rt){let ot=0,J=tt+rt;for(let lt=tt;lt<J;lt++){let st=tt>0?X[lt-rt]:0,ut=X[lt]-st;ot+=Math.abs(ut)}return ot}function W(X,tt,rt,ot,J,lt){for(let st=0;st<rt;st++){let ut=st>=lt?X[tt+st-lt]:0,it=tt>0?X[tt+st-rt]:0,ct=X[tt+st]-(ut+it>>1);ot[J+st]=ct}}function V(X,tt,rt,ot){let J=0;for(let lt=0;lt<rt;lt++){let st=lt>=ot?X[tt+lt-ot]:0,ut=tt>0?X[tt+lt-rt]:0,it=X[tt+lt]-(st+ut>>1);J+=Math.abs(it)}return J}function Q(X,tt,rt,ot,J,lt){for(let st=0;st<rt;st++){let ut=st>=lt?X[tt+st-lt]:0,it=tt>0?X[tt+st-rt]:0,ct=tt>0&&st>=lt?X[tt+st-(rt+lt)]:0,At=X[tt+st]-F(ut,it,ct);ot[J+st]=At}}function K(X,tt,rt,ot){let J=0;for(let lt=0;lt<rt;lt++){let st=lt>=ot?X[tt+lt-ot]:0,ut=tt>0?X[tt+lt-rt]:0,it=tt>0&&lt>=ot?X[tt+lt-(rt+ot)]:0,ct=X[tt+lt]-F(st,ut,it);J+=Math.abs(ct)}return J}let q={0:D,1:Z,2:j,3:W,4:Q},et={0:U,1:$,2:H,3:V,4:K};w.exports=function(X,tt,rt,ot,J){let lt;if(!("filterType"in ot)||ot.filterType===-1)lt=[0,1,2,3,4];else if(typeof ot.filterType=="number")lt=[ot.filterType];else throw new Error("unrecognised filter types");ot.bitDepth===16&&(J*=2);let st=tt*J,ut=0,it=0,ct=P.alloc((st+1)*rt),At=lt[0];for(let Et=0;Et<rt;Et++){if(lt.length>1){let gt=1/0;for(let pt=0;pt<lt.length;pt++){let vt=et[lt[pt]](X,it,st,J);vt<gt&&(At=lt[pt],gt=vt)}}ct[ut]=At,ut++,q[At](X,it,st,ct,ut,J),ut+=st,it+=st}return ct}}).call(this)}).call(this,g("buffer").Buffer)},{"./paeth-predictor":15,buffer:32}],7:[function(g,w,I){(function(P){(function(){let F=g("util"),D=g("./chunkstream"),U=g("./filter-parse"),Z=w.exports=function($){D.call(this);let j=[],H=this;this._filter=new U($,{read:this.read.bind(this),write:function(W){j.push(W)},complete:function(){H.emit("complete",P.concat(j))}}),this._filter.start()};F.inherits(Z,D)}).call(this)}).call(this,g("buffer").Buffer)},{"./chunkstream":3,"./filter-parse":9,buffer:32,util:84}],8:[function(g,w,I){(function(P){(function(){let F=g("./sync-reader"),D=g("./filter-parse");I.process=function(U,Z){let $=[],j=new F(U);return new D(Z,{read:j.read.bind(j),write:function(W){$.push(W)},complete:function(){}}).start(),j.process(),P.concat($)}}).call(this)}).call(this,g("buffer").Buffer)},{"./filter-parse":9,"./sync-reader":22,buffer:32}],9:[function(g,w,I){(function(P){(function(){let F=g("./interlace"),D=g("./paeth-predictor");function U($,j,H){let W=$*j;return H!==8&&(W=Math.ceil(W/(8/H))),W}let Z=w.exports=function($,j){let H=$.width,W=$.height,V=$.interlace,Q=$.bpp,K=$.depth;if(this.read=j.read,this.write=j.write,this.complete=j.complete,this._imageIndex=0,this._images=[],V){let q=F.getImagePasses(H,W);for(let et=0;et<q.length;et++)this._images.push({byteWidth:U(q[et].width,Q,K),height:q[et].height,lineIndex:0})}else this._images.push({byteWidth:U(H,Q,K),height:W,lineIndex:0});K===8?this._xComparison=Q:K===16?this._xComparison=Q*2:this._xComparison=1};Z.prototype.start=function(){this.read(this._images[this._imageIndex].byteWidth+1,this._reverseFilterLine.bind(this))},Z.prototype._unFilterType1=function($,j,H){let W=this._xComparison,V=W-1;for(let Q=0;Q<H;Q++){let K=$[1+Q],q=Q>V?j[Q-W]:0;j[Q]=K+q}},Z.prototype._unFilterType2=function($,j,H){let W=this._lastLine;for(let V=0;V<H;V++){let Q=$[1+V],K=W?W[V]:0;j[V]=Q+K}},Z.prototype._unFilterType3=function($,j,H){let W=this._xComparison,V=W-1,Q=this._lastLine;for(let K=0;K<H;K++){let q=$[1+K],et=Q?Q[K]:0,X=K>V?j[K-W]:0,tt=Math.floor((X+et)/2);j[K]=q+tt}},Z.prototype._unFilterType4=function($,j,H){let W=this._xComparison,V=W-1,Q=this._lastLine;for(let K=0;K<H;K++){let q=$[1+K],et=Q?Q[K]:0,X=K>V?j[K-W]:0,tt=K>V&&Q?Q[K-W]:0,rt=D(X,et,tt);j[K]=q+rt}},Z.prototype._reverseFilterLine=function($){let j=$[0],H,W=this._images[this._imageIndex],V=W.byteWidth;if(j===0)H=$.slice(1,V+1);else switch(H=P.alloc(V),j){case 1:this._unFilterType1($,H,V);break;case 2:this._unFilterType2($,H,V);break;case 3:this._unFilterType3($,H,V);break;case 4:this._unFilterType4($,H,V);break;default:throw new Error("Unrecognised filter type - "+j)}this.write(H),W.lineIndex++,W.lineIndex>=W.height?(this._lastLine=null,this._imageIndex++,W=this._images[this._imageIndex]):this._lastLine=H,W?this.read(W.byteWidth+1,this._reverseFilterLine.bind(this)):(this._lastLine=null,this.complete())}}).call(this)}).call(this,g("buffer").Buffer)},{"./interlace":11,"./paeth-predictor":15,buffer:32}],10:[function(g,w,I){(function(P){(function(){function F(Z,$,j,H,W){let V=0;for(let Q=0;Q<H;Q++)for(let K=0;K<j;K++){let q=W[Z[V]];if(!q)throw new Error("index "+Z[V]+" not in palette");for(let et=0;et<4;et++)$[V+et]=q[et];V+=4}}function D(Z,$,j,H,W){let V=0;for(let Q=0;Q<H;Q++)for(let K=0;K<j;K++){let q=!1;if(W.length===1?W[0]===Z[V]&&(q=!0):W[0]===Z[V]&&W[1]===Z[V+1]&&W[2]===Z[V+2]&&(q=!0),q)for(let et=0;et<4;et++)$[V+et]=0;V+=4}}function U(Z,$,j,H,W){let V=255,Q=Math.pow(2,W)-1,K=0;for(let q=0;q<H;q++)for(let et=0;et<j;et++){for(let X=0;X<4;X++)$[K+X]=Math.floor(Z[K+X]*V/Q+.5);K+=4}}w.exports=function(Z,$,j=!1){let H=$.depth,W=$.width,V=$.height,Q=$.colorType,K=$.transColor,q=$.palette,et=Z;return Q===3?F(Z,et,W,V,q):(K&&D(Z,et,W,V,K),H!==8&&!j&&(H===16&&(et=P.alloc(W*V*4)),U(Z,et,W,V,H))),et}}).call(this)}).call(this,g("buffer").Buffer)},{buffer:32}],11:[function(g,w,I){let P=[{x:[0],y:[0]},{x:[4],y:[0]},{x:[0,4],y:[4]},{x:[2,6],y:[0,4]},{x:[0,2,4,6],y:[2,6]},{x:[1,3,5,7],y:[0,2,4,6]},{x:[0,1,2,3,4,5,6,7],y:[1,3,5,7]}];I.getImagePasses=function(F,D){let U=[],Z=F%8,$=D%8,j=(F-Z)/8,H=(D-$)/8;for(let W=0;W<P.length;W++){let V=P[W],Q=j*V.x.length,K=H*V.y.length;for(let q=0;q<V.x.length&&V.x[q]<Z;q++)Q++;for(let q=0;q<V.y.length&&V.y[q]<$;q++)K++;Q>0&&K>0&&U.push({width:Q,height:K,index:W})}return U},I.getInterlaceIterator=function(F){return function(D,U,Z){let $=D%P[Z].x.length,j=(D-$)/P[Z].x.length*8+P[Z].x[$],H=U%P[Z].y.length,W=(U-H)/P[Z].y.length*8+P[Z].y[H];return j*4+W*F*4}}},{}],12:[function(g,w,I){(function(P){(function(){let F=g("util"),D=g("stream"),U=g("./constants"),Z=g("./packer"),$=w.exports=function(j){D.call(this);let H=j||{};this._packer=new Z(H),this._deflate=this._packer.createDeflate(),this.readable=!0};F.inherits($,D),$.prototype.pack=function(j,H,W,V){this.emit("data",P.from(U.PNG_SIGNATURE)),this.emit("data",this._packer.packIHDR(H,W)),V&&this.emit("data",this._packer.packGAMA(V));let Q=this._packer.filterData(j,H,W);this._deflate.on("error",this.emit.bind(this,"error")),this._deflate.on("data",function(K){this.emit("data",this._packer.packIDAT(K))}.bind(this)),this._deflate.on("end",function(){this.emit("data",this._packer.packIEND()),this.emit("end")}.bind(this)),this._deflate.end(Q)}}).call(this)}).call(this,g("buffer").Buffer)},{"./constants":4,"./packer":14,buffer:32,stream:65,util:84}],13:[function(g,w,I){(function(P){(function(){let F=!0,D=g("zlib");D.deflateSync||(F=!1);let U=g("./constants"),Z=g("./packer");w.exports=function($,j){if(!F)throw new Error("To use the sync capability of this library in old node versions, please pin pngjs to v2.3.0");let H=j||{},W=new Z(H),V=[];V.push(P.from(U.PNG_SIGNATURE)),V.push(W.packIHDR($.width,$.height)),$.gamma&&V.push(W.packGAMA($.gamma));let Q=W.filterData($.data,$.width,$.height),K=D.deflateSync(Q,W.getDeflateOptions());if(Q=null,!K||!K.length)throw new Error("bad png - invalid compressed data response");return V.push(W.packIDAT(K)),V.push(W.packIEND()),P.concat(V)}}).call(this)}).call(this,g("buffer").Buffer)},{"./constants":4,"./packer":14,buffer:32,zlib:31}],14:[function(g,w,I){(function(P){(function(){let F=g("./constants"),D=g("./crc"),U=g("./bitpacker"),Z=g("./filter-pack"),$=g("zlib"),j=w.exports=function(H){if(this._options=H,H.deflateChunkSize=H.deflateChunkSize||32*1024,H.deflateLevel=H.deflateLevel!=null?H.deflateLevel:9,H.deflateStrategy=H.deflateStrategy!=null?H.deflateStrategy:3,H.inputHasAlpha=H.inputHasAlpha!=null?H.inputHasAlpha:!0,H.deflateFactory=H.deflateFactory||$.createDeflate,H.bitDepth=H.bitDepth||8,H.colorType=typeof H.colorType=="number"?H.colorType:F.COLORTYPE_COLOR_ALPHA,H.inputColorType=typeof H.inputColorType=="number"?H.inputColorType:F.COLORTYPE_COLOR_ALPHA,[F.COLORTYPE_GRAYSCALE,F.COLORTYPE_COLOR,F.COLORTYPE_COLOR_ALPHA,F.COLORTYPE_ALPHA].indexOf(H.colorType)===-1)throw new Error("option color type:"+H.colorType+" is not supported at present");if([F.COLORTYPE_GRAYSCALE,F.COLORTYPE_COLOR,F.COLORTYPE_COLOR_ALPHA,F.COLORTYPE_ALPHA].indexOf(H.inputColorType)===-1)throw new Error("option input color type:"+H.inputColorType+" is not supported at present");if(H.bitDepth!==8&&H.bitDepth!==16)throw new Error("option bit depth:"+H.bitDepth+" is not supported at present")};j.prototype.getDeflateOptions=function(){return{chunkSize:this._options.deflateChunkSize,level:this._options.deflateLevel,strategy:this._options.deflateStrategy}},j.prototype.createDeflate=function(){return this._options.deflateFactory(this.getDeflateOptions())},j.prototype.filterData=function(H,W,V){let Q=U(H,W,V,this._options),K=F.COLORTYPE_TO_BPP_MAP[this._options.colorType];return Z(Q,W,V,this._options,K)},j.prototype._packChunk=function(H,W){let V=W?W.length:0,Q=P.alloc(V+12);return Q.writeUInt32BE(V,0),Q.writeUInt32BE(H,4),W&&W.copy(Q,8),Q.writeInt32BE(D.crc32(Q.slice(4,Q.length-4)),Q.length-4),Q},j.prototype.packGAMA=function(H){let W=P.alloc(4);return W.writeUInt32BE(Math.floor(H*F.GAMMA_DIVISION),0),this._packChunk(F.TYPE_gAMA,W)},j.prototype.packIHDR=function(H,W){let V=P.alloc(13);return V.writeUInt32BE(H,0),V.writeUInt32BE(W,4),V[8]=this._options.bitDepth,V[9]=this._options.colorType,V[10]=0,V[11]=0,V[12]=0,this._packChunk(F.TYPE_IHDR,V)},j.prototype.packIDAT=function(H){return this._packChunk(F.TYPE_IDAT,H)},j.prototype.packIEND=function(){return this._packChunk(F.TYPE_IEND,null)}}).call(this)}).call(this,g("buffer").Buffer)},{"./bitpacker":2,"./constants":4,"./crc":5,"./filter-pack":6,buffer:32,zlib:31}],15:[function(g,w,I){w.exports=function(F,D,U){let Z=F+D-U,$=Math.abs(Z-F),j=Math.abs(Z-D),H=Math.abs(Z-U);return $<=j&&$<=H?F:j<=H?D:U}},{}],16:[function(g,w,I){let P=g("util"),F=g("zlib"),D=g("./chunkstream"),U=g("./filter-parse-async"),Z=g("./parser"),$=g("./bitmapper"),j=g("./format-normaliser"),H=w.exports=function(W){D.call(this),this._parser=new Z(W,{read:this.read.bind(this),error:this._handleError.bind(this),metadata:this._handleMetaData.bind(this),gamma:this.emit.bind(this,"gamma"),palette:this._handlePalette.bind(this),transColor:this._handleTransColor.bind(this),finished:this._finished.bind(this),inflateData:this._inflateData.bind(this),simpleTransparency:this._simpleTransparency.bind(this),headersFinished:this._headersFinished.bind(this)}),this._options=W,this.writable=!0,this._parser.start()};P.inherits(H,D),H.prototype._handleError=function(W){this.emit("error",W),this.writable=!1,this.destroy(),this._inflate&&this._inflate.destroy&&this._inflate.destroy(),this._filter&&(this._filter.destroy(),this._filter.on("error",function(){})),this.errord=!0},H.prototype._inflateData=function(W){if(!this._inflate)if(this._bitmapInfo.interlace)this._inflate=F.createInflate(),this._inflate.on("error",this.emit.bind(this,"error")),this._filter.on("complete",this._complete.bind(this)),this._inflate.pipe(this._filter);else{let Q=((this._bitmapInfo.width*this._bitmapInfo.bpp*this._bitmapInfo.depth+7>>3)+1)*this._bitmapInfo.height,K=Math.max(Q,F.Z_MIN_CHUNK);this._inflate=F.createInflate({chunkSize:K});let q=Q,et=this.emit.bind(this,"error");this._inflate.on("error",function(tt){q&&et(tt)}),this._filter.on("complete",this._complete.bind(this));let X=this._filter.write.bind(this._filter);this._inflate.on("data",function(tt){q&&(tt.length>q&&(tt=tt.slice(0,q)),q-=tt.length,X(tt))}),this._inflate.on("end",this._filter.end.bind(this._filter))}this._inflate.write(W)},H.prototype._handleMetaData=function(W){this._metaData=W,this._bitmapInfo=Object.create(W),this._filter=new U(this._bitmapInfo)},H.prototype._handleTransColor=function(W){this._bitmapInfo.transColor=W},H.prototype._handlePalette=function(W){this._bitmapInfo.palette=W},H.prototype._simpleTransparency=function(){this._metaData.alpha=!0},H.prototype._headersFinished=function(){this.emit("metadata",this._metaData)},H.prototype._finished=function(){this.errord||(this._inflate?this._inflate.end():this.emit("error","No Inflate block"))},H.prototype._complete=function(W){if(this.errord)return;let V;try{let Q=$.dataToBitMap(W,this._bitmapInfo);V=j(Q,this._bitmapInfo,this._options.skipRescale),Q=null}catch(Q){this._handleError(Q);return}this.emit("parsed",V)}},{"./bitmapper":1,"./chunkstream":3,"./filter-parse-async":7,"./format-normaliser":10,"./parser":18,util:84,zlib:31}],17:[function(g,w,I){(function(P){(function(){let F=!0,D=g("zlib"),U=g("./sync-inflate");D.deflateSync||(F=!1);let Z=g("./sync-reader"),$=g("./filter-parse-sync"),j=g("./parser"),H=g("./bitmapper"),W=g("./format-normaliser");w.exports=function(V,Q){if(!F)throw new Error("To use the sync capability of this library in old node versions, please pin pngjs to v2.3.0");let K;function q(Tt){K=Tt}let et;function X(Tt){et=Tt}function tt(Tt){et.transColor=Tt}function rt(Tt){et.palette=Tt}function ot(){et.alpha=!0}let J;function lt(Tt){J=Tt}let st=[];function ut(Tt){st.push(Tt)}let it=new Z(V);if(new j(Q,{read:it.read.bind(it),error:q,metadata:X,gamma:lt,palette:rt,transColor:tt,inflateData:ut,simpleTransparency:ot}).start(),it.process(),K)throw K;let At=P.concat(st);st.length=0;let Et;if(et.interlace)Et=D.inflateSync(At);else{let It=((et.width*et.bpp*et.depth+7>>3)+1)*et.height;Et=U(At,{chunkSize:It,maxLength:It})}if(At=null,!Et||!Et.length)throw new Error("bad png - invalid inflate data response");let gt=$.process(Et,et);At=null;let pt=H.dataToBitMap(gt,et);gt=null;let vt=W(pt,et,Q.skipRescale);return et.data=vt,et.gamma=J||0,et}}).call(this)}).call(this,g("buffer").Buffer)},{"./bitmapper":1,"./filter-parse-sync":8,"./format-normaliser":10,"./parser":18,"./sync-inflate":21,"./sync-reader":22,buffer:32,zlib:31}],18:[function(g,w,I){(function(P){(function(){let F=g("./constants"),D=g("./crc"),U=w.exports=function(Z,$){this._options=Z,Z.checkCRC=Z.checkCRC!==!1,this._hasIHDR=!1,this._hasIEND=!1,this._emittedHeadersFinished=!1,this._palette=[],this._colorType=0,this._chunks={},this._chunks[F.TYPE_IHDR]=this._handleIHDR.bind(this),this._chunks[F.TYPE_IEND]=this._handleIEND.bind(this),this._chunks[F.TYPE_IDAT]=this._handleIDAT.bind(this),this._chunks[F.TYPE_PLTE]=this._handlePLTE.bind(this),this._chunks[F.TYPE_tRNS]=this._handleTRNS.bind(this),this._chunks[F.TYPE_gAMA]=this._handleGAMA.bind(this),this.read=$.read,this.error=$.error,this.metadata=$.metadata,this.gamma=$.gamma,this.transColor=$.transColor,this.palette=$.palette,this.parsed=$.parsed,this.inflateData=$.inflateData,this.finished=$.finished,this.simpleTransparency=$.simpleTransparency,this.headersFinished=$.headersFinished||function(){}};U.prototype.start=function(){this.read(F.PNG_SIGNATURE.length,this._parseSignature.bind(this))},U.prototype._parseSignature=function(Z){let $=F.PNG_SIGNATURE;for(let j=0;j<$.length;j++)if(Z[j]!==$[j]){this.error(new Error("Invalid file signature"));return}this.read(8,this._parseChunkBegin.bind(this))},U.prototype._parseChunkBegin=function(Z){let $=Z.readUInt32BE(0),j=Z.readUInt32BE(4),H="";for(let V=4;V<8;V++)H+=String.fromCharCode(Z[V]);let W=!!(Z[4]&32);if(!this._hasIHDR&&j!==F.TYPE_IHDR){this.error(new Error("Expected IHDR on beggining"));return}if(this._crc=new D,this._crc.write(P.from(H)),this._chunks[j])return this._chunks[j]($);if(!W){this.error(new Error("Unsupported critical chunk type "+H));return}this.read($+4,this._skipChunk.bind(this))},U.prototype._skipChunk=function(){this.read(8,this._parseChunkBegin.bind(this))},U.prototype._handleChunkEnd=function(){this.read(4,this._parseChunkEnd.bind(this))},U.prototype._parseChunkEnd=function(Z){let $=Z.readInt32BE(0),j=this._crc.crc32();if(this._options.checkCRC&&j!==$){this.error(new Error("Crc error - "+$+" - "+j));return}this._hasIEND||this.read(8,this._parseChunkBegin.bind(this))},U.prototype._handleIHDR=function(Z){this.read(Z,this._parseIHDR.bind(this))},U.prototype._parseIHDR=function(Z){this._crc.write(Z);let $=Z.readUInt32BE(0),j=Z.readUInt32BE(4),H=Z[8],W=Z[9],V=Z[10],Q=Z[11],K=Z[12];if(H!==8&&H!==4&&H!==2&&H!==1&&H!==16){this.error(new Error("Unsupported bit depth "+H));return}if(!(W in F.COLORTYPE_TO_BPP_MAP)){this.error(new Error("Unsupported color type"));return}if(V!==0){this.error(new Error("Unsupported compression method"));return}if(Q!==0){this.error(new Error("Unsupported filter method"));return}if(K!==0&&K!==1){this.error(new Error("Unsupported interlace method"));return}this._colorType=W;let q=F.COLORTYPE_TO_BPP_MAP[this._colorType];this._hasIHDR=!0,this.metadata({width:$,height:j,depth:H,interlace:!!K,palette:!!(W&F.COLORTYPE_PALETTE),color:!!(W&F.COLORTYPE_COLOR),alpha:!!(W&F.COLORTYPE_ALPHA),bpp:q,colorType:W}),this._handleChunkEnd()},U.prototype._handlePLTE=function(Z){this.read(Z,this._parsePLTE.bind(this))},U.prototype._parsePLTE=function(Z){this._crc.write(Z);let $=Math.floor(Z.length/3);for(let j=0;j<$;j++)this._palette.push([Z[j*3],Z[j*3+1],Z[j*3+2],255]);this.palette(this._palette),this._handleChunkEnd()},U.prototype._handleTRNS=function(Z){this.simpleTransparency(),this.read(Z,this._parseTRNS.bind(this))},U.prototype._parseTRNS=function(Z){if(this._crc.write(Z),this._colorType===F.COLORTYPE_PALETTE_COLOR){if(this._palette.length===0){this.error(new Error("Transparency chunk must be after palette"));return}if(Z.length>this._palette.length){this.error(new Error("More transparent colors than palette size"));return}for(let $=0;$<Z.length;$++)this._palette[$][3]=Z[$];this.palette(this._palette)}this._colorType===F.COLORTYPE_GRAYSCALE&&this.transColor([Z.readUInt16BE(0)]),this._colorType===F.COLORTYPE_COLOR&&this.transColor([Z.readUInt16BE(0),Z.readUInt16BE(2),Z.readUInt16BE(4)]),this._handleChunkEnd()},U.prototype._handleGAMA=function(Z){this.read(Z,this._parseGAMA.bind(this))},U.prototype._parseGAMA=function(Z){this._crc.write(Z),this.gamma(Z.readUInt32BE(0)/F.GAMMA_DIVISION),this._handleChunkEnd()},U.prototype._handleIDAT=function(Z){this._emittedHeadersFinished||(this._emittedHeadersFinished=!0,this.headersFinished()),this.read(-Z,this._parseIDAT.bind(this,Z))},U.prototype._parseIDAT=function(Z,$){if(this._crc.write($),this._colorType===F.COLORTYPE_PALETTE_COLOR&&this._palette.length===0)throw new Error("Expected palette not found");this.inflateData($);let j=Z-$.length;j>0?this._handleIDAT(j):this._handleChunkEnd()},U.prototype._handleIEND=function(Z){this.read(Z,this._parseIEND.bind(this))},U.prototype._parseIEND=function(Z){this._crc.write(Z),this._hasIEND=!0,this._handleChunkEnd(),this.finished&&this.finished()}}).call(this)}).call(this,g("buffer").Buffer)},{"./constants":4,"./crc":5,buffer:32}],19:[function(g,w,I){let P=g("./parser-sync"),F=g("./packer-sync");I.read=function(D,U){return P(D,U||{})},I.write=function(D,U){return F(D,U)}},{"./packer-sync":13,"./parser-sync":17}],20:[function(g,w,I){(function(P,F){(function(){let D=g("util"),U=g("stream"),Z=g("./parser-async"),$=g("./packer-async"),j=g("./png-sync"),H=I.PNG=function(W){U.call(this),W=W||{},this.width=W.width|0,this.height=W.height|0,this.data=this.width>0&&this.height>0?F.alloc(4*this.width*this.height):null,W.fill&&this.data&&this.data.fill(0),this.gamma=0,this.readable=this.writable=!0,this._parser=new Z(W),this._parser.on("error",this.emit.bind(this,"error")),this._parser.on("close",this._handleClose.bind(this)),this._parser.on("metadata",this._metadata.bind(this)),this._parser.on("gamma",this._gamma.bind(this)),this._parser.on("parsed",function(V){this.data=V,this.emit("parsed",V)}.bind(this)),this._packer=new $(W),this._packer.on("data",this.emit.bind(this,"data")),this._packer.on("end",this.emit.bind(this,"end")),this._parser.on("close",this._handleClose.bind(this)),this._packer.on("error",this.emit.bind(this,"error"))};D.inherits(H,U),H.sync=j,H.prototype.pack=function(){return!this.data||!this.data.length?(this.emit("error","No data provided"),this):(P.nextTick(function(){this._packer.pack(this.data,this.width,this.height,this.gamma)}.bind(this)),this)},H.prototype.parse=function(W,V){if(V){let Q,K;Q=function(q){this.removeListener("error",K),this.data=q,V(null,this)}.bind(this),K=function(q){this.removeListener("parsed",Q),V(q,null)}.bind(this),this.once("parsed",Q),this.once("error",K)}return this.end(W),this},H.prototype.write=function(W){return this._parser.write(W),!0},H.prototype.end=function(W){this._parser.end(W)},H.prototype._metadata=function(W){this.width=W.width,this.height=W.height,this.emit("metadata",W)},H.prototype._gamma=function(W){this.gamma=W},H.prototype._handleClose=function(){!this._parser.writable&&!this._packer.readable&&this.emit("close")},H.bitblt=function(W,V,Q,K,q,et,X,tt){if(Q|=0,K|=0,q|=0,et|=0,X|=0,tt|=0,Q>W.width||K>W.height||Q+q>W.width||K+et>W.height)throw new Error("bitblt reading outside image");if(X>V.width||tt>V.height||X+q>V.width||tt+et>V.height)throw new Error("bitblt writing outside image");for(let rt=0;rt<et;rt++)W.data.copy(V.data,(tt+rt)*V.width+X<<2,(K+rt)*W.width+Q<<2,(K+rt)*W.width+Q+q<<2)},H.prototype.bitblt=function(W,V,Q,K,q,et,X){return H.bitblt(this,W,V,Q,K,q,et,X),this},H.adjustGamma=function(W){if(W.gamma){for(let V=0;V<W.height;V++)for(let Q=0;Q<W.width;Q++){let K=W.width*V+Q<<2;for(let q=0;q<3;q++){let et=W.data[K+q]/255;et=Math.pow(et,1/2.2/W.gamma),W.data[K+q]=Math.round(et*255)}}W.gamma=0}},H.prototype.adjustGamma=function(){H.adjustGamma(this)}}).call(this)}).call(this,g("_process"),g("buffer").Buffer)},{"./packer-async":12,"./parser-async":16,"./png-sync":19,_process:63,buffer:32,stream:65,util:84}],21:[function(g,w,I){(function(P,F){(function(){let D=g("assert").ok,U=g("zlib"),Z=g("util"),$=g("buffer").kMaxLength;function j(K){if(!(this instanceof j))return new j(K);K&&K.chunkSize<U.Z_MIN_CHUNK&&(K.chunkSize=U.Z_MIN_CHUNK),U.Inflate.call(this,K),this._offset=this._offset===void 0?this._outOffset:this._offset,this._buffer=this._buffer||this._outBuffer,K&&K.maxLength!=null&&(this._maxLength=K.maxLength)}function H(K){return new j(K)}function W(K,q){K._handle&&(K._handle.close(),K._handle=null)}j.prototype._processChunk=function(K,q,et){if(typeof et=="function")return U.Inflate._processChunk.call(this,K,q,et);let X=this,tt=K&&K.length,rt=this._chunkSize-this._offset,ot=this._maxLength,J=0,lt=[],st=0,ut;this.on("error",function(Et){ut=Et});function it(Et,gt){if(X._hadError)return;let pt=rt-gt;if(D(pt>=0,"have should not go down"),pt>0){let vt=X._buffer.slice(X._offset,X._offset+pt);if(X._offset+=pt,vt.length>ot&&(vt=vt.slice(0,ot)),lt.push(vt),st+=vt.length,ot-=vt.length,ot===0)return!1}return(gt===0||X._offset>=X._chunkSize)&&(rt=X._chunkSize,X._offset=0,X._buffer=F.allocUnsafe(X._chunkSize)),gt===0?(J+=tt-Et,tt=Et,!0):!1}D(this._handle,"zlib binding closed");let ct;do ct=this._handle.writeSync(q,K,J,tt,this._buffer,this._offset,rt),ct=ct||this._writeState;while(!this._hadError&&it(ct[0],ct[1]));if(this._hadError)throw ut;if(st>=$)throw W(this),new RangeError("Cannot create final Buffer. It would be larger than 0x"+$.toString(16)+" bytes");let At=F.concat(lt,st);return W(this),At},Z.inherits(j,U.Inflate);function V(K,q){if(typeof q=="string"&&(q=F.from(q)),!(q instanceof F))throw new TypeError("Not a string or buffer");let et=K._finishFlushFlag;return et==null&&(et=U.Z_FINISH),K._processChunk(q,et)}function Q(K,q){return V(new j(q),K)}w.exports=I=Q,I.Inflate=j,I.createInflate=H,I.inflateSync=Q}).call(this)}).call(this,g("_process"),g("buffer").Buffer)},{_process:63,assert:23,buffer:32,util:84,zlib:31}],22:[function(g,w,I){let P=w.exports=function(F){this._buffer=F,this._reads=[]};P.prototype.read=function(F,D){this._reads.push({length:Math.abs(F),allowLess:F<0,func:D})},P.prototype.process=function(){for(;this._reads.length>0&&this._buffer.length;){let F=this._reads[0];if(this._buffer.length&&(this._buffer.length>=F.length||F.allowLess)){this._reads.shift();let D=this._buffer;this._buffer=D.slice(F.length),F.func.call(this,D.slice(0,F.length))}else break}if(this._reads.length>0)throw new Error("There are some read requests waitng on finished stream");if(this._buffer.length>0)throw new Error("unrecognised content at end of stream")}},{}],23:[function(g,w,I){(function(P){(function(){var F=g("object-assign");/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */function D(pt,vt){if(pt===vt)return 0;for(var Tt=pt.length,It=vt.length,$t=0,Bt=Math.min(Tt,It);$t<Bt;++$t)if(pt[$t]!==vt[$t]){Tt=pt[$t],It=vt[$t];break}return Tt<It?-1:It<Tt?1:0}function U(pt){return P.Buffer&&typeof P.Buffer.isBuffer=="function"?P.Buffer.isBuffer(pt):!!(pt!=null&&pt._isBuffer)}var Z=g("util/"),$=Object.prototype.hasOwnProperty,j=Array.prototype.slice,H=function(){return function(){}.name==="foo"}();function W(pt){return Object.prototype.toString.call(pt)}function V(pt){return U(pt)||typeof P.ArrayBuffer!="function"?!1:typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(pt):pt?!!(pt instanceof DataView||pt.buffer&&pt.buffer instanceof ArrayBuffer):!1}var Q=w.exports=ot,K=/\s*function\s+([^\(\s]*)\s*/;function q(pt){if(Z.isFunction(pt)){if(H)return pt.name;var vt=pt.toString(),Tt=vt.match(K);return Tt&&Tt[1]}}Q.AssertionError=function(vt){this.name="AssertionError",this.actual=vt.actual,this.expected=vt.expected,this.operator=vt.operator,vt.message?(this.message=vt.message,this.generatedMessage=!1):(this.message=tt(this),this.generatedMessage=!0);var Tt=vt.stackStartFunction||rt;if(Error.captureStackTrace)Error.captureStackTrace(this,Tt);else{var It=new Error;if(It.stack){var $t=It.stack,Bt=q(Tt),zt=$t.indexOf(`
`+Bt);if(zt>=0){var Ot=$t.indexOf(`
`,zt+1);$t=$t.substring(Ot+1)}this.stack=$t}}},Z.inherits(Q.AssertionError,Error);function et(pt,vt){return typeof pt=="string"?pt.length<vt?pt:pt.slice(0,vt):pt}function X(pt){if(H||!Z.isFunction(pt))return Z.inspect(pt);var vt=q(pt),Tt=vt?": "+vt:"";return"[Function"+Tt+"]"}function tt(pt){return et(X(pt.actual),128)+" "+pt.operator+" "+et(X(pt.expected),128)}function rt(pt,vt,Tt,It,$t){throw new Q.AssertionError({message:Tt,actual:pt,expected:vt,operator:It,stackStartFunction:$t})}Q.fail=rt;function ot(pt,vt){pt||rt(pt,!0,vt,"==",Q.ok)}Q.ok=ot,Q.equal=function(vt,Tt,It){vt!=Tt&&rt(vt,Tt,It,"==",Q.equal)},Q.notEqual=function(vt,Tt,It){vt==Tt&&rt(vt,Tt,It,"!=",Q.notEqual)},Q.deepEqual=function(vt,Tt,It){J(vt,Tt,!1)||rt(vt,Tt,It,"deepEqual",Q.deepEqual)},Q.deepStrictEqual=function(vt,Tt,It){J(vt,Tt,!0)||rt(vt,Tt,It,"deepStrictEqual",Q.deepStrictEqual)};function J(pt,vt,Tt,It){if(pt===vt)return!0;if(U(pt)&&U(vt))return D(pt,vt)===0;if(Z.isDate(pt)&&Z.isDate(vt))return pt.getTime()===vt.getTime();if(Z.isRegExp(pt)&&Z.isRegExp(vt))return pt.source===vt.source&&pt.global===vt.global&&pt.multiline===vt.multiline&&pt.lastIndex===vt.lastIndex&&pt.ignoreCase===vt.ignoreCase;if((pt===null||typeof pt!="object")&&(vt===null||typeof vt!="object"))return Tt?pt===vt:pt==vt;if(V(pt)&&V(vt)&&W(pt)===W(vt)&&!(pt instanceof Float32Array||pt instanceof Float64Array))return D(new Uint8Array(pt.buffer),new Uint8Array(vt.buffer))===0;if(U(pt)!==U(vt))return!1;It=It||{actual:[],expected:[]};var $t=It.actual.indexOf(pt);return $t!==-1&&$t===It.expected.indexOf(vt)?!0:(It.actual.push(pt),It.expected.push(vt),st(pt,vt,Tt,It))}function lt(pt){return Object.prototype.toString.call(pt)=="[object Arguments]"}function st(pt,vt,Tt,It){if(pt==null||vt===null||vt===void 0)return!1;if(Z.isPrimitive(pt)||Z.isPrimitive(vt))return pt===vt;if(Tt&&Object.getPrototypeOf(pt)!==Object.getPrototypeOf(vt))return!1;var $t=lt(pt),Bt=lt(vt);if($t&&!Bt||!$t&&Bt)return!1;if($t)return pt=j.call(pt),vt=j.call(vt),J(pt,vt,Tt);var zt=gt(pt),Ot=gt(vt),Nt,Pt;if(zt.length!==Ot.length)return!1;for(zt.sort(),Ot.sort(),Pt=zt.length-1;Pt>=0;Pt--)if(zt[Pt]!==Ot[Pt])return!1;for(Pt=zt.length-1;Pt>=0;Pt--)if(Nt=zt[Pt],!J(pt[Nt],vt[Nt],Tt,It))return!1;return!0}Q.notDeepEqual=function(vt,Tt,It){J(vt,Tt,!1)&&rt(vt,Tt,It,"notDeepEqual",Q.notDeepEqual)},Q.notDeepStrictEqual=ut;function ut(pt,vt,Tt){J(pt,vt,!0)&&rt(pt,vt,Tt,"notDeepStrictEqual",ut)}Q.strictEqual=function(vt,Tt,It){vt!==Tt&&rt(vt,Tt,It,"===",Q.strictEqual)},Q.notStrictEqual=function(vt,Tt,It){vt===Tt&&rt(vt,Tt,It,"!==",Q.notStrictEqual)};function it(pt,vt){if(!pt||!vt)return!1;if(Object.prototype.toString.call(vt)=="[object RegExp]")return vt.test(pt);try{if(pt instanceof vt)return!0}catch{}return Error.isPrototypeOf(vt)?!1:vt.call({},pt)===!0}function ct(pt){var vt;try{pt()}catch(Tt){vt=Tt}return vt}function At(pt,vt,Tt,It){var $t;if(typeof vt!="function")throw new TypeError('"block" argument must be a function');typeof Tt=="string"&&(It=Tt,Tt=null),$t=ct(vt),It=(Tt&&Tt.name?" ("+Tt.name+").":".")+(It?" "+It:"."),pt&&!$t&&rt($t,Tt,"Missing expected exception"+It);var Bt=typeof It=="string",zt=!pt&&Z.isError($t),Ot=!pt&&$t&&!Tt;if((zt&&Bt&&it($t,Tt)||Ot)&&rt($t,Tt,"Got unwanted exception"+It),pt&&$t&&Tt&&!it($t,Tt)||!pt&&$t)throw $t}Q.throws=function(pt,vt,Tt){At(!0,pt,vt,Tt)},Q.doesNotThrow=function(pt,vt,Tt){At(!1,pt,vt,Tt)},Q.ifError=function(pt){if(pt)throw pt};function Et(pt,vt){pt||rt(pt,!0,vt,"==",Et)}Q.strict=F(Et,Q,{equal:Q.strictEqual,deepEqual:Q.deepStrictEqual,notEqual:Q.notStrictEqual,notDeepEqual:Q.notDeepStrictEqual}),Q.strict.strict=Q.strict;var gt=Object.keys||function(pt){var vt=[];for(var Tt in pt)$.call(pt,Tt)&&vt.push(Tt);return vt}}).call(this)}).call(this,typeof commonjsGlobal$1<"u"?commonjsGlobal$1:typeof self<"u"?self:typeof window<"u"?window:{})},{"object-assign":51,"util/":26}],24:[function(g,w,I){typeof Object.create=="function"?w.exports=function(F,D){F.super_=D,F.prototype=Object.create(D.prototype,{constructor:{value:F,enumerable:!1,writable:!0,configurable:!0}})}:w.exports=function(F,D){F.super_=D;var U=function(){};U.prototype=D.prototype,F.prototype=new U,F.prototype.constructor=F}},{}],25:[function(g,w,I){w.exports=function(F){return F&&typeof F=="object"&&typeof F.copy=="function"&&typeof F.fill=="function"&&typeof F.readUInt8=="function"}},{}],26:[function(g,w,I){(function(P,F){(function(){var D=/%[sdj%]/g;I.format=function(Ot){if(!st(Ot)){for(var Nt=[],Pt=0;Pt<arguments.length;Pt++)Nt.push($(arguments[Pt]));return Nt.join(" ")}for(var Pt=1,Ut=arguments,Ft=Ut.length,Zt=String(Ot).replace(D,function(Dt){if(Dt==="%%")return"%";if(Pt>=Ft)return Dt;switch(Dt){case"%s":return String(Ut[Pt++]);case"%d":return Number(Ut[Pt++]);case"%j":try{return JSON.stringify(Ut[Pt++])}catch{return"[Circular]"}default:return Dt}}),Ht=Ut[Pt];Pt<Ft;Ht=Ut[++Pt])ot(Ht)||!At(Ht)?Zt+=" "+Ht:Zt+=" "+$(Ht);return Zt},I.deprecate=function(Ot,Nt){if(it(F.process))return function(){return I.deprecate(Ot,Nt).apply(this,arguments)};if(P.noDeprecation===!0)return Ot;var Pt=!1;function Ut(){if(!Pt){if(P.throwDeprecation)throw new Error(Nt);P.traceDeprecation?console.trace(Nt):console.error(Nt),Pt=!0}return Ot.apply(this,arguments)}return Ut};var U={},Z;I.debuglog=function(Ot){if(it(Z)&&(Z=P.env.NODE_DEBUG||""),Ot=Ot.toUpperCase(),!U[Ot])if(new RegExp("\\b"+Ot+"\\b","i").test(Z)){var Nt=P.pid;U[Ot]=function(){var Pt=I.format.apply(I,arguments);console.error("%s %d: %s",Ot,Nt,Pt)}}else U[Ot]=function(){};return U[Ot]};function $(Ot,Nt){var Pt={seen:[],stylize:H};return arguments.length>=3&&(Pt.depth=arguments[2]),arguments.length>=4&&(Pt.colors=arguments[3]),rt(Nt)?Pt.showHidden=Nt:Nt&&I._extend(Pt,Nt),it(Pt.showHidden)&&(Pt.showHidden=!1),it(Pt.depth)&&(Pt.depth=2),it(Pt.colors)&&(Pt.colors=!1),it(Pt.customInspect)&&(Pt.customInspect=!0),Pt.colors&&(Pt.stylize=j),V(Pt,Ot,Pt.depth)}I.inspect=$,$.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},$.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function j(Ot,Nt){var Pt=$.styles[Nt];return Pt?"\x1B["+$.colors[Pt][0]+"m"+Ot+"\x1B["+$.colors[Pt][1]+"m":Ot}function H(Ot,Nt){return Ot}function W(Ot){var Nt={};return Ot.forEach(function(Pt,Ut){Nt[Pt]=!0}),Nt}function V(Ot,Nt,Pt){if(Ot.customInspect&&Nt&&pt(Nt.inspect)&&Nt.inspect!==I.inspect&&!(Nt.constructor&&Nt.constructor.prototype===Nt)){var Ut=Nt.inspect(Pt,Ot);return st(Ut)||(Ut=V(Ot,Ut,Pt)),Ut}var Ft=Q(Ot,Nt);if(Ft)return Ft;var Zt=Object.keys(Nt),Ht=W(Zt);if(Ot.showHidden&&(Zt=Object.getOwnPropertyNames(Nt)),gt(Nt)&&(Zt.indexOf("message")>=0||Zt.indexOf("description")>=0))return K(Nt);if(Zt.length===0){if(pt(Nt)){var Dt=Nt.name?": "+Nt.name:"";return Ot.stylize("[Function"+Dt+"]","special")}if(ct(Nt))return Ot.stylize(RegExp.prototype.toString.call(Nt),"regexp");if(Et(Nt))return Ot.stylize(Date.prototype.toString.call(Nt),"date");if(gt(Nt))return K(Nt)}var dt="",Lt=!1,bt=["{","}"];if(tt(Nt)&&(Lt=!0,bt=["[","]"]),pt(Nt)){var wt=Nt.name?": "+Nt.name:"";dt=" [Function"+wt+"]"}if(ct(Nt)&&(dt=" "+RegExp.prototype.toString.call(Nt)),Et(Nt)&&(dt=" "+Date.prototype.toUTCString.call(Nt)),gt(Nt)&&(dt=" "+K(Nt)),Zt.length===0&&(!Lt||Nt.length==0))return bt[0]+dt+bt[1];if(Pt<0)return ct(Nt)?Ot.stylize(RegExp.prototype.toString.call(Nt),"regexp"):Ot.stylize("[Object]","special");Ot.seen.push(Nt);var xt;return Lt?xt=q(Ot,Nt,Pt,Ht,Zt):xt=Zt.map(function(Rt){return et(Ot,Nt,Pt,Ht,Rt,Lt)}),Ot.seen.pop(),X(xt,dt,bt)}function Q(Ot,Nt){if(it(Nt))return Ot.stylize("undefined","undefined");if(st(Nt)){var Pt="'"+JSON.stringify(Nt).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return Ot.stylize(Pt,"string")}if(lt(Nt))return Ot.stylize(""+Nt,"number");if(rt(Nt))return Ot.stylize(""+Nt,"boolean");if(ot(Nt))return Ot.stylize("null","null")}function K(Ot){return"["+Error.prototype.toString.call(Ot)+"]"}function q(Ot,Nt,Pt,Ut,Ft){for(var Zt=[],Ht=0,Dt=Nt.length;Ht<Dt;++Ht)zt(Nt,String(Ht))?Zt.push(et(Ot,Nt,Pt,Ut,String(Ht),!0)):Zt.push("");return Ft.forEach(function(dt){dt.match(/^\d+$/)||Zt.push(et(Ot,Nt,Pt,Ut,dt,!0))}),Zt}function et(Ot,Nt,Pt,Ut,Ft,Zt){var Ht,Dt,dt;if(dt=Object.getOwnPropertyDescriptor(Nt,Ft)||{value:Nt[Ft]},dt.get?dt.set?Dt=Ot.stylize("[Getter/Setter]","special"):Dt=Ot.stylize("[Getter]","special"):dt.set&&(Dt=Ot.stylize("[Setter]","special")),zt(Ut,Ft)||(Ht="["+Ft+"]"),Dt||(Ot.seen.indexOf(dt.value)<0?(ot(Pt)?Dt=V(Ot,dt.value,null):Dt=V(Ot,dt.value,Pt-1),Dt.indexOf(`
`)>-1&&(Zt?Dt=Dt.split(`
`).map(function(Lt){return"  "+Lt}).join(`
`).substr(2):Dt=`
`+Dt.split(`
`).map(function(Lt){return"   "+Lt}).join(`
`))):Dt=Ot.stylize("[Circular]","special")),it(Ht)){if(Zt&&Ft.match(/^\d+$/))return Dt;Ht=JSON.stringify(""+Ft),Ht.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(Ht=Ht.substr(1,Ht.length-2),Ht=Ot.stylize(Ht,"name")):(Ht=Ht.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),Ht=Ot.stylize(Ht,"string"))}return Ht+": "+Dt}function X(Ot,Nt,Pt){var Ut=Ot.reduce(function(Ft,Zt){return Zt.indexOf(`
`)>=0,Ft+Zt.replace(/\u001b\[\d\d?m/g,"").length+1},0);return Ut>60?Pt[0]+(Nt===""?"":Nt+`
 `)+" "+Ot.join(`,
  `)+" "+Pt[1]:Pt[0]+Nt+" "+Ot.join(", ")+" "+Pt[1]}function tt(Ot){return Array.isArray(Ot)}I.isArray=tt;function rt(Ot){return typeof Ot=="boolean"}I.isBoolean=rt;function ot(Ot){return Ot===null}I.isNull=ot;function J(Ot){return Ot==null}I.isNullOrUndefined=J;function lt(Ot){return typeof Ot=="number"}I.isNumber=lt;function st(Ot){return typeof Ot=="string"}I.isString=st;function ut(Ot){return typeof Ot=="symbol"}I.isSymbol=ut;function it(Ot){return Ot===void 0}I.isUndefined=it;function ct(Ot){return At(Ot)&&Tt(Ot)==="[object RegExp]"}I.isRegExp=ct;function At(Ot){return typeof Ot=="object"&&Ot!==null}I.isObject=At;function Et(Ot){return At(Ot)&&Tt(Ot)==="[object Date]"}I.isDate=Et;function gt(Ot){return At(Ot)&&(Tt(Ot)==="[object Error]"||Ot instanceof Error)}I.isError=gt;function pt(Ot){return typeof Ot=="function"}I.isFunction=pt;function vt(Ot){return Ot===null||typeof Ot=="boolean"||typeof Ot=="number"||typeof Ot=="string"||typeof Ot=="symbol"||typeof Ot>"u"}I.isPrimitive=vt,I.isBuffer=g("./support/isBuffer");function Tt(Ot){return Object.prototype.toString.call(Ot)}function It(Ot){return Ot<10?"0"+Ot.toString(10):Ot.toString(10)}var $t=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function Bt(){var Ot=new Date,Nt=[It(Ot.getHours()),It(Ot.getMinutes()),It(Ot.getSeconds())].join(":");return[Ot.getDate(),$t[Ot.getMonth()],Nt].join(" ")}I.log=function(){console.log("%s - %s",Bt(),I.format.apply(I,arguments))},I.inherits=g("inherits"),I._extend=function(Ot,Nt){if(!Nt||!At(Nt))return Ot;for(var Pt=Object.keys(Nt),Ut=Pt.length;Ut--;)Ot[Pt[Ut]]=Nt[Pt[Ut]];return Ot};function zt(Ot,Nt){return Object.prototype.hasOwnProperty.call(Ot,Nt)}}).call(this)}).call(this,g("_process"),typeof commonjsGlobal$1<"u"?commonjsGlobal$1:typeof self<"u"?self:typeof window<"u"?window:{})},{"./support/isBuffer":25,_process:63,inherits:24}],27:[function(g,w,I){(function(P){(function(){var F=["BigInt64Array","BigUint64Array","Float32Array","Float64Array","Int16Array","Int32Array","Int8Array","Uint16Array","Uint32Array","Uint8Array","Uint8ClampedArray"],D=typeof globalThis>"u"?P:globalThis;w.exports=function(){for(var Z=[],$=0;$<F.length;$++)typeof D[F[$]]=="function"&&(Z[Z.length]=F[$]);return Z}}).call(this)}).call(this,typeof commonjsGlobal$1<"u"?commonjsGlobal$1:typeof self<"u"?self:typeof window<"u"?window:{})},{}],28:[function(g,w,I){I.byteLength=H,I.toByteArray=V,I.fromByteArray=q;for(var P=[],F=[],D=typeof Uint8Array<"u"?Uint8Array:Array,U="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Z=0,$=U.length;Z<$;++Z)P[Z]=U[Z],F[U.charCodeAt(Z)]=Z;F[45]=62,F[95]=63;function j(et){var X=et.length;if(X%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var tt=et.indexOf("=");tt===-1&&(tt=X);var rt=tt===X?0:4-tt%4;return[tt,rt]}function H(et){var X=j(et),tt=X[0],rt=X[1];return(tt+rt)*3/4-rt}function W(et,X,tt){return(X+tt)*3/4-tt}function V(et){var X,tt=j(et),rt=tt[0],ot=tt[1],J=new D(W(et,rt,ot)),lt=0,st=ot>0?rt-4:rt,ut;for(ut=0;ut<st;ut+=4)X=F[et.charCodeAt(ut)]<<18|F[et.charCodeAt(ut+1)]<<12|F[et.charCodeAt(ut+2)]<<6|F[et.charCodeAt(ut+3)],J[lt++]=X>>16&255,J[lt++]=X>>8&255,J[lt++]=X&255;return ot===2&&(X=F[et.charCodeAt(ut)]<<2|F[et.charCodeAt(ut+1)]>>4,J[lt++]=X&255),ot===1&&(X=F[et.charCodeAt(ut)]<<10|F[et.charCodeAt(ut+1)]<<4|F[et.charCodeAt(ut+2)]>>2,J[lt++]=X>>8&255,J[lt++]=X&255),J}function Q(et){return P[et>>18&63]+P[et>>12&63]+P[et>>6&63]+P[et&63]}function K(et,X,tt){for(var rt,ot=[],J=X;J<tt;J+=3)rt=(et[J]<<16&16711680)+(et[J+1]<<8&65280)+(et[J+2]&255),ot.push(Q(rt));return ot.join("")}function q(et){for(var X,tt=et.length,rt=tt%3,ot=[],J=16383,lt=0,st=tt-rt;lt<st;lt+=J)ot.push(K(et,lt,lt+J>st?st:lt+J));return rt===1?(X=et[tt-1],ot.push(P[X>>2]+P[X<<4&63]+"==")):rt===2&&(X=(et[tt-2]<<8)+et[tt-1],ot.push(P[X>>10]+P[X>>4&63]+P[X<<2&63]+"=")),ot.join("")}},{}],29:[function(g,w,I){},{}],30:[function(g,w,I){(function(P,F){(function(){var D=g("assert"),U=g("pako/lib/zlib/zstream"),Z=g("pako/lib/zlib/deflate.js"),$=g("pako/lib/zlib/inflate.js"),j=g("pako/lib/zlib/constants");for(var H in j)I[H]=j[H];I.NONE=0,I.DEFLATE=1,I.INFLATE=2,I.GZIP=3,I.GUNZIP=4,I.DEFLATERAW=5,I.INFLATERAW=6,I.UNZIP=7;var W=31,V=139;function Q(K){if(typeof K!="number"||K<I.DEFLATE||K>I.UNZIP)throw new TypeError("Bad argument");this.dictionary=null,this.err=0,this.flush=0,this.init_done=!1,this.level=0,this.memLevel=0,this.mode=K,this.strategy=0,this.windowBits=0,this.write_in_progress=!1,this.pending_close=!1,this.gzip_id_bytes_read=0}Q.prototype.close=function(){if(this.write_in_progress){this.pending_close=!0;return}this.pending_close=!1,D(this.init_done,"close before init"),D(this.mode<=I.UNZIP),this.mode===I.DEFLATE||this.mode===I.GZIP||this.mode===I.DEFLATERAW?Z.deflateEnd(this.strm):(this.mode===I.INFLATE||this.mode===I.GUNZIP||this.mode===I.INFLATERAW||this.mode===I.UNZIP)&&$.inflateEnd(this.strm),this.mode=I.NONE,this.dictionary=null},Q.prototype.write=function(K,q,et,X,tt,rt,ot){return this._write(!0,K,q,et,X,tt,rt,ot)},Q.prototype.writeSync=function(K,q,et,X,tt,rt,ot){return this._write(!1,K,q,et,X,tt,rt,ot)},Q.prototype._write=function(K,q,et,X,tt,rt,ot,J){if(D.equal(arguments.length,8),D(this.init_done,"write before init"),D(this.mode!==I.NONE,"already finalized"),D.equal(!1,this.write_in_progress,"write already in progress"),D.equal(!1,this.pending_close,"close is pending"),this.write_in_progress=!0,D.equal(!1,q===void 0,"must provide flush value"),this.write_in_progress=!0,q!==I.Z_NO_FLUSH&&q!==I.Z_PARTIAL_FLUSH&&q!==I.Z_SYNC_FLUSH&&q!==I.Z_FULL_FLUSH&&q!==I.Z_FINISH&&q!==I.Z_BLOCK)throw new Error("Invalid flush value");if(et==null&&(et=F.alloc(0),tt=0,X=0),this.strm.avail_in=tt,this.strm.input=et,this.strm.next_in=X,this.strm.avail_out=J,this.strm.output=rt,this.strm.next_out=ot,this.flush=q,!K)return this._process(),this._checkError()?this._afterSync():void 0;var lt=this;return P.nextTick(function(){lt._process(),lt._after()}),this},Q.prototype._afterSync=function(){var K=this.strm.avail_out,q=this.strm.avail_in;return this.write_in_progress=!1,[q,K]},Q.prototype._process=function(){var K=null;switch(this.mode){case I.DEFLATE:case I.GZIP:case I.DEFLATERAW:this.err=Z.deflate(this.strm,this.flush);break;case I.UNZIP:switch(this.strm.avail_in>0&&(K=this.strm.next_in),this.gzip_id_bytes_read){case 0:if(K===null)break;if(this.strm.input[K]===W){if(this.gzip_id_bytes_read=1,K++,this.strm.avail_in===1)break}else{this.mode=I.INFLATE;break}case 1:if(K===null)break;this.strm.input[K]===V?(this.gzip_id_bytes_read=2,this.mode=I.GUNZIP):this.mode=I.INFLATE;break;default:throw new Error("invalid number of gzip magic number bytes read")}case I.INFLATE:case I.GUNZIP:case I.INFLATERAW:for(this.err=$.inflate(this.strm,this.flush),this.err===I.Z_NEED_DICT&&this.dictionary&&(this.err=$.inflateSetDictionary(this.strm,this.dictionary),this.err===I.Z_OK?this.err=$.inflate(this.strm,this.flush):this.err===I.Z_DATA_ERROR&&(this.err=I.Z_NEED_DICT));this.strm.avail_in>0&&this.mode===I.GUNZIP&&this.err===I.Z_STREAM_END&&this.strm.next_in[0]!==0;)this.reset(),this.err=$.inflate(this.strm,this.flush);break;default:throw new Error("Unknown mode "+this.mode)}},Q.prototype._checkError=function(){switch(this.err){case I.Z_OK:case I.Z_BUF_ERROR:if(this.strm.avail_out!==0&&this.flush===I.Z_FINISH)return this._error("unexpected end of file"),!1;break;case I.Z_STREAM_END:break;case I.Z_NEED_DICT:return this.dictionary==null?this._error("Missing dictionary"):this._error("Bad dictionary"),!1;default:return this._error("Zlib error"),!1}return!0},Q.prototype._after=function(){if(this._checkError()){var K=this.strm.avail_out,q=this.strm.avail_in;this.write_in_progress=!1,this.callback(q,K),this.pending_close&&this.close()}},Q.prototype._error=function(K){this.strm.msg&&(K=this.strm.msg),this.onerror(K,this.err),this.write_in_progress=!1,this.pending_close&&this.close()},Q.prototype.init=function(K,q,et,X,tt){D(arguments.length===4||arguments.length===5,"init(windowBits, level, memLevel, strategy, [dictionary])"),D(K>=8&&K<=15,"invalid windowBits"),D(q>=-1&&q<=9,"invalid compression level"),D(et>=1&&et<=9,"invalid memlevel"),D(X===I.Z_FILTERED||X===I.Z_HUFFMAN_ONLY||X===I.Z_RLE||X===I.Z_FIXED||X===I.Z_DEFAULT_STRATEGY,"invalid strategy"),this._init(q,K,et,X,tt),this._setDictionary()},Q.prototype.params=function(){throw new Error("deflateParams Not supported")},Q.prototype.reset=function(){this._reset(),this._setDictionary()},Q.prototype._init=function(K,q,et,X,tt){switch(this.level=K,this.windowBits=q,this.memLevel=et,this.strategy=X,this.flush=I.Z_NO_FLUSH,this.err=I.Z_OK,(this.mode===I.GZIP||this.mode===I.GUNZIP)&&(this.windowBits+=16),this.mode===I.UNZIP&&(this.windowBits+=32),(this.mode===I.DEFLATERAW||this.mode===I.INFLATERAW)&&(this.windowBits=-1*this.windowBits),this.strm=new U,this.mode){case I.DEFLATE:case I.GZIP:case I.DEFLATERAW:this.err=Z.deflateInit2(this.strm,this.level,I.Z_DEFLATED,this.windowBits,this.memLevel,this.strategy);break;case I.INFLATE:case I.GUNZIP:case I.INFLATERAW:case I.UNZIP:this.err=$.inflateInit2(this.strm,this.windowBits);break;default:throw new Error("Unknown mode "+this.mode)}this.err!==I.Z_OK&&this._error("Init error"),this.dictionary=tt,this.write_in_progress=!1,this.init_done=!0},Q.prototype._setDictionary=function(){if(this.dictionary!=null){switch(this.err=I.Z_OK,this.mode){case I.DEFLATE:case I.DEFLATERAW:this.err=Z.deflateSetDictionary(this.strm,this.dictionary);break}this.err!==I.Z_OK&&this._error("Failed to set dictionary")}},Q.prototype._reset=function(){switch(this.err=I.Z_OK,this.mode){case I.DEFLATE:case I.DEFLATERAW:case I.GZIP:this.err=Z.deflateReset(this.strm);break;case I.INFLATE:case I.INFLATERAW:case I.GUNZIP:this.err=$.inflateReset(this.strm);break}this.err!==I.Z_OK&&this._error("Failed to reset stream")},I.Zlib=Q}).call(this)}).call(this,g("_process"),g("buffer").Buffer)},{_process:63,assert:23,buffer:32,"pako/lib/zlib/constants":54,"pako/lib/zlib/deflate.js":56,"pako/lib/zlib/inflate.js":58,"pako/lib/zlib/zstream":62}],31:[function(g,w,I){(function(P){(function(){var F=g("buffer").Buffer,D=g("stream").Transform,U=g("./binding"),Z=g("util"),$=g("assert").ok,j=g("buffer").kMaxLength,H="Cannot create final Buffer. It would be larger than 0x"+j.toString(16)+" bytes";U.Z_MIN_WINDOWBITS=8,U.Z_MAX_WINDOWBITS=15,U.Z_DEFAULT_WINDOWBITS=15,U.Z_MIN_CHUNK=64,U.Z_MAX_CHUNK=1/0,U.Z_DEFAULT_CHUNK=16*1024,U.Z_MIN_MEMLEVEL=1,U.Z_MAX_MEMLEVEL=9,U.Z_DEFAULT_MEMLEVEL=8,U.Z_MIN_LEVEL=-1,U.Z_MAX_LEVEL=9,U.Z_DEFAULT_LEVEL=U.Z_DEFAULT_COMPRESSION;for(var W=Object.keys(U),V=0;V<W.length;V++){var Q=W[V];Q.match(/^Z/)&&Object.defineProperty(I,Q,{enumerable:!0,value:U[Q],writable:!1})}for(var K={Z_OK:U.Z_OK,Z_STREAM_END:U.Z_STREAM_END,Z_NEED_DICT:U.Z_NEED_DICT,Z_ERRNO:U.Z_ERRNO,Z_STREAM_ERROR:U.Z_STREAM_ERROR,Z_DATA_ERROR:U.Z_DATA_ERROR,Z_MEM_ERROR:U.Z_MEM_ERROR,Z_BUF_ERROR:U.Z_BUF_ERROR,Z_VERSION_ERROR:U.Z_VERSION_ERROR},q=Object.keys(K),et=0;et<q.length;et++){var X=q[et];K[K[X]]=X}Object.defineProperty(I,"codes",{enumerable:!0,value:Object.freeze(K),writable:!1}),I.Deflate=ot,I.Inflate=J,I.Gzip=lt,I.Gunzip=st,I.DeflateRaw=ut,I.InflateRaw=it,I.Unzip=ct,I.createDeflate=function(vt){return new ot(vt)},I.createInflate=function(vt){return new J(vt)},I.createDeflateRaw=function(vt){return new ut(vt)},I.createInflateRaw=function(vt){return new it(vt)},I.createGzip=function(vt){return new lt(vt)},I.createGunzip=function(vt){return new st(vt)},I.createUnzip=function(vt){return new ct(vt)},I.deflate=function(vt,Tt,It){return typeof Tt=="function"&&(It=Tt,Tt={}),tt(new ot(Tt),vt,It)},I.deflateSync=function(vt,Tt){return rt(new ot(Tt),vt)},I.gzip=function(vt,Tt,It){return typeof Tt=="function"&&(It=Tt,Tt={}),tt(new lt(Tt),vt,It)},I.gzipSync=function(vt,Tt){return rt(new lt(Tt),vt)},I.deflateRaw=function(vt,Tt,It){return typeof Tt=="function"&&(It=Tt,Tt={}),tt(new ut(Tt),vt,It)},I.deflateRawSync=function(vt,Tt){return rt(new ut(Tt),vt)},I.unzip=function(vt,Tt,It){return typeof Tt=="function"&&(It=Tt,Tt={}),tt(new ct(Tt),vt,It)},I.unzipSync=function(vt,Tt){return rt(new ct(Tt),vt)},I.inflate=function(vt,Tt,It){return typeof Tt=="function"&&(It=Tt,Tt={}),tt(new J(Tt),vt,It)},I.inflateSync=function(vt,Tt){return rt(new J(Tt),vt)},I.gunzip=function(vt,Tt,It){return typeof Tt=="function"&&(It=Tt,Tt={}),tt(new st(Tt),vt,It)},I.gunzipSync=function(vt,Tt){return rt(new st(Tt),vt)},I.inflateRaw=function(vt,Tt,It){return typeof Tt=="function"&&(It=Tt,Tt={}),tt(new it(Tt),vt,It)},I.inflateRawSync=function(vt,Tt){return rt(new it(Tt),vt)};function tt(vt,Tt,It){var $t=[],Bt=0;vt.on("error",Ot),vt.on("end",Nt),vt.end(Tt),zt();function zt(){for(var Pt;(Pt=vt.read())!==null;)$t.push(Pt),Bt+=Pt.length;vt.once("readable",zt)}function Ot(Pt){vt.removeListener("end",Nt),vt.removeListener("readable",zt),It(Pt)}function Nt(){var Pt,Ut=null;Bt>=j?Ut=new RangeError(H):Pt=F.concat($t,Bt),$t=[],vt.close(),It(Ut,Pt)}}function rt(vt,Tt){if(typeof Tt=="string"&&(Tt=F.from(Tt)),!F.isBuffer(Tt))throw new TypeError("Not a string or buffer");var It=vt._finishFlushFlag;return vt._processChunk(Tt,It)}function ot(vt){if(!(this instanceof ot))return new ot(vt);Et.call(this,vt,U.DEFLATE)}function J(vt){if(!(this instanceof J))return new J(vt);Et.call(this,vt,U.INFLATE)}function lt(vt){if(!(this instanceof lt))return new lt(vt);Et.call(this,vt,U.GZIP)}function st(vt){if(!(this instanceof st))return new st(vt);Et.call(this,vt,U.GUNZIP)}function ut(vt){if(!(this instanceof ut))return new ut(vt);Et.call(this,vt,U.DEFLATERAW)}function it(vt){if(!(this instanceof it))return new it(vt);Et.call(this,vt,U.INFLATERAW)}function ct(vt){if(!(this instanceof ct))return new ct(vt);Et.call(this,vt,U.UNZIP)}function At(vt){return vt===U.Z_NO_FLUSH||vt===U.Z_PARTIAL_FLUSH||vt===U.Z_SYNC_FLUSH||vt===U.Z_FULL_FLUSH||vt===U.Z_FINISH||vt===U.Z_BLOCK}function Et(vt,Tt){var It=this;if(this._opts=vt=vt||{},this._chunkSize=vt.chunkSize||I.Z_DEFAULT_CHUNK,D.call(this,vt),vt.flush&&!At(vt.flush))throw new Error("Invalid flush flag: "+vt.flush);if(vt.finishFlush&&!At(vt.finishFlush))throw new Error("Invalid flush flag: "+vt.finishFlush);if(this._flushFlag=vt.flush||U.Z_NO_FLUSH,this._finishFlushFlag=typeof vt.finishFlush<"u"?vt.finishFlush:U.Z_FINISH,vt.chunkSize&&(vt.chunkSize<I.Z_MIN_CHUNK||vt.chunkSize>I.Z_MAX_CHUNK))throw new Error("Invalid chunk size: "+vt.chunkSize);if(vt.windowBits&&(vt.windowBits<I.Z_MIN_WINDOWBITS||vt.windowBits>I.Z_MAX_WINDOWBITS))throw new Error("Invalid windowBits: "+vt.windowBits);if(vt.level&&(vt.level<I.Z_MIN_LEVEL||vt.level>I.Z_MAX_LEVEL))throw new Error("Invalid compression level: "+vt.level);if(vt.memLevel&&(vt.memLevel<I.Z_MIN_MEMLEVEL||vt.memLevel>I.Z_MAX_MEMLEVEL))throw new Error("Invalid memLevel: "+vt.memLevel);if(vt.strategy&&vt.strategy!=I.Z_FILTERED&&vt.strategy!=I.Z_HUFFMAN_ONLY&&vt.strategy!=I.Z_RLE&&vt.strategy!=I.Z_FIXED&&vt.strategy!=I.Z_DEFAULT_STRATEGY)throw new Error("Invalid strategy: "+vt.strategy);if(vt.dictionary&&!F.isBuffer(vt.dictionary))throw new Error("Invalid dictionary: it should be a Buffer instance");this._handle=new U.Zlib(Tt);var $t=this;this._hadError=!1,this._handle.onerror=function(Ot,Nt){gt($t),$t._hadError=!0;var Pt=new Error(Ot);Pt.errno=Nt,Pt.code=I.codes[Nt],$t.emit("error",Pt)};var Bt=I.Z_DEFAULT_COMPRESSION;typeof vt.level=="number"&&(Bt=vt.level);var zt=I.Z_DEFAULT_STRATEGY;typeof vt.strategy=="number"&&(zt=vt.strategy),this._handle.init(vt.windowBits||I.Z_DEFAULT_WINDOWBITS,Bt,vt.memLevel||I.Z_DEFAULT_MEMLEVEL,zt,vt.dictionary),this._buffer=F.allocUnsafe(this._chunkSize),this._offset=0,this._level=Bt,this._strategy=zt,this.once("end",this.close),Object.defineProperty(this,"_closed",{get:function(){return!It._handle},configurable:!0,enumerable:!0})}Z.inherits(Et,D),Et.prototype.params=function(vt,Tt,It){if(vt<I.Z_MIN_LEVEL||vt>I.Z_MAX_LEVEL)throw new RangeError("Invalid compression level: "+vt);if(Tt!=I.Z_FILTERED&&Tt!=I.Z_HUFFMAN_ONLY&&Tt!=I.Z_RLE&&Tt!=I.Z_FIXED&&Tt!=I.Z_DEFAULT_STRATEGY)throw new TypeError("Invalid strategy: "+Tt);if(this._level!==vt||this._strategy!==Tt){var $t=this;this.flush(U.Z_SYNC_FLUSH,function(){$($t._handle,"zlib binding closed"),$t._handle.params(vt,Tt),$t._hadError||($t._level=vt,$t._strategy=Tt,It&&It())})}else P.nextTick(It)},Et.prototype.reset=function(){return $(this._handle,"zlib binding closed"),this._handle.reset()},Et.prototype._flush=function(vt){this._transform(F.alloc(0),"",vt)},Et.prototype.flush=function(vt,Tt){var It=this,$t=this._writableState;(typeof vt=="function"||vt===void 0&&!Tt)&&(Tt=vt,vt=U.Z_FULL_FLUSH),$t.ended?Tt&&P.nextTick(Tt):$t.ending?Tt&&this.once("end",Tt):$t.needDrain?Tt&&this.once("drain",function(){return It.flush(vt,Tt)}):(this._flushFlag=vt,this.write(F.alloc(0),"",Tt))},Et.prototype.close=function(vt){gt(this,vt),P.nextTick(pt,this)};function gt(vt,Tt){Tt&&P.nextTick(Tt),vt._handle&&(vt._handle.close(),vt._handle=null)}function pt(vt){vt.emit("close")}Et.prototype._transform=function(vt,Tt,It){var $t,Bt=this._writableState,zt=Bt.ending||Bt.ended,Ot=zt&&(!vt||Bt.length===vt.length);if(vt!==null&&!F.isBuffer(vt))return It(new Error("invalid input"));if(!this._handle)return It(new Error("zlib binding closed"));Ot?$t=this._finishFlushFlag:($t=this._flushFlag,vt.length>=Bt.length&&(this._flushFlag=this._opts.flush||U.Z_NO_FLUSH)),this._processChunk(vt,$t,It)},Et.prototype._processChunk=function(vt,Tt,It){var $t=vt&&vt.length,Bt=this._chunkSize-this._offset,zt=0,Ot=this,Nt=typeof It=="function";if(!Nt){var Pt=[],Ut=0,Ft;this.on("error",function(Lt){Ft=Lt}),$(this._handle,"zlib binding closed");do var Zt=this._handle.writeSync(Tt,vt,zt,$t,this._buffer,this._offset,Bt);while(!this._hadError&&dt(Zt[0],Zt[1]));if(this._hadError)throw Ft;if(Ut>=j)throw gt(this),new RangeError(H);var Ht=F.concat(Pt,Ut);return gt(this),Ht}$(this._handle,"zlib binding closed");var Dt=this._handle.write(Tt,vt,zt,$t,this._buffer,this._offset,Bt);Dt.buffer=vt,Dt.callback=dt;function dt(Lt,bt){if(this&&(this.buffer=null,this.callback=null),!Ot._hadError){var wt=Bt-bt;if($(wt>=0,"have should not go down"),wt>0){var xt=Ot._buffer.slice(Ot._offset,Ot._offset+wt);Ot._offset+=wt,Nt?Ot.push(xt):(Pt.push(xt),Ut+=xt.length)}if((bt===0||Ot._offset>=Ot._chunkSize)&&(Bt=Ot._chunkSize,Ot._offset=0,Ot._buffer=F.allocUnsafe(Ot._chunkSize)),bt===0){if(zt+=$t-Lt,$t=Lt,!Nt)return!0;var Rt=Ot._handle.write(Tt,vt,zt,$t,Ot._buffer,Ot._offset,Ot._chunkSize);Rt.callback=dt,Rt.buffer=vt;return}if(!Nt)return!1;It()}}},Z.inherits(ot,Et),Z.inherits(J,Et),Z.inherits(lt,Et),Z.inherits(st,Et),Z.inherits(ut,Et),Z.inherits(it,Et),Z.inherits(ct,Et)}).call(this)}).call(this,g("_process"))},{"./binding":30,_process:63,assert:23,buffer:32,stream:65,util:84}],32:[function(g,w,I){(function(P){(function(){var F=g("base64-js"),D=g("ieee754");I.Buffer=j,I.SlowBuffer=rt,I.INSPECT_MAX_BYTES=50;var U=2147483647;I.kMaxLength=U,j.TYPED_ARRAY_SUPPORT=Z(),!j.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function Z(){try{var ft=new Uint8Array(1);return ft.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},ft.foo()===42}catch{return!1}}Object.defineProperty(j.prototype,"parent",{enumerable:!0,get:function(){if(j.isBuffer(this))return this.buffer}}),Object.defineProperty(j.prototype,"offset",{enumerable:!0,get:function(){if(j.isBuffer(this))return this.byteOffset}});function $(ft){if(ft>U)throw new RangeError('The value "'+ft+'" is invalid for option "size"');var at=new Uint8Array(ft);return at.__proto__=j.prototype,at}function j(ft,at,_t){if(typeof ft=="number"){if(typeof at=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return Q(ft)}return H(ft,at,_t)}typeof Symbol<"u"&&Symbol.species!=null&&j[Symbol.species]===j&&Object.defineProperty(j,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),j.poolSize=8192;function H(ft,at,_t){if(typeof ft=="string")return K(ft,at);if(ArrayBuffer.isView(ft))return q(ft);if(ft==null)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof ft);if(nt(ft,ArrayBuffer)||ft&&nt(ft.buffer,ArrayBuffer))return et(ft,at,_t);if(typeof ft=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var St=ft.valueOf&&ft.valueOf();if(St!=null&&St!==ft)return j.from(St,at,_t);var Vt=X(ft);if(Vt)return Vt;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof ft[Symbol.toPrimitive]=="function")return j.from(ft[Symbol.toPrimitive]("string"),at,_t);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof ft)}j.from=function(ft,at,_t){return H(ft,at,_t)},j.prototype.__proto__=Uint8Array.prototype,j.__proto__=Uint8Array;function W(ft){if(typeof ft!="number")throw new TypeError('"size" argument must be of type number');if(ft<0)throw new RangeError('The value "'+ft+'" is invalid for option "size"')}function V(ft,at,_t){return W(ft),ft<=0?$(ft):at!==void 0?typeof _t=="string"?$(ft).fill(at,_t):$(ft).fill(at):$(ft)}j.alloc=function(ft,at,_t){return V(ft,at,_t)};function Q(ft){return W(ft),$(ft<0?0:tt(ft)|0)}j.allocUnsafe=function(ft){return Q(ft)},j.allocUnsafeSlow=function(ft){return Q(ft)};function K(ft,at){if((typeof at!="string"||at==="")&&(at="utf8"),!j.isEncoding(at))throw new TypeError("Unknown encoding: "+at);var _t=ot(ft,at)|0,St=$(_t),Vt=St.write(ft,at);return Vt!==_t&&(St=St.slice(0,Vt)),St}function q(ft){for(var at=ft.length<0?0:tt(ft.length)|0,_t=$(at),St=0;St<at;St+=1)_t[St]=ft[St]&255;return _t}function et(ft,at,_t){if(at<0||ft.byteLength<at)throw new RangeError('"offset" is outside of buffer bounds');if(ft.byteLength<at+(_t||0))throw new RangeError('"length" is outside of buffer bounds');var St;return at===void 0&&_t===void 0?St=new Uint8Array(ft):_t===void 0?St=new Uint8Array(ft,at):St=new Uint8Array(ft,at,_t),St.__proto__=j.prototype,St}function X(ft){if(j.isBuffer(ft)){var at=tt(ft.length)|0,_t=$(at);return _t.length===0||ft.copy(_t,0,0,at),_t}if(ft.length!==void 0)return typeof ft.length!="number"||ht(ft.length)?$(0):q(ft);if(ft.type==="Buffer"&&Array.isArray(ft.data))return q(ft.data)}function tt(ft){if(ft>=U)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+U.toString(16)+" bytes");return ft|0}function rt(ft){return+ft!=ft&&(ft=0),j.alloc(+ft)}j.isBuffer=function(at){return at!=null&&at._isBuffer===!0&&at!==j.prototype},j.compare=function(at,_t){if(nt(at,Uint8Array)&&(at=j.from(at,at.offset,at.byteLength)),nt(_t,Uint8Array)&&(_t=j.from(_t,_t.offset,_t.byteLength)),!j.isBuffer(at)||!j.isBuffer(_t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(at===_t)return 0;for(var St=at.length,Vt=_t.length,ee=0,Jt=Math.min(St,Vt);ee<Jt;++ee)if(at[ee]!==_t[ee]){St=at[ee],Vt=_t[ee];break}return St<Vt?-1:Vt<St?1:0},j.isEncoding=function(at){switch(String(at).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},j.concat=function(at,_t){if(!Array.isArray(at))throw new TypeError('"list" argument must be an Array of Buffers');if(at.length===0)return j.alloc(0);var St;if(_t===void 0)for(_t=0,St=0;St<at.length;++St)_t+=at[St].length;var Vt=j.allocUnsafe(_t),ee=0;for(St=0;St<at.length;++St){var Jt=at[St];if(nt(Jt,Uint8Array)&&(Jt=j.from(Jt)),!j.isBuffer(Jt))throw new TypeError('"list" argument must be an Array of Buffers');Jt.copy(Vt,ee),ee+=Jt.length}return Vt};function ot(ft,at){if(j.isBuffer(ft))return ft.length;if(ArrayBuffer.isView(ft)||nt(ft,ArrayBuffer))return ft.byteLength;if(typeof ft!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof ft);var _t=ft.length,St=arguments.length>2&&arguments[2]===!0;if(!St&&_t===0)return 0;for(var Vt=!1;;)switch(at){case"ascii":case"latin1":case"binary":return _t;case"utf8":case"utf-8":return bt(ft).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return _t*2;case"hex":return _t>>>1;case"base64":return Rt(ft).length;default:if(Vt)return St?-1:bt(ft).length;at=(""+at).toLowerCase(),Vt=!0}}j.byteLength=ot;function J(ft,at,_t){var St=!1;if((at===void 0||at<0)&&(at=0),at>this.length||((_t===void 0||_t>this.length)&&(_t=this.length),_t<=0)||(_t>>>=0,at>>>=0,_t<=at))return"";for(ft||(ft="utf8");;)switch(ft){case"hex":return Ot(this,at,_t);case"utf8":case"utf-8":return Tt(this,at,_t);case"ascii":return Bt(this,at,_t);case"latin1":case"binary":return zt(this,at,_t);case"base64":return vt(this,at,_t);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Nt(this,at,_t);default:if(St)throw new TypeError("Unknown encoding: "+ft);ft=(ft+"").toLowerCase(),St=!0}}j.prototype._isBuffer=!0;function lt(ft,at,_t){var St=ft[at];ft[at]=ft[_t],ft[_t]=St}j.prototype.swap16=function(){var at=this.length;if(at%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var _t=0;_t<at;_t+=2)lt(this,_t,_t+1);return this},j.prototype.swap32=function(){var at=this.length;if(at%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var _t=0;_t<at;_t+=4)lt(this,_t,_t+3),lt(this,_t+1,_t+2);return this},j.prototype.swap64=function(){var at=this.length;if(at%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var _t=0;_t<at;_t+=8)lt(this,_t,_t+7),lt(this,_t+1,_t+6),lt(this,_t+2,_t+5),lt(this,_t+3,_t+4);return this},j.prototype.toString=function(){var at=this.length;return at===0?"":arguments.length===0?Tt(this,0,at):J.apply(this,arguments)},j.prototype.toLocaleString=j.prototype.toString,j.prototype.equals=function(at){if(!j.isBuffer(at))throw new TypeError("Argument must be a Buffer");return this===at?!0:j.compare(this,at)===0},j.prototype.inspect=function(){var at="",_t=I.INSPECT_MAX_BYTES;return at=this.toString("hex",0,_t).replace(/(.{2})/g,"$1 ").trim(),this.length>_t&&(at+=" ... "),"<Buffer "+at+">"},j.prototype.compare=function(at,_t,St,Vt,ee){if(nt(at,Uint8Array)&&(at=j.from(at,at.offset,at.byteLength)),!j.isBuffer(at))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof at);if(_t===void 0&&(_t=0),St===void 0&&(St=at?at.length:0),Vt===void 0&&(Vt=0),ee===void 0&&(ee=this.length),_t<0||St>at.length||Vt<0||ee>this.length)throw new RangeError("out of range index");if(Vt>=ee&&_t>=St)return 0;if(Vt>=ee)return-1;if(_t>=St)return 1;if(_t>>>=0,St>>>=0,Vt>>>=0,ee>>>=0,this===at)return 0;for(var Jt=ee-Vt,se=St-_t,ae=Math.min(Jt,se),fe=this.slice(Vt,ee),le=at.slice(_t,St),ue=0;ue<ae;++ue)if(fe[ue]!==le[ue]){Jt=fe[ue],se=le[ue];break}return Jt<se?-1:se<Jt?1:0};function st(ft,at,_t,St,Vt){if(ft.length===0)return-1;if(typeof _t=="string"?(St=_t,_t=0):_t>2147483647?_t=2147483647:_t<-2147483648&&(_t=-2147483648),_t=+_t,ht(_t)&&(_t=Vt?0:ft.length-1),_t<0&&(_t=ft.length+_t),_t>=ft.length){if(Vt)return-1;_t=ft.length-1}else if(_t<0)if(Vt)_t=0;else return-1;if(typeof at=="string"&&(at=j.from(at,St)),j.isBuffer(at))return at.length===0?-1:ut(ft,at,_t,St,Vt);if(typeof at=="number")return at=at&255,typeof Uint8Array.prototype.indexOf=="function"?Vt?Uint8Array.prototype.indexOf.call(ft,at,_t):Uint8Array.prototype.lastIndexOf.call(ft,at,_t):ut(ft,[at],_t,St,Vt);throw new TypeError("val must be string, number or Buffer")}function ut(ft,at,_t,St,Vt){var ee=1,Jt=ft.length,se=at.length;if(St!==void 0&&(St=String(St).toLowerCase(),St==="ucs2"||St==="ucs-2"||St==="utf16le"||St==="utf-16le")){if(ft.length<2||at.length<2)return-1;ee=2,Jt/=2,se/=2,_t/=2}function ae(he,Wt){return ee===1?he[Wt]:he.readUInt16BE(Wt*ee)}var fe;if(Vt){var le=-1;for(fe=_t;fe<Jt;fe++)if(ae(ft,fe)===ae(at,le===-1?0:fe-le)){if(le===-1&&(le=fe),fe-le+1===se)return le*ee}else le!==-1&&(fe-=fe-le),le=-1}else for(_t+se>Jt&&(_t=Jt-se),fe=_t;fe>=0;fe--){for(var ue=!0,me=0;me<se;me++)if(ae(ft,fe+me)!==ae(at,me)){ue=!1;break}if(ue)return fe}return-1}j.prototype.includes=function(at,_t,St){return this.indexOf(at,_t,St)!==-1},j.prototype.indexOf=function(at,_t,St){return st(this,at,_t,St,!0)},j.prototype.lastIndexOf=function(at,_t,St){return st(this,at,_t,St,!1)};function it(ft,at,_t,St){_t=Number(_t)||0;var Vt=ft.length-_t;St?(St=Number(St),St>Vt&&(St=Vt)):St=Vt;var ee=at.length;St>ee/2&&(St=ee/2);for(var Jt=0;Jt<St;++Jt){var se=parseInt(at.substr(Jt*2,2),16);if(ht(se))return Jt;ft[_t+Jt]=se}return Jt}function ct(ft,at,_t,St){return Gt(bt(at,ft.length-_t),ft,_t,St)}function At(ft,at,_t,St){return Gt(wt(at),ft,_t,St)}function Et(ft,at,_t,St){return At(ft,at,_t,St)}function gt(ft,at,_t,St){return Gt(Rt(at),ft,_t,St)}function pt(ft,at,_t,St){return Gt(xt(at,ft.length-_t),ft,_t,St)}j.prototype.write=function(at,_t,St,Vt){if(_t===void 0)Vt="utf8",St=this.length,_t=0;else if(St===void 0&&typeof _t=="string")Vt=_t,St=this.length,_t=0;else if(isFinite(_t))_t=_t>>>0,isFinite(St)?(St=St>>>0,Vt===void 0&&(Vt="utf8")):(Vt=St,St=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var ee=this.length-_t;if((St===void 0||St>ee)&&(St=ee),at.length>0&&(St<0||_t<0)||_t>this.length)throw new RangeError("Attempt to write outside buffer bounds");Vt||(Vt="utf8");for(var Jt=!1;;)switch(Vt){case"hex":return it(this,at,_t,St);case"utf8":case"utf-8":return ct(this,at,_t,St);case"ascii":return At(this,at,_t,St);case"latin1":case"binary":return Et(this,at,_t,St);case"base64":return gt(this,at,_t,St);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return pt(this,at,_t,St);default:if(Jt)throw new TypeError("Unknown encoding: "+Vt);Vt=(""+Vt).toLowerCase(),Jt=!0}},j.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function vt(ft,at,_t){return at===0&&_t===ft.length?F.fromByteArray(ft):F.fromByteArray(ft.slice(at,_t))}function Tt(ft,at,_t){_t=Math.min(ft.length,_t);for(var St=[],Vt=at;Vt<_t;){var ee=ft[Vt],Jt=null,se=ee>239?4:ee>223?3:ee>191?2:1;if(Vt+se<=_t){var ae,fe,le,ue;switch(se){case 1:ee<128&&(Jt=ee);break;case 2:ae=ft[Vt+1],(ae&192)===128&&(ue=(ee&31)<<6|ae&63,ue>127&&(Jt=ue));break;case 3:ae=ft[Vt+1],fe=ft[Vt+2],(ae&192)===128&&(fe&192)===128&&(ue=(ee&15)<<12|(ae&63)<<6|fe&63,ue>2047&&(ue<55296||ue>57343)&&(Jt=ue));break;case 4:ae=ft[Vt+1],fe=ft[Vt+2],le=ft[Vt+3],(ae&192)===128&&(fe&192)===128&&(le&192)===128&&(ue=(ee&15)<<18|(ae&63)<<12|(fe&63)<<6|le&63,ue>65535&&ue<1114112&&(Jt=ue))}}Jt===null?(Jt=65533,se=1):Jt>65535&&(Jt-=65536,St.push(Jt>>>10&1023|55296),Jt=56320|Jt&1023),St.push(Jt),Vt+=se}return $t(St)}var It=4096;function $t(ft){var at=ft.length;if(at<=It)return String.fromCharCode.apply(String,ft);for(var _t="",St=0;St<at;)_t+=String.fromCharCode.apply(String,ft.slice(St,St+=It));return _t}function Bt(ft,at,_t){var St="";_t=Math.min(ft.length,_t);for(var Vt=at;Vt<_t;++Vt)St+=String.fromCharCode(ft[Vt]&127);return St}function zt(ft,at,_t){var St="";_t=Math.min(ft.length,_t);for(var Vt=at;Vt<_t;++Vt)St+=String.fromCharCode(ft[Vt]);return St}function Ot(ft,at,_t){var St=ft.length;(!at||at<0)&&(at=0),(!_t||_t<0||_t>St)&&(_t=St);for(var Vt="",ee=at;ee<_t;++ee)Vt+=Lt(ft[ee]);return Vt}function Nt(ft,at,_t){for(var St=ft.slice(at,_t),Vt="",ee=0;ee<St.length;ee+=2)Vt+=String.fromCharCode(St[ee]+St[ee+1]*256);return Vt}j.prototype.slice=function(at,_t){var St=this.length;at=~~at,_t=_t===void 0?St:~~_t,at<0?(at+=St,at<0&&(at=0)):at>St&&(at=St),_t<0?(_t+=St,_t<0&&(_t=0)):_t>St&&(_t=St),_t<at&&(_t=at);var Vt=this.subarray(at,_t);return Vt.__proto__=j.prototype,Vt};function Pt(ft,at,_t){if(ft%1!==0||ft<0)throw new RangeError("offset is not uint");if(ft+at>_t)throw new RangeError("Trying to access beyond buffer length")}j.prototype.readUIntLE=function(at,_t,St){at=at>>>0,_t=_t>>>0,St||Pt(at,_t,this.length);for(var Vt=this[at],ee=1,Jt=0;++Jt<_t&&(ee*=256);)Vt+=this[at+Jt]*ee;return Vt},j.prototype.readUIntBE=function(at,_t,St){at=at>>>0,_t=_t>>>0,St||Pt(at,_t,this.length);for(var Vt=this[at+--_t],ee=1;_t>0&&(ee*=256);)Vt+=this[at+--_t]*ee;return Vt},j.prototype.readUInt8=function(at,_t){return at=at>>>0,_t||Pt(at,1,this.length),this[at]},j.prototype.readUInt16LE=function(at,_t){return at=at>>>0,_t||Pt(at,2,this.length),this[at]|this[at+1]<<8},j.prototype.readUInt16BE=function(at,_t){return at=at>>>0,_t||Pt(at,2,this.length),this[at]<<8|this[at+1]},j.prototype.readUInt32LE=function(at,_t){return at=at>>>0,_t||Pt(at,4,this.length),(this[at]|this[at+1]<<8|this[at+2]<<16)+this[at+3]*16777216},j.prototype.readUInt32BE=function(at,_t){return at=at>>>0,_t||Pt(at,4,this.length),this[at]*16777216+(this[at+1]<<16|this[at+2]<<8|this[at+3])},j.prototype.readIntLE=function(at,_t,St){at=at>>>0,_t=_t>>>0,St||Pt(at,_t,this.length);for(var Vt=this[at],ee=1,Jt=0;++Jt<_t&&(ee*=256);)Vt+=this[at+Jt]*ee;return ee*=128,Vt>=ee&&(Vt-=Math.pow(2,8*_t)),Vt},j.prototype.readIntBE=function(at,_t,St){at=at>>>0,_t=_t>>>0,St||Pt(at,_t,this.length);for(var Vt=_t,ee=1,Jt=this[at+--Vt];Vt>0&&(ee*=256);)Jt+=this[at+--Vt]*ee;return ee*=128,Jt>=ee&&(Jt-=Math.pow(2,8*_t)),Jt},j.prototype.readInt8=function(at,_t){return at=at>>>0,_t||Pt(at,1,this.length),this[at]&128?(255-this[at]+1)*-1:this[at]},j.prototype.readInt16LE=function(at,_t){at=at>>>0,_t||Pt(at,2,this.length);var St=this[at]|this[at+1]<<8;return St&32768?St|4294901760:St},j.prototype.readInt16BE=function(at,_t){at=at>>>0,_t||Pt(at,2,this.length);var St=this[at+1]|this[at]<<8;return St&32768?St|4294901760:St},j.prototype.readInt32LE=function(at,_t){return at=at>>>0,_t||Pt(at,4,this.length),this[at]|this[at+1]<<8|this[at+2]<<16|this[at+3]<<24},j.prototype.readInt32BE=function(at,_t){return at=at>>>0,_t||Pt(at,4,this.length),this[at]<<24|this[at+1]<<16|this[at+2]<<8|this[at+3]},j.prototype.readFloatLE=function(at,_t){return at=at>>>0,_t||Pt(at,4,this.length),D.read(this,at,!0,23,4)},j.prototype.readFloatBE=function(at,_t){return at=at>>>0,_t||Pt(at,4,this.length),D.read(this,at,!1,23,4)},j.prototype.readDoubleLE=function(at,_t){return at=at>>>0,_t||Pt(at,8,this.length),D.read(this,at,!0,52,8)},j.prototype.readDoubleBE=function(at,_t){return at=at>>>0,_t||Pt(at,8,this.length),D.read(this,at,!1,52,8)};function Ut(ft,at,_t,St,Vt,ee){if(!j.isBuffer(ft))throw new TypeError('"buffer" argument must be a Buffer instance');if(at>Vt||at<ee)throw new RangeError('"value" argument is out of bounds');if(_t+St>ft.length)throw new RangeError("Index out of range")}j.prototype.writeUIntLE=function(at,_t,St,Vt){if(at=+at,_t=_t>>>0,St=St>>>0,!Vt){var ee=Math.pow(2,8*St)-1;Ut(this,at,_t,St,ee,0)}var Jt=1,se=0;for(this[_t]=at&255;++se<St&&(Jt*=256);)this[_t+se]=at/Jt&255;return _t+St},j.prototype.writeUIntBE=function(at,_t,St,Vt){if(at=+at,_t=_t>>>0,St=St>>>0,!Vt){var ee=Math.pow(2,8*St)-1;Ut(this,at,_t,St,ee,0)}var Jt=St-1,se=1;for(this[_t+Jt]=at&255;--Jt>=0&&(se*=256);)this[_t+Jt]=at/se&255;return _t+St},j.prototype.writeUInt8=function(at,_t,St){return at=+at,_t=_t>>>0,St||Ut(this,at,_t,1,255,0),this[_t]=at&255,_t+1},j.prototype.writeUInt16LE=function(at,_t,St){return at=+at,_t=_t>>>0,St||Ut(this,at,_t,2,65535,0),this[_t]=at&255,this[_t+1]=at>>>8,_t+2},j.prototype.writeUInt16BE=function(at,_t,St){return at=+at,_t=_t>>>0,St||Ut(this,at,_t,2,65535,0),this[_t]=at>>>8,this[_t+1]=at&255,_t+2},j.prototype.writeUInt32LE=function(at,_t,St){return at=+at,_t=_t>>>0,St||Ut(this,at,_t,4,4294967295,0),this[_t+3]=at>>>24,this[_t+2]=at>>>16,this[_t+1]=at>>>8,this[_t]=at&255,_t+4},j.prototype.writeUInt32BE=function(at,_t,St){return at=+at,_t=_t>>>0,St||Ut(this,at,_t,4,4294967295,0),this[_t]=at>>>24,this[_t+1]=at>>>16,this[_t+2]=at>>>8,this[_t+3]=at&255,_t+4},j.prototype.writeIntLE=function(at,_t,St,Vt){if(at=+at,_t=_t>>>0,!Vt){var ee=Math.pow(2,8*St-1);Ut(this,at,_t,St,ee-1,-ee)}var Jt=0,se=1,ae=0;for(this[_t]=at&255;++Jt<St&&(se*=256);)at<0&&ae===0&&this[_t+Jt-1]!==0&&(ae=1),this[_t+Jt]=(at/se>>0)-ae&255;return _t+St},j.prototype.writeIntBE=function(at,_t,St,Vt){if(at=+at,_t=_t>>>0,!Vt){var ee=Math.pow(2,8*St-1);Ut(this,at,_t,St,ee-1,-ee)}var Jt=St-1,se=1,ae=0;for(this[_t+Jt]=at&255;--Jt>=0&&(se*=256);)at<0&&ae===0&&this[_t+Jt+1]!==0&&(ae=1),this[_t+Jt]=(at/se>>0)-ae&255;return _t+St},j.prototype.writeInt8=function(at,_t,St){return at=+at,_t=_t>>>0,St||Ut(this,at,_t,1,127,-128),at<0&&(at=255+at+1),this[_t]=at&255,_t+1},j.prototype.writeInt16LE=function(at,_t,St){return at=+at,_t=_t>>>0,St||Ut(this,at,_t,2,32767,-32768),this[_t]=at&255,this[_t+1]=at>>>8,_t+2},j.prototype.writeInt16BE=function(at,_t,St){return at=+at,_t=_t>>>0,St||Ut(this,at,_t,2,32767,-32768),this[_t]=at>>>8,this[_t+1]=at&255,_t+2},j.prototype.writeInt32LE=function(at,_t,St){return at=+at,_t=_t>>>0,St||Ut(this,at,_t,4,2147483647,-2147483648),this[_t]=at&255,this[_t+1]=at>>>8,this[_t+2]=at>>>16,this[_t+3]=at>>>24,_t+4},j.prototype.writeInt32BE=function(at,_t,St){return at=+at,_t=_t>>>0,St||Ut(this,at,_t,4,2147483647,-2147483648),at<0&&(at=4294967295+at+1),this[_t]=at>>>24,this[_t+1]=at>>>16,this[_t+2]=at>>>8,this[_t+3]=at&255,_t+4};function Ft(ft,at,_t,St,Vt,ee){if(_t+St>ft.length)throw new RangeError("Index out of range");if(_t<0)throw new RangeError("Index out of range")}function Zt(ft,at,_t,St,Vt){return at=+at,_t=_t>>>0,Vt||Ft(ft,at,_t,4),D.write(ft,at,_t,St,23,4),_t+4}j.prototype.writeFloatLE=function(at,_t,St){return Zt(this,at,_t,!0,St)},j.prototype.writeFloatBE=function(at,_t,St){return Zt(this,at,_t,!1,St)};function Ht(ft,at,_t,St,Vt){return at=+at,_t=_t>>>0,Vt||Ft(ft,at,_t,8),D.write(ft,at,_t,St,52,8),_t+8}j.prototype.writeDoubleLE=function(at,_t,St){return Ht(this,at,_t,!0,St)},j.prototype.writeDoubleBE=function(at,_t,St){return Ht(this,at,_t,!1,St)},j.prototype.copy=function(at,_t,St,Vt){if(!j.isBuffer(at))throw new TypeError("argument should be a Buffer");if(St||(St=0),!Vt&&Vt!==0&&(Vt=this.length),_t>=at.length&&(_t=at.length),_t||(_t=0),Vt>0&&Vt<St&&(Vt=St),Vt===St||at.length===0||this.length===0)return 0;if(_t<0)throw new RangeError("targetStart out of bounds");if(St<0||St>=this.length)throw new RangeError("Index out of range");if(Vt<0)throw new RangeError("sourceEnd out of bounds");Vt>this.length&&(Vt=this.length),at.length-_t<Vt-St&&(Vt=at.length-_t+St);var ee=Vt-St;if(this===at&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(_t,St,Vt);else if(this===at&&St<_t&&_t<Vt)for(var Jt=ee-1;Jt>=0;--Jt)at[Jt+_t]=this[Jt+St];else Uint8Array.prototype.set.call(at,this.subarray(St,Vt),_t);return ee},j.prototype.fill=function(at,_t,St,Vt){if(typeof at=="string"){if(typeof _t=="string"?(Vt=_t,_t=0,St=this.length):typeof St=="string"&&(Vt=St,St=this.length),Vt!==void 0&&typeof Vt!="string")throw new TypeError("encoding must be a string");if(typeof Vt=="string"&&!j.isEncoding(Vt))throw new TypeError("Unknown encoding: "+Vt);if(at.length===1){var ee=at.charCodeAt(0);(Vt==="utf8"&&ee<128||Vt==="latin1")&&(at=ee)}}else typeof at=="number"&&(at=at&255);if(_t<0||this.length<_t||this.length<St)throw new RangeError("Out of range index");if(St<=_t)return this;_t=_t>>>0,St=St===void 0?this.length:St>>>0,at||(at=0);var Jt;if(typeof at=="number")for(Jt=_t;Jt<St;++Jt)this[Jt]=at;else{var se=j.isBuffer(at)?at:j.from(at,Vt),ae=se.length;if(ae===0)throw new TypeError('The value "'+at+'" is invalid for argument "value"');for(Jt=0;Jt<St-_t;++Jt)this[Jt+_t]=se[Jt%ae]}return this};var Dt=/[^+/0-9A-Za-z-_]/g;function dt(ft){if(ft=ft.split("=")[0],ft=ft.trim().replace(Dt,""),ft.length<2)return"";for(;ft.length%4!==0;)ft=ft+"=";return ft}function Lt(ft){return ft<16?"0"+ft.toString(16):ft.toString(16)}function bt(ft,at){at=at||1/0;for(var _t,St=ft.length,Vt=null,ee=[],Jt=0;Jt<St;++Jt){if(_t=ft.charCodeAt(Jt),_t>55295&&_t<57344){if(!Vt){if(_t>56319){(at-=3)>-1&&ee.push(239,191,189);continue}else if(Jt+1===St){(at-=3)>-1&&ee.push(239,191,189);continue}Vt=_t;continue}if(_t<56320){(at-=3)>-1&&ee.push(239,191,189),Vt=_t;continue}_t=(Vt-55296<<10|_t-56320)+65536}else Vt&&(at-=3)>-1&&ee.push(239,191,189);if(Vt=null,_t<128){if((at-=1)<0)break;ee.push(_t)}else if(_t<2048){if((at-=2)<0)break;ee.push(_t>>6|192,_t&63|128)}else if(_t<65536){if((at-=3)<0)break;ee.push(_t>>12|224,_t>>6&63|128,_t&63|128)}else if(_t<1114112){if((at-=4)<0)break;ee.push(_t>>18|240,_t>>12&63|128,_t>>6&63|128,_t&63|128)}else throw new Error("Invalid code point")}return ee}function wt(ft){for(var at=[],_t=0;_t<ft.length;++_t)at.push(ft.charCodeAt(_t)&255);return at}function xt(ft,at){for(var _t,St,Vt,ee=[],Jt=0;Jt<ft.length&&!((at-=2)<0);++Jt)_t=ft.charCodeAt(Jt),St=_t>>8,Vt=_t%256,ee.push(Vt),ee.push(St);return ee}function Rt(ft){return F.toByteArray(dt(ft))}function Gt(ft,at,_t,St){for(var Vt=0;Vt<St&&!(Vt+_t>=at.length||Vt>=ft.length);++Vt)at[Vt+_t]=ft[Vt];return Vt}function nt(ft,at){return ft instanceof at||ft!=null&&ft.constructor!=null&&ft.constructor.name!=null&&ft.constructor.name===at.name}function ht(ft){return ft!==ft}}).call(this)}).call(this,g("buffer").Buffer)},{"base64-js":28,buffer:32,ieee754:45}],33:[function(g,w,I){var P=g("get-intrinsic"),F=g("./"),D=F(P("String.prototype.indexOf"));w.exports=function(Z,$){var j=P(Z,!!$);return typeof j=="function"&&D(Z,".prototype.")>-1?F(j):j}},{"./":34,"get-intrinsic":39}],34:[function(g,w,I){var P=g("function-bind"),F=g("get-intrinsic"),D=F("%Function.prototype.apply%"),U=F("%Function.prototype.call%"),Z=F("%Reflect.apply%",!0)||P.call(U,D),$=F("%Object.getOwnPropertyDescriptor%",!0),j=F("%Object.defineProperty%",!0),H=F("%Math.max%");if(j)try{j({},"a",{value:1})}catch{j=null}w.exports=function(Q){var K=Z(P,U,arguments);if($&&j){var q=$(K,"length");q.configurable&&j(K,"length",{value:1+H(0,Q.length-(arguments.length-1))})}return K};var W=function(){return Z(P,D,arguments)};j?j(w.exports,"apply",{value:W}):w.exports.apply=W},{"function-bind":38,"get-intrinsic":39}],35:[function(g,w,I){var P=typeof Reflect=="object"?Reflect:null,F=P&&typeof P.apply=="function"?P.apply:function(ut,it,ct){return Function.prototype.apply.call(ut,it,ct)},D;P&&typeof P.ownKeys=="function"?D=P.ownKeys:Object.getOwnPropertySymbols?D=function(ut){return Object.getOwnPropertyNames(ut).concat(Object.getOwnPropertySymbols(ut))}:D=function(ut){return Object.getOwnPropertyNames(ut)};function U(st){console&&console.warn&&console.warn(st)}var Z=Number.isNaN||function(ut){return ut!==ut};function $(){$.init.call(this)}w.exports=$,w.exports.once=ot,$.EventEmitter=$,$.prototype._events=void 0,$.prototype._eventsCount=0,$.prototype._maxListeners=void 0;var j=10;function H(st){if(typeof st!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof st)}Object.defineProperty($,"defaultMaxListeners",{enumerable:!0,get:function(){return j},set:function(st){if(typeof st!="number"||st<0||Z(st))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+st+".");j=st}}),$.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},$.prototype.setMaxListeners=function(ut){if(typeof ut!="number"||ut<0||Z(ut))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+ut+".");return this._maxListeners=ut,this};function W(st){return st._maxListeners===void 0?$.defaultMaxListeners:st._maxListeners}$.prototype.getMaxListeners=function(){return W(this)},$.prototype.emit=function(ut){for(var it=[],ct=1;ct<arguments.length;ct++)it.push(arguments[ct]);var At=ut==="error",Et=this._events;if(Et!==void 0)At=At&&Et.error===void 0;else if(!At)return!1;if(At){var gt;if(it.length>0&&(gt=it[0]),gt instanceof Error)throw gt;var pt=new Error("Unhandled error."+(gt?" ("+gt.message+")":""));throw pt.context=gt,pt}var vt=Et[ut];if(vt===void 0)return!1;if(typeof vt=="function")F(vt,this,it);else for(var Tt=vt.length,It=X(vt,Tt),ct=0;ct<Tt;++ct)F(It[ct],this,it);return!0};function V(st,ut,it,ct){var At,Et,gt;if(H(it),Et=st._events,Et===void 0?(Et=st._events=Object.create(null),st._eventsCount=0):(Et.newListener!==void 0&&(st.emit("newListener",ut,it.listener?it.listener:it),Et=st._events),gt=Et[ut]),gt===void 0)gt=Et[ut]=it,++st._eventsCount;else if(typeof gt=="function"?gt=Et[ut]=ct?[it,gt]:[gt,it]:ct?gt.unshift(it):gt.push(it),At=W(st),At>0&&gt.length>At&&!gt.warned){gt.warned=!0;var pt=new Error("Possible EventEmitter memory leak detected. "+gt.length+" "+String(ut)+" listeners added. Use emitter.setMaxListeners() to increase limit");pt.name="MaxListenersExceededWarning",pt.emitter=st,pt.type=ut,pt.count=gt.length,U(pt)}return st}$.prototype.addListener=function(ut,it){return V(this,ut,it,!1)},$.prototype.on=$.prototype.addListener,$.prototype.prependListener=function(ut,it){return V(this,ut,it,!0)};function Q(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function K(st,ut,it){var ct={fired:!1,wrapFn:void 0,target:st,type:ut,listener:it},At=Q.bind(ct);return At.listener=it,ct.wrapFn=At,At}$.prototype.once=function(ut,it){return H(it),this.on(ut,K(this,ut,it)),this},$.prototype.prependOnceListener=function(ut,it){return H(it),this.prependListener(ut,K(this,ut,it)),this},$.prototype.removeListener=function(ut,it){var ct,At,Et,gt,pt;if(H(it),At=this._events,At===void 0)return this;if(ct=At[ut],ct===void 0)return this;if(ct===it||ct.listener===it)--this._eventsCount===0?this._events=Object.create(null):(delete At[ut],At.removeListener&&this.emit("removeListener",ut,ct.listener||it));else if(typeof ct!="function"){for(Et=-1,gt=ct.length-1;gt>=0;gt--)if(ct[gt]===it||ct[gt].listener===it){pt=ct[gt].listener,Et=gt;break}if(Et<0)return this;Et===0?ct.shift():tt(ct,Et),ct.length===1&&(At[ut]=ct[0]),At.removeListener!==void 0&&this.emit("removeListener",ut,pt||it)}return this},$.prototype.off=$.prototype.removeListener,$.prototype.removeAllListeners=function(ut){var it,ct,At;if(ct=this._events,ct===void 0)return this;if(ct.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):ct[ut]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete ct[ut]),this;if(arguments.length===0){var Et=Object.keys(ct),gt;for(At=0;At<Et.length;++At)gt=Et[At],gt!=="removeListener"&&this.removeAllListeners(gt);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(it=ct[ut],typeof it=="function")this.removeListener(ut,it);else if(it!==void 0)for(At=it.length-1;At>=0;At--)this.removeListener(ut,it[At]);return this};function q(st,ut,it){var ct=st._events;if(ct===void 0)return[];var At=ct[ut];return At===void 0?[]:typeof At=="function"?it?[At.listener||At]:[At]:it?rt(At):X(At,At.length)}$.prototype.listeners=function(ut){return q(this,ut,!0)},$.prototype.rawListeners=function(ut){return q(this,ut,!1)},$.listenerCount=function(st,ut){return typeof st.listenerCount=="function"?st.listenerCount(ut):et.call(st,ut)},$.prototype.listenerCount=et;function et(st){var ut=this._events;if(ut!==void 0){var it=ut[st];if(typeof it=="function")return 1;if(it!==void 0)return it.length}return 0}$.prototype.eventNames=function(){return this._eventsCount>0?D(this._events):[]};function X(st,ut){for(var it=new Array(ut),ct=0;ct<ut;++ct)it[ct]=st[ct];return it}function tt(st,ut){for(;ut+1<st.length;ut++)st[ut]=st[ut+1];st.pop()}function rt(st){for(var ut=new Array(st.length),it=0;it<ut.length;++it)ut[it]=st[it].listener||st[it];return ut}function ot(st,ut){return new Promise(function(it,ct){function At(gt){st.removeListener(ut,Et),ct(gt)}function Et(){typeof st.removeListener=="function"&&st.removeListener("error",At),it([].slice.call(arguments))}lt(st,ut,Et,{once:!0}),ut!=="error"&&J(st,At,{once:!0})})}function J(st,ut,it){typeof st.on=="function"&&lt(st,"error",ut,it)}function lt(st,ut,it,ct){if(typeof st.on=="function")ct.once?st.once(ut,it):st.on(ut,it);else if(typeof st.addEventListener=="function")st.addEventListener(ut,function At(Et){ct.once&&st.removeEventListener(ut,At),it(Et)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof st)}},{}],36:[function(g,w,I){var P=g("is-callable"),F=Object.prototype.toString,D=Object.prototype.hasOwnProperty,U=function(W,V,Q){for(var K=0,q=W.length;K<q;K++)D.call(W,K)&&(Q==null?V(W[K],K,W):V.call(Q,W[K],K,W))},Z=function(W,V,Q){for(var K=0,q=W.length;K<q;K++)Q==null?V(W.charAt(K),K,W):V.call(Q,W.charAt(K),K,W)},$=function(W,V,Q){for(var K in W)D.call(W,K)&&(Q==null?V(W[K],K,W):V.call(Q,W[K],K,W))},j=function(W,V,Q){if(!P(V))throw new TypeError("iterator must be a function");var K;arguments.length>=3&&(K=Q),F.call(W)==="[object Array]"?U(W,V,K):typeof W=="string"?Z(W,V,K):$(W,V,K)};w.exports=j},{"is-callable":48}],37:[function(g,w,I){var P="Function.prototype.bind called on incompatible ",F=Array.prototype.slice,D=Object.prototype.toString,U="[object Function]";w.exports=function($){var j=this;if(typeof j!="function"||D.call(j)!==U)throw new TypeError(P+j);for(var H=F.call(arguments,1),W,V=function(){if(this instanceof W){var X=j.apply(this,H.concat(F.call(arguments)));return Object(X)===X?X:this}else return j.apply($,H.concat(F.call(arguments)))},Q=Math.max(0,j.length-H.length),K=[],q=0;q<Q;q++)K.push("$"+q);if(W=Function("binder","return function ("+K.join(",")+"){ return binder.apply(this,arguments); }")(V),j.prototype){var et=function(){};et.prototype=j.prototype,W.prototype=new et,et.prototype=null}return W}},{}],38:[function(g,w,I){var P=g("./implementation");w.exports=Function.prototype.bind||P},{"./implementation":37}],39:[function(g,w,I){var P,F=SyntaxError,D=Function,U=TypeError,Z=function(pt){try{return D('"use strict"; return ('+pt+").constructor;")()}catch{}},$=Object.getOwnPropertyDescriptor;if($)try{$({},"")}catch{$=null}var j=function(){throw new U},H=$?function(){try{return arguments.callee,j}catch{try{return $(arguments,"callee").get}catch{return j}}}():j,W=g("has-symbols")(),V=Object.getPrototypeOf||function(pt){return pt.__proto__},Q={},K=typeof Uint8Array>"u"?P:V(Uint8Array),q={"%AggregateError%":typeof AggregateError>"u"?P:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?P:ArrayBuffer,"%ArrayIteratorPrototype%":W?V([][Symbol.iterator]()):P,"%AsyncFromSyncIteratorPrototype%":P,"%AsyncFunction%":Q,"%AsyncGenerator%":Q,"%AsyncGeneratorFunction%":Q,"%AsyncIteratorPrototype%":Q,"%Atomics%":typeof Atomics>"u"?P:Atomics,"%BigInt%":typeof BigInt>"u"?P:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?P:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?P:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?P:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array>"u"?P:Float32Array,"%Float64Array%":typeof Float64Array>"u"?P:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?P:FinalizationRegistry,"%Function%":D,"%GeneratorFunction%":Q,"%Int8Array%":typeof Int8Array>"u"?P:Int8Array,"%Int16Array%":typeof Int16Array>"u"?P:Int16Array,"%Int32Array%":typeof Int32Array>"u"?P:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":W?V(V([][Symbol.iterator]())):P,"%JSON%":typeof JSON=="object"?JSON:P,"%Map%":typeof Map>"u"?P:Map,"%MapIteratorPrototype%":typeof Map>"u"||!W?P:V(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?P:Promise,"%Proxy%":typeof Proxy>"u"?P:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect>"u"?P:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?P:Set,"%SetIteratorPrototype%":typeof Set>"u"||!W?P:V(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?P:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":W?V(""[Symbol.iterator]()):P,"%Symbol%":W?Symbol:P,"%SyntaxError%":F,"%ThrowTypeError%":H,"%TypedArray%":K,"%TypeError%":U,"%Uint8Array%":typeof Uint8Array>"u"?P:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?P:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?P:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?P:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap>"u"?P:WeakMap,"%WeakRef%":typeof WeakRef>"u"?P:WeakRef,"%WeakSet%":typeof WeakSet>"u"?P:WeakSet};try{null.error}catch(pt){var et=V(V(pt));q["%Error.prototype%"]=et}var X=function pt(vt){var Tt;if(vt==="%AsyncFunction%")Tt=Z("async function () {}");else if(vt==="%GeneratorFunction%")Tt=Z("function* () {}");else if(vt==="%AsyncGeneratorFunction%")Tt=Z("async function* () {}");else if(vt==="%AsyncGenerator%"){var It=pt("%AsyncGeneratorFunction%");It&&(Tt=It.prototype)}else if(vt==="%AsyncIteratorPrototype%"){var $t=pt("%AsyncGenerator%");$t&&(Tt=V($t.prototype))}return q[vt]=Tt,Tt},tt={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},rt=g("function-bind"),ot=g("has"),J=rt.call(Function.call,Array.prototype.concat),lt=rt.call(Function.apply,Array.prototype.splice),st=rt.call(Function.call,String.prototype.replace),ut=rt.call(Function.call,String.prototype.slice),it=rt.call(Function.call,RegExp.prototype.exec),ct=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,At=/\\(\\)?/g,Et=function(vt){var Tt=ut(vt,0,1),It=ut(vt,-1);if(Tt==="%"&&It!=="%")throw new F("invalid intrinsic syntax, expected closing `%`");if(It==="%"&&Tt!=="%")throw new F("invalid intrinsic syntax, expected opening `%`");var $t=[];return st(vt,ct,function(Bt,zt,Ot,Nt){$t[$t.length]=Ot?st(Nt,At,"$1"):zt||Bt}),$t},gt=function(vt,Tt){var It=vt,$t;if(ot(tt,It)&&($t=tt[It],It="%"+$t[0]+"%"),ot(q,It)){var Bt=q[It];if(Bt===Q&&(Bt=X(It)),typeof Bt>"u"&&!Tt)throw new U("intrinsic "+vt+" exists, but is not available. Please file an issue!");return{alias:$t,name:It,value:Bt}}throw new F("intrinsic "+vt+" does not exist!")};w.exports=function(vt,Tt){if(typeof vt!="string"||vt.length===0)throw new U("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof Tt!="boolean")throw new U('"allowMissing" argument must be a boolean');if(it(/^%?[^%]*%?$/,vt)===null)throw new F("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var It=Et(vt),$t=It.length>0?It[0]:"",Bt=gt("%"+$t+"%",Tt),zt=Bt.name,Ot=Bt.value,Nt=!1,Pt=Bt.alias;Pt&&($t=Pt[0],lt(It,J([0,1],Pt)));for(var Ut=1,Ft=!0;Ut<It.length;Ut+=1){var Zt=It[Ut],Ht=ut(Zt,0,1),Dt=ut(Zt,-1);if((Ht==='"'||Ht==="'"||Ht==="`"||Dt==='"'||Dt==="'"||Dt==="`")&&Ht!==Dt)throw new F("property names with quotes must have matching quotes");if((Zt==="constructor"||!Ft)&&(Nt=!0),$t+="."+Zt,zt="%"+$t+"%",ot(q,zt))Ot=q[zt];else if(Ot!=null){if(!(Zt in Ot)){if(!Tt)throw new U("base intrinsic for "+vt+" exists, but the property is not available.");return}if($&&Ut+1>=It.length){var dt=$(Ot,Zt);Ft=!!dt,Ft&&"get"in dt&&!("originalValue"in dt.get)?Ot=dt.get:Ot=Ot[Zt]}else Ft=ot(Ot,Zt),Ot=Ot[Zt];Ft&&!Nt&&(q[zt]=Ot)}}return Ot}},{"function-bind":38,has:44,"has-symbols":41}],40:[function(g,w,I){var P=g("get-intrinsic"),F=P("%Object.getOwnPropertyDescriptor%",!0);if(F)try{F([],"length")}catch{F=null}w.exports=F},{"get-intrinsic":39}],41:[function(g,w,I){var P=typeof Symbol<"u"&&Symbol,F=g("./shams");w.exports=function(){return typeof P!="function"||typeof Symbol!="function"||typeof P("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:F()}},{"./shams":42}],42:[function(g,w,I){w.exports=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var F={},D=Symbol("test"),U=Object(D);if(typeof D=="string"||Object.prototype.toString.call(D)!=="[object Symbol]"||Object.prototype.toString.call(U)!=="[object Symbol]")return!1;var Z=42;F[D]=Z;for(D in F)return!1;if(typeof Object.keys=="function"&&Object.keys(F).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(F).length!==0)return!1;var $=Object.getOwnPropertySymbols(F);if($.length!==1||$[0]!==D||!Object.prototype.propertyIsEnumerable.call(F,D))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var j=Object.getOwnPropertyDescriptor(F,D);if(j.value!==Z||j.enumerable!==!0)return!1}return!0}},{}],43:[function(g,w,I){var P=g("has-symbols/shams");w.exports=function(){return P()&&!!Symbol.toStringTag}},{"has-symbols/shams":42}],44:[function(g,w,I){var P=g("function-bind");w.exports=P.call(Function.call,Object.prototype.hasOwnProperty)},{"function-bind":38}],45:[function(g,w,I){/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */I.read=function(P,F,D,U,Z){var $,j,H=Z*8-U-1,W=(1<<H)-1,V=W>>1,Q=-7,K=D?Z-1:0,q=D?-1:1,et=P[F+K];for(K+=q,$=et&(1<<-Q)-1,et>>=-Q,Q+=H;Q>0;$=$*256+P[F+K],K+=q,Q-=8);for(j=$&(1<<-Q)-1,$>>=-Q,Q+=U;Q>0;j=j*256+P[F+K],K+=q,Q-=8);if($===0)$=1-V;else{if($===W)return j?NaN:(et?-1:1)*(1/0);j=j+Math.pow(2,U),$=$-V}return(et?-1:1)*j*Math.pow(2,$-U)},I.write=function(P,F,D,U,Z,$){var j,H,W,V=$*8-Z-1,Q=(1<<V)-1,K=Q>>1,q=Z===23?Math.pow(2,-24)-Math.pow(2,-77):0,et=U?0:$-1,X=U?1:-1,tt=F<0||F===0&&1/F<0?1:0;for(F=Math.abs(F),isNaN(F)||F===1/0?(H=isNaN(F)?1:0,j=Q):(j=Math.floor(Math.log(F)/Math.LN2),F*(W=Math.pow(2,-j))<1&&(j--,W*=2),j+K>=1?F+=q/W:F+=q*Math.pow(2,1-K),F*W>=2&&(j++,W/=2),j+K>=Q?(H=0,j=Q):j+K>=1?(H=(F*W-1)*Math.pow(2,Z),j=j+K):(H=F*Math.pow(2,K-1)*Math.pow(2,Z),j=0));Z>=8;P[D+et]=H&255,et+=X,H/=256,Z-=8);for(j=j<<Z|H,V+=Z;V>0;P[D+et]=j&255,et+=X,j/=256,V-=8);P[D+et-X]|=tt*128}},{}],46:[function(g,w,I){typeof Object.create=="function"?w.exports=function(F,D){D&&(F.super_=D,F.prototype=Object.create(D.prototype,{constructor:{value:F,enumerable:!1,writable:!0,configurable:!0}}))}:w.exports=function(F,D){if(D){F.super_=D;var U=function(){};U.prototype=D.prototype,F.prototype=new U,F.prototype.constructor=F}}},{}],47:[function(g,w,I){var P=g("has-tostringtag/shams")(),F=g("call-bind/callBound"),D=F("Object.prototype.toString"),U=function(H){return P&&H&&typeof H=="object"&&Symbol.toStringTag in H?!1:D(H)==="[object Arguments]"},Z=function(H){return U(H)?!0:H!==null&&typeof H=="object"&&typeof H.length=="number"&&H.length>=0&&D(H)!=="[object Array]"&&D(H.callee)==="[object Function]"},$=function(){return U(arguments)}();U.isLegacyArguments=Z,w.exports=$?U:Z},{"call-bind/callBound":33,"has-tostringtag/shams":43}],48:[function(g,w,I){var P=Function.prototype.toString,F=typeof Reflect=="object"&&Reflect!==null&&Reflect.apply,D,U;if(typeof F=="function"&&typeof Object.defineProperty=="function")try{D=Object.defineProperty({},"length",{get:function(){throw U}}),U={},F(function(){throw 42},null,D)}catch(J){J!==U&&(F=null)}else F=null;var Z=/^\s*class\b/,$=function(lt){try{var st=P.call(lt);return Z.test(st)}catch{return!1}},j=function(lt){try{return $(lt)?!1:(P.call(lt),!0)}catch{return!1}},H=Object.prototype.toString,W="[object Object]",V="[object Function]",Q="[object GeneratorFunction]",K="[object HTMLAllCollection]",q="[object HTML document.all class]",et="[object HTMLCollection]",X=typeof Symbol=="function"&&!!Symbol.toStringTag,tt=!(0 in[,]),rt=function(){return!1};if(typeof document=="object"){var ot=document.all;H.call(ot)===H.call(document.all)&&(rt=function(lt){if((tt||!lt)&&(typeof lt>"u"||typeof lt=="object"))try{var st=H.call(lt);return(st===K||st===q||st===et||st===W)&&lt("")==null}catch{}return!1})}w.exports=F?function(lt){if(rt(lt))return!0;if(!lt||typeof lt!="function"&&typeof lt!="object")return!1;try{F(lt,null,D)}catch(st){if(st!==U)return!1}return!$(lt)&&j(lt)}:function(lt){if(rt(lt))return!0;if(!lt||typeof lt!="function"&&typeof lt!="object")return!1;if(X)return j(lt);if($(lt))return!1;var st=H.call(lt);return st!==V&&st!==Q&&!/^\[object HTML/.test(st)?!1:j(lt)}},{}],49:[function(g,w,I){var P=Object.prototype.toString,F=Function.prototype.toString,D=/^\s*(?:function)?\*/,U=g("has-tostringtag/shams")(),Z=Object.getPrototypeOf,$=function(){if(!U)return!1;try{return Function("return function*() {}")()}catch{}},j;w.exports=function(W){if(typeof W!="function")return!1;if(D.test(F.call(W)))return!0;if(!U){var V=P.call(W);return V==="[object GeneratorFunction]"}if(!Z)return!1;if(typeof j>"u"){var Q=$();j=Q?Z(Q):!1}return Z(W)===j}},{"has-tostringtag/shams":43}],50:[function(g,w,I){(function(P){(function(){var F=g("for-each"),D=g("available-typed-arrays"),U=g("call-bind/callBound"),Z=U("Object.prototype.toString"),$=g("has-tostringtag/shams")(),j=g("gopd"),H=typeof globalThis>"u"?P:globalThis,W=D(),V=U("Array.prototype.indexOf",!0)||function(tt,rt){for(var ot=0;ot<tt.length;ot+=1)if(tt[ot]===rt)return ot;return-1},Q=U("String.prototype.slice"),K={},q=Object.getPrototypeOf;$&&j&&q&&F(W,function(X){var tt=new H[X];if(Symbol.toStringTag in tt){var rt=q(tt),ot=j(rt,Symbol.toStringTag);if(!ot){var J=q(rt);ot=j(J,Symbol.toStringTag)}K[X]=ot.get}});var et=function(tt){var rt=!1;return F(K,function(ot,J){if(!rt)try{rt=ot.call(tt)===J}catch{}}),rt};w.exports=function(tt){if(!tt||typeof tt!="object")return!1;if(!$||!(Symbol.toStringTag in tt)){var rt=Q(Z(tt),8,-1);return V(W,rt)>-1}return j?et(tt):!1}}).call(this)}).call(this,typeof commonjsGlobal$1<"u"?commonjsGlobal$1:typeof self<"u"?self:typeof window<"u"?window:{})},{"available-typed-arrays":27,"call-bind/callBound":33,"for-each":36,gopd:40,"has-tostringtag/shams":43}],51:[function(g,w,I){var P=Object.getOwnPropertySymbols,F=Object.prototype.hasOwnProperty,D=Object.prototype.propertyIsEnumerable;function U($){if($==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object($)}function Z(){try{if(!Object.assign)return!1;var $=new String("abc");if($[5]="de",Object.getOwnPropertyNames($)[0]==="5")return!1;for(var j={},H=0;H<10;H++)j["_"+String.fromCharCode(H)]=H;var W=Object.getOwnPropertyNames(j).map(function(Q){return j[Q]});if(W.join("")!=="0123456789")return!1;var V={};return"abcdefghijklmnopqrst".split("").forEach(function(Q){V[Q]=Q}),Object.keys(Object.assign({},V)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}w.exports=Z()?Object.assign:function($,j){for(var H,W=U($),V,Q=1;Q<arguments.length;Q++){H=Object(arguments[Q]);for(var K in H)F.call(H,K)&&(W[K]=H[K]);if(P){V=P(H);for(var q=0;q<V.length;q++)D.call(H,V[q])&&(W[V[q]]=H[V[q]])}}return W}},{}],52:[function(g,w,I){var P=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";function F(Z,$){return Object.prototype.hasOwnProperty.call(Z,$)}I.assign=function(Z){for(var $=Array.prototype.slice.call(arguments,1);$.length;){var j=$.shift();if(j){if(typeof j!="object")throw new TypeError(j+"must be non-object");for(var H in j)F(j,H)&&(Z[H]=j[H])}}return Z},I.shrinkBuf=function(Z,$){return Z.length===$?Z:Z.subarray?Z.subarray(0,$):(Z.length=$,Z)};var D={arraySet:function(Z,$,j,H,W){if($.subarray&&Z.subarray){Z.set($.subarray(j,j+H),W);return}for(var V=0;V<H;V++)Z[W+V]=$[j+V]},flattenChunks:function(Z){var $,j,H,W,V,Q;for(H=0,$=0,j=Z.length;$<j;$++)H+=Z[$].length;for(Q=new Uint8Array(H),W=0,$=0,j=Z.length;$<j;$++)V=Z[$],Q.set(V,W),W+=V.length;return Q}},U={arraySet:function(Z,$,j,H,W){for(var V=0;V<H;V++)Z[W+V]=$[j+V]},flattenChunks:function(Z){return[].concat.apply([],Z)}};I.setTyped=function(Z){Z?(I.Buf8=Uint8Array,I.Buf16=Uint16Array,I.Buf32=Int32Array,I.assign(I,D)):(I.Buf8=Array,I.Buf16=Array,I.Buf32=Array,I.assign(I,U))},I.setTyped(P)},{}],53:[function(g,w,I){function P(F,D,U,Z){for(var $=F&65535|0,j=F>>>16&65535|0,H=0;U!==0;){H=U>2e3?2e3:U,U-=H;do $=$+D[Z++]|0,j=j+$|0;while(--H);$%=65521,j%=65521}return $|j<<16|0}w.exports=P},{}],54:[function(g,w,I){w.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],55:[function(g,w,I){function P(){for(var U,Z=[],$=0;$<256;$++){U=$;for(var j=0;j<8;j++)U=U&1?3988292384^U>>>1:U>>>1;Z[$]=U}return Z}var F=P();function D(U,Z,$,j){var H=F,W=j+$;U^=-1;for(var V=j;V<W;V++)U=U>>>8^H[(U^Z[V])&255];return U^-1}w.exports=D},{}],56:[function(g,w,I){var P=g("../utils/common"),F=g("./trees"),D=g("./adler32"),U=g("./crc32"),Z=g("./messages"),$=0,j=1,H=3,W=4,V=5,Q=0,K=1,q=-2,et=-3,X=-5,tt=-1,rt=1,ot=2,J=3,lt=4,st=0,ut=2,it=8,ct=9,At=15,Et=8,gt=29,pt=256,vt=pt+1+gt,Tt=30,It=19,$t=2*vt+1,Bt=15,zt=3,Ot=258,Nt=Ot+zt+1,Pt=32,Ut=42,Ft=69,Zt=73,Ht=91,Dt=103,dt=113,Lt=666,bt=1,wt=2,xt=3,Rt=4,Gt=3;function nt(mt,qt){return mt.msg=Z[qt],qt}function ht(mt){return(mt<<1)-(mt>4?9:0)}function ft(mt){for(var qt=mt.length;--qt>=0;)mt[qt]=0}function at(mt){var qt=mt.state,ie=qt.pending;ie>mt.avail_out&&(ie=mt.avail_out),ie!==0&&(P.arraySet(mt.output,qt.pending_buf,qt.pending_out,ie,mt.next_out),mt.next_out+=ie,qt.pending_out+=ie,mt.total_out+=ie,mt.avail_out-=ie,qt.pending-=ie,qt.pending===0&&(qt.pending_out=0))}function _t(mt,qt){F._tr_flush_block(mt,mt.block_start>=0?mt.block_start:-1,mt.strstart-mt.block_start,qt),mt.block_start=mt.strstart,at(mt.strm)}function St(mt,qt){mt.pending_buf[mt.pending++]=qt}function Vt(mt,qt){mt.pending_buf[mt.pending++]=qt>>>8&255,mt.pending_buf[mt.pending++]=qt&255}function ee(mt,qt,ie,jt){var Kt=mt.avail_in;return Kt>jt&&(Kt=jt),Kt===0?0:(mt.avail_in-=Kt,P.arraySet(qt,mt.input,mt.next_in,Kt,ie),mt.state.wrap===1?mt.adler=D(mt.adler,qt,Kt,ie):mt.state.wrap===2&&(mt.adler=U(mt.adler,qt,Kt,ie)),mt.next_in+=Kt,mt.total_in+=Kt,Kt)}function Jt(mt,qt){var ie=mt.max_chain_length,jt=mt.strstart,Kt,ne,pe=mt.prev_length,ce=mt.nice_match,de=mt.strstart>mt.w_size-Nt?mt.strstart-(mt.w_size-Nt):0,ge=mt.window,ve=mt.w_mask,Ee=mt.prev,ye=mt.strstart+Ot,_e=ge[jt+pe-1],we=ge[jt+pe];mt.prev_length>=mt.good_match&&(ie>>=2),ce>mt.lookahead&&(ce=mt.lookahead);do if(Kt=qt,!(ge[Kt+pe]!==we||ge[Kt+pe-1]!==_e||ge[Kt]!==ge[jt]||ge[++Kt]!==ge[jt+1])){jt+=2,Kt++;do;while(ge[++jt]===ge[++Kt]&&ge[++jt]===ge[++Kt]&&ge[++jt]===ge[++Kt]&&ge[++jt]===ge[++Kt]&&ge[++jt]===ge[++Kt]&&ge[++jt]===ge[++Kt]&&ge[++jt]===ge[++Kt]&&ge[++jt]===ge[++Kt]&&jt<ye);if(ne=Ot-(ye-jt),jt=ye-Ot,ne>pe){if(mt.match_start=qt,pe=ne,ne>=ce)break;_e=ge[jt+pe-1],we=ge[jt+pe]}}while((qt=Ee[qt&ve])>de&&--ie!==0);return pe<=mt.lookahead?pe:mt.lookahead}function se(mt){var qt=mt.w_size,ie,jt,Kt,ne,pe;do{if(ne=mt.window_size-mt.lookahead-mt.strstart,mt.strstart>=qt+(qt-Nt)){P.arraySet(mt.window,mt.window,qt,qt,0),mt.match_start-=qt,mt.strstart-=qt,mt.block_start-=qt,jt=mt.hash_size,ie=jt;do Kt=mt.head[--ie],mt.head[ie]=Kt>=qt?Kt-qt:0;while(--jt);jt=qt,ie=jt;do Kt=mt.prev[--ie],mt.prev[ie]=Kt>=qt?Kt-qt:0;while(--jt);ne+=qt}if(mt.strm.avail_in===0)break;if(jt=ee(mt.strm,mt.window,mt.strstart+mt.lookahead,ne),mt.lookahead+=jt,mt.lookahead+mt.insert>=zt)for(pe=mt.strstart-mt.insert,mt.ins_h=mt.window[pe],mt.ins_h=(mt.ins_h<<mt.hash_shift^mt.window[pe+1])&mt.hash_mask;mt.insert&&(mt.ins_h=(mt.ins_h<<mt.hash_shift^mt.window[pe+zt-1])&mt.hash_mask,mt.prev[pe&mt.w_mask]=mt.head[mt.ins_h],mt.head[mt.ins_h]=pe,pe++,mt.insert--,!(mt.lookahead+mt.insert<zt)););}while(mt.lookahead<Nt&&mt.strm.avail_in!==0)}function ae(mt,qt){var ie=65535;for(ie>mt.pending_buf_size-5&&(ie=mt.pending_buf_size-5);;){if(mt.lookahead<=1){if(se(mt),mt.lookahead===0&&qt===$)return bt;if(mt.lookahead===0)break}mt.strstart+=mt.lookahead,mt.lookahead=0;var jt=mt.block_start+ie;if((mt.strstart===0||mt.strstart>=jt)&&(mt.lookahead=mt.strstart-jt,mt.strstart=jt,_t(mt,!1),mt.strm.avail_out===0)||mt.strstart-mt.block_start>=mt.w_size-Nt&&(_t(mt,!1),mt.strm.avail_out===0))return bt}return mt.insert=0,qt===W?(_t(mt,!0),mt.strm.avail_out===0?xt:Rt):(mt.strstart>mt.block_start&&(_t(mt,!1),mt.strm.avail_out===0),bt)}function fe(mt,qt){for(var ie,jt;;){if(mt.lookahead<Nt){if(se(mt),mt.lookahead<Nt&&qt===$)return bt;if(mt.lookahead===0)break}if(ie=0,mt.lookahead>=zt&&(mt.ins_h=(mt.ins_h<<mt.hash_shift^mt.window[mt.strstart+zt-1])&mt.hash_mask,ie=mt.prev[mt.strstart&mt.w_mask]=mt.head[mt.ins_h],mt.head[mt.ins_h]=mt.strstart),ie!==0&&mt.strstart-ie<=mt.w_size-Nt&&(mt.match_length=Jt(mt,ie)),mt.match_length>=zt)if(jt=F._tr_tally(mt,mt.strstart-mt.match_start,mt.match_length-zt),mt.lookahead-=mt.match_length,mt.match_length<=mt.max_lazy_match&&mt.lookahead>=zt){mt.match_length--;do mt.strstart++,mt.ins_h=(mt.ins_h<<mt.hash_shift^mt.window[mt.strstart+zt-1])&mt.hash_mask,ie=mt.prev[mt.strstart&mt.w_mask]=mt.head[mt.ins_h],mt.head[mt.ins_h]=mt.strstart;while(--mt.match_length!==0);mt.strstart++}else mt.strstart+=mt.match_length,mt.match_length=0,mt.ins_h=mt.window[mt.strstart],mt.ins_h=(mt.ins_h<<mt.hash_shift^mt.window[mt.strstart+1])&mt.hash_mask;else jt=F._tr_tally(mt,0,mt.window[mt.strstart]),mt.lookahead--,mt.strstart++;if(jt&&(_t(mt,!1),mt.strm.avail_out===0))return bt}return mt.insert=mt.strstart<zt-1?mt.strstart:zt-1,qt===W?(_t(mt,!0),mt.strm.avail_out===0?xt:Rt):mt.last_lit&&(_t(mt,!1),mt.strm.avail_out===0)?bt:wt}function le(mt,qt){for(var ie,jt,Kt;;){if(mt.lookahead<Nt){if(se(mt),mt.lookahead<Nt&&qt===$)return bt;if(mt.lookahead===0)break}if(ie=0,mt.lookahead>=zt&&(mt.ins_h=(mt.ins_h<<mt.hash_shift^mt.window[mt.strstart+zt-1])&mt.hash_mask,ie=mt.prev[mt.strstart&mt.w_mask]=mt.head[mt.ins_h],mt.head[mt.ins_h]=mt.strstart),mt.prev_length=mt.match_length,mt.prev_match=mt.match_start,mt.match_length=zt-1,ie!==0&&mt.prev_length<mt.max_lazy_match&&mt.strstart-ie<=mt.w_size-Nt&&(mt.match_length=Jt(mt,ie),mt.match_length<=5&&(mt.strategy===rt||mt.match_length===zt&&mt.strstart-mt.match_start>4096)&&(mt.match_length=zt-1)),mt.prev_length>=zt&&mt.match_length<=mt.prev_length){Kt=mt.strstart+mt.lookahead-zt,jt=F._tr_tally(mt,mt.strstart-1-mt.prev_match,mt.prev_length-zt),mt.lookahead-=mt.prev_length-1,mt.prev_length-=2;do++mt.strstart<=Kt&&(mt.ins_h=(mt.ins_h<<mt.hash_shift^mt.window[mt.strstart+zt-1])&mt.hash_mask,ie=mt.prev[mt.strstart&mt.w_mask]=mt.head[mt.ins_h],mt.head[mt.ins_h]=mt.strstart);while(--mt.prev_length!==0);if(mt.match_available=0,mt.match_length=zt-1,mt.strstart++,jt&&(_t(mt,!1),mt.strm.avail_out===0))return bt}else if(mt.match_available){if(jt=F._tr_tally(mt,0,mt.window[mt.strstart-1]),jt&&_t(mt,!1),mt.strstart++,mt.lookahead--,mt.strm.avail_out===0)return bt}else mt.match_available=1,mt.strstart++,mt.lookahead--}return mt.match_available&&(jt=F._tr_tally(mt,0,mt.window[mt.strstart-1]),mt.match_available=0),mt.insert=mt.strstart<zt-1?mt.strstart:zt-1,qt===W?(_t(mt,!0),mt.strm.avail_out===0?xt:Rt):mt.last_lit&&(_t(mt,!1),mt.strm.avail_out===0)?bt:wt}function ue(mt,qt){for(var ie,jt,Kt,ne,pe=mt.window;;){if(mt.lookahead<=Ot){if(se(mt),mt.lookahead<=Ot&&qt===$)return bt;if(mt.lookahead===0)break}if(mt.match_length=0,mt.lookahead>=zt&&mt.strstart>0&&(Kt=mt.strstart-1,jt=pe[Kt],jt===pe[++Kt]&&jt===pe[++Kt]&&jt===pe[++Kt])){ne=mt.strstart+Ot;do;while(jt===pe[++Kt]&&jt===pe[++Kt]&&jt===pe[++Kt]&&jt===pe[++Kt]&&jt===pe[++Kt]&&jt===pe[++Kt]&&jt===pe[++Kt]&&jt===pe[++Kt]&&Kt<ne);mt.match_length=Ot-(ne-Kt),mt.match_length>mt.lookahead&&(mt.match_length=mt.lookahead)}if(mt.match_length>=zt?(ie=F._tr_tally(mt,1,mt.match_length-zt),mt.lookahead-=mt.match_length,mt.strstart+=mt.match_length,mt.match_length=0):(ie=F._tr_tally(mt,0,mt.window[mt.strstart]),mt.lookahead--,mt.strstart++),ie&&(_t(mt,!1),mt.strm.avail_out===0))return bt}return mt.insert=0,qt===W?(_t(mt,!0),mt.strm.avail_out===0?xt:Rt):mt.last_lit&&(_t(mt,!1),mt.strm.avail_out===0)?bt:wt}function me(mt,qt){for(var ie;;){if(mt.lookahead===0&&(se(mt),mt.lookahead===0)){if(qt===$)return bt;break}if(mt.match_length=0,ie=F._tr_tally(mt,0,mt.window[mt.strstart]),mt.lookahead--,mt.strstart++,ie&&(_t(mt,!1),mt.strm.avail_out===0))return bt}return mt.insert=0,qt===W?(_t(mt,!0),mt.strm.avail_out===0?xt:Rt):mt.last_lit&&(_t(mt,!1),mt.strm.avail_out===0)?bt:wt}function he(mt,qt,ie,jt,Kt){this.good_length=mt,this.max_lazy=qt,this.nice_length=ie,this.max_chain=jt,this.func=Kt}var Wt;Wt=[new he(0,0,0,0,ae),new he(4,4,8,4,fe),new he(4,5,16,8,fe),new he(4,6,32,32,fe),new he(4,4,16,16,le),new he(8,16,32,32,le),new he(8,16,128,128,le),new he(8,32,128,256,le),new he(32,128,258,1024,le),new he(32,258,258,4096,le)];function oe(mt){mt.window_size=2*mt.w_size,ft(mt.head),mt.max_lazy_match=Wt[mt.level].max_lazy,mt.good_match=Wt[mt.level].good_length,mt.nice_match=Wt[mt.level].nice_length,mt.max_chain_length=Wt[mt.level].max_chain,mt.strstart=0,mt.block_start=0,mt.lookahead=0,mt.insert=0,mt.match_length=mt.prev_length=zt-1,mt.match_available=0,mt.ins_h=0}function kt(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=it,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new P.Buf16($t*2),this.dyn_dtree=new P.Buf16((2*Tt+1)*2),this.bl_tree=new P.Buf16((2*It+1)*2),ft(this.dyn_ltree),ft(this.dyn_dtree),ft(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new P.Buf16(Bt+1),this.heap=new P.Buf16(2*vt+1),ft(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new P.Buf16(2*vt+1),ft(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Xt(mt){var qt;return!mt||!mt.state?nt(mt,q):(mt.total_in=mt.total_out=0,mt.data_type=ut,qt=mt.state,qt.pending=0,qt.pending_out=0,qt.wrap<0&&(qt.wrap=-qt.wrap),qt.status=qt.wrap?Ut:dt,mt.adler=qt.wrap===2?0:1,qt.last_flush=$,F._tr_init(qt),Q)}function Ct(mt){var qt=Xt(mt);return qt===Q&&oe(mt.state),qt}function re(mt,qt){return!mt||!mt.state||mt.state.wrap!==2?q:(mt.state.gzhead=qt,Q)}function te(mt,qt,ie,jt,Kt,ne){if(!mt)return q;var pe=1;if(qt===tt&&(qt=6),jt<0?(pe=0,jt=-jt):jt>15&&(pe=2,jt-=16),Kt<1||Kt>ct||ie!==it||jt<8||jt>15||qt<0||qt>9||ne<0||ne>lt)return nt(mt,q);jt===8&&(jt=9);var ce=new kt;return mt.state=ce,ce.strm=mt,ce.wrap=pe,ce.gzhead=null,ce.w_bits=jt,ce.w_size=1<<ce.w_bits,ce.w_mask=ce.w_size-1,ce.hash_bits=Kt+7,ce.hash_size=1<<ce.hash_bits,ce.hash_mask=ce.hash_size-1,ce.hash_shift=~~((ce.hash_bits+zt-1)/zt),ce.window=new P.Buf8(ce.w_size*2),ce.head=new P.Buf16(ce.hash_size),ce.prev=new P.Buf16(ce.w_size),ce.lit_bufsize=1<<Kt+6,ce.pending_buf_size=ce.lit_bufsize*4,ce.pending_buf=new P.Buf8(ce.pending_buf_size),ce.d_buf=1*ce.lit_bufsize,ce.l_buf=3*ce.lit_bufsize,ce.level=qt,ce.strategy=ne,ce.method=ie,Ct(mt)}function yt(mt,qt){return te(mt,qt,it,At,Et,st)}function Mt(mt,qt){var ie,jt,Kt,ne;if(!mt||!mt.state||qt>V||qt<0)return mt?nt(mt,q):q;if(jt=mt.state,!mt.output||!mt.input&&mt.avail_in!==0||jt.status===Lt&&qt!==W)return nt(mt,mt.avail_out===0?X:q);if(jt.strm=mt,ie=jt.last_flush,jt.last_flush=qt,jt.status===Ut)if(jt.wrap===2)mt.adler=0,St(jt,31),St(jt,139),St(jt,8),jt.gzhead?(St(jt,(jt.gzhead.text?1:0)+(jt.gzhead.hcrc?2:0)+(jt.gzhead.extra?4:0)+(jt.gzhead.name?8:0)+(jt.gzhead.comment?16:0)),St(jt,jt.gzhead.time&255),St(jt,jt.gzhead.time>>8&255),St(jt,jt.gzhead.time>>16&255),St(jt,jt.gzhead.time>>24&255),St(jt,jt.level===9?2:jt.strategy>=ot||jt.level<2?4:0),St(jt,jt.gzhead.os&255),jt.gzhead.extra&&jt.gzhead.extra.length&&(St(jt,jt.gzhead.extra.length&255),St(jt,jt.gzhead.extra.length>>8&255)),jt.gzhead.hcrc&&(mt.adler=U(mt.adler,jt.pending_buf,jt.pending,0)),jt.gzindex=0,jt.status=Ft):(St(jt,0),St(jt,0),St(jt,0),St(jt,0),St(jt,0),St(jt,jt.level===9?2:jt.strategy>=ot||jt.level<2?4:0),St(jt,Gt),jt.status=dt);else{var pe=it+(jt.w_bits-8<<4)<<8,ce=-1;jt.strategy>=ot||jt.level<2?ce=0:jt.level<6?ce=1:jt.level===6?ce=2:ce=3,pe|=ce<<6,jt.strstart!==0&&(pe|=Pt),pe+=31-pe%31,jt.status=dt,Vt(jt,pe),jt.strstart!==0&&(Vt(jt,mt.adler>>>16),Vt(jt,mt.adler&65535)),mt.adler=1}if(jt.status===Ft)if(jt.gzhead.extra){for(Kt=jt.pending;jt.gzindex<(jt.gzhead.extra.length&65535)&&!(jt.pending===jt.pending_buf_size&&(jt.gzhead.hcrc&&jt.pending>Kt&&(mt.adler=U(mt.adler,jt.pending_buf,jt.pending-Kt,Kt)),at(mt),Kt=jt.pending,jt.pending===jt.pending_buf_size));)St(jt,jt.gzhead.extra[jt.gzindex]&255),jt.gzindex++;jt.gzhead.hcrc&&jt.pending>Kt&&(mt.adler=U(mt.adler,jt.pending_buf,jt.pending-Kt,Kt)),jt.gzindex===jt.gzhead.extra.length&&(jt.gzindex=0,jt.status=Zt)}else jt.status=Zt;if(jt.status===Zt)if(jt.gzhead.name){Kt=jt.pending;do{if(jt.pending===jt.pending_buf_size&&(jt.gzhead.hcrc&&jt.pending>Kt&&(mt.adler=U(mt.adler,jt.pending_buf,jt.pending-Kt,Kt)),at(mt),Kt=jt.pending,jt.pending===jt.pending_buf_size)){ne=1;break}jt.gzindex<jt.gzhead.name.length?ne=jt.gzhead.name.charCodeAt(jt.gzindex++)&255:ne=0,St(jt,ne)}while(ne!==0);jt.gzhead.hcrc&&jt.pending>Kt&&(mt.adler=U(mt.adler,jt.pending_buf,jt.pending-Kt,Kt)),ne===0&&(jt.gzindex=0,jt.status=Ht)}else jt.status=Ht;if(jt.status===Ht)if(jt.gzhead.comment){Kt=jt.pending;do{if(jt.pending===jt.pending_buf_size&&(jt.gzhead.hcrc&&jt.pending>Kt&&(mt.adler=U(mt.adler,jt.pending_buf,jt.pending-Kt,Kt)),at(mt),Kt=jt.pending,jt.pending===jt.pending_buf_size)){ne=1;break}jt.gzindex<jt.gzhead.comment.length?ne=jt.gzhead.comment.charCodeAt(jt.gzindex++)&255:ne=0,St(jt,ne)}while(ne!==0);jt.gzhead.hcrc&&jt.pending>Kt&&(mt.adler=U(mt.adler,jt.pending_buf,jt.pending-Kt,Kt)),ne===0&&(jt.status=Dt)}else jt.status=Dt;if(jt.status===Dt&&(jt.gzhead.hcrc?(jt.pending+2>jt.pending_buf_size&&at(mt),jt.pending+2<=jt.pending_buf_size&&(St(jt,mt.adler&255),St(jt,mt.adler>>8&255),mt.adler=0,jt.status=dt)):jt.status=dt),jt.pending!==0){if(at(mt),mt.avail_out===0)return jt.last_flush=-1,Q}else if(mt.avail_in===0&&ht(qt)<=ht(ie)&&qt!==W)return nt(mt,X);if(jt.status===Lt&&mt.avail_in!==0)return nt(mt,X);if(mt.avail_in!==0||jt.lookahead!==0||qt!==$&&jt.status!==Lt){var de=jt.strategy===ot?me(jt,qt):jt.strategy===J?ue(jt,qt):Wt[jt.level].func(jt,qt);if((de===xt||de===Rt)&&(jt.status=Lt),de===bt||de===xt)return mt.avail_out===0&&(jt.last_flush=-1),Q;if(de===wt&&(qt===j?F._tr_align(jt):qt!==V&&(F._tr_stored_block(jt,0,0,!1),qt===H&&(ft(jt.head),jt.lookahead===0&&(jt.strstart=0,jt.block_start=0,jt.insert=0))),at(mt),mt.avail_out===0))return jt.last_flush=-1,Q}return qt!==W?Q:jt.wrap<=0?K:(jt.wrap===2?(St(jt,mt.adler&255),St(jt,mt.adler>>8&255),St(jt,mt.adler>>16&255),St(jt,mt.adler>>24&255),St(jt,mt.total_in&255),St(jt,mt.total_in>>8&255),St(jt,mt.total_in>>16&255),St(jt,mt.total_in>>24&255)):(Vt(jt,mt.adler>>>16),Vt(jt,mt.adler&65535)),at(mt),jt.wrap>0&&(jt.wrap=-jt.wrap),jt.pending!==0?Q:K)}function Yt(mt){var qt;return!mt||!mt.state?q:(qt=mt.state.status,qt!==Ut&&qt!==Ft&&qt!==Zt&&qt!==Ht&&qt!==Dt&&qt!==dt&&qt!==Lt?nt(mt,q):(mt.state=null,qt===dt?nt(mt,et):Q))}function Qt(mt,qt){var ie=qt.length,jt,Kt,ne,pe,ce,de,ge,ve;if(!mt||!mt.state||(jt=mt.state,pe=jt.wrap,pe===2||pe===1&&jt.status!==Ut||jt.lookahead))return q;for(pe===1&&(mt.adler=D(mt.adler,qt,ie,0)),jt.wrap=0,ie>=jt.w_size&&(pe===0&&(ft(jt.head),jt.strstart=0,jt.block_start=0,jt.insert=0),ve=new P.Buf8(jt.w_size),P.arraySet(ve,qt,ie-jt.w_size,jt.w_size,0),qt=ve,ie=jt.w_size),ce=mt.avail_in,de=mt.next_in,ge=mt.input,mt.avail_in=ie,mt.next_in=0,mt.input=qt,se(jt);jt.lookahead>=zt;){Kt=jt.strstart,ne=jt.lookahead-(zt-1);do jt.ins_h=(jt.ins_h<<jt.hash_shift^jt.window[Kt+zt-1])&jt.hash_mask,jt.prev[Kt&jt.w_mask]=jt.head[jt.ins_h],jt.head[jt.ins_h]=Kt,Kt++;while(--ne);jt.strstart=Kt,jt.lookahead=zt-1,se(jt)}return jt.strstart+=jt.lookahead,jt.block_start=jt.strstart,jt.insert=jt.lookahead,jt.lookahead=0,jt.match_length=jt.prev_length=zt-1,jt.match_available=0,mt.next_in=de,mt.input=ge,mt.avail_in=ce,jt.wrap=pe,Q}I.deflateInit=yt,I.deflateInit2=te,I.deflateReset=Ct,I.deflateResetKeep=Xt,I.deflateSetHeader=re,I.deflate=Mt,I.deflateEnd=Yt,I.deflateSetDictionary=Qt,I.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":52,"./adler32":53,"./crc32":55,"./messages":60,"./trees":61}],57:[function(g,w,I){var P=30,F=12;w.exports=function(U,Z){var $,j,H,W,V,Q,K,q,et,X,tt,rt,ot,J,lt,st,ut,it,ct,At,Et,gt,pt,vt,Tt;$=U.state,j=U.next_in,vt=U.input,H=j+(U.avail_in-5),W=U.next_out,Tt=U.output,V=W-(Z-U.avail_out),Q=W+(U.avail_out-257),K=$.dmax,q=$.wsize,et=$.whave,X=$.wnext,tt=$.window,rt=$.hold,ot=$.bits,J=$.lencode,lt=$.distcode,st=(1<<$.lenbits)-1,ut=(1<<$.distbits)-1;t:do{ot<15&&(rt+=vt[j++]<<ot,ot+=8,rt+=vt[j++]<<ot,ot+=8),it=J[rt&st];e:for(;;){if(ct=it>>>24,rt>>>=ct,ot-=ct,ct=it>>>16&255,ct===0)Tt[W++]=it&65535;else if(ct&16){At=it&65535,ct&=15,ct&&(ot<ct&&(rt+=vt[j++]<<ot,ot+=8),At+=rt&(1<<ct)-1,rt>>>=ct,ot-=ct),ot<15&&(rt+=vt[j++]<<ot,ot+=8,rt+=vt[j++]<<ot,ot+=8),it=lt[rt&ut];r:for(;;){if(ct=it>>>24,rt>>>=ct,ot-=ct,ct=it>>>16&255,ct&16){if(Et=it&65535,ct&=15,ot<ct&&(rt+=vt[j++]<<ot,ot+=8,ot<ct&&(rt+=vt[j++]<<ot,ot+=8)),Et+=rt&(1<<ct)-1,Et>K){U.msg="invalid distance too far back",$.mode=P;break t}if(rt>>>=ct,ot-=ct,ct=W-V,Et>ct){if(ct=Et-ct,ct>et&&$.sane){U.msg="invalid distance too far back",$.mode=P;break t}if(gt=0,pt=tt,X===0){if(gt+=q-ct,ct<At){At-=ct;do Tt[W++]=tt[gt++];while(--ct);gt=W-Et,pt=Tt}}else if(X<ct){if(gt+=q+X-ct,ct-=X,ct<At){At-=ct;do Tt[W++]=tt[gt++];while(--ct);if(gt=0,X<At){ct=X,At-=ct;do Tt[W++]=tt[gt++];while(--ct);gt=W-Et,pt=Tt}}}else if(gt+=X-ct,ct<At){At-=ct;do Tt[W++]=tt[gt++];while(--ct);gt=W-Et,pt=Tt}for(;At>2;)Tt[W++]=pt[gt++],Tt[W++]=pt[gt++],Tt[W++]=pt[gt++],At-=3;At&&(Tt[W++]=pt[gt++],At>1&&(Tt[W++]=pt[gt++]))}else{gt=W-Et;do Tt[W++]=Tt[gt++],Tt[W++]=Tt[gt++],Tt[W++]=Tt[gt++],At-=3;while(At>2);At&&(Tt[W++]=Tt[gt++],At>1&&(Tt[W++]=Tt[gt++]))}}else if(ct&64){U.msg="invalid distance code",$.mode=P;break t}else{it=lt[(it&65535)+(rt&(1<<ct)-1)];continue r}break}}else if(ct&64)if(ct&32){$.mode=F;break t}else{U.msg="invalid literal/length code",$.mode=P;break t}else{it=J[(it&65535)+(rt&(1<<ct)-1)];continue e}break}}while(j<H&&W<Q);At=ot>>3,j-=At,ot-=At<<3,rt&=(1<<ot)-1,U.next_in=j,U.next_out=W,U.avail_in=j<H?5+(H-j):5-(j-H),U.avail_out=W<Q?257+(Q-W):257-(W-Q),$.hold=rt,$.bits=ot}},{}],58:[function(g,w,I){var P=g("../utils/common"),F=g("./adler32"),D=g("./crc32"),U=g("./inffast"),Z=g("./inftrees"),$=0,j=1,H=2,W=4,V=5,Q=6,K=0,q=1,et=2,X=-2,tt=-3,rt=-4,ot=-5,J=8,lt=1,st=2,ut=3,it=4,ct=5,At=6,Et=7,gt=8,pt=9,vt=10,Tt=11,It=12,$t=13,Bt=14,zt=15,Ot=16,Nt=17,Pt=18,Ut=19,Ft=20,Zt=21,Ht=22,Dt=23,dt=24,Lt=25,bt=26,wt=27,xt=28,Rt=29,Gt=30,nt=31,ht=32,ft=852,at=592,_t=15,St=_t;function Vt(te){return(te>>>24&255)+(te>>>8&65280)+((te&65280)<<8)+((te&255)<<24)}function ee(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new P.Buf16(320),this.work=new P.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function Jt(te){var yt;return!te||!te.state?X:(yt=te.state,te.total_in=te.total_out=yt.total=0,te.msg="",yt.wrap&&(te.adler=yt.wrap&1),yt.mode=lt,yt.last=0,yt.havedict=0,yt.dmax=32768,yt.head=null,yt.hold=0,yt.bits=0,yt.lencode=yt.lendyn=new P.Buf32(ft),yt.distcode=yt.distdyn=new P.Buf32(at),yt.sane=1,yt.back=-1,K)}function se(te){var yt;return!te||!te.state?X:(yt=te.state,yt.wsize=0,yt.whave=0,yt.wnext=0,Jt(te))}function ae(te,yt){var Mt,Yt;return!te||!te.state||(Yt=te.state,yt<0?(Mt=0,yt=-yt):(Mt=(yt>>4)+1,yt<48&&(yt&=15)),yt&&(yt<8||yt>15))?X:(Yt.window!==null&&Yt.wbits!==yt&&(Yt.window=null),Yt.wrap=Mt,Yt.wbits=yt,se(te))}function fe(te,yt){var Mt,Yt;return te?(Yt=new ee,te.state=Yt,Yt.window=null,Mt=ae(te,yt),Mt!==K&&(te.state=null),Mt):X}function le(te){return fe(te,St)}var ue=!0,me,he;function Wt(te){if(ue){var yt;for(me=new P.Buf32(512),he=new P.Buf32(32),yt=0;yt<144;)te.lens[yt++]=8;for(;yt<256;)te.lens[yt++]=9;for(;yt<280;)te.lens[yt++]=7;for(;yt<288;)te.lens[yt++]=8;for(Z(j,te.lens,0,288,me,0,te.work,{bits:9}),yt=0;yt<32;)te.lens[yt++]=5;Z(H,te.lens,0,32,he,0,te.work,{bits:5}),ue=!1}te.lencode=me,te.lenbits=9,te.distcode=he,te.distbits=5}function oe(te,yt,Mt,Yt){var Qt,mt=te.state;return mt.window===null&&(mt.wsize=1<<mt.wbits,mt.wnext=0,mt.whave=0,mt.window=new P.Buf8(mt.wsize)),Yt>=mt.wsize?(P.arraySet(mt.window,yt,Mt-mt.wsize,mt.wsize,0),mt.wnext=0,mt.whave=mt.wsize):(Qt=mt.wsize-mt.wnext,Qt>Yt&&(Qt=Yt),P.arraySet(mt.window,yt,Mt-Yt,Qt,mt.wnext),Yt-=Qt,Yt?(P.arraySet(mt.window,yt,Mt-Yt,Yt,0),mt.wnext=Yt,mt.whave=mt.wsize):(mt.wnext+=Qt,mt.wnext===mt.wsize&&(mt.wnext=0),mt.whave<mt.wsize&&(mt.whave+=Qt))),0}function kt(te,yt){var Mt,Yt,Qt,mt,qt,ie,jt,Kt,ne,pe,ce,de,ge,ve,Ee=0,ye,_e,we,xe,Se,Ae,be,Ie,Te=new P.Buf8(4),Re,ke,Me=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!te||!te.state||!te.output||!te.input&&te.avail_in!==0)return X;Mt=te.state,Mt.mode===It&&(Mt.mode=$t),qt=te.next_out,Qt=te.output,jt=te.avail_out,mt=te.next_in,Yt=te.input,ie=te.avail_in,Kt=Mt.hold,ne=Mt.bits,pe=ie,ce=jt,Ie=K;t:for(;;)switch(Mt.mode){case lt:if(Mt.wrap===0){Mt.mode=$t;break}for(;ne<16;){if(ie===0)break t;ie--,Kt+=Yt[mt++]<<ne,ne+=8}if(Mt.wrap&2&&Kt===35615){Mt.check=0,Te[0]=Kt&255,Te[1]=Kt>>>8&255,Mt.check=D(Mt.check,Te,2,0),Kt=0,ne=0,Mt.mode=st;break}if(Mt.flags=0,Mt.head&&(Mt.head.done=!1),!(Mt.wrap&1)||(((Kt&255)<<8)+(Kt>>8))%31){te.msg="incorrect header check",Mt.mode=Gt;break}if((Kt&15)!==J){te.msg="unknown compression method",Mt.mode=Gt;break}if(Kt>>>=4,ne-=4,be=(Kt&15)+8,Mt.wbits===0)Mt.wbits=be;else if(be>Mt.wbits){te.msg="invalid window size",Mt.mode=Gt;break}Mt.dmax=1<<be,te.adler=Mt.check=1,Mt.mode=Kt&512?vt:It,Kt=0,ne=0;break;case st:for(;ne<16;){if(ie===0)break t;ie--,Kt+=Yt[mt++]<<ne,ne+=8}if(Mt.flags=Kt,(Mt.flags&255)!==J){te.msg="unknown compression method",Mt.mode=Gt;break}if(Mt.flags&57344){te.msg="unknown header flags set",Mt.mode=Gt;break}Mt.head&&(Mt.head.text=Kt>>8&1),Mt.flags&512&&(Te[0]=Kt&255,Te[1]=Kt>>>8&255,Mt.check=D(Mt.check,Te,2,0)),Kt=0,ne=0,Mt.mode=ut;case ut:for(;ne<32;){if(ie===0)break t;ie--,Kt+=Yt[mt++]<<ne,ne+=8}Mt.head&&(Mt.head.time=Kt),Mt.flags&512&&(Te[0]=Kt&255,Te[1]=Kt>>>8&255,Te[2]=Kt>>>16&255,Te[3]=Kt>>>24&255,Mt.check=D(Mt.check,Te,4,0)),Kt=0,ne=0,Mt.mode=it;case it:for(;ne<16;){if(ie===0)break t;ie--,Kt+=Yt[mt++]<<ne,ne+=8}Mt.head&&(Mt.head.xflags=Kt&255,Mt.head.os=Kt>>8),Mt.flags&512&&(Te[0]=Kt&255,Te[1]=Kt>>>8&255,Mt.check=D(Mt.check,Te,2,0)),Kt=0,ne=0,Mt.mode=ct;case ct:if(Mt.flags&1024){for(;ne<16;){if(ie===0)break t;ie--,Kt+=Yt[mt++]<<ne,ne+=8}Mt.length=Kt,Mt.head&&(Mt.head.extra_len=Kt),Mt.flags&512&&(Te[0]=Kt&255,Te[1]=Kt>>>8&255,Mt.check=D(Mt.check,Te,2,0)),Kt=0,ne=0}else Mt.head&&(Mt.head.extra=null);Mt.mode=At;case At:if(Mt.flags&1024&&(de=Mt.length,de>ie&&(de=ie),de&&(Mt.head&&(be=Mt.head.extra_len-Mt.length,Mt.head.extra||(Mt.head.extra=new Array(Mt.head.extra_len)),P.arraySet(Mt.head.extra,Yt,mt,de,be)),Mt.flags&512&&(Mt.check=D(Mt.check,Yt,de,mt)),ie-=de,mt+=de,Mt.length-=de),Mt.length))break t;Mt.length=0,Mt.mode=Et;case Et:if(Mt.flags&2048){if(ie===0)break t;de=0;do be=Yt[mt+de++],Mt.head&&be&&Mt.length<65536&&(Mt.head.name+=String.fromCharCode(be));while(be&&de<ie);if(Mt.flags&512&&(Mt.check=D(Mt.check,Yt,de,mt)),ie-=de,mt+=de,be)break t}else Mt.head&&(Mt.head.name=null);Mt.length=0,Mt.mode=gt;case gt:if(Mt.flags&4096){if(ie===0)break t;de=0;do be=Yt[mt+de++],Mt.head&&be&&Mt.length<65536&&(Mt.head.comment+=String.fromCharCode(be));while(be&&de<ie);if(Mt.flags&512&&(Mt.check=D(Mt.check,Yt,de,mt)),ie-=de,mt+=de,be)break t}else Mt.head&&(Mt.head.comment=null);Mt.mode=pt;case pt:if(Mt.flags&512){for(;ne<16;){if(ie===0)break t;ie--,Kt+=Yt[mt++]<<ne,ne+=8}if(Kt!==(Mt.check&65535)){te.msg="header crc mismatch",Mt.mode=Gt;break}Kt=0,ne=0}Mt.head&&(Mt.head.hcrc=Mt.flags>>9&1,Mt.head.done=!0),te.adler=Mt.check=0,Mt.mode=It;break;case vt:for(;ne<32;){if(ie===0)break t;ie--,Kt+=Yt[mt++]<<ne,ne+=8}te.adler=Mt.check=Vt(Kt),Kt=0,ne=0,Mt.mode=Tt;case Tt:if(Mt.havedict===0)return te.next_out=qt,te.avail_out=jt,te.next_in=mt,te.avail_in=ie,Mt.hold=Kt,Mt.bits=ne,et;te.adler=Mt.check=1,Mt.mode=It;case It:if(yt===V||yt===Q)break t;case $t:if(Mt.last){Kt>>>=ne&7,ne-=ne&7,Mt.mode=wt;break}for(;ne<3;){if(ie===0)break t;ie--,Kt+=Yt[mt++]<<ne,ne+=8}switch(Mt.last=Kt&1,Kt>>>=1,ne-=1,Kt&3){case 0:Mt.mode=Bt;break;case 1:if(Wt(Mt),Mt.mode=Ft,yt===Q){Kt>>>=2,ne-=2;break t}break;case 2:Mt.mode=Nt;break;case 3:te.msg="invalid block type",Mt.mode=Gt}Kt>>>=2,ne-=2;break;case Bt:for(Kt>>>=ne&7,ne-=ne&7;ne<32;){if(ie===0)break t;ie--,Kt+=Yt[mt++]<<ne,ne+=8}if((Kt&65535)!==(Kt>>>16^65535)){te.msg="invalid stored block lengths",Mt.mode=Gt;break}if(Mt.length=Kt&65535,Kt=0,ne=0,Mt.mode=zt,yt===Q)break t;case zt:Mt.mode=Ot;case Ot:if(de=Mt.length,de){if(de>ie&&(de=ie),de>jt&&(de=jt),de===0)break t;P.arraySet(Qt,Yt,mt,de,qt),ie-=de,mt+=de,jt-=de,qt+=de,Mt.length-=de;break}Mt.mode=It;break;case Nt:for(;ne<14;){if(ie===0)break t;ie--,Kt+=Yt[mt++]<<ne,ne+=8}if(Mt.nlen=(Kt&31)+257,Kt>>>=5,ne-=5,Mt.ndist=(Kt&31)+1,Kt>>>=5,ne-=5,Mt.ncode=(Kt&15)+4,Kt>>>=4,ne-=4,Mt.nlen>286||Mt.ndist>30){te.msg="too many length or distance symbols",Mt.mode=Gt;break}Mt.have=0,Mt.mode=Pt;case Pt:for(;Mt.have<Mt.ncode;){for(;ne<3;){if(ie===0)break t;ie--,Kt+=Yt[mt++]<<ne,ne+=8}Mt.lens[Me[Mt.have++]]=Kt&7,Kt>>>=3,ne-=3}for(;Mt.have<19;)Mt.lens[Me[Mt.have++]]=0;if(Mt.lencode=Mt.lendyn,Mt.lenbits=7,Re={bits:Mt.lenbits},Ie=Z($,Mt.lens,0,19,Mt.lencode,0,Mt.work,Re),Mt.lenbits=Re.bits,Ie){te.msg="invalid code lengths set",Mt.mode=Gt;break}Mt.have=0,Mt.mode=Ut;case Ut:for(;Mt.have<Mt.nlen+Mt.ndist;){for(;Ee=Mt.lencode[Kt&(1<<Mt.lenbits)-1],ye=Ee>>>24,_e=Ee>>>16&255,we=Ee&65535,!(ye<=ne);){if(ie===0)break t;ie--,Kt+=Yt[mt++]<<ne,ne+=8}if(we<16)Kt>>>=ye,ne-=ye,Mt.lens[Mt.have++]=we;else{if(we===16){for(ke=ye+2;ne<ke;){if(ie===0)break t;ie--,Kt+=Yt[mt++]<<ne,ne+=8}if(Kt>>>=ye,ne-=ye,Mt.have===0){te.msg="invalid bit length repeat",Mt.mode=Gt;break}be=Mt.lens[Mt.have-1],de=3+(Kt&3),Kt>>>=2,ne-=2}else if(we===17){for(ke=ye+3;ne<ke;){if(ie===0)break t;ie--,Kt+=Yt[mt++]<<ne,ne+=8}Kt>>>=ye,ne-=ye,be=0,de=3+(Kt&7),Kt>>>=3,ne-=3}else{for(ke=ye+7;ne<ke;){if(ie===0)break t;ie--,Kt+=Yt[mt++]<<ne,ne+=8}Kt>>>=ye,ne-=ye,be=0,de=11+(Kt&127),Kt>>>=7,ne-=7}if(Mt.have+de>Mt.nlen+Mt.ndist){te.msg="invalid bit length repeat",Mt.mode=Gt;break}for(;de--;)Mt.lens[Mt.have++]=be}}if(Mt.mode===Gt)break;if(Mt.lens[256]===0){te.msg="invalid code -- missing end-of-block",Mt.mode=Gt;break}if(Mt.lenbits=9,Re={bits:Mt.lenbits},Ie=Z(j,Mt.lens,0,Mt.nlen,Mt.lencode,0,Mt.work,Re),Mt.lenbits=Re.bits,Ie){te.msg="invalid literal/lengths set",Mt.mode=Gt;break}if(Mt.distbits=6,Mt.distcode=Mt.distdyn,Re={bits:Mt.distbits},Ie=Z(H,Mt.lens,Mt.nlen,Mt.ndist,Mt.distcode,0,Mt.work,Re),Mt.distbits=Re.bits,Ie){te.msg="invalid distances set",Mt.mode=Gt;break}if(Mt.mode=Ft,yt===Q)break t;case Ft:Mt.mode=Zt;case Zt:if(ie>=6&&jt>=258){te.next_out=qt,te.avail_out=jt,te.next_in=mt,te.avail_in=ie,Mt.hold=Kt,Mt.bits=ne,U(te,ce),qt=te.next_out,Qt=te.output,jt=te.avail_out,mt=te.next_in,Yt=te.input,ie=te.avail_in,Kt=Mt.hold,ne=Mt.bits,Mt.mode===It&&(Mt.back=-1);break}for(Mt.back=0;Ee=Mt.lencode[Kt&(1<<Mt.lenbits)-1],ye=Ee>>>24,_e=Ee>>>16&255,we=Ee&65535,!(ye<=ne);){if(ie===0)break t;ie--,Kt+=Yt[mt++]<<ne,ne+=8}if(_e&&!(_e&240)){for(xe=ye,Se=_e,Ae=we;Ee=Mt.lencode[Ae+((Kt&(1<<xe+Se)-1)>>xe)],ye=Ee>>>24,_e=Ee>>>16&255,we=Ee&65535,!(xe+ye<=ne);){if(ie===0)break t;ie--,Kt+=Yt[mt++]<<ne,ne+=8}Kt>>>=xe,ne-=xe,Mt.back+=xe}if(Kt>>>=ye,ne-=ye,Mt.back+=ye,Mt.length=we,_e===0){Mt.mode=bt;break}if(_e&32){Mt.back=-1,Mt.mode=It;break}if(_e&64){te.msg="invalid literal/length code",Mt.mode=Gt;break}Mt.extra=_e&15,Mt.mode=Ht;case Ht:if(Mt.extra){for(ke=Mt.extra;ne<ke;){if(ie===0)break t;ie--,Kt+=Yt[mt++]<<ne,ne+=8}Mt.length+=Kt&(1<<Mt.extra)-1,Kt>>>=Mt.extra,ne-=Mt.extra,Mt.back+=Mt.extra}Mt.was=Mt.length,Mt.mode=Dt;case Dt:for(;Ee=Mt.distcode[Kt&(1<<Mt.distbits)-1],ye=Ee>>>24,_e=Ee>>>16&255,we=Ee&65535,!(ye<=ne);){if(ie===0)break t;ie--,Kt+=Yt[mt++]<<ne,ne+=8}if(!(_e&240)){for(xe=ye,Se=_e,Ae=we;Ee=Mt.distcode[Ae+((Kt&(1<<xe+Se)-1)>>xe)],ye=Ee>>>24,_e=Ee>>>16&255,we=Ee&65535,!(xe+ye<=ne);){if(ie===0)break t;ie--,Kt+=Yt[mt++]<<ne,ne+=8}Kt>>>=xe,ne-=xe,Mt.back+=xe}if(Kt>>>=ye,ne-=ye,Mt.back+=ye,_e&64){te.msg="invalid distance code",Mt.mode=Gt;break}Mt.offset=we,Mt.extra=_e&15,Mt.mode=dt;case dt:if(Mt.extra){for(ke=Mt.extra;ne<ke;){if(ie===0)break t;ie--,Kt+=Yt[mt++]<<ne,ne+=8}Mt.offset+=Kt&(1<<Mt.extra)-1,Kt>>>=Mt.extra,ne-=Mt.extra,Mt.back+=Mt.extra}if(Mt.offset>Mt.dmax){te.msg="invalid distance too far back",Mt.mode=Gt;break}Mt.mode=Lt;case Lt:if(jt===0)break t;if(de=ce-jt,Mt.offset>de){if(de=Mt.offset-de,de>Mt.whave&&Mt.sane){te.msg="invalid distance too far back",Mt.mode=Gt;break}de>Mt.wnext?(de-=Mt.wnext,ge=Mt.wsize-de):ge=Mt.wnext-de,de>Mt.length&&(de=Mt.length),ve=Mt.window}else ve=Qt,ge=qt-Mt.offset,de=Mt.length;de>jt&&(de=jt),jt-=de,Mt.length-=de;do Qt[qt++]=ve[ge++];while(--de);Mt.length===0&&(Mt.mode=Zt);break;case bt:if(jt===0)break t;Qt[qt++]=Mt.length,jt--,Mt.mode=Zt;break;case wt:if(Mt.wrap){for(;ne<32;){if(ie===0)break t;ie--,Kt|=Yt[mt++]<<ne,ne+=8}if(ce-=jt,te.total_out+=ce,Mt.total+=ce,ce&&(te.adler=Mt.check=Mt.flags?D(Mt.check,Qt,ce,qt-ce):F(Mt.check,Qt,ce,qt-ce)),ce=jt,(Mt.flags?Kt:Vt(Kt))!==Mt.check){te.msg="incorrect data check",Mt.mode=Gt;break}Kt=0,ne=0}Mt.mode=xt;case xt:if(Mt.wrap&&Mt.flags){for(;ne<32;){if(ie===0)break t;ie--,Kt+=Yt[mt++]<<ne,ne+=8}if(Kt!==(Mt.total&4294967295)){te.msg="incorrect length check",Mt.mode=Gt;break}Kt=0,ne=0}Mt.mode=Rt;case Rt:Ie=q;break t;case Gt:Ie=tt;break t;case nt:return rt;case ht:default:return X}return te.next_out=qt,te.avail_out=jt,te.next_in=mt,te.avail_in=ie,Mt.hold=Kt,Mt.bits=ne,(Mt.wsize||ce!==te.avail_out&&Mt.mode<Gt&&(Mt.mode<wt||yt!==W))&&oe(te,te.output,te.next_out,ce-te.avail_out),pe-=te.avail_in,ce-=te.avail_out,te.total_in+=pe,te.total_out+=ce,Mt.total+=ce,Mt.wrap&&ce&&(te.adler=Mt.check=Mt.flags?D(Mt.check,Qt,ce,te.next_out-ce):F(Mt.check,Qt,ce,te.next_out-ce)),te.data_type=Mt.bits+(Mt.last?64:0)+(Mt.mode===It?128:0)+(Mt.mode===Ft||Mt.mode===zt?256:0),(pe===0&&ce===0||yt===W)&&Ie===K&&(Ie=ot),Ie}function Xt(te){if(!te||!te.state)return X;var yt=te.state;return yt.window&&(yt.window=null),te.state=null,K}function Ct(te,yt){var Mt;return!te||!te.state||(Mt=te.state,!(Mt.wrap&2))?X:(Mt.head=yt,yt.done=!1,K)}function re(te,yt){var Mt=yt.length,Yt,Qt,mt;return!te||!te.state||(Yt=te.state,Yt.wrap!==0&&Yt.mode!==Tt)?X:Yt.mode===Tt&&(Qt=1,Qt=F(Qt,yt,Mt,0),Qt!==Yt.check)?tt:(mt=oe(te,yt,Mt,Mt),mt?(Yt.mode=nt,rt):(Yt.havedict=1,K))}I.inflateReset=se,I.inflateReset2=ae,I.inflateResetKeep=Jt,I.inflateInit=le,I.inflateInit2=fe,I.inflate=kt,I.inflateEnd=Xt,I.inflateGetHeader=Ct,I.inflateSetDictionary=re,I.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":52,"./adler32":53,"./crc32":55,"./inffast":57,"./inftrees":59}],59:[function(g,w,I){var P=g("../utils/common"),F=15,D=852,U=592,Z=0,$=1,j=2,H=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],W=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],V=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],Q=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];w.exports=function(q,et,X,tt,rt,ot,J,lt){var st=lt.bits,ut=0,it=0,ct=0,At=0,Et=0,gt=0,pt=0,vt=0,Tt=0,It=0,$t,Bt,zt,Ot,Nt,Pt=null,Ut=0,Ft,Zt=new P.Buf16(F+1),Ht=new P.Buf16(F+1),Dt=null,dt=0,Lt,bt,wt;for(ut=0;ut<=F;ut++)Zt[ut]=0;for(it=0;it<tt;it++)Zt[et[X+it]]++;for(Et=st,At=F;At>=1&&Zt[At]===0;At--);if(Et>At&&(Et=At),At===0)return rt[ot++]=1<<24|64<<16|0,rt[ot++]=1<<24|64<<16|0,lt.bits=1,0;for(ct=1;ct<At&&Zt[ct]===0;ct++);for(Et<ct&&(Et=ct),vt=1,ut=1;ut<=F;ut++)if(vt<<=1,vt-=Zt[ut],vt<0)return-1;if(vt>0&&(q===Z||At!==1))return-1;for(Ht[1]=0,ut=1;ut<F;ut++)Ht[ut+1]=Ht[ut]+Zt[ut];for(it=0;it<tt;it++)et[X+it]!==0&&(J[Ht[et[X+it]]++]=it);if(q===Z?(Pt=Dt=J,Ft=19):q===$?(Pt=H,Ut-=257,Dt=W,dt-=257,Ft=256):(Pt=V,Dt=Q,Ft=-1),It=0,it=0,ut=ct,Nt=ot,gt=Et,pt=0,zt=-1,Tt=1<<Et,Ot=Tt-1,q===$&&Tt>D||q===j&&Tt>U)return 1;for(;;){Lt=ut-pt,J[it]<Ft?(bt=0,wt=J[it]):J[it]>Ft?(bt=Dt[dt+J[it]],wt=Pt[Ut+J[it]]):(bt=96,wt=0),$t=1<<ut-pt,Bt=1<<gt,ct=Bt;do Bt-=$t,rt[Nt+(It>>pt)+Bt]=Lt<<24|bt<<16|wt|0;while(Bt!==0);for($t=1<<ut-1;It&$t;)$t>>=1;if($t!==0?(It&=$t-1,It+=$t):It=0,it++,--Zt[ut]===0){if(ut===At)break;ut=et[X+J[it]]}if(ut>Et&&(It&Ot)!==zt){for(pt===0&&(pt=Et),Nt+=ct,gt=ut-pt,vt=1<<gt;gt+pt<At&&(vt-=Zt[gt+pt],!(vt<=0));)gt++,vt<<=1;if(Tt+=1<<gt,q===$&&Tt>D||q===j&&Tt>U)return 1;zt=It&Ot,rt[zt]=Et<<24|gt<<16|Nt-ot|0}}return It!==0&&(rt[Nt+It]=ut-pt<<24|64<<16|0),lt.bits=Et,0}},{"../utils/common":52}],60:[function(g,w,I){w.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],61:[function(g,w,I){var P=g("../utils/common"),F=4,D=0,U=1,Z=2;function $(kt){for(var Xt=kt.length;--Xt>=0;)kt[Xt]=0}var j=0,H=1,W=2,V=3,Q=258,K=29,q=256,et=q+1+K,X=30,tt=19,rt=2*et+1,ot=15,J=16,lt=7,st=256,ut=16,it=17,ct=18,At=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],Et=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],gt=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],pt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],vt=512,Tt=new Array((et+2)*2);$(Tt);var It=new Array(X*2);$(It);var $t=new Array(vt);$($t);var Bt=new Array(Q-V+1);$(Bt);var zt=new Array(K);$(zt);var Ot=new Array(X);$(Ot);function Nt(kt,Xt,Ct,re,te){this.static_tree=kt,this.extra_bits=Xt,this.extra_base=Ct,this.elems=re,this.max_length=te,this.has_stree=kt&&kt.length}var Pt,Ut,Ft;function Zt(kt,Xt){this.dyn_tree=kt,this.max_code=0,this.stat_desc=Xt}function Ht(kt){return kt<256?$t[kt]:$t[256+(kt>>>7)]}function Dt(kt,Xt){kt.pending_buf[kt.pending++]=Xt&255,kt.pending_buf[kt.pending++]=Xt>>>8&255}function dt(kt,Xt,Ct){kt.bi_valid>J-Ct?(kt.bi_buf|=Xt<<kt.bi_valid&65535,Dt(kt,kt.bi_buf),kt.bi_buf=Xt>>J-kt.bi_valid,kt.bi_valid+=Ct-J):(kt.bi_buf|=Xt<<kt.bi_valid&65535,kt.bi_valid+=Ct)}function Lt(kt,Xt,Ct){dt(kt,Ct[Xt*2],Ct[Xt*2+1])}function bt(kt,Xt){var Ct=0;do Ct|=kt&1,kt>>>=1,Ct<<=1;while(--Xt>0);return Ct>>>1}function wt(kt){kt.bi_valid===16?(Dt(kt,kt.bi_buf),kt.bi_buf=0,kt.bi_valid=0):kt.bi_valid>=8&&(kt.pending_buf[kt.pending++]=kt.bi_buf&255,kt.bi_buf>>=8,kt.bi_valid-=8)}function xt(kt,Xt){var Ct=Xt.dyn_tree,re=Xt.max_code,te=Xt.stat_desc.static_tree,yt=Xt.stat_desc.has_stree,Mt=Xt.stat_desc.extra_bits,Yt=Xt.stat_desc.extra_base,Qt=Xt.stat_desc.max_length,mt,qt,ie,jt,Kt,ne,pe=0;for(jt=0;jt<=ot;jt++)kt.bl_count[jt]=0;for(Ct[kt.heap[kt.heap_max]*2+1]=0,mt=kt.heap_max+1;mt<rt;mt++)qt=kt.heap[mt],jt=Ct[Ct[qt*2+1]*2+1]+1,jt>Qt&&(jt=Qt,pe++),Ct[qt*2+1]=jt,!(qt>re)&&(kt.bl_count[jt]++,Kt=0,qt>=Yt&&(Kt=Mt[qt-Yt]),ne=Ct[qt*2],kt.opt_len+=ne*(jt+Kt),yt&&(kt.static_len+=ne*(te[qt*2+1]+Kt)));if(pe!==0){do{for(jt=Qt-1;kt.bl_count[jt]===0;)jt--;kt.bl_count[jt]--,kt.bl_count[jt+1]+=2,kt.bl_count[Qt]--,pe-=2}while(pe>0);for(jt=Qt;jt!==0;jt--)for(qt=kt.bl_count[jt];qt!==0;)ie=kt.heap[--mt],!(ie>re)&&(Ct[ie*2+1]!==jt&&(kt.opt_len+=(jt-Ct[ie*2+1])*Ct[ie*2],Ct[ie*2+1]=jt),qt--)}}function Rt(kt,Xt,Ct){var re=new Array(ot+1),te=0,yt,Mt;for(yt=1;yt<=ot;yt++)re[yt]=te=te+Ct[yt-1]<<1;for(Mt=0;Mt<=Xt;Mt++){var Yt=kt[Mt*2+1];Yt!==0&&(kt[Mt*2]=bt(re[Yt]++,Yt))}}function Gt(){var kt,Xt,Ct,re,te,yt=new Array(ot+1);for(Ct=0,re=0;re<K-1;re++)for(zt[re]=Ct,kt=0;kt<1<<At[re];kt++)Bt[Ct++]=re;for(Bt[Ct-1]=re,te=0,re=0;re<16;re++)for(Ot[re]=te,kt=0;kt<1<<Et[re];kt++)$t[te++]=re;for(te>>=7;re<X;re++)for(Ot[re]=te<<7,kt=0;kt<1<<Et[re]-7;kt++)$t[256+te++]=re;for(Xt=0;Xt<=ot;Xt++)yt[Xt]=0;for(kt=0;kt<=143;)Tt[kt*2+1]=8,kt++,yt[8]++;for(;kt<=255;)Tt[kt*2+1]=9,kt++,yt[9]++;for(;kt<=279;)Tt[kt*2+1]=7,kt++,yt[7]++;for(;kt<=287;)Tt[kt*2+1]=8,kt++,yt[8]++;for(Rt(Tt,et+1,yt),kt=0;kt<X;kt++)It[kt*2+1]=5,It[kt*2]=bt(kt,5);Pt=new Nt(Tt,At,q+1,et,ot),Ut=new Nt(It,Et,0,X,ot),Ft=new Nt(new Array(0),gt,0,tt,lt)}function nt(kt){var Xt;for(Xt=0;Xt<et;Xt++)kt.dyn_ltree[Xt*2]=0;for(Xt=0;Xt<X;Xt++)kt.dyn_dtree[Xt*2]=0;for(Xt=0;Xt<tt;Xt++)kt.bl_tree[Xt*2]=0;kt.dyn_ltree[st*2]=1,kt.opt_len=kt.static_len=0,kt.last_lit=kt.matches=0}function ht(kt){kt.bi_valid>8?Dt(kt,kt.bi_buf):kt.bi_valid>0&&(kt.pending_buf[kt.pending++]=kt.bi_buf),kt.bi_buf=0,kt.bi_valid=0}function ft(kt,Xt,Ct,re){ht(kt),Dt(kt,Ct),Dt(kt,~Ct),P.arraySet(kt.pending_buf,kt.window,Xt,Ct,kt.pending),kt.pending+=Ct}function at(kt,Xt,Ct,re){var te=Xt*2,yt=Ct*2;return kt[te]<kt[yt]||kt[te]===kt[yt]&&re[Xt]<=re[Ct]}function _t(kt,Xt,Ct){for(var re=kt.heap[Ct],te=Ct<<1;te<=kt.heap_len&&(te<kt.heap_len&&at(Xt,kt.heap[te+1],kt.heap[te],kt.depth)&&te++,!at(Xt,re,kt.heap[te],kt.depth));)kt.heap[Ct]=kt.heap[te],Ct=te,te<<=1;kt.heap[Ct]=re}function St(kt,Xt,Ct){var re,te,yt=0,Mt,Yt;if(kt.last_lit!==0)do re=kt.pending_buf[kt.d_buf+yt*2]<<8|kt.pending_buf[kt.d_buf+yt*2+1],te=kt.pending_buf[kt.l_buf+yt],yt++,re===0?Lt(kt,te,Xt):(Mt=Bt[te],Lt(kt,Mt+q+1,Xt),Yt=At[Mt],Yt!==0&&(te-=zt[Mt],dt(kt,te,Yt)),re--,Mt=Ht(re),Lt(kt,Mt,Ct),Yt=Et[Mt],Yt!==0&&(re-=Ot[Mt],dt(kt,re,Yt)));while(yt<kt.last_lit);Lt(kt,st,Xt)}function Vt(kt,Xt){var Ct=Xt.dyn_tree,re=Xt.stat_desc.static_tree,te=Xt.stat_desc.has_stree,yt=Xt.stat_desc.elems,Mt,Yt,Qt=-1,mt;for(kt.heap_len=0,kt.heap_max=rt,Mt=0;Mt<yt;Mt++)Ct[Mt*2]!==0?(kt.heap[++kt.heap_len]=Qt=Mt,kt.depth[Mt]=0):Ct[Mt*2+1]=0;for(;kt.heap_len<2;)mt=kt.heap[++kt.heap_len]=Qt<2?++Qt:0,Ct[mt*2]=1,kt.depth[mt]=0,kt.opt_len--,te&&(kt.static_len-=re[mt*2+1]);for(Xt.max_code=Qt,Mt=kt.heap_len>>1;Mt>=1;Mt--)_t(kt,Ct,Mt);mt=yt;do Mt=kt.heap[1],kt.heap[1]=kt.heap[kt.heap_len--],_t(kt,Ct,1),Yt=kt.heap[1],kt.heap[--kt.heap_max]=Mt,kt.heap[--kt.heap_max]=Yt,Ct[mt*2]=Ct[Mt*2]+Ct[Yt*2],kt.depth[mt]=(kt.depth[Mt]>=kt.depth[Yt]?kt.depth[Mt]:kt.depth[Yt])+1,Ct[Mt*2+1]=Ct[Yt*2+1]=mt,kt.heap[1]=mt++,_t(kt,Ct,1);while(kt.heap_len>=2);kt.heap[--kt.heap_max]=kt.heap[1],xt(kt,Xt),Rt(Ct,Qt,kt.bl_count)}function ee(kt,Xt,Ct){var re,te=-1,yt,Mt=Xt[0*2+1],Yt=0,Qt=7,mt=4;for(Mt===0&&(Qt=138,mt=3),Xt[(Ct+1)*2+1]=65535,re=0;re<=Ct;re++)yt=Mt,Mt=Xt[(re+1)*2+1],!(++Yt<Qt&&yt===Mt)&&(Yt<mt?kt.bl_tree[yt*2]+=Yt:yt!==0?(yt!==te&&kt.bl_tree[yt*2]++,kt.bl_tree[ut*2]++):Yt<=10?kt.bl_tree[it*2]++:kt.bl_tree[ct*2]++,Yt=0,te=yt,Mt===0?(Qt=138,mt=3):yt===Mt?(Qt=6,mt=3):(Qt=7,mt=4))}function Jt(kt,Xt,Ct){var re,te=-1,yt,Mt=Xt[0*2+1],Yt=0,Qt=7,mt=4;for(Mt===0&&(Qt=138,mt=3),re=0;re<=Ct;re++)if(yt=Mt,Mt=Xt[(re+1)*2+1],!(++Yt<Qt&&yt===Mt)){if(Yt<mt)do Lt(kt,yt,kt.bl_tree);while(--Yt!==0);else yt!==0?(yt!==te&&(Lt(kt,yt,kt.bl_tree),Yt--),Lt(kt,ut,kt.bl_tree),dt(kt,Yt-3,2)):Yt<=10?(Lt(kt,it,kt.bl_tree),dt(kt,Yt-3,3)):(Lt(kt,ct,kt.bl_tree),dt(kt,Yt-11,7));Yt=0,te=yt,Mt===0?(Qt=138,mt=3):yt===Mt?(Qt=6,mt=3):(Qt=7,mt=4)}}function se(kt){var Xt;for(ee(kt,kt.dyn_ltree,kt.l_desc.max_code),ee(kt,kt.dyn_dtree,kt.d_desc.max_code),Vt(kt,kt.bl_desc),Xt=tt-1;Xt>=3&&kt.bl_tree[pt[Xt]*2+1]===0;Xt--);return kt.opt_len+=3*(Xt+1)+5+5+4,Xt}function ae(kt,Xt,Ct,re){var te;for(dt(kt,Xt-257,5),dt(kt,Ct-1,5),dt(kt,re-4,4),te=0;te<re;te++)dt(kt,kt.bl_tree[pt[te]*2+1],3);Jt(kt,kt.dyn_ltree,Xt-1),Jt(kt,kt.dyn_dtree,Ct-1)}function fe(kt){var Xt=4093624447,Ct;for(Ct=0;Ct<=31;Ct++,Xt>>>=1)if(Xt&1&&kt.dyn_ltree[Ct*2]!==0)return D;if(kt.dyn_ltree[9*2]!==0||kt.dyn_ltree[10*2]!==0||kt.dyn_ltree[13*2]!==0)return U;for(Ct=32;Ct<q;Ct++)if(kt.dyn_ltree[Ct*2]!==0)return U;return D}var le=!1;function ue(kt){le||(Gt(),le=!0),kt.l_desc=new Zt(kt.dyn_ltree,Pt),kt.d_desc=new Zt(kt.dyn_dtree,Ut),kt.bl_desc=new Zt(kt.bl_tree,Ft),kt.bi_buf=0,kt.bi_valid=0,nt(kt)}function me(kt,Xt,Ct,re){dt(kt,(j<<1)+(re?1:0),3),ft(kt,Xt,Ct)}function he(kt){dt(kt,H<<1,3),Lt(kt,st,Tt),wt(kt)}function Wt(kt,Xt,Ct,re){var te,yt,Mt=0;kt.level>0?(kt.strm.data_type===Z&&(kt.strm.data_type=fe(kt)),Vt(kt,kt.l_desc),Vt(kt,kt.d_desc),Mt=se(kt),te=kt.opt_len+3+7>>>3,yt=kt.static_len+3+7>>>3,yt<=te&&(te=yt)):te=yt=Ct+5,Ct+4<=te&&Xt!==-1?me(kt,Xt,Ct,re):kt.strategy===F||yt===te?(dt(kt,(H<<1)+(re?1:0),3),St(kt,Tt,It)):(dt(kt,(W<<1)+(re?1:0),3),ae(kt,kt.l_desc.max_code+1,kt.d_desc.max_code+1,Mt+1),St(kt,kt.dyn_ltree,kt.dyn_dtree)),nt(kt),re&&ht(kt)}function oe(kt,Xt,Ct){return kt.pending_buf[kt.d_buf+kt.last_lit*2]=Xt>>>8&255,kt.pending_buf[kt.d_buf+kt.last_lit*2+1]=Xt&255,kt.pending_buf[kt.l_buf+kt.last_lit]=Ct&255,kt.last_lit++,Xt===0?kt.dyn_ltree[Ct*2]++:(kt.matches++,Xt--,kt.dyn_ltree[(Bt[Ct]+q+1)*2]++,kt.dyn_dtree[Ht(Xt)*2]++),kt.last_lit===kt.lit_bufsize-1}I._tr_init=ue,I._tr_stored_block=me,I._tr_flush_block=Wt,I._tr_tally=oe,I._tr_align=he},{"../utils/common":52}],62:[function(g,w,I){function P(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}w.exports=P},{}],63:[function(g,w,I){var P=w.exports={},F,D;function U(){throw new Error("setTimeout has not been defined")}function Z(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?F=setTimeout:F=U}catch{F=U}try{typeof clearTimeout=="function"?D=clearTimeout:D=Z}catch{D=Z}})();function $(tt){if(F===setTimeout)return setTimeout(tt,0);if((F===U||!F)&&setTimeout)return F=setTimeout,setTimeout(tt,0);try{return F(tt,0)}catch{try{return F.call(null,tt,0)}catch{return F.call(this,tt,0)}}}function j(tt){if(D===clearTimeout)return clearTimeout(tt);if((D===Z||!D)&&clearTimeout)return D=clearTimeout,clearTimeout(tt);try{return D(tt)}catch{try{return D.call(null,tt)}catch{return D.call(this,tt)}}}var H=[],W=!1,V,Q=-1;function K(){!W||!V||(W=!1,V.length?H=V.concat(H):Q=-1,H.length&&q())}function q(){if(!W){var tt=$(K);W=!0;for(var rt=H.length;rt;){for(V=H,H=[];++Q<rt;)V&&V[Q].run();Q=-1,rt=H.length}V=null,W=!1,j(tt)}}P.nextTick=function(tt){var rt=new Array(arguments.length-1);if(arguments.length>1)for(var ot=1;ot<arguments.length;ot++)rt[ot-1]=arguments[ot];H.push(new et(tt,rt)),H.length===1&&!W&&$(q)};function et(tt,rt){this.fun=tt,this.array=rt}et.prototype.run=function(){this.fun.apply(null,this.array)},P.title="browser",P.browser=!0,P.env={},P.argv=[],P.version="",P.versions={};function X(){}P.on=X,P.addListener=X,P.once=X,P.off=X,P.removeListener=X,P.removeAllListeners=X,P.emit=X,P.prependListener=X,P.prependOnceListener=X,P.listeners=function(tt){return[]},P.binding=function(tt){throw new Error("process.binding is not supported")},P.cwd=function(){return"/"},P.chdir=function(tt){throw new Error("process.chdir is not supported")},P.umask=function(){return 0}},{}],64:[function(g,w,I){/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var P=g("buffer"),F=P.Buffer;function D(Z,$){for(var j in Z)$[j]=Z[j]}F.from&&F.alloc&&F.allocUnsafe&&F.allocUnsafeSlow?w.exports=P:(D(P,I),I.Buffer=U);function U(Z,$,j){return F(Z,$,j)}U.prototype=Object.create(F.prototype),D(F,U),U.from=function(Z,$,j){if(typeof Z=="number")throw new TypeError("Argument must not be a number");return F(Z,$,j)},U.alloc=function(Z,$,j){if(typeof Z!="number")throw new TypeError("Argument must be a number");var H=F(Z);return $!==void 0?typeof j=="string"?H.fill($,j):H.fill($):H.fill(0),H},U.allocUnsafe=function(Z){if(typeof Z!="number")throw new TypeError("Argument must be a number");return F(Z)},U.allocUnsafeSlow=function(Z){if(typeof Z!="number")throw new TypeError("Argument must be a number");return P.SlowBuffer(Z)}},{buffer:32}],65:[function(g,w,I){w.exports=D;var P=g("events").EventEmitter,F=g("inherits");F(D,P),D.Readable=g("readable-stream/lib/_stream_readable.js"),D.Writable=g("readable-stream/lib/_stream_writable.js"),D.Duplex=g("readable-stream/lib/_stream_duplex.js"),D.Transform=g("readable-stream/lib/_stream_transform.js"),D.PassThrough=g("readable-stream/lib/_stream_passthrough.js"),D.finished=g("readable-stream/lib/internal/streams/end-of-stream.js"),D.pipeline=g("readable-stream/lib/internal/streams/pipeline.js"),D.Stream=D;function D(){P.call(this)}D.prototype.pipe=function(U,Z){var $=this;function j(et){U.writable&&U.write(et)===!1&&$.pause&&$.pause()}$.on("data",j);function H(){$.readable&&$.resume&&$.resume()}U.on("drain",H),!U._isStdio&&(!Z||Z.end!==!1)&&($.on("end",V),$.on("close",Q));var W=!1;function V(){W||(W=!0,U.end())}function Q(){W||(W=!0,typeof U.destroy=="function"&&U.destroy())}function K(et){if(q(),P.listenerCount(this,"error")===0)throw et}$.on("error",K),U.on("error",K);function q(){$.removeListener("data",j),U.removeListener("drain",H),$.removeListener("end",V),$.removeListener("close",Q),$.removeListener("error",K),U.removeListener("error",K),$.removeListener("end",q),$.removeListener("close",q),U.removeListener("close",q)}return $.on("end",q),$.on("close",q),U.on("close",q),U.emit("pipe",$),U}},{events:35,inherits:46,"readable-stream/lib/_stream_duplex.js":67,"readable-stream/lib/_stream_passthrough.js":68,"readable-stream/lib/_stream_readable.js":69,"readable-stream/lib/_stream_transform.js":70,"readable-stream/lib/_stream_writable.js":71,"readable-stream/lib/internal/streams/end-of-stream.js":75,"readable-stream/lib/internal/streams/pipeline.js":77}],66:[function(g,w,I){function P(H,W){H.prototype=Object.create(W.prototype),H.prototype.constructor=H,H.__proto__=W}var F={};function D(H,W,V){V||(V=Error);function Q(q,et,X){return typeof W=="string"?W:W(q,et,X)}var K=function(q){P(et,q);function et(X,tt,rt){return q.call(this,Q(X,tt,rt))||this}return et}(V);K.prototype.name=V.name,K.prototype.code=H,F[H]=K}function U(H,W){if(Array.isArray(H)){var V=H.length;return H=H.map(function(Q){return String(Q)}),V>2?"one of ".concat(W," ").concat(H.slice(0,V-1).join(", "),", or ")+H[V-1]:V===2?"one of ".concat(W," ").concat(H[0]," or ").concat(H[1]):"of ".concat(W," ").concat(H[0])}else return"of ".concat(W," ").concat(String(H))}function Z(H,W,V){return H.substr(0,W.length)===W}function $(H,W,V){return(V===void 0||V>H.length)&&(V=H.length),H.substring(V-W.length,V)===W}function j(H,W,V){return typeof V!="number"&&(V=0),V+W.length>H.length?!1:H.indexOf(W,V)!==-1}D("ERR_INVALID_OPT_VALUE",function(H,W){return'The value "'+W+'" is invalid for option "'+H+'"'},TypeError),D("ERR_INVALID_ARG_TYPE",function(H,W,V){var Q;typeof W=="string"&&Z(W,"not ")?(Q="must not be",W=W.replace(/^not /,"")):Q="must be";var K;if($(H," argument"))K="The ".concat(H," ").concat(Q," ").concat(U(W,"type"));else{var q=j(H,".")?"property":"argument";K='The "'.concat(H,'" ').concat(q," ").concat(Q," ").concat(U(W,"type"))}return K+=". Received type ".concat(typeof V),K},TypeError),D("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),D("ERR_METHOD_NOT_IMPLEMENTED",function(H){return"The "+H+" method is not implemented"}),D("ERR_STREAM_PREMATURE_CLOSE","Premature close"),D("ERR_STREAM_DESTROYED",function(H){return"Cannot call "+H+" after a stream was destroyed"}),D("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),D("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),D("ERR_STREAM_WRITE_AFTER_END","write after end"),D("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),D("ERR_UNKNOWN_ENCODING",function(H){return"Unknown encoding: "+H},TypeError),D("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),w.exports.codes=F},{}],67:[function(g,w,I){(function(P){(function(){var F=Object.keys||function(Q){var K=[];for(var q in Q)K.push(q);return K};w.exports=H;var D=g("./_stream_readable"),U=g("./_stream_writable");g("inherits")(H,D);for(var Z=F(U.prototype),$=0;$<Z.length;$++){var j=Z[$];H.prototype[j]||(H.prototype[j]=U.prototype[j])}function H(Q){if(!(this instanceof H))return new H(Q);D.call(this,Q),U.call(this,Q),this.allowHalfOpen=!0,Q&&(Q.readable===!1&&(this.readable=!1),Q.writable===!1&&(this.writable=!1),Q.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",W)))}Object.defineProperty(H.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(H.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(H.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function W(){this._writableState.ended||P.nextTick(V,this)}function V(Q){Q.end()}Object.defineProperty(H.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(K){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=K,this._writableState.destroyed=K)}})}).call(this)}).call(this,g("_process"))},{"./_stream_readable":69,"./_stream_writable":71,_process:63,inherits:46}],68:[function(g,w,I){w.exports=F;var P=g("./_stream_transform");g("inherits")(F,P);function F(D){if(!(this instanceof F))return new F(D);P.call(this,D)}F.prototype._transform=function(D,U,Z){Z(null,D)}},{"./_stream_transform":70,inherits:46}],69:[function(g,w,I){(function(P,F){(function(){w.exports=pt;var D;pt.ReadableState=gt,g("events").EventEmitter;var U=function(ht,ft){return ht.listeners(ft).length},Z=g("./internal/streams/stream"),$=g("buffer").Buffer,j=F.Uint8Array||function(){};function H(nt){return $.from(nt)}function W(nt){return $.isBuffer(nt)||nt instanceof j}var V=g("util"),Q;V&&V.debuglog?Q=V.debuglog("stream"):Q=function(){};var K=g("./internal/streams/buffer_list"),q=g("./internal/streams/destroy"),et=g("./internal/streams/state"),X=et.getHighWaterMark,tt=g("../errors").codes,rt=tt.ERR_INVALID_ARG_TYPE,ot=tt.ERR_STREAM_PUSH_AFTER_EOF,J=tt.ERR_METHOD_NOT_IMPLEMENTED,lt=tt.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,st,ut,it;g("inherits")(pt,Z);var ct=q.errorOrDestroy,At=["error","close","destroy","pause","resume"];function Et(nt,ht,ft){if(typeof nt.prependListener=="function")return nt.prependListener(ht,ft);!nt._events||!nt._events[ht]?nt.on(ht,ft):Array.isArray(nt._events[ht])?nt._events[ht].unshift(ft):nt._events[ht]=[ft,nt._events[ht]]}function gt(nt,ht,ft){D=D||g("./_stream_duplex"),nt=nt||{},typeof ft!="boolean"&&(ft=ht instanceof D),this.objectMode=!!nt.objectMode,ft&&(this.objectMode=this.objectMode||!!nt.readableObjectMode),this.highWaterMark=X(this,nt,"readableHighWaterMark",ft),this.buffer=new K,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=nt.emitClose!==!1,this.autoDestroy=!!nt.autoDestroy,this.destroyed=!1,this.defaultEncoding=nt.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,nt.encoding&&(st||(st=g("string_decoder/").StringDecoder),this.decoder=new st(nt.encoding),this.encoding=nt.encoding)}function pt(nt){if(D=D||g("./_stream_duplex"),!(this instanceof pt))return new pt(nt);var ht=this instanceof D;this._readableState=new gt(nt,this,ht),this.readable=!0,nt&&(typeof nt.read=="function"&&(this._read=nt.read),typeof nt.destroy=="function"&&(this._destroy=nt.destroy)),Z.call(this)}Object.defineProperty(pt.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(ht){this._readableState&&(this._readableState.destroyed=ht)}}),pt.prototype.destroy=q.destroy,pt.prototype._undestroy=q.undestroy,pt.prototype._destroy=function(nt,ht){ht(nt)},pt.prototype.push=function(nt,ht){var ft=this._readableState,at;return ft.objectMode?at=!0:typeof nt=="string"&&(ht=ht||ft.defaultEncoding,ht!==ft.encoding&&(nt=$.from(nt,ht),ht=""),at=!0),vt(this,nt,ht,!1,at)},pt.prototype.unshift=function(nt){return vt(this,nt,null,!0,!1)};function vt(nt,ht,ft,at,_t){Q("readableAddChunk",ht);var St=nt._readableState;if(ht===null)St.reading=!1,Ot(nt,St);else{var Vt;if(_t||(Vt=It(St,ht)),Vt)ct(nt,Vt);else if(St.objectMode||ht&&ht.length>0)if(typeof ht!="string"&&!St.objectMode&&Object.getPrototypeOf(ht)!==$.prototype&&(ht=H(ht)),at)St.endEmitted?ct(nt,new lt):Tt(nt,St,ht,!0);else if(St.ended)ct(nt,new ot);else{if(St.destroyed)return!1;St.reading=!1,St.decoder&&!ft?(ht=St.decoder.write(ht),St.objectMode||ht.length!==0?Tt(nt,St,ht,!1):Ut(nt,St)):Tt(nt,St,ht,!1)}else at||(St.reading=!1,Ut(nt,St))}return!St.ended&&(St.length<St.highWaterMark||St.length===0)}function Tt(nt,ht,ft,at){ht.flowing&&ht.length===0&&!ht.sync?(ht.awaitDrain=0,nt.emit("data",ft)):(ht.length+=ht.objectMode?1:ft.length,at?ht.buffer.unshift(ft):ht.buffer.push(ft),ht.needReadable&&Nt(nt)),Ut(nt,ht)}function It(nt,ht){var ft;return!W(ht)&&typeof ht!="string"&&ht!==void 0&&!nt.objectMode&&(ft=new rt("chunk",["string","Buffer","Uint8Array"],ht)),ft}pt.prototype.isPaused=function(){return this._readableState.flowing===!1},pt.prototype.setEncoding=function(nt){st||(st=g("string_decoder/").StringDecoder);var ht=new st(nt);this._readableState.decoder=ht,this._readableState.encoding=this._readableState.decoder.encoding;for(var ft=this._readableState.buffer.head,at="";ft!==null;)at+=ht.write(ft.data),ft=ft.next;return this._readableState.buffer.clear(),at!==""&&this._readableState.buffer.push(at),this._readableState.length=at.length,this};var $t=1073741824;function Bt(nt){return nt>=$t?nt=$t:(nt--,nt|=nt>>>1,nt|=nt>>>2,nt|=nt>>>4,nt|=nt>>>8,nt|=nt>>>16,nt++),nt}function zt(nt,ht){return nt<=0||ht.length===0&&ht.ended?0:ht.objectMode?1:nt!==nt?ht.flowing&&ht.length?ht.buffer.head.data.length:ht.length:(nt>ht.highWaterMark&&(ht.highWaterMark=Bt(nt)),nt<=ht.length?nt:ht.ended?ht.length:(ht.needReadable=!0,0))}pt.prototype.read=function(nt){Q("read",nt),nt=parseInt(nt,10);var ht=this._readableState,ft=nt;if(nt!==0&&(ht.emittedReadable=!1),nt===0&&ht.needReadable&&((ht.highWaterMark!==0?ht.length>=ht.highWaterMark:ht.length>0)||ht.ended))return Q("read: emitReadable",ht.length,ht.ended),ht.length===0&&ht.ended?xt(this):Nt(this),null;if(nt=zt(nt,ht),nt===0&&ht.ended)return ht.length===0&&xt(this),null;var at=ht.needReadable;Q("need readable",at),(ht.length===0||ht.length-nt<ht.highWaterMark)&&(at=!0,Q("length less than watermark",at)),ht.ended||ht.reading?(at=!1,Q("reading or ended",at)):at&&(Q("do read"),ht.reading=!0,ht.sync=!0,ht.length===0&&(ht.needReadable=!0),this._read(ht.highWaterMark),ht.sync=!1,ht.reading||(nt=zt(ft,ht)));var _t;return nt>0?_t=wt(nt,ht):_t=null,_t===null?(ht.needReadable=ht.length<=ht.highWaterMark,nt=0):(ht.length-=nt,ht.awaitDrain=0),ht.length===0&&(ht.ended||(ht.needReadable=!0),ft!==nt&&ht.ended&&xt(this)),_t!==null&&this.emit("data",_t),_t};function Ot(nt,ht){if(Q("onEofChunk"),!ht.ended){if(ht.decoder){var ft=ht.decoder.end();ft&&ft.length&&(ht.buffer.push(ft),ht.length+=ht.objectMode?1:ft.length)}ht.ended=!0,ht.sync?Nt(nt):(ht.needReadable=!1,ht.emittedReadable||(ht.emittedReadable=!0,Pt(nt)))}}function Nt(nt){var ht=nt._readableState;Q("emitReadable",ht.needReadable,ht.emittedReadable),ht.needReadable=!1,ht.emittedReadable||(Q("emitReadable",ht.flowing),ht.emittedReadable=!0,P.nextTick(Pt,nt))}function Pt(nt){var ht=nt._readableState;Q("emitReadable_",ht.destroyed,ht.length,ht.ended),!ht.destroyed&&(ht.length||ht.ended)&&(nt.emit("readable"),ht.emittedReadable=!1),ht.needReadable=!ht.flowing&&!ht.ended&&ht.length<=ht.highWaterMark,bt(nt)}function Ut(nt,ht){ht.readingMore||(ht.readingMore=!0,P.nextTick(Ft,nt,ht))}function Ft(nt,ht){for(;!ht.reading&&!ht.ended&&(ht.length<ht.highWaterMark||ht.flowing&&ht.length===0);){var ft=ht.length;if(Q("maybeReadMore read 0"),nt.read(0),ft===ht.length)break}ht.readingMore=!1}pt.prototype._read=function(nt){ct(this,new J("_read()"))},pt.prototype.pipe=function(nt,ht){var ft=this,at=this._readableState;switch(at.pipesCount){case 0:at.pipes=nt;break;case 1:at.pipes=[at.pipes,nt];break;default:at.pipes.push(nt);break}at.pipesCount+=1,Q("pipe count=%d opts=%j",at.pipesCount,ht);var _t=(!ht||ht.end!==!1)&&nt!==P.stdout&&nt!==P.stderr,St=_t?ee:he;at.endEmitted?P.nextTick(St):ft.once("end",St),nt.on("unpipe",Vt);function Vt(Wt,oe){Q("onunpipe"),Wt===ft&&oe&&oe.hasUnpiped===!1&&(oe.hasUnpiped=!0,ae())}function ee(){Q("onend"),nt.end()}var Jt=Zt(ft);nt.on("drain",Jt);var se=!1;function ae(){Q("cleanup"),nt.removeListener("close",ue),nt.removeListener("finish",me),nt.removeListener("drain",Jt),nt.removeListener("error",le),nt.removeListener("unpipe",Vt),ft.removeListener("end",ee),ft.removeListener("end",he),ft.removeListener("data",fe),se=!0,at.awaitDrain&&(!nt._writableState||nt._writableState.needDrain)&&Jt()}ft.on("data",fe);function fe(Wt){Q("ondata");var oe=nt.write(Wt);Q("dest.write",oe),oe===!1&&((at.pipesCount===1&&at.pipes===nt||at.pipesCount>1&&Gt(at.pipes,nt)!==-1)&&!se&&(Q("false write response, pause",at.awaitDrain),at.awaitDrain++),ft.pause())}function le(Wt){Q("onerror",Wt),he(),nt.removeListener("error",le),U(nt,"error")===0&&ct(nt,Wt)}Et(nt,"error",le);function ue(){nt.removeListener("finish",me),he()}nt.once("close",ue);function me(){Q("onfinish"),nt.removeListener("close",ue),he()}nt.once("finish",me);function he(){Q("unpipe"),ft.unpipe(nt)}return nt.emit("pipe",ft),at.flowing||(Q("pipe resume"),ft.resume()),nt};function Zt(nt){return function(){var ft=nt._readableState;Q("pipeOnDrain",ft.awaitDrain),ft.awaitDrain&&ft.awaitDrain--,ft.awaitDrain===0&&U(nt,"data")&&(ft.flowing=!0,bt(nt))}}pt.prototype.unpipe=function(nt){var ht=this._readableState,ft={hasUnpiped:!1};if(ht.pipesCount===0)return this;if(ht.pipesCount===1)return nt&&nt!==ht.pipes?this:(nt||(nt=ht.pipes),ht.pipes=null,ht.pipesCount=0,ht.flowing=!1,nt&&nt.emit("unpipe",this,ft),this);if(!nt){var at=ht.pipes,_t=ht.pipesCount;ht.pipes=null,ht.pipesCount=0,ht.flowing=!1;for(var St=0;St<_t;St++)at[St].emit("unpipe",this,{hasUnpiped:!1});return this}var Vt=Gt(ht.pipes,nt);return Vt===-1?this:(ht.pipes.splice(Vt,1),ht.pipesCount-=1,ht.pipesCount===1&&(ht.pipes=ht.pipes[0]),nt.emit("unpipe",this,ft),this)},pt.prototype.on=function(nt,ht){var ft=Z.prototype.on.call(this,nt,ht),at=this._readableState;return nt==="data"?(at.readableListening=this.listenerCount("readable")>0,at.flowing!==!1&&this.resume()):nt==="readable"&&!at.endEmitted&&!at.readableListening&&(at.readableListening=at.needReadable=!0,at.flowing=!1,at.emittedReadable=!1,Q("on readable",at.length,at.reading),at.length?Nt(this):at.reading||P.nextTick(Dt,this)),ft},pt.prototype.addListener=pt.prototype.on,pt.prototype.removeListener=function(nt,ht){var ft=Z.prototype.removeListener.call(this,nt,ht);return nt==="readable"&&P.nextTick(Ht,this),ft},pt.prototype.removeAllListeners=function(nt){var ht=Z.prototype.removeAllListeners.apply(this,arguments);return(nt==="readable"||nt===void 0)&&P.nextTick(Ht,this),ht};function Ht(nt){var ht=nt._readableState;ht.readableListening=nt.listenerCount("readable")>0,ht.resumeScheduled&&!ht.paused?ht.flowing=!0:nt.listenerCount("data")>0&&nt.resume()}function Dt(nt){Q("readable nexttick read 0"),nt.read(0)}pt.prototype.resume=function(){var nt=this._readableState;return nt.flowing||(Q("resume"),nt.flowing=!nt.readableListening,dt(this,nt)),nt.paused=!1,this};function dt(nt,ht){ht.resumeScheduled||(ht.resumeScheduled=!0,P.nextTick(Lt,nt,ht))}function Lt(nt,ht){Q("resume",ht.reading),ht.reading||nt.read(0),ht.resumeScheduled=!1,nt.emit("resume"),bt(nt),ht.flowing&&!ht.reading&&nt.read(0)}pt.prototype.pause=function(){return Q("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(Q("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this};function bt(nt){var ht=nt._readableState;for(Q("flow",ht.flowing);ht.flowing&&nt.read()!==null;);}pt.prototype.wrap=function(nt){var ht=this,ft=this._readableState,at=!1;nt.on("end",function(){if(Q("wrapped end"),ft.decoder&&!ft.ended){var Vt=ft.decoder.end();Vt&&Vt.length&&ht.push(Vt)}ht.push(null)}),nt.on("data",function(Vt){if(Q("wrapped data"),ft.decoder&&(Vt=ft.decoder.write(Vt)),!(ft.objectMode&&Vt==null)&&!(!ft.objectMode&&(!Vt||!Vt.length))){var ee=ht.push(Vt);ee||(at=!0,nt.pause())}});for(var _t in nt)this[_t]===void 0&&typeof nt[_t]=="function"&&(this[_t]=function(ee){return function(){return nt[ee].apply(nt,arguments)}}(_t));for(var St=0;St<At.length;St++)nt.on(At[St],this.emit.bind(this,At[St]));return this._read=function(Vt){Q("wrapped _read",Vt),at&&(at=!1,nt.resume())},this},typeof Symbol=="function"&&(pt.prototype[Symbol.asyncIterator]=function(){return ut===void 0&&(ut=g("./internal/streams/async_iterator")),ut(this)}),Object.defineProperty(pt.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(pt.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(pt.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(ht){this._readableState&&(this._readableState.flowing=ht)}}),pt._fromList=wt,Object.defineProperty(pt.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}});function wt(nt,ht){if(ht.length===0)return null;var ft;return ht.objectMode?ft=ht.buffer.shift():!nt||nt>=ht.length?(ht.decoder?ft=ht.buffer.join(""):ht.buffer.length===1?ft=ht.buffer.first():ft=ht.buffer.concat(ht.length),ht.buffer.clear()):ft=ht.buffer.consume(nt,ht.decoder),ft}function xt(nt){var ht=nt._readableState;Q("endReadable",ht.endEmitted),ht.endEmitted||(ht.ended=!0,P.nextTick(Rt,ht,nt))}function Rt(nt,ht){if(Q("endReadableNT",nt.endEmitted,nt.length),!nt.endEmitted&&nt.length===0&&(nt.endEmitted=!0,ht.readable=!1,ht.emit("end"),nt.autoDestroy)){var ft=ht._writableState;(!ft||ft.autoDestroy&&ft.finished)&&ht.destroy()}}typeof Symbol=="function"&&(pt.from=function(nt,ht){return it===void 0&&(it=g("./internal/streams/from")),it(pt,nt,ht)});function Gt(nt,ht){for(var ft=0,at=nt.length;ft<at;ft++)if(nt[ft]===ht)return ft;return-1}}).call(this)}).call(this,g("_process"),typeof commonjsGlobal$1<"u"?commonjsGlobal$1:typeof self<"u"?self:typeof window<"u"?window:{})},{"../errors":66,"./_stream_duplex":67,"./internal/streams/async_iterator":72,"./internal/streams/buffer_list":73,"./internal/streams/destroy":74,"./internal/streams/from":76,"./internal/streams/state":78,"./internal/streams/stream":79,_process:63,buffer:32,events:35,inherits:46,"string_decoder/":80,util:29}],70:[function(g,w,I){w.exports=H;var P=g("../errors").codes,F=P.ERR_METHOD_NOT_IMPLEMENTED,D=P.ERR_MULTIPLE_CALLBACK,U=P.ERR_TRANSFORM_ALREADY_TRANSFORMING,Z=P.ERR_TRANSFORM_WITH_LENGTH_0,$=g("./_stream_duplex");g("inherits")(H,$);function j(Q,K){var q=this._transformState;q.transforming=!1;var et=q.writecb;if(et===null)return this.emit("error",new D);q.writechunk=null,q.writecb=null,K!=null&&this.push(K),et(Q);var X=this._readableState;X.reading=!1,(X.needReadable||X.length<X.highWaterMark)&&this._read(X.highWaterMark)}function H(Q){if(!(this instanceof H))return new H(Q);$.call(this,Q),this._transformState={afterTransform:j.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,Q&&(typeof Q.transform=="function"&&(this._transform=Q.transform),typeof Q.flush=="function"&&(this._flush=Q.flush)),this.on("prefinish",W)}function W(){var Q=this;typeof this._flush=="function"&&!this._readableState.destroyed?this._flush(function(K,q){V(Q,K,q)}):V(this,null,null)}H.prototype.push=function(Q,K){return this._transformState.needTransform=!1,$.prototype.push.call(this,Q,K)},H.prototype._transform=function(Q,K,q){q(new F("_transform()"))},H.prototype._write=function(Q,K,q){var et=this._transformState;if(et.writecb=q,et.writechunk=Q,et.writeencoding=K,!et.transforming){var X=this._readableState;(et.needTransform||X.needReadable||X.length<X.highWaterMark)&&this._read(X.highWaterMark)}},H.prototype._read=function(Q){var K=this._transformState;K.writechunk!==null&&!K.transforming?(K.transforming=!0,this._transform(K.writechunk,K.writeencoding,K.afterTransform)):K.needTransform=!0},H.prototype._destroy=function(Q,K){$.prototype._destroy.call(this,Q,function(q){K(q)})};function V(Q,K,q){if(K)return Q.emit("error",K);if(q!=null&&Q.push(q),Q._writableState.length)throw new Z;if(Q._transformState.transforming)throw new U;return Q.push(null)}},{"../errors":66,"./_stream_duplex":67,inherits:46}],71:[function(g,w,I){(function(P,F){(function(){w.exports=gt;function D(bt){var wt=this;this.next=null,this.entry=null,this.finish=function(){Lt(wt,bt)}}var U;gt.WritableState=At;var Z={deprecate:g("util-deprecate")},$=g("./internal/streams/stream"),j=g("buffer").Buffer,H=F.Uint8Array||function(){};function W(bt){return j.from(bt)}function V(bt){return j.isBuffer(bt)||bt instanceof H}var Q=g("./internal/streams/destroy"),K=g("./internal/streams/state"),q=K.getHighWaterMark,et=g("../errors").codes,X=et.ERR_INVALID_ARG_TYPE,tt=et.ERR_METHOD_NOT_IMPLEMENTED,rt=et.ERR_MULTIPLE_CALLBACK,ot=et.ERR_STREAM_CANNOT_PIPE,J=et.ERR_STREAM_DESTROYED,lt=et.ERR_STREAM_NULL_VALUES,st=et.ERR_STREAM_WRITE_AFTER_END,ut=et.ERR_UNKNOWN_ENCODING,it=Q.errorOrDestroy;g("inherits")(gt,$);function ct(){}function At(bt,wt,xt){U=U||g("./_stream_duplex"),bt=bt||{},typeof xt!="boolean"&&(xt=wt instanceof U),this.objectMode=!!bt.objectMode,xt&&(this.objectMode=this.objectMode||!!bt.writableObjectMode),this.highWaterMark=q(this,bt,"writableHighWaterMark",xt),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var Rt=bt.decodeStrings===!1;this.decodeStrings=!Rt,this.defaultEncoding=bt.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(Gt){Ot(wt,Gt)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=bt.emitClose!==!1,this.autoDestroy=!!bt.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new D(this)}At.prototype.getBuffer=function(){for(var wt=this.bufferedRequest,xt=[];wt;)xt.push(wt),wt=wt.next;return xt},function(){try{Object.defineProperty(At.prototype,"buffer",{get:Z.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}();var Et;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(Et=Function.prototype[Symbol.hasInstance],Object.defineProperty(gt,Symbol.hasInstance,{value:function(wt){return Et.call(this,wt)?!0:this!==gt?!1:wt&&wt._writableState instanceof At}})):Et=function(wt){return wt instanceof this};function gt(bt){U=U||g("./_stream_duplex");var wt=this instanceof U;if(!wt&&!Et.call(gt,this))return new gt(bt);this._writableState=new At(bt,this,wt),this.writable=!0,bt&&(typeof bt.write=="function"&&(this._write=bt.write),typeof bt.writev=="function"&&(this._writev=bt.writev),typeof bt.destroy=="function"&&(this._destroy=bt.destroy),typeof bt.final=="function"&&(this._final=bt.final)),$.call(this)}gt.prototype.pipe=function(){it(this,new ot)};function pt(bt,wt){var xt=new st;it(bt,xt),P.nextTick(wt,xt)}function vt(bt,wt,xt,Rt){var Gt;return xt===null?Gt=new lt:typeof xt!="string"&&!wt.objectMode&&(Gt=new X("chunk",["string","Buffer"],xt)),Gt?(it(bt,Gt),P.nextTick(Rt,Gt),!1):!0}gt.prototype.write=function(bt,wt,xt){var Rt=this._writableState,Gt=!1,nt=!Rt.objectMode&&V(bt);return nt&&!j.isBuffer(bt)&&(bt=W(bt)),typeof wt=="function"&&(xt=wt,wt=null),nt?wt="buffer":wt||(wt=Rt.defaultEncoding),typeof xt!="function"&&(xt=ct),Rt.ending?pt(this,xt):(nt||vt(this,Rt,bt,xt))&&(Rt.pendingcb++,Gt=It(this,Rt,nt,bt,wt,xt)),Gt},gt.prototype.cork=function(){this._writableState.corked++},gt.prototype.uncork=function(){var bt=this._writableState;bt.corked&&(bt.corked--,!bt.writing&&!bt.corked&&!bt.bufferProcessing&&bt.bufferedRequest&&Ut(this,bt))},gt.prototype.setDefaultEncoding=function(wt){if(typeof wt=="string"&&(wt=wt.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((wt+"").toLowerCase())>-1))throw new ut(wt);return this._writableState.defaultEncoding=wt,this},Object.defineProperty(gt.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});function Tt(bt,wt,xt){return!bt.objectMode&&bt.decodeStrings!==!1&&typeof wt=="string"&&(wt=j.from(wt,xt)),wt}Object.defineProperty(gt.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function It(bt,wt,xt,Rt,Gt,nt){if(!xt){var ht=Tt(wt,Rt,Gt);Rt!==ht&&(xt=!0,Gt="buffer",Rt=ht)}var ft=wt.objectMode?1:Rt.length;wt.length+=ft;var at=wt.length<wt.highWaterMark;if(at||(wt.needDrain=!0),wt.writing||wt.corked){var _t=wt.lastBufferedRequest;wt.lastBufferedRequest={chunk:Rt,encoding:Gt,isBuf:xt,callback:nt,next:null},_t?_t.next=wt.lastBufferedRequest:wt.bufferedRequest=wt.lastBufferedRequest,wt.bufferedRequestCount+=1}else $t(bt,wt,!1,ft,Rt,Gt,nt);return at}function $t(bt,wt,xt,Rt,Gt,nt,ht){wt.writelen=Rt,wt.writecb=ht,wt.writing=!0,wt.sync=!0,wt.destroyed?wt.onwrite(new J("write")):xt?bt._writev(Gt,wt.onwrite):bt._write(Gt,nt,wt.onwrite),wt.sync=!1}function Bt(bt,wt,xt,Rt,Gt){--wt.pendingcb,xt?(P.nextTick(Gt,Rt),P.nextTick(Dt,bt,wt),bt._writableState.errorEmitted=!0,it(bt,Rt)):(Gt(Rt),bt._writableState.errorEmitted=!0,it(bt,Rt),Dt(bt,wt))}function zt(bt){bt.writing=!1,bt.writecb=null,bt.length-=bt.writelen,bt.writelen=0}function Ot(bt,wt){var xt=bt._writableState,Rt=xt.sync,Gt=xt.writecb;if(typeof Gt!="function")throw new rt;if(zt(xt),wt)Bt(bt,xt,Rt,wt,Gt);else{var nt=Ft(xt)||bt.destroyed;!nt&&!xt.corked&&!xt.bufferProcessing&&xt.bufferedRequest&&Ut(bt,xt),Rt?P.nextTick(Nt,bt,xt,nt,Gt):Nt(bt,xt,nt,Gt)}}function Nt(bt,wt,xt,Rt){xt||Pt(bt,wt),wt.pendingcb--,Rt(),Dt(bt,wt)}function Pt(bt,wt){wt.length===0&&wt.needDrain&&(wt.needDrain=!1,bt.emit("drain"))}function Ut(bt,wt){wt.bufferProcessing=!0;var xt=wt.bufferedRequest;if(bt._writev&&xt&&xt.next){var Rt=wt.bufferedRequestCount,Gt=new Array(Rt),nt=wt.corkedRequestsFree;nt.entry=xt;for(var ht=0,ft=!0;xt;)Gt[ht]=xt,xt.isBuf||(ft=!1),xt=xt.next,ht+=1;Gt.allBuffers=ft,$t(bt,wt,!0,wt.length,Gt,"",nt.finish),wt.pendingcb++,wt.lastBufferedRequest=null,nt.next?(wt.corkedRequestsFree=nt.next,nt.next=null):wt.corkedRequestsFree=new D(wt),wt.bufferedRequestCount=0}else{for(;xt;){var at=xt.chunk,_t=xt.encoding,St=xt.callback,Vt=wt.objectMode?1:at.length;if($t(bt,wt,!1,Vt,at,_t,St),xt=xt.next,wt.bufferedRequestCount--,wt.writing)break}xt===null&&(wt.lastBufferedRequest=null)}wt.bufferedRequest=xt,wt.bufferProcessing=!1}gt.prototype._write=function(bt,wt,xt){xt(new tt("_write()"))},gt.prototype._writev=null,gt.prototype.end=function(bt,wt,xt){var Rt=this._writableState;return typeof bt=="function"?(xt=bt,bt=null,wt=null):typeof wt=="function"&&(xt=wt,wt=null),bt!=null&&this.write(bt,wt),Rt.corked&&(Rt.corked=1,this.uncork()),Rt.ending||dt(this,Rt,xt),this},Object.defineProperty(gt.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function Ft(bt){return bt.ending&&bt.length===0&&bt.bufferedRequest===null&&!bt.finished&&!bt.writing}function Zt(bt,wt){bt._final(function(xt){wt.pendingcb--,xt&&it(bt,xt),wt.prefinished=!0,bt.emit("prefinish"),Dt(bt,wt)})}function Ht(bt,wt){!wt.prefinished&&!wt.finalCalled&&(typeof bt._final=="function"&&!wt.destroyed?(wt.pendingcb++,wt.finalCalled=!0,P.nextTick(Zt,bt,wt)):(wt.prefinished=!0,bt.emit("prefinish")))}function Dt(bt,wt){var xt=Ft(wt);if(xt&&(Ht(bt,wt),wt.pendingcb===0&&(wt.finished=!0,bt.emit("finish"),wt.autoDestroy))){var Rt=bt._readableState;(!Rt||Rt.autoDestroy&&Rt.endEmitted)&&bt.destroy()}return xt}function dt(bt,wt,xt){wt.ending=!0,Dt(bt,wt),xt&&(wt.finished?P.nextTick(xt):bt.once("finish",xt)),wt.ended=!0,bt.writable=!1}function Lt(bt,wt,xt){var Rt=bt.entry;for(bt.entry=null;Rt;){var Gt=Rt.callback;wt.pendingcb--,Gt(xt),Rt=Rt.next}wt.corkedRequestsFree.next=bt}Object.defineProperty(gt.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(wt){this._writableState&&(this._writableState.destroyed=wt)}}),gt.prototype.destroy=Q.destroy,gt.prototype._undestroy=Q.undestroy,gt.prototype._destroy=function(bt,wt){wt(bt)}}).call(this)}).call(this,g("_process"),typeof commonjsGlobal$1<"u"?commonjsGlobal$1:typeof self<"u"?self:typeof window<"u"?window:{})},{"../errors":66,"./_stream_duplex":67,"./internal/streams/destroy":74,"./internal/streams/state":78,"./internal/streams/stream":79,_process:63,buffer:32,inherits:46,"util-deprecate":81}],72:[function(g,w,I){(function(P){(function(){var F;function D(J,lt,st){return lt in J?Object.defineProperty(J,lt,{value:st,enumerable:!0,configurable:!0,writable:!0}):J[lt]=st,J}var U=g("./end-of-stream"),Z=Symbol("lastResolve"),$=Symbol("lastReject"),j=Symbol("error"),H=Symbol("ended"),W=Symbol("lastPromise"),V=Symbol("handlePromise"),Q=Symbol("stream");function K(J,lt){return{value:J,done:lt}}function q(J){var lt=J[Z];if(lt!==null){var st=J[Q].read();st!==null&&(J[W]=null,J[Z]=null,J[$]=null,lt(K(st,!1)))}}function et(J){P.nextTick(q,J)}function X(J,lt){return function(st,ut){J.then(function(){if(lt[H]){st(K(void 0,!0));return}lt[V](st,ut)},ut)}}var tt=Object.getPrototypeOf(function(){}),rt=Object.setPrototypeOf((F={get stream(){return this[Q]},next:function(){var lt=this,st=this[j];if(st!==null)return Promise.reject(st);if(this[H])return Promise.resolve(K(void 0,!0));if(this[Q].destroyed)return new Promise(function(At,Et){P.nextTick(function(){lt[j]?Et(lt[j]):At(K(void 0,!0))})});var ut=this[W],it;if(ut)it=new Promise(X(ut,this));else{var ct=this[Q].read();if(ct!==null)return Promise.resolve(K(ct,!1));it=new Promise(this[V])}return this[W]=it,it}},D(F,Symbol.asyncIterator,function(){return this}),D(F,"return",function(){var lt=this;return new Promise(function(st,ut){lt[Q].destroy(null,function(it){if(it){ut(it);return}st(K(void 0,!0))})})}),F),tt),ot=function(lt){var st,ut=Object.create(rt,(st={},D(st,Q,{value:lt,writable:!0}),D(st,Z,{value:null,writable:!0}),D(st,$,{value:null,writable:!0}),D(st,j,{value:null,writable:!0}),D(st,H,{value:lt._readableState.endEmitted,writable:!0}),D(st,V,{value:function(ct,At){var Et=ut[Q].read();Et?(ut[W]=null,ut[Z]=null,ut[$]=null,ct(K(Et,!1))):(ut[Z]=ct,ut[$]=At)},writable:!0}),st));return ut[W]=null,U(lt,function(it){if(it&&it.code!=="ERR_STREAM_PREMATURE_CLOSE"){var ct=ut[$];ct!==null&&(ut[W]=null,ut[Z]=null,ut[$]=null,ct(it)),ut[j]=it;return}var At=ut[Z];At!==null&&(ut[W]=null,ut[Z]=null,ut[$]=null,At(K(void 0,!0))),ut[H]=!0}),lt.on("readable",et.bind(null,ut)),ut};w.exports=ot}).call(this)}).call(this,g("_process"))},{"./end-of-stream":75,_process:63}],73:[function(g,w,I){function P(q,et){var X=Object.keys(q);if(Object.getOwnPropertySymbols){var tt=Object.getOwnPropertySymbols(q);et&&(tt=tt.filter(function(rt){return Object.getOwnPropertyDescriptor(q,rt).enumerable})),X.push.apply(X,tt)}return X}function F(q){for(var et=1;et<arguments.length;et++){var X=arguments[et]!=null?arguments[et]:{};et%2?P(Object(X),!0).forEach(function(tt){D(q,tt,X[tt])}):Object.getOwnPropertyDescriptors?Object.defineProperties(q,Object.getOwnPropertyDescriptors(X)):P(Object(X)).forEach(function(tt){Object.defineProperty(q,tt,Object.getOwnPropertyDescriptor(X,tt))})}return q}function D(q,et,X){return et in q?Object.defineProperty(q,et,{value:X,enumerable:!0,configurable:!0,writable:!0}):q[et]=X,q}function U(q,et){if(!(q instanceof et))throw new TypeError("Cannot call a class as a function")}function Z(q,et){for(var X=0;X<et.length;X++){var tt=et[X];tt.enumerable=tt.enumerable||!1,tt.configurable=!0,"value"in tt&&(tt.writable=!0),Object.defineProperty(q,tt.key,tt)}}function $(q,et,X){return et&&Z(q.prototype,et),q}var j=g("buffer"),H=j.Buffer,W=g("util"),V=W.inspect,Q=V&&V.custom||"inspect";function K(q,et,X){H.prototype.copy.call(q,et,X)}w.exports=function(){function q(){U(this,q),this.head=null,this.tail=null,this.length=0}return $(q,[{key:"push",value:function(X){var tt={data:X,next:null};this.length>0?this.tail.next=tt:this.head=tt,this.tail=tt,++this.length}},{key:"unshift",value:function(X){var tt={data:X,next:this.head};this.length===0&&(this.tail=tt),this.head=tt,++this.length}},{key:"shift",value:function(){if(this.length!==0){var X=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,X}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(X){if(this.length===0)return"";for(var tt=this.head,rt=""+tt.data;tt=tt.next;)rt+=X+tt.data;return rt}},{key:"concat",value:function(X){if(this.length===0)return H.alloc(0);for(var tt=H.allocUnsafe(X>>>0),rt=this.head,ot=0;rt;)K(rt.data,tt,ot),ot+=rt.data.length,rt=rt.next;return tt}},{key:"consume",value:function(X,tt){var rt;return X<this.head.data.length?(rt=this.head.data.slice(0,X),this.head.data=this.head.data.slice(X)):X===this.head.data.length?rt=this.shift():rt=tt?this._getString(X):this._getBuffer(X),rt}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(X){var tt=this.head,rt=1,ot=tt.data;for(X-=ot.length;tt=tt.next;){var J=tt.data,lt=X>J.length?J.length:X;if(lt===J.length?ot+=J:ot+=J.slice(0,X),X-=lt,X===0){lt===J.length?(++rt,tt.next?this.head=tt.next:this.head=this.tail=null):(this.head=tt,tt.data=J.slice(lt));break}++rt}return this.length-=rt,ot}},{key:"_getBuffer",value:function(X){var tt=H.allocUnsafe(X),rt=this.head,ot=1;for(rt.data.copy(tt),X-=rt.data.length;rt=rt.next;){var J=rt.data,lt=X>J.length?J.length:X;if(J.copy(tt,tt.length-X,0,lt),X-=lt,X===0){lt===J.length?(++ot,rt.next?this.head=rt.next:this.head=this.tail=null):(this.head=rt,rt.data=J.slice(lt));break}++ot}return this.length-=ot,tt}},{key:Q,value:function(X,tt){return V(this,F({},tt,{depth:0,customInspect:!1}))}}]),q}()},{buffer:32,util:29}],74:[function(g,w,I){(function(P){(function(){function F(H,W){var V=this,Q=this._readableState&&this._readableState.destroyed,K=this._writableState&&this._writableState.destroyed;return Q||K?(W?W(H):H&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,P.nextTick($,this,H)):P.nextTick($,this,H)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(H||null,function(q){!W&&q?V._writableState?V._writableState.errorEmitted?P.nextTick(U,V):(V._writableState.errorEmitted=!0,P.nextTick(D,V,q)):P.nextTick(D,V,q):W?(P.nextTick(U,V),W(q)):P.nextTick(U,V)}),this)}function D(H,W){$(H,W),U(H)}function U(H){H._writableState&&!H._writableState.emitClose||H._readableState&&!H._readableState.emitClose||H.emit("close")}function Z(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function $(H,W){H.emit("error",W)}function j(H,W){var V=H._readableState,Q=H._writableState;V&&V.autoDestroy||Q&&Q.autoDestroy?H.destroy(W):H.emit("error",W)}w.exports={destroy:F,undestroy:Z,errorOrDestroy:j}}).call(this)}).call(this,g("_process"))},{_process:63}],75:[function(g,w,I){var P=g("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function F($){var j=!1;return function(){if(!j){j=!0;for(var H=arguments.length,W=new Array(H),V=0;V<H;V++)W[V]=arguments[V];$.apply(this,W)}}}function D(){}function U($){return $.setHeader&&typeof $.abort=="function"}function Z($,j,H){if(typeof j=="function")return Z($,null,j);j||(j={}),H=F(H||D);var W=j.readable||j.readable!==!1&&$.readable,V=j.writable||j.writable!==!1&&$.writable,Q=function(){$.writable||q()},K=$._writableState&&$._writableState.finished,q=function(){V=!1,K=!0,W||H.call($)},et=$._readableState&&$._readableState.endEmitted,X=function(){W=!1,et=!0,V||H.call($)},tt=function(lt){H.call($,lt)},rt=function(){var lt;if(W&&!et)return(!$._readableState||!$._readableState.ended)&&(lt=new P),H.call($,lt);if(V&&!K)return(!$._writableState||!$._writableState.ended)&&(lt=new P),H.call($,lt)},ot=function(){$.req.on("finish",q)};return U($)?($.on("complete",q),$.on("abort",rt),$.req?ot():$.on("request",ot)):V&&!$._writableState&&($.on("end",Q),$.on("close",Q)),$.on("end",X),$.on("finish",q),j.error!==!1&&$.on("error",tt),$.on("close",rt),function(){$.removeListener("complete",q),$.removeListener("abort",rt),$.removeListener("request",ot),$.req&&$.req.removeListener("finish",q),$.removeListener("end",Q),$.removeListener("close",Q),$.removeListener("finish",q),$.removeListener("end",X),$.removeListener("error",tt),$.removeListener("close",rt)}}w.exports=Z},{"../../../errors":66}],76:[function(g,w,I){w.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],77:[function(g,w,I){var P;function F(q){var et=!1;return function(){et||(et=!0,q.apply(void 0,arguments))}}var D=g("../../../errors").codes,U=D.ERR_MISSING_ARGS,Z=D.ERR_STREAM_DESTROYED;function $(q){if(q)throw q}function j(q){return q.setHeader&&typeof q.abort=="function"}function H(q,et,X,tt){tt=F(tt);var rt=!1;q.on("close",function(){rt=!0}),P===void 0&&(P=g("./end-of-stream")),P(q,{readable:et,writable:X},function(J){if(J)return tt(J);rt=!0,tt()});var ot=!1;return function(J){if(!rt&&!ot){if(ot=!0,j(q))return q.abort();if(typeof q.destroy=="function")return q.destroy();tt(J||new Z("pipe"))}}}function W(q){q()}function V(q,et){return q.pipe(et)}function Q(q){return!q.length||typeof q[q.length-1]!="function"?$:q.pop()}function K(){for(var q=arguments.length,et=new Array(q),X=0;X<q;X++)et[X]=arguments[X];var tt=Q(et);if(Array.isArray(et[0])&&(et=et[0]),et.length<2)throw new U("streams");var rt,ot=et.map(function(J,lt){var st=lt<et.length-1,ut=lt>0;return H(J,st,ut,function(it){rt||(rt=it),it&&ot.forEach(W),!st&&(ot.forEach(W),tt(rt))})});return et.reduce(V)}w.exports=K},{"../../../errors":66,"./end-of-stream":75}],78:[function(g,w,I){var P=g("../../../errors").codes.ERR_INVALID_OPT_VALUE;function F(U,Z,$){return U.highWaterMark!=null?U.highWaterMark:Z?U[$]:null}function D(U,Z,$,j){var H=F(Z,j,$);if(H!=null){if(!(isFinite(H)&&Math.floor(H)===H)||H<0){var W=j?$:"highWaterMark";throw new P(W,H)}return Math.floor(H)}return U.objectMode?16:16*1024}w.exports={getHighWaterMark:D}},{"../../../errors":66}],79:[function(g,w,I){w.exports=g("events").EventEmitter},{events:35}],80:[function(g,w,I){var P=g("safe-buffer").Buffer,F=P.isEncoding||function(ot){switch(ot=""+ot,ot&&ot.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function D(ot){if(!ot)return"utf8";for(var J;;)switch(ot){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return ot;default:if(J)return;ot=(""+ot).toLowerCase(),J=!0}}function U(ot){var J=D(ot);if(typeof J!="string"&&(P.isEncoding===F||!F(ot)))throw new Error("Unknown encoding: "+ot);return J||ot}I.StringDecoder=Z;function Z(ot){this.encoding=U(ot);var J;switch(this.encoding){case"utf16le":this.text=K,this.end=q,J=4;break;case"utf8":this.fillLast=W,J=4;break;case"base64":this.text=et,this.end=X,J=3;break;default:this.write=tt,this.end=rt;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=P.allocUnsafe(J)}Z.prototype.write=function(ot){if(ot.length===0)return"";var J,lt;if(this.lastNeed){if(J=this.fillLast(ot),J===void 0)return"";lt=this.lastNeed,this.lastNeed=0}else lt=0;return lt<ot.length?J?J+this.text(ot,lt):this.text(ot,lt):J||""},Z.prototype.end=Q,Z.prototype.text=V,Z.prototype.fillLast=function(ot){if(this.lastNeed<=ot.length)return ot.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);ot.copy(this.lastChar,this.lastTotal-this.lastNeed,0,ot.length),this.lastNeed-=ot.length};function $(ot){return ot<=127?0:ot>>5===6?2:ot>>4===14?3:ot>>3===30?4:ot>>6===2?-1:-2}function j(ot,J,lt){var st=J.length-1;if(st<lt)return 0;var ut=$(J[st]);return ut>=0?(ut>0&&(ot.lastNeed=ut-1),ut):--st<lt||ut===-2?0:(ut=$(J[st]),ut>=0?(ut>0&&(ot.lastNeed=ut-2),ut):--st<lt||ut===-2?0:(ut=$(J[st]),ut>=0?(ut>0&&(ut===2?ut=0:ot.lastNeed=ut-3),ut):0))}function H(ot,J,lt){if((J[0]&192)!==128)return ot.lastNeed=0,"�";if(ot.lastNeed>1&&J.length>1){if((J[1]&192)!==128)return ot.lastNeed=1,"�";if(ot.lastNeed>2&&J.length>2&&(J[2]&192)!==128)return ot.lastNeed=2,"�"}}function W(ot){var J=this.lastTotal-this.lastNeed,lt=H(this,ot);if(lt!==void 0)return lt;if(this.lastNeed<=ot.length)return ot.copy(this.lastChar,J,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);ot.copy(this.lastChar,J,0,ot.length),this.lastNeed-=ot.length}function V(ot,J){var lt=j(this,ot,J);if(!this.lastNeed)return ot.toString("utf8",J);this.lastTotal=lt;var st=ot.length-(lt-this.lastNeed);return ot.copy(this.lastChar,0,st),ot.toString("utf8",J,st)}function Q(ot){var J=ot&&ot.length?this.write(ot):"";return this.lastNeed?J+"�":J}function K(ot,J){if((ot.length-J)%2===0){var lt=ot.toString("utf16le",J);if(lt){var st=lt.charCodeAt(lt.length-1);if(st>=55296&&st<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=ot[ot.length-2],this.lastChar[1]=ot[ot.length-1],lt.slice(0,-1)}return lt}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=ot[ot.length-1],ot.toString("utf16le",J,ot.length-1)}function q(ot){var J=ot&&ot.length?this.write(ot):"";if(this.lastNeed){var lt=this.lastTotal-this.lastNeed;return J+this.lastChar.toString("utf16le",0,lt)}return J}function et(ot,J){var lt=(ot.length-J)%3;return lt===0?ot.toString("base64",J):(this.lastNeed=3-lt,this.lastTotal=3,lt===1?this.lastChar[0]=ot[ot.length-1]:(this.lastChar[0]=ot[ot.length-2],this.lastChar[1]=ot[ot.length-1]),ot.toString("base64",J,ot.length-lt))}function X(ot){var J=ot&&ot.length?this.write(ot):"";return this.lastNeed?J+this.lastChar.toString("base64",0,3-this.lastNeed):J}function tt(ot){return ot.toString(this.encoding)}function rt(ot){return ot&&ot.length?this.write(ot):""}},{"safe-buffer":64}],81:[function(g,w,I){(function(P){(function(){w.exports=F;function F(U,Z){if(D("noDeprecation"))return U;var $=!1;function j(){if(!$){if(D("throwDeprecation"))throw new Error(Z);D("traceDeprecation")?console.trace(Z):console.warn(Z),$=!0}return U.apply(this,arguments)}return j}function D(U){try{if(!P.localStorage)return!1}catch{return!1}var Z=P.localStorage[U];return Z==null?!1:String(Z).toLowerCase()==="true"}}).call(this)}).call(this,typeof commonjsGlobal$1<"u"?commonjsGlobal$1:typeof self<"u"?self:typeof window<"u"?window:{})},{}],82:[function(g,w,I){arguments[4][25][0].apply(I,arguments)},{dup:25}],83:[function(g,w,I){var P=g("is-arguments"),F=g("is-generator-function"),D=g("which-typed-array"),U=g("is-typed-array");function Z(St){return St.call.bind(St)}var $=typeof BigInt<"u",j=typeof Symbol<"u",H=Z(Object.prototype.toString),W=Z(Number.prototype.valueOf),V=Z(String.prototype.valueOf),Q=Z(Boolean.prototype.valueOf);if($)var K=Z(BigInt.prototype.valueOf);if(j)var q=Z(Symbol.prototype.valueOf);function et(St,Vt){if(typeof St!="object")return!1;try{return Vt(St),!0}catch{return!1}}I.isArgumentsObject=P,I.isGeneratorFunction=F,I.isTypedArray=U;function X(St){return typeof Promise<"u"&&St instanceof Promise||St!==null&&typeof St=="object"&&typeof St.then=="function"&&typeof St.catch=="function"}I.isPromise=X;function tt(St){return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?ArrayBuffer.isView(St):U(St)||Ft(St)}I.isArrayBufferView=tt;function rt(St){return D(St)==="Uint8Array"}I.isUint8Array=rt;function ot(St){return D(St)==="Uint8ClampedArray"}I.isUint8ClampedArray=ot;function J(St){return D(St)==="Uint16Array"}I.isUint16Array=J;function lt(St){return D(St)==="Uint32Array"}I.isUint32Array=lt;function st(St){return D(St)==="Int8Array"}I.isInt8Array=st;function ut(St){return D(St)==="Int16Array"}I.isInt16Array=ut;function it(St){return D(St)==="Int32Array"}I.isInt32Array=it;function ct(St){return D(St)==="Float32Array"}I.isFloat32Array=ct;function At(St){return D(St)==="Float64Array"}I.isFloat64Array=At;function Et(St){return D(St)==="BigInt64Array"}I.isBigInt64Array=Et;function gt(St){return D(St)==="BigUint64Array"}I.isBigUint64Array=gt;function pt(St){return H(St)==="[object Map]"}pt.working=typeof Map<"u"&&pt(new Map);function vt(St){return typeof Map>"u"?!1:pt.working?pt(St):St instanceof Map}I.isMap=vt;function Tt(St){return H(St)==="[object Set]"}Tt.working=typeof Set<"u"&&Tt(new Set);function It(St){return typeof Set>"u"?!1:Tt.working?Tt(St):St instanceof Set}I.isSet=It;function $t(St){return H(St)==="[object WeakMap]"}$t.working=typeof WeakMap<"u"&&$t(new WeakMap);function Bt(St){return typeof WeakMap>"u"?!1:$t.working?$t(St):St instanceof WeakMap}I.isWeakMap=Bt;function zt(St){return H(St)==="[object WeakSet]"}zt.working=typeof WeakSet<"u"&&zt(new WeakSet);function Ot(St){return zt(St)}I.isWeakSet=Ot;function Nt(St){return H(St)==="[object ArrayBuffer]"}Nt.working=typeof ArrayBuffer<"u"&&Nt(new ArrayBuffer);function Pt(St){return typeof ArrayBuffer>"u"?!1:Nt.working?Nt(St):St instanceof ArrayBuffer}I.isArrayBuffer=Pt;function Ut(St){return H(St)==="[object DataView]"}Ut.working=typeof ArrayBuffer<"u"&&typeof DataView<"u"&&Ut(new DataView(new ArrayBuffer(1),0,1));function Ft(St){return typeof DataView>"u"?!1:Ut.working?Ut(St):St instanceof DataView}I.isDataView=Ft;var Zt=typeof SharedArrayBuffer<"u"?SharedArrayBuffer:void 0;function Ht(St){return H(St)==="[object SharedArrayBuffer]"}function Dt(St){return typeof Zt>"u"?!1:(typeof Ht.working>"u"&&(Ht.working=Ht(new Zt)),Ht.working?Ht(St):St instanceof Zt)}I.isSharedArrayBuffer=Dt;function dt(St){return H(St)==="[object AsyncFunction]"}I.isAsyncFunction=dt;function Lt(St){return H(St)==="[object Map Iterator]"}I.isMapIterator=Lt;function bt(St){return H(St)==="[object Set Iterator]"}I.isSetIterator=bt;function wt(St){return H(St)==="[object Generator]"}I.isGeneratorObject=wt;function xt(St){return H(St)==="[object WebAssembly.Module]"}I.isWebAssemblyCompiledModule=xt;function Rt(St){return et(St,W)}I.isNumberObject=Rt;function Gt(St){return et(St,V)}I.isStringObject=Gt;function nt(St){return et(St,Q)}I.isBooleanObject=nt;function ht(St){return $&&et(St,K)}I.isBigIntObject=ht;function ft(St){return j&&et(St,q)}I.isSymbolObject=ft;function at(St){return Rt(St)||Gt(St)||nt(St)||ht(St)||ft(St)}I.isBoxedPrimitive=at;function _t(St){return typeof Uint8Array<"u"&&(Pt(St)||Dt(St))}I.isAnyArrayBuffer=_t,["isProxy","isExternal","isModuleNamespaceObject"].forEach(function(St){Object.defineProperty(I,St,{enumerable:!1,value:function(){throw new Error(St+" is not supported in userland")}})})},{"is-arguments":47,"is-generator-function":49,"is-typed-array":50,"which-typed-array":85}],84:[function(g,w,I){(function(P){(function(){var F=Object.getOwnPropertyDescriptors||function(Zt){for(var Ht=Object.keys(Zt),Dt={},dt=0;dt<Ht.length;dt++)Dt[Ht[dt]]=Object.getOwnPropertyDescriptor(Zt,Ht[dt]);return Dt},D=/%[sdj%]/g;I.format=function(Ft){if(!ut(Ft)){for(var Zt=[],Ht=0;Ht<arguments.length;Ht++)Zt.push(j(arguments[Ht]));return Zt.join(" ")}for(var Ht=1,Dt=arguments,dt=Dt.length,Lt=String(Ft).replace(D,function(wt){if(wt==="%%")return"%";if(Ht>=dt)return wt;switch(wt){case"%s":return String(Dt[Ht++]);case"%d":return Number(Dt[Ht++]);case"%j":try{return JSON.stringify(Dt[Ht++])}catch{return"[Circular]"}default:return wt}}),bt=Dt[Ht];Ht<dt;bt=Dt[++Ht])J(bt)||!Et(bt)?Lt+=" "+bt:Lt+=" "+j(bt);return Lt},I.deprecate=function(Ft,Zt){if(typeof P<"u"&&P.noDeprecation===!0)return Ft;if(typeof P>"u")return function(){return I.deprecate(Ft,Zt).apply(this,arguments)};var Ht=!1;function Dt(){if(!Ht){if(P.throwDeprecation)throw new Error(Zt);P.traceDeprecation?console.trace(Zt):console.error(Zt),Ht=!0}return Ft.apply(this,arguments)}return Dt};var U={},Z=/^$/;if(P.env.NODE_DEBUG){var $=P.env.NODE_DEBUG;$=$.replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase(),Z=new RegExp("^"+$+"$","i")}I.debuglog=function(Ft){if(Ft=Ft.toUpperCase(),!U[Ft])if(Z.test(Ft)){var Zt=P.pid;U[Ft]=function(){var Ht=I.format.apply(I,arguments);console.error("%s %d: %s",Ft,Zt,Ht)}}else U[Ft]=function(){};return U[Ft]};function j(Ft,Zt){var Ht={seen:[],stylize:W};return arguments.length>=3&&(Ht.depth=arguments[2]),arguments.length>=4&&(Ht.colors=arguments[3]),ot(Zt)?Ht.showHidden=Zt:Zt&&I._extend(Ht,Zt),ct(Ht.showHidden)&&(Ht.showHidden=!1),ct(Ht.depth)&&(Ht.depth=2),ct(Ht.colors)&&(Ht.colors=!1),ct(Ht.customInspect)&&(Ht.customInspect=!0),Ht.colors&&(Ht.stylize=H),Q(Ht,Ft,Ht.depth)}I.inspect=j,j.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},j.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function H(Ft,Zt){var Ht=j.styles[Zt];return Ht?"\x1B["+j.colors[Ht][0]+"m"+Ft+"\x1B["+j.colors[Ht][1]+"m":Ft}function W(Ft,Zt){return Ft}function V(Ft){var Zt={};return Ft.forEach(function(Ht,Dt){Zt[Ht]=!0}),Zt}function Q(Ft,Zt,Ht){if(Ft.customInspect&&Zt&&vt(Zt.inspect)&&Zt.inspect!==I.inspect&&!(Zt.constructor&&Zt.constructor.prototype===Zt)){var Dt=Zt.inspect(Ht,Ft);return ut(Dt)||(Dt=Q(Ft,Dt,Ht)),Dt}var dt=K(Ft,Zt);if(dt)return dt;var Lt=Object.keys(Zt),bt=V(Lt);if(Ft.showHidden&&(Lt=Object.getOwnPropertyNames(Zt)),pt(Zt)&&(Lt.indexOf("message")>=0||Lt.indexOf("description")>=0))return q(Zt);if(Lt.length===0){if(vt(Zt)){var wt=Zt.name?": "+Zt.name:"";return Ft.stylize("[Function"+wt+"]","special")}if(At(Zt))return Ft.stylize(RegExp.prototype.toString.call(Zt),"regexp");if(gt(Zt))return Ft.stylize(Date.prototype.toString.call(Zt),"date");if(pt(Zt))return q(Zt)}var xt="",Rt=!1,Gt=["{","}"];if(rt(Zt)&&(Rt=!0,Gt=["[","]"]),vt(Zt)){var nt=Zt.name?": "+Zt.name:"";xt=" [Function"+nt+"]"}if(At(Zt)&&(xt=" "+RegExp.prototype.toString.call(Zt)),gt(Zt)&&(xt=" "+Date.prototype.toUTCString.call(Zt)),pt(Zt)&&(xt=" "+q(Zt)),Lt.length===0&&(!Rt||Zt.length==0))return Gt[0]+xt+Gt[1];if(Ht<0)return At(Zt)?Ft.stylize(RegExp.prototype.toString.call(Zt),"regexp"):Ft.stylize("[Object]","special");Ft.seen.push(Zt);var ht;return Rt?ht=et(Ft,Zt,Ht,bt,Lt):ht=Lt.map(function(ft){return X(Ft,Zt,Ht,bt,ft,Rt)}),Ft.seen.pop(),tt(ht,xt,Gt)}function K(Ft,Zt){if(ct(Zt))return Ft.stylize("undefined","undefined");if(ut(Zt)){var Ht="'"+JSON.stringify(Zt).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return Ft.stylize(Ht,"string")}if(st(Zt))return Ft.stylize(""+Zt,"number");if(ot(Zt))return Ft.stylize(""+Zt,"boolean");if(J(Zt))return Ft.stylize("null","null")}function q(Ft){return"["+Error.prototype.toString.call(Ft)+"]"}function et(Ft,Zt,Ht,Dt,dt){for(var Lt=[],bt=0,wt=Zt.length;bt<wt;++bt)Ot(Zt,String(bt))?Lt.push(X(Ft,Zt,Ht,Dt,String(bt),!0)):Lt.push("");return dt.forEach(function(xt){xt.match(/^\d+$/)||Lt.push(X(Ft,Zt,Ht,Dt,xt,!0))}),Lt}function X(Ft,Zt,Ht,Dt,dt,Lt){var bt,wt,xt;if(xt=Object.getOwnPropertyDescriptor(Zt,dt)||{value:Zt[dt]},xt.get?xt.set?wt=Ft.stylize("[Getter/Setter]","special"):wt=Ft.stylize("[Getter]","special"):xt.set&&(wt=Ft.stylize("[Setter]","special")),Ot(Dt,dt)||(bt="["+dt+"]"),wt||(Ft.seen.indexOf(xt.value)<0?(J(Ht)?wt=Q(Ft,xt.value,null):wt=Q(Ft,xt.value,Ht-1),wt.indexOf(`
`)>-1&&(Lt?wt=wt.split(`
`).map(function(Rt){return"  "+Rt}).join(`
`).slice(2):wt=`
`+wt.split(`
`).map(function(Rt){return"   "+Rt}).join(`
`))):wt=Ft.stylize("[Circular]","special")),ct(bt)){if(Lt&&dt.match(/^\d+$/))return wt;bt=JSON.stringify(""+dt),bt.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(bt=bt.slice(1,-1),bt=Ft.stylize(bt,"name")):(bt=bt.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),bt=Ft.stylize(bt,"string"))}return bt+": "+wt}function tt(Ft,Zt,Ht){var Dt=Ft.reduce(function(dt,Lt){return Lt.indexOf(`
`)>=0,dt+Lt.replace(/\u001b\[\d\d?m/g,"").length+1},0);return Dt>60?Ht[0]+(Zt===""?"":Zt+`
 `)+" "+Ft.join(`,
  `)+" "+Ht[1]:Ht[0]+Zt+" "+Ft.join(", ")+" "+Ht[1]}I.types=g("./support/types");function rt(Ft){return Array.isArray(Ft)}I.isArray=rt;function ot(Ft){return typeof Ft=="boolean"}I.isBoolean=ot;function J(Ft){return Ft===null}I.isNull=J;function lt(Ft){return Ft==null}I.isNullOrUndefined=lt;function st(Ft){return typeof Ft=="number"}I.isNumber=st;function ut(Ft){return typeof Ft=="string"}I.isString=ut;function it(Ft){return typeof Ft=="symbol"}I.isSymbol=it;function ct(Ft){return Ft===void 0}I.isUndefined=ct;function At(Ft){return Et(Ft)&&It(Ft)==="[object RegExp]"}I.isRegExp=At,I.types.isRegExp=At;function Et(Ft){return typeof Ft=="object"&&Ft!==null}I.isObject=Et;function gt(Ft){return Et(Ft)&&It(Ft)==="[object Date]"}I.isDate=gt,I.types.isDate=gt;function pt(Ft){return Et(Ft)&&(It(Ft)==="[object Error]"||Ft instanceof Error)}I.isError=pt,I.types.isNativeError=pt;function vt(Ft){return typeof Ft=="function"}I.isFunction=vt;function Tt(Ft){return Ft===null||typeof Ft=="boolean"||typeof Ft=="number"||typeof Ft=="string"||typeof Ft=="symbol"||typeof Ft>"u"}I.isPrimitive=Tt,I.isBuffer=g("./support/isBuffer");function It(Ft){return Object.prototype.toString.call(Ft)}function $t(Ft){return Ft<10?"0"+Ft.toString(10):Ft.toString(10)}var Bt=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function zt(){var Ft=new Date,Zt=[$t(Ft.getHours()),$t(Ft.getMinutes()),$t(Ft.getSeconds())].join(":");return[Ft.getDate(),Bt[Ft.getMonth()],Zt].join(" ")}I.log=function(){console.log("%s - %s",zt(),I.format.apply(I,arguments))},I.inherits=g("inherits"),I._extend=function(Ft,Zt){if(!Zt||!Et(Zt))return Ft;for(var Ht=Object.keys(Zt),Dt=Ht.length;Dt--;)Ft[Ht[Dt]]=Zt[Ht[Dt]];return Ft};function Ot(Ft,Zt){return Object.prototype.hasOwnProperty.call(Ft,Zt)}var Nt=typeof Symbol<"u"?Symbol("util.promisify.custom"):void 0;I.promisify=function(Zt){if(typeof Zt!="function")throw new TypeError('The "original" argument must be of type Function');if(Nt&&Zt[Nt]){var Ht=Zt[Nt];if(typeof Ht!="function")throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(Ht,Nt,{value:Ht,enumerable:!1,writable:!1,configurable:!0}),Ht}function Ht(){for(var Dt,dt,Lt=new Promise(function(xt,Rt){Dt=xt,dt=Rt}),bt=[],wt=0;wt<arguments.length;wt++)bt.push(arguments[wt]);bt.push(function(xt,Rt){xt?dt(xt):Dt(Rt)});try{Zt.apply(this,bt)}catch(xt){dt(xt)}return Lt}return Object.setPrototypeOf(Ht,Object.getPrototypeOf(Zt)),Nt&&Object.defineProperty(Ht,Nt,{value:Ht,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(Ht,F(Zt))},I.promisify.custom=Nt;function Pt(Ft,Zt){if(!Ft){var Ht=new Error("Promise was rejected with a falsy value");Ht.reason=Ft,Ft=Ht}return Zt(Ft)}function Ut(Ft){if(typeof Ft!="function")throw new TypeError('The "original" argument must be of type Function');function Zt(){for(var Ht=[],Dt=0;Dt<arguments.length;Dt++)Ht.push(arguments[Dt]);var dt=Ht.pop();if(typeof dt!="function")throw new TypeError("The last argument must be of type Function");var Lt=this,bt=function(){return dt.apply(Lt,arguments)};Ft.apply(this,Ht).then(function(wt){P.nextTick(bt.bind(null,null,wt))},function(wt){P.nextTick(Pt.bind(null,wt,bt))})}return Object.setPrototypeOf(Zt,Object.getPrototypeOf(Ft)),Object.defineProperties(Zt,F(Ft)),Zt}I.callbackify=Ut}).call(this)}).call(this,g("_process"))},{"./support/isBuffer":82,"./support/types":83,_process:63,inherits:46}],85:[function(g,w,I){(function(P){(function(){var F=g("for-each"),D=g("available-typed-arrays"),U=g("call-bind/callBound"),Z=g("gopd"),$=U("Object.prototype.toString"),j=g("has-tostringtag/shams")(),H=typeof globalThis>"u"?P:globalThis,W=D(),V=U("String.prototype.slice"),Q={},K=Object.getPrototypeOf;j&&Z&&K&&F(W,function(X){if(typeof H[X]=="function"){var tt=new H[X];if(Symbol.toStringTag in tt){var rt=K(tt),ot=Z(rt,Symbol.toStringTag);if(!ot){var J=K(rt);ot=Z(J,Symbol.toStringTag)}Q[X]=ot.get}}});var q=function(tt){var rt=!1;return F(Q,function(ot,J){if(!rt)try{var lt=ot.call(tt);lt===J&&(rt=lt)}catch{}}),rt},et=g("is-typed-array");w.exports=function(tt){return et(tt)?!j||!(Symbol.toStringTag in tt)?V($(tt),8,-1):q(tt):!1}}).call(this)}).call(this,typeof commonjsGlobal$1<"u"?commonjsGlobal$1:typeof self<"u"?self:typeof window<"u"?window:{})},{"available-typed-arrays":27,"call-bind/callBound":33,"for-each":36,gopd:40,"has-tostringtag/shams":43,"is-typed-array":50}]},{},[20])(20)})})(browser$2);var browserExports$1=browser$2.exports,commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(d){return d&&d.__esModule&&Object.prototype.hasOwnProperty.call(d,"default")?d.default:d}function getAugmentedNamespace(d){if(d.__esModule)return d;var m=d.default;if(typeof m=="function"){var g=function w(){return this instanceof w?Reflect.construct(m,arguments,this.constructor):m.apply(this,arguments)};g.prototype=m.prototype}else g={};return Object.defineProperty(g,"__esModule",{value:!0}),Object.keys(d).forEach(function(w){var I=Object.getOwnPropertyDescriptor(d,w);Object.defineProperty(g,w,I.get?I:{enumerable:!0,get:function(){return d[w]}})}),g}typeof self>"u"&&typeof commonjsGlobal=="object"&&(commonjsGlobal.self=commonjsGlobal);var global$1=typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{},lookup=[],revLookup=[],Arr=typeof Uint8Array<"u"?Uint8Array:Array,inited=!1;function init(){inited=!0;for(var d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",m=0;m<64;++m)lookup[m]=d[m],revLookup[d.charCodeAt(m)]=m;revLookup[45]=62,revLookup[95]=63}function toByteArray(d){var m,g,w,I,P,F;inited||init();var D=d.length;if(D%4>0)throw new Error("Invalid string. Length must be a multiple of 4");P=d[D-2]==="="?2:d[D-1]==="="?1:0,F=new Arr(3*D/4-P),w=P>0?D-4:D;var U=0;for(m=0,g=0;m<w;m+=4,g+=3)I=revLookup[d.charCodeAt(m)]<<18|revLookup[d.charCodeAt(m+1)]<<12|revLookup[d.charCodeAt(m+2)]<<6|revLookup[d.charCodeAt(m+3)],F[U++]=I>>16&255,F[U++]=I>>8&255,F[U++]=255&I;return P===2?(I=revLookup[d.charCodeAt(m)]<<2|revLookup[d.charCodeAt(m+1)]>>4,F[U++]=255&I):P===1&&(I=revLookup[d.charCodeAt(m)]<<10|revLookup[d.charCodeAt(m+1)]<<4|revLookup[d.charCodeAt(m+2)]>>2,F[U++]=I>>8&255,F[U++]=255&I),F}function tripletToBase64(d){return lookup[d>>18&63]+lookup[d>>12&63]+lookup[d>>6&63]+lookup[63&d]}function encodeChunk(d,m,g){for(var w,I=[],P=m;P<g;P+=3)w=(d[P]<<16)+(d[P+1]<<8)+d[P+2],I.push(tripletToBase64(w));return I.join("")}function fromByteArray(d){var m;inited||init();for(var g=d.length,w=g%3,I="",P=[],F=16383,D=0,U=g-w;D<U;D+=F)P.push(encodeChunk(d,D,D+F>U?U:D+F));return w===1?(m=d[g-1],I+=lookup[m>>2],I+=lookup[m<<4&63],I+="=="):w===2&&(m=(d[g-2]<<8)+d[g-1],I+=lookup[m>>10],I+=lookup[m>>4&63],I+=lookup[m<<2&63],I+="="),P.push(I),P.join("")}function read(d,m,g,w,I){var P,F,D=8*I-w-1,U=(1<<D)-1,Z=U>>1,$=-7,j=g?I-1:0,H=g?-1:1,W=d[m+j];for(j+=H,P=W&(1<<-$)-1,W>>=-$,$+=D;$>0;P=256*P+d[m+j],j+=H,$-=8);for(F=P&(1<<-$)-1,P>>=-$,$+=w;$>0;F=256*F+d[m+j],j+=H,$-=8);if(P===0)P=1-Z;else{if(P===U)return F?NaN:1/0*(W?-1:1);F+=Math.pow(2,w),P-=Z}return(W?-1:1)*F*Math.pow(2,P-w)}function write(d,m,g,w,I,P){var F,D,U,Z=8*P-I-1,$=(1<<Z)-1,j=$>>1,H=I===23?Math.pow(2,-24)-Math.pow(2,-77):0,W=w?0:P-1,V=w?1:-1,Q=m<0||m===0&&1/m<0?1:0;for(m=Math.abs(m),isNaN(m)||m===1/0?(D=isNaN(m)?1:0,F=$):(F=Math.floor(Math.log(m)/Math.LN2),m*(U=Math.pow(2,-F))<1&&(F--,U*=2),(m+=F+j>=1?H/U:H*Math.pow(2,1-j))*U>=2&&(F++,U/=2),F+j>=$?(D=0,F=$):F+j>=1?(D=(m*U-1)*Math.pow(2,I),F+=j):(D=m*Math.pow(2,j-1)*Math.pow(2,I),F=0));I>=8;d[g+W]=255&D,W+=V,D/=256,I-=8);for(F=F<<I|D,Z+=I;Z>0;d[g+W]=255&F,W+=V,F/=256,Z-=8);d[g+W-V]|=128*Q}var toString={}.toString,isArray$1=Array.isArray||function(d){return toString.call(d)=="[object Array]"},INSPECT_MAX_BYTES=50;function kMaxLength(){return Buffer$2.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function createBuffer(d,m){if(kMaxLength()<m)throw new RangeError("Invalid typed array length");return Buffer$2.TYPED_ARRAY_SUPPORT?(d=new Uint8Array(m)).__proto__=Buffer$2.prototype:(d===null&&(d=new Buffer$2(m)),d.length=m),d}function Buffer$2(d,m,g){if(!(Buffer$2.TYPED_ARRAY_SUPPORT||this instanceof Buffer$2))return new Buffer$2(d,m,g);if(typeof d=="number"){if(typeof m=="string")throw new Error("If encoding is specified then the first argument must be a string");return allocUnsafe(this,d)}return from(this,d,m,g)}function from(d,m,g,w){if(typeof m=="number")throw new TypeError('"value" argument must not be a number');return typeof ArrayBuffer<"u"&&m instanceof ArrayBuffer?fromArrayBuffer(d,m,g,w):typeof m=="string"?fromString(d,m,g):fromObject(d,m)}function assertSize(d){if(typeof d!="number")throw new TypeError('"size" argument must be a number');if(d<0)throw new RangeError('"size" argument must not be negative')}function alloc(d,m,g,w){return assertSize(m),m<=0?createBuffer(d,m):g!==void 0?typeof w=="string"?createBuffer(d,m).fill(g,w):createBuffer(d,m).fill(g):createBuffer(d,m)}function allocUnsafe(d,m){if(assertSize(m),d=createBuffer(d,m<0?0:0|checked(m)),!Buffer$2.TYPED_ARRAY_SUPPORT)for(var g=0;g<m;++g)d[g]=0;return d}function fromString(d,m,g){if(typeof g=="string"&&g!==""||(g="utf8"),!Buffer$2.isEncoding(g))throw new TypeError('"encoding" must be a valid string encoding');var w=0|byteLength(m,g),I=(d=createBuffer(d,w)).write(m,g);return I!==w&&(d=d.slice(0,I)),d}function fromArrayLike(d,m){var g=m.length<0?0:0|checked(m.length);d=createBuffer(d,g);for(var w=0;w<g;w+=1)d[w]=255&m[w];return d}function fromArrayBuffer(d,m,g,w){if(m.byteLength,g<0||m.byteLength<g)throw new RangeError("'offset' is out of bounds");if(m.byteLength<g+(w||0))throw new RangeError("'length' is out of bounds");return m=g===void 0&&w===void 0?new Uint8Array(m):w===void 0?new Uint8Array(m,g):new Uint8Array(m,g,w),Buffer$2.TYPED_ARRAY_SUPPORT?(d=m).__proto__=Buffer$2.prototype:d=fromArrayLike(d,m),d}function fromObject(d,m){if(internalIsBuffer(m)){var g=0|checked(m.length);return(d=createBuffer(d,g)).length===0||m.copy(d,0,0,g),d}if(m){if(typeof ArrayBuffer<"u"&&m.buffer instanceof ArrayBuffer||"length"in m)return typeof m.length!="number"||isnan(m.length)?createBuffer(d,0):fromArrayLike(d,m);if(m.type==="Buffer"&&isArray$1(m.data))return fromArrayLike(d,m.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function checked(d){if(d>=kMaxLength())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+kMaxLength().toString(16)+" bytes");return 0|d}function internalIsBuffer(d){return!(d==null||!d._isBuffer)}function byteLength(d,m){if(internalIsBuffer(d))return d.length;if(typeof ArrayBuffer<"u"&&typeof ArrayBuffer.isView=="function"&&(ArrayBuffer.isView(d)||d instanceof ArrayBuffer))return d.byteLength;typeof d!="string"&&(d=""+d);var g=d.length;if(g===0)return 0;for(var w=!1;;)switch(m){case"ascii":case"latin1":case"binary":return g;case"utf8":case"utf-8":case void 0:return utf8ToBytes(d).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*g;case"hex":return g>>>1;case"base64":return base64ToBytes(d).length;default:if(w)return utf8ToBytes(d).length;m=(""+m).toLowerCase(),w=!0}}function slowToString(d,m,g){var w=!1;if((m===void 0||m<0)&&(m=0),m>this.length||((g===void 0||g>this.length)&&(g=this.length),g<=0)||(g>>>=0)<=(m>>>=0))return"";for(d||(d="utf8");;)switch(d){case"hex":return hexSlice(this,m,g);case"utf8":case"utf-8":return utf8Slice(this,m,g);case"ascii":return asciiSlice(this,m,g);case"latin1":case"binary":return latin1Slice(this,m,g);case"base64":return base64Slice(this,m,g);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return utf16leSlice(this,m,g);default:if(w)throw new TypeError("Unknown encoding: "+d);d=(d+"").toLowerCase(),w=!0}}function swap(d,m,g){var w=d[m];d[m]=d[g],d[g]=w}function bidirectionalIndexOf(d,m,g,w,I){if(d.length===0)return-1;if(typeof g=="string"?(w=g,g=0):g>2147483647?g=2147483647:g<-2147483648&&(g=-2147483648),g=+g,isNaN(g)&&(g=I?0:d.length-1),g<0&&(g=d.length+g),g>=d.length){if(I)return-1;g=d.length-1}else if(g<0){if(!I)return-1;g=0}if(typeof m=="string"&&(m=Buffer$2.from(m,w)),internalIsBuffer(m))return m.length===0?-1:arrayIndexOf(d,m,g,w,I);if(typeof m=="number")return m&=255,Buffer$2.TYPED_ARRAY_SUPPORT&&typeof Uint8Array.prototype.indexOf=="function"?I?Uint8Array.prototype.indexOf.call(d,m,g):Uint8Array.prototype.lastIndexOf.call(d,m,g):arrayIndexOf(d,[m],g,w,I);throw new TypeError("val must be string, number or Buffer")}function arrayIndexOf(d,m,g,w,I){var P,F=1,D=d.length,U=m.length;if(w!==void 0&&((w=String(w).toLowerCase())==="ucs2"||w==="ucs-2"||w==="utf16le"||w==="utf-16le")){if(d.length<2||m.length<2)return-1;F=2,D/=2,U/=2,g/=2}function Z(W,V){return F===1?W[V]:W.readUInt16BE(V*F)}if(I){var $=-1;for(P=g;P<D;P++)if(Z(d,P)===Z(m,$===-1?0:P-$)){if($===-1&&($=P),P-$+1===U)return $*F}else $!==-1&&(P-=P-$),$=-1}else for(g+U>D&&(g=D-U),P=g;P>=0;P--){for(var j=!0,H=0;H<U;H++)if(Z(d,P+H)!==Z(m,H)){j=!1;break}if(j)return P}return-1}function hexWrite(d,m,g,w){g=Number(g)||0;var I=d.length-g;w?(w=Number(w))>I&&(w=I):w=I;var P=m.length;if(P%2!=0)throw new TypeError("Invalid hex string");w>P/2&&(w=P/2);for(var F=0;F<w;++F){var D=parseInt(m.substr(2*F,2),16);if(isNaN(D))return F;d[g+F]=D}return F}function utf8Write(d,m,g,w){return blitBuffer(utf8ToBytes(m,d.length-g),d,g,w)}function asciiWrite(d,m,g,w){return blitBuffer(asciiToBytes(m),d,g,w)}function latin1Write(d,m,g,w){return asciiWrite(d,m,g,w)}function base64Write(d,m,g,w){return blitBuffer(base64ToBytes(m),d,g,w)}function ucs2Write(d,m,g,w){return blitBuffer(utf16leToBytes(m,d.length-g),d,g,w)}function base64Slice(d,m,g){return m===0&&g===d.length?fromByteArray(d):fromByteArray(d.slice(m,g))}function utf8Slice(d,m,g){g=Math.min(d.length,g);for(var w=[],I=m;I<g;){var P,F,D,U,Z=d[I],$=null,j=Z>239?4:Z>223?3:Z>191?2:1;if(I+j<=g)switch(j){case 1:Z<128&&($=Z);break;case 2:(192&(P=d[I+1]))==128&&(U=(31&Z)<<6|63&P)>127&&($=U);break;case 3:P=d[I+1],F=d[I+2],(192&P)==128&&(192&F)==128&&(U=(15&Z)<<12|(63&P)<<6|63&F)>2047&&(U<55296||U>57343)&&($=U);break;case 4:P=d[I+1],F=d[I+2],D=d[I+3],(192&P)==128&&(192&F)==128&&(192&D)==128&&(U=(15&Z)<<18|(63&P)<<12|(63&F)<<6|63&D)>65535&&U<1114112&&($=U)}$===null?($=65533,j=1):$>65535&&($-=65536,w.push($>>>10&1023|55296),$=56320|1023&$),w.push($),I+=j}return decodeCodePointsArray(w)}Buffer$2.TYPED_ARRAY_SUPPORT=global$1.TYPED_ARRAY_SUPPORT===void 0||global$1.TYPED_ARRAY_SUPPORT,kMaxLength(),Buffer$2.poolSize=8192,Buffer$2._augment=function(d){return d.__proto__=Buffer$2.prototype,d},Buffer$2.from=function(d,m,g){return from(null,d,m,g)},Buffer$2.TYPED_ARRAY_SUPPORT&&(Buffer$2.prototype.__proto__=Uint8Array.prototype,Buffer$2.__proto__=Uint8Array,typeof Symbol<"u"&&Symbol.species&&Buffer$2[Symbol.species]),Buffer$2.alloc=function(d,m,g){return alloc(null,d,m,g)},Buffer$2.allocUnsafe=function(d){return allocUnsafe(null,d)},Buffer$2.allocUnsafeSlow=function(d){return allocUnsafe(null,d)},Buffer$2.isBuffer=isBuffer,Buffer$2.compare=function(d,m){if(!internalIsBuffer(d)||!internalIsBuffer(m))throw new TypeError("Arguments must be Buffers");if(d===m)return 0;for(var g=d.length,w=m.length,I=0,P=Math.min(g,w);I<P;++I)if(d[I]!==m[I]){g=d[I],w=m[I];break}return g<w?-1:w<g?1:0},Buffer$2.isEncoding=function(d){switch(String(d).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Buffer$2.concat=function(d,m){if(!isArray$1(d))throw new TypeError('"list" argument must be an Array of Buffers');if(d.length===0)return Buffer$2.alloc(0);var g;if(m===void 0)for(m=0,g=0;g<d.length;++g)m+=d[g].length;var w=Buffer$2.allocUnsafe(m),I=0;for(g=0;g<d.length;++g){var P=d[g];if(!internalIsBuffer(P))throw new TypeError('"list" argument must be an Array of Buffers');P.copy(w,I),I+=P.length}return w},Buffer$2.byteLength=byteLength,Buffer$2.prototype._isBuffer=!0,Buffer$2.prototype.swap16=function(){var d=this.length;if(d%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var m=0;m<d;m+=2)swap(this,m,m+1);return this},Buffer$2.prototype.swap32=function(){var d=this.length;if(d%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var m=0;m<d;m+=4)swap(this,m,m+3),swap(this,m+1,m+2);return this},Buffer$2.prototype.swap64=function(){var d=this.length;if(d%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var m=0;m<d;m+=8)swap(this,m,m+7),swap(this,m+1,m+6),swap(this,m+2,m+5),swap(this,m+3,m+4);return this},Buffer$2.prototype.toString=function(){var d=0|this.length;return d===0?"":arguments.length===0?utf8Slice(this,0,d):slowToString.apply(this,arguments)},Buffer$2.prototype.equals=function(d){if(!internalIsBuffer(d))throw new TypeError("Argument must be a Buffer");return this===d||Buffer$2.compare(this,d)===0},Buffer$2.prototype.inspect=function(){var d="",m=INSPECT_MAX_BYTES;return this.length>0&&(d=this.toString("hex",0,m).match(/.{2}/g).join(" "),this.length>m&&(d+=" ... ")),"<Buffer "+d+">"},Buffer$2.prototype.compare=function(d,m,g,w,I){if(!internalIsBuffer(d))throw new TypeError("Argument must be a Buffer");if(m===void 0&&(m=0),g===void 0&&(g=d?d.length:0),w===void 0&&(w=0),I===void 0&&(I=this.length),m<0||g>d.length||w<0||I>this.length)throw new RangeError("out of range index");if(w>=I&&m>=g)return 0;if(w>=I)return-1;if(m>=g)return 1;if(this===d)return 0;for(var P=(I>>>=0)-(w>>>=0),F=(g>>>=0)-(m>>>=0),D=Math.min(P,F),U=this.slice(w,I),Z=d.slice(m,g),$=0;$<D;++$)if(U[$]!==Z[$]){P=U[$],F=Z[$];break}return P<F?-1:F<P?1:0},Buffer$2.prototype.includes=function(d,m,g){return this.indexOf(d,m,g)!==-1},Buffer$2.prototype.indexOf=function(d,m,g){return bidirectionalIndexOf(this,d,m,g,!0)},Buffer$2.prototype.lastIndexOf=function(d,m,g){return bidirectionalIndexOf(this,d,m,g,!1)},Buffer$2.prototype.write=function(d,m,g,w){if(m===void 0)w="utf8",g=this.length,m=0;else if(g===void 0&&typeof m=="string")w=m,g=this.length,m=0;else{if(!isFinite(m))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");m|=0,isFinite(g)?(g|=0,w===void 0&&(w="utf8")):(w=g,g=void 0)}var I=this.length-m;if((g===void 0||g>I)&&(g=I),d.length>0&&(g<0||m<0)||m>this.length)throw new RangeError("Attempt to write outside buffer bounds");w||(w="utf8");for(var P=!1;;)switch(w){case"hex":return hexWrite(this,d,m,g);case"utf8":case"utf-8":return utf8Write(this,d,m,g);case"ascii":return asciiWrite(this,d,m,g);case"latin1":case"binary":return latin1Write(this,d,m,g);case"base64":return base64Write(this,d,m,g);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ucs2Write(this,d,m,g);default:if(P)throw new TypeError("Unknown encoding: "+w);w=(""+w).toLowerCase(),P=!0}},Buffer$2.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var MAX_ARGUMENTS_LENGTH=4096;function decodeCodePointsArray(d){var m=d.length;if(m<=MAX_ARGUMENTS_LENGTH)return String.fromCharCode.apply(String,d);for(var g="",w=0;w<m;)g+=String.fromCharCode.apply(String,d.slice(w,w+=MAX_ARGUMENTS_LENGTH));return g}function asciiSlice(d,m,g){var w="";g=Math.min(d.length,g);for(var I=m;I<g;++I)w+=String.fromCharCode(127&d[I]);return w}function latin1Slice(d,m,g){var w="";g=Math.min(d.length,g);for(var I=m;I<g;++I)w+=String.fromCharCode(d[I]);return w}function hexSlice(d,m,g){var w=d.length;(!m||m<0)&&(m=0),(!g||g<0||g>w)&&(g=w);for(var I="",P=m;P<g;++P)I+=toHex(d[P]);return I}function utf16leSlice(d,m,g){for(var w=d.slice(m,g),I="",P=0;P<w.length;P+=2)I+=String.fromCharCode(w[P]+256*w[P+1]);return I}function checkOffset(d,m,g){if(d%1!=0||d<0)throw new RangeError("offset is not uint");if(d+m>g)throw new RangeError("Trying to access beyond buffer length")}function checkInt(d,m,g,w,I,P){if(!internalIsBuffer(d))throw new TypeError('"buffer" argument must be a Buffer instance');if(m>I||m<P)throw new RangeError('"value" argument is out of bounds');if(g+w>d.length)throw new RangeError("Index out of range")}function objectWriteUInt16(d,m,g,w){m<0&&(m=65535+m+1);for(var I=0,P=Math.min(d.length-g,2);I<P;++I)d[g+I]=(m&255<<8*(w?I:1-I))>>>8*(w?I:1-I)}function objectWriteUInt32(d,m,g,w){m<0&&(m=4294967295+m+1);for(var I=0,P=Math.min(d.length-g,4);I<P;++I)d[g+I]=m>>>8*(w?I:3-I)&255}function checkIEEE754(d,m,g,w,I,P){if(g+w>d.length)throw new RangeError("Index out of range");if(g<0)throw new RangeError("Index out of range")}function writeFloat(d,m,g,w,I){return I||checkIEEE754(d,m,g,4),write(d,m,g,w,23,4),g+4}function writeDouble(d,m,g,w,I){return I||checkIEEE754(d,m,g,8),write(d,m,g,w,52,8),g+8}Buffer$2.prototype.slice=function(d,m){var g,w=this.length;if((d=~~d)<0?(d+=w)<0&&(d=0):d>w&&(d=w),(m=m===void 0?w:~~m)<0?(m+=w)<0&&(m=0):m>w&&(m=w),m<d&&(m=d),Buffer$2.TYPED_ARRAY_SUPPORT)(g=this.subarray(d,m)).__proto__=Buffer$2.prototype;else{var I=m-d;g=new Buffer$2(I,void 0);for(var P=0;P<I;++P)g[P]=this[P+d]}return g},Buffer$2.prototype.readUIntLE=function(d,m,g){d|=0,m|=0,g||checkOffset(d,m,this.length);for(var w=this[d],I=1,P=0;++P<m&&(I*=256);)w+=this[d+P]*I;return w},Buffer$2.prototype.readUIntBE=function(d,m,g){d|=0,m|=0,g||checkOffset(d,m,this.length);for(var w=this[d+--m],I=1;m>0&&(I*=256);)w+=this[d+--m]*I;return w},Buffer$2.prototype.readUInt8=function(d,m){return m||checkOffset(d,1,this.length),this[d]},Buffer$2.prototype.readUInt16LE=function(d,m){return m||checkOffset(d,2,this.length),this[d]|this[d+1]<<8},Buffer$2.prototype.readUInt16BE=function(d,m){return m||checkOffset(d,2,this.length),this[d]<<8|this[d+1]},Buffer$2.prototype.readUInt32LE=function(d,m){return m||checkOffset(d,4,this.length),(this[d]|this[d+1]<<8|this[d+2]<<16)+16777216*this[d+3]},Buffer$2.prototype.readUInt32BE=function(d,m){return m||checkOffset(d,4,this.length),16777216*this[d]+(this[d+1]<<16|this[d+2]<<8|this[d+3])},Buffer$2.prototype.readIntLE=function(d,m,g){d|=0,m|=0,g||checkOffset(d,m,this.length);for(var w=this[d],I=1,P=0;++P<m&&(I*=256);)w+=this[d+P]*I;return w>=(I*=128)&&(w-=Math.pow(2,8*m)),w},Buffer$2.prototype.readIntBE=function(d,m,g){d|=0,m|=0,g||checkOffset(d,m,this.length);for(var w=m,I=1,P=this[d+--w];w>0&&(I*=256);)P+=this[d+--w]*I;return P>=(I*=128)&&(P-=Math.pow(2,8*m)),P},Buffer$2.prototype.readInt8=function(d,m){return m||checkOffset(d,1,this.length),128&this[d]?-1*(255-this[d]+1):this[d]},Buffer$2.prototype.readInt16LE=function(d,m){m||checkOffset(d,2,this.length);var g=this[d]|this[d+1]<<8;return 32768&g?4294901760|g:g},Buffer$2.prototype.readInt16BE=function(d,m){m||checkOffset(d,2,this.length);var g=this[d+1]|this[d]<<8;return 32768&g?4294901760|g:g},Buffer$2.prototype.readInt32LE=function(d,m){return m||checkOffset(d,4,this.length),this[d]|this[d+1]<<8|this[d+2]<<16|this[d+3]<<24},Buffer$2.prototype.readInt32BE=function(d,m){return m||checkOffset(d,4,this.length),this[d]<<24|this[d+1]<<16|this[d+2]<<8|this[d+3]},Buffer$2.prototype.readFloatLE=function(d,m){return m||checkOffset(d,4,this.length),read(this,d,!0,23,4)},Buffer$2.prototype.readFloatBE=function(d,m){return m||checkOffset(d,4,this.length),read(this,d,!1,23,4)},Buffer$2.prototype.readDoubleLE=function(d,m){return m||checkOffset(d,8,this.length),read(this,d,!0,52,8)},Buffer$2.prototype.readDoubleBE=function(d,m){return m||checkOffset(d,8,this.length),read(this,d,!1,52,8)},Buffer$2.prototype.writeUIntLE=function(d,m,g,w){d=+d,m|=0,g|=0,w||checkInt(this,d,m,g,Math.pow(2,8*g)-1,0);var I=1,P=0;for(this[m]=255&d;++P<g&&(I*=256);)this[m+P]=d/I&255;return m+g},Buffer$2.prototype.writeUIntBE=function(d,m,g,w){d=+d,m|=0,g|=0,w||checkInt(this,d,m,g,Math.pow(2,8*g)-1,0);var I=g-1,P=1;for(this[m+I]=255&d;--I>=0&&(P*=256);)this[m+I]=d/P&255;return m+g},Buffer$2.prototype.writeUInt8=function(d,m,g){return d=+d,m|=0,g||checkInt(this,d,m,1,255,0),Buffer$2.TYPED_ARRAY_SUPPORT||(d=Math.floor(d)),this[m]=255&d,m+1},Buffer$2.prototype.writeUInt16LE=function(d,m,g){return d=+d,m|=0,g||checkInt(this,d,m,2,65535,0),Buffer$2.TYPED_ARRAY_SUPPORT?(this[m]=255&d,this[m+1]=d>>>8):objectWriteUInt16(this,d,m,!0),m+2},Buffer$2.prototype.writeUInt16BE=function(d,m,g){return d=+d,m|=0,g||checkInt(this,d,m,2,65535,0),Buffer$2.TYPED_ARRAY_SUPPORT?(this[m]=d>>>8,this[m+1]=255&d):objectWriteUInt16(this,d,m,!1),m+2},Buffer$2.prototype.writeUInt32LE=function(d,m,g){return d=+d,m|=0,g||checkInt(this,d,m,4,4294967295,0),Buffer$2.TYPED_ARRAY_SUPPORT?(this[m+3]=d>>>24,this[m+2]=d>>>16,this[m+1]=d>>>8,this[m]=255&d):objectWriteUInt32(this,d,m,!0),m+4},Buffer$2.prototype.writeUInt32BE=function(d,m,g){return d=+d,m|=0,g||checkInt(this,d,m,4,4294967295,0),Buffer$2.TYPED_ARRAY_SUPPORT?(this[m]=d>>>24,this[m+1]=d>>>16,this[m+2]=d>>>8,this[m+3]=255&d):objectWriteUInt32(this,d,m,!1),m+4},Buffer$2.prototype.writeIntLE=function(d,m,g,w){if(d=+d,m|=0,!w){var I=Math.pow(2,8*g-1);checkInt(this,d,m,g,I-1,-I)}var P=0,F=1,D=0;for(this[m]=255&d;++P<g&&(F*=256);)d<0&&D===0&&this[m+P-1]!==0&&(D=1),this[m+P]=(d/F|0)-D&255;return m+g},Buffer$2.prototype.writeIntBE=function(d,m,g,w){if(d=+d,m|=0,!w){var I=Math.pow(2,8*g-1);checkInt(this,d,m,g,I-1,-I)}var P=g-1,F=1,D=0;for(this[m+P]=255&d;--P>=0&&(F*=256);)d<0&&D===0&&this[m+P+1]!==0&&(D=1),this[m+P]=(d/F|0)-D&255;return m+g},Buffer$2.prototype.writeInt8=function(d,m,g){return d=+d,m|=0,g||checkInt(this,d,m,1,127,-128),Buffer$2.TYPED_ARRAY_SUPPORT||(d=Math.floor(d)),d<0&&(d=255+d+1),this[m]=255&d,m+1},Buffer$2.prototype.writeInt16LE=function(d,m,g){return d=+d,m|=0,g||checkInt(this,d,m,2,32767,-32768),Buffer$2.TYPED_ARRAY_SUPPORT?(this[m]=255&d,this[m+1]=d>>>8):objectWriteUInt16(this,d,m,!0),m+2},Buffer$2.prototype.writeInt16BE=function(d,m,g){return d=+d,m|=0,g||checkInt(this,d,m,2,32767,-32768),Buffer$2.TYPED_ARRAY_SUPPORT?(this[m]=d>>>8,this[m+1]=255&d):objectWriteUInt16(this,d,m,!1),m+2},Buffer$2.prototype.writeInt32LE=function(d,m,g){return d=+d,m|=0,g||checkInt(this,d,m,4,2147483647,-2147483648),Buffer$2.TYPED_ARRAY_SUPPORT?(this[m]=255&d,this[m+1]=d>>>8,this[m+2]=d>>>16,this[m+3]=d>>>24):objectWriteUInt32(this,d,m,!0),m+4},Buffer$2.prototype.writeInt32BE=function(d,m,g){return d=+d,m|=0,g||checkInt(this,d,m,4,2147483647,-2147483648),d<0&&(d=4294967295+d+1),Buffer$2.TYPED_ARRAY_SUPPORT?(this[m]=d>>>24,this[m+1]=d>>>16,this[m+2]=d>>>8,this[m+3]=255&d):objectWriteUInt32(this,d,m,!1),m+4},Buffer$2.prototype.writeFloatLE=function(d,m,g){return writeFloat(this,d,m,!0,g)},Buffer$2.prototype.writeFloatBE=function(d,m,g){return writeFloat(this,d,m,!1,g)},Buffer$2.prototype.writeDoubleLE=function(d,m,g){return writeDouble(this,d,m,!0,g)},Buffer$2.prototype.writeDoubleBE=function(d,m,g){return writeDouble(this,d,m,!1,g)},Buffer$2.prototype.copy=function(d,m,g,w){if(g||(g=0),w||w===0||(w=this.length),m>=d.length&&(m=d.length),m||(m=0),w>0&&w<g&&(w=g),w===g||d.length===0||this.length===0)return 0;if(m<0)throw new RangeError("targetStart out of bounds");if(g<0||g>=this.length)throw new RangeError("sourceStart out of bounds");if(w<0)throw new RangeError("sourceEnd out of bounds");w>this.length&&(w=this.length),d.length-m<w-g&&(w=d.length-m+g);var I,P=w-g;if(this===d&&g<m&&m<w)for(I=P-1;I>=0;--I)d[I+m]=this[I+g];else if(P<1e3||!Buffer$2.TYPED_ARRAY_SUPPORT)for(I=0;I<P;++I)d[I+m]=this[I+g];else Uint8Array.prototype.set.call(d,this.subarray(g,g+P),m);return P},Buffer$2.prototype.fill=function(d,m,g,w){if(typeof d=="string"){if(typeof m=="string"?(w=m,m=0,g=this.length):typeof g=="string"&&(w=g,g=this.length),d.length===1){var I=d.charCodeAt(0);I<256&&(d=I)}if(w!==void 0&&typeof w!="string")throw new TypeError("encoding must be a string");if(typeof w=="string"&&!Buffer$2.isEncoding(w))throw new TypeError("Unknown encoding: "+w)}else typeof d=="number"&&(d&=255);if(m<0||this.length<m||this.length<g)throw new RangeError("Out of range index");if(g<=m)return this;var P;if(m>>>=0,g=g===void 0?this.length:g>>>0,d||(d=0),typeof d=="number")for(P=m;P<g;++P)this[P]=d;else{var F=internalIsBuffer(d)?d:utf8ToBytes(new Buffer$2(d,w).toString()),D=F.length;for(P=0;P<g-m;++P)this[P+m]=F[P%D]}return this};var INVALID_BASE64_RE=/[^+\/0-9A-Za-z-_]/g,HeaderTypes;function base64clean(d){if((d=stringtrim(d).replace(INVALID_BASE64_RE,"")).length<2)return"";for(;d.length%4!=0;)d+="=";return d}function stringtrim(d){return d.trim?d.trim():d.replace(/^\s+|\s+$/g,"")}function toHex(d){return d<16?"0"+d.toString(16):d.toString(16)}function utf8ToBytes(d,m){var g;m=m||1/0;for(var w=d.length,I=null,P=[],F=0;F<w;++F){if((g=d.charCodeAt(F))>55295&&g<57344){if(!I){if(g>56319){(m-=3)>-1&&P.push(239,191,189);continue}if(F+1===w){(m-=3)>-1&&P.push(239,191,189);continue}I=g;continue}if(g<56320){(m-=3)>-1&&P.push(239,191,189),I=g;continue}g=65536+(I-55296<<10|g-56320)}else I&&(m-=3)>-1&&P.push(239,191,189);if(I=null,g<128){if((m-=1)<0)break;P.push(g)}else if(g<2048){if((m-=2)<0)break;P.push(g>>6|192,63&g|128)}else if(g<65536){if((m-=3)<0)break;P.push(g>>12|224,g>>6&63|128,63&g|128)}else{if(!(g<1114112))throw new Error("Invalid code point");if((m-=4)<0)break;P.push(g>>18|240,g>>12&63|128,g>>6&63|128,63&g|128)}}return P}function asciiToBytes(d){for(var m=[],g=0;g<d.length;++g)m.push(255&d.charCodeAt(g));return m}function utf16leToBytes(d,m){for(var g,w,I,P=[],F=0;F<d.length&&!((m-=2)<0);++F)w=(g=d.charCodeAt(F))>>8,I=g%256,P.push(I),P.push(w);return P}function base64ToBytes(d){return toByteArray(base64clean(d))}function blitBuffer(d,m,g,w){for(var I=0;I<w&&!(I+g>=m.length||I>=d.length);++I)m[I+g]=d[I];return I}function isnan(d){return d!=d}function isBuffer(d){return d!=null&&(!!d._isBuffer||isFastBuffer(d)||isSlowBuffer(d))}function isFastBuffer(d){return!!d.constructor&&typeof d.constructor.isBuffer=="function"&&d.constructor.isBuffer(d)}function isSlowBuffer(d){return typeof d.readFloatLE=="function"&&typeof d.slice=="function"&&isFastBuffer(d.slice(0,0))}(function(d){d[d.BITMAP_INFO_HEADER=40]="BITMAP_INFO_HEADER",d[d.BITMAP_V2_INFO_HEADER=52]="BITMAP_V2_INFO_HEADER",d[d.BITMAP_V3_INFO_HEADER=56]="BITMAP_V3_INFO_HEADER",d[d.BITMAP_V4_HEADER=108]="BITMAP_V4_HEADER",d[d.BITMAP_V5_HEADER=124]="BITMAP_V5_HEADER"})(HeaderTypes||(HeaderTypes={}));var HeaderTypes$1=HeaderTypes,BmpCompression;function maskColor(d,m,g,w){const I=1+~d&d,P=1+~m&m,F=1+~g&g,D=1+~w&w,U=d/I+1,Z=m/P+1,$=g/F+1,j=w/D+1;return{shiftRed:H=>(H&d)/I*256/U,shiftGreen:H=>(H&m)/P*256/Z,shiftBlue:H=>(H&g)/F*256/$,shiftAlpha:w!==0?H=>(H&w)/D*256/j:()=>255}}(function(d){d[d.NONE=0]="NONE",d[d.BI_RLE8=1]="BI_RLE8",d[d.BI_RLE4=2]="BI_RLE4",d[d.BI_BIT_FIELDS=3]="BI_BIT_FIELDS",d[d.BI_ALPHA_BIT_FIELDS=6]="BI_ALPHA_BIT_FIELDS"})(BmpCompression||(BmpCompression={}));class BmpDecoder{flag;fileSize;reserved1;reserved2;offset;headerSize;width;height;planes;bitPP;compression;rawSize;hr;vr;colors;importantColors;palette;data;maskRed;maskGreen;maskBlue;maskAlpha;toRGBA;pos;bottomUp;buffer;locRed;locGreen;locBlue;locAlpha;shiftRed;shiftGreen;shiftBlue;shiftAlpha;constructor(m,{toRGBA:g}={toRGBA:!1}){if(this.buffer=m,this.toRGBA=!!g,this.pos=0,this.bottomUp=!0,this.flag=this.buffer.toString("utf-8",0,this.pos+=2),this.flag!=="BM")throw new Error("Invalid BMP File");this.locRed=this.toRGBA?0:3,this.locGreen=this.toRGBA?1:2,this.locBlue=this.toRGBA?2:1,this.locAlpha=this.toRGBA?3:0,this.parseHeader(),this.parseRGBA()}parseHeader(){if(this.fileSize=this.readUInt32LE(),this.reserved1=this.buffer.readUInt16LE(this.pos),this.pos+=2,this.reserved2=this.buffer.readUInt16LE(this.pos),this.pos+=2,this.offset=this.readUInt32LE(),this.headerSize=this.readUInt32LE(),!(this.headerSize in HeaderTypes$1))throw new Error(`Unsupported BMP header size ${this.headerSize}`);if(this.width=this.readUInt32LE(),this.height=this.readUInt32LE(),this.height=this.height>2147483647?this.height-4294967296:this.height,this.planes=this.buffer.readUInt16LE(this.pos),this.pos+=2,this.bitPP=this.buffer.readUInt16LE(this.pos),this.pos+=2,this.compression=this.readUInt32LE(),this.rawSize=this.readUInt32LE(),this.hr=this.readUInt32LE(),this.vr=this.readUInt32LE(),this.colors=this.readUInt32LE(),this.importantColors=this.readUInt32LE(),this.bitPP===32?(this.maskAlpha=0,this.maskRed=16711680,this.maskGreen=65280,this.maskBlue=255):this.bitPP===16&&(this.maskAlpha=0,this.maskRed=31744,this.maskGreen=992,this.maskBlue=31),(this.headerSize>HeaderTypes$1.BITMAP_INFO_HEADER||this.compression===BmpCompression.BI_BIT_FIELDS||this.compression===BmpCompression.BI_ALPHA_BIT_FIELDS)&&(this.maskRed=this.readUInt32LE(),this.maskGreen=this.readUInt32LE(),this.maskBlue=this.readUInt32LE()),(this.headerSize>HeaderTypes$1.BITMAP_V2_INFO_HEADER||this.compression===BmpCompression.BI_ALPHA_BIT_FIELDS)&&(this.maskAlpha=this.readUInt32LE()),this.headerSize>HeaderTypes$1.BITMAP_V3_INFO_HEADER&&(this.pos+=HeaderTypes$1.BITMAP_V4_HEADER-HeaderTypes$1.BITMAP_V3_INFO_HEADER),this.headerSize>HeaderTypes$1.BITMAP_V4_HEADER&&(this.pos+=HeaderTypes$1.BITMAP_V5_HEADER-HeaderTypes$1.BITMAP_V4_HEADER),this.bitPP<=8||this.colors>0){const g=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(g);for(let w=0;w<g;w++){const I=this.buffer.readUInt8(this.pos++),P=this.buffer.readUInt8(this.pos++),F=this.buffer.readUInt8(this.pos++),D=this.buffer.readUInt8(this.pos++);this.palette[w]={red:F,green:P,blue:I,quad:D}}}this.height<0&&(this.height*=-1,this.bottomUp=!1);const m=maskColor(this.maskRed,this.maskGreen,this.maskBlue,this.maskAlpha);this.shiftRed=m.shiftRed,this.shiftGreen=m.shiftGreen,this.shiftBlue=m.shiftBlue,this.shiftAlpha=m.shiftAlpha}parseRGBA(){switch(this.data=Buffer$2.alloc(this.width*this.height*4),this.bitPP){case 1:this.bit1();break;case 4:this.bit4();break;case 8:this.bit8();break;case 16:this.bit16();break;case 24:this.bit24();break;default:this.bit32()}}bit1(){const m=Math.ceil(this.width/8),g=m%4,w=g!==0?4-g:0;this.scanImage(w,m,(I,P)=>{const F=this.buffer.readUInt8(this.pos++),D=P*this.width*4+8*I*4;for(let U=0;U<8&&8*I+U<this.width;U++){const Z=this.palette[F>>7-U&1];this.data[D+U*this.locAlpha]=0,this.data[D+4*U+this.locBlue]=Z.blue,this.data[D+4*U+this.locGreen]=Z.green,this.data[D+4*U+this.locRed]=Z.red}})}bit4(){if(this.compression===BmpCompression.BI_RLE4){this.data.fill(0);let m=!1,g=this.bottomUp?this.height-1:0,w=0;for(;w<this.data.length;){const I=this.buffer.readUInt8(this.pos++),P=this.buffer.readUInt8(this.pos++);if(I===0){if(P===0){g+=this.bottomUp?-1:1,w=g*this.width*4,m=!1;continue}if(P===1)break;if(P===2){const F=this.buffer.readUInt8(this.pos++),D=this.buffer.readUInt8(this.pos++);g+=this.bottomUp?-D:D,w+=D*this.width*4+4*F}else{let F=this.buffer.readUInt8(this.pos++);for(let D=0;D<P;D++)w=this.setPixelData(w,m?15&F:(240&F)>>4),1&D&&D+1<P&&(F=this.buffer.readUInt8(this.pos++)),m=!m;(P+1>>1&1)==1&&this.pos++}}else for(let F=0;F<I;F++)w=this.setPixelData(w,m?15&P:(240&P)>>4),m=!m}}else{const m=Math.ceil(this.width/2),g=m%4,w=g!==0?4-g:0;this.scanImage(w,m,(I,P)=>{const F=this.buffer.readUInt8(this.pos++),D=P*this.width*4+2*I*4,U=F>>4;let Z=this.palette[U];if(this.data[D]=0,this.data[D+1]=Z.blue,this.data[D+2]=Z.green,this.data[D+3]=Z.red,2*I+1>=this.width)return!1;const $=15&F;Z=this.palette[$],this.data[D+4]=0,this.data[D+4+1]=Z.blue,this.data[D+4+2]=Z.green,this.data[D+4+3]=Z.red})}}bit8(){if(this.compression===BmpCompression.BI_RLE8){this.data.fill(0);let m=this.bottomUp?this.height-1:0,g=0;for(;g<this.data.length;){const w=this.buffer.readUInt8(this.pos++),I=this.buffer.readUInt8(this.pos++);if(w===0){if(I===0){m+=this.bottomUp?-1:1,g=m*this.width*4;continue}if(I===1)break;if(I===2){const P=this.buffer.readUInt8(this.pos++),F=this.buffer.readUInt8(this.pos++);m+=this.bottomUp?-F:F,g+=F*this.width*4+4*P}else{for(let P=0;P<I;P++){const F=this.buffer.readUInt8(this.pos++);g=this.setPixelData(g,F)}!0&I&&this.pos++}}else for(let P=0;P<w;P++)g=this.setPixelData(g,I)}}else{const m=this.width%4,g=m!==0?4-m:0;this.scanImage(g,this.width,(w,I)=>{const P=this.buffer.readUInt8(this.pos++),F=I*this.width*4+4*w;if(P<this.palette.length){const D=this.palette[P];this.data[F]=0,this.data[F+1]=D.blue,this.data[F+2]=D.green,this.data[F+3]=D.red}else this.data[F]=0,this.data[F+1]=255,this.data[F+2]=255,this.data[F+3]=255})}}bit16(){const m=this.width%2*2;this.scanImage(m,this.width,(g,w)=>{const I=w*this.width*4+4*g,P=this.buffer.readUInt16LE(this.pos);this.pos+=2,this.data[I+this.locRed]=this.shiftRed(P),this.data[I+this.locGreen]=this.shiftGreen(P),this.data[I+this.locBlue]=this.shiftBlue(P),this.data[I+this.locAlpha]=this.shiftAlpha(P)})}bit24(){const m=this.width%4;this.scanImage(m,this.width,(g,w)=>{const I=w*this.width*4+4*g,P=this.buffer.readUInt8(this.pos++),F=this.buffer.readUInt8(this.pos++),D=this.buffer.readUInt8(this.pos++);this.data[I+this.locRed]=D,this.data[I+this.locGreen]=F,this.data[I+this.locBlue]=P,this.data[I+this.locAlpha]=0})}bit32(){this.scanImage(0,this.width,(m,g)=>{const w=g*this.width*4+4*m,I=this.readUInt32LE();this.data[w+this.locRed]=this.shiftRed(I),this.data[w+this.locGreen]=this.shiftGreen(I),this.data[w+this.locBlue]=this.shiftBlue(I),this.data[w+this.locAlpha]=this.shiftAlpha(I)})}scanImage(m=0,g=this.width,w){for(let I=this.height-1;I>=0;I--){const P=this.bottomUp?I:this.height-1-I;for(let F=0;F<g;F++)if(w.call(this,F,P)===!1)return;this.pos+=m}}readUInt32LE(){const m=this.buffer.readUInt32LE(this.pos);return this.pos+=4,m}setPixelData(m,g){const{blue:w,green:I,red:P}=this.palette[g];return this.data[m+this.locAlpha]=0,this.data[m+1+this.locBlue]=w,this.data[m+2+this.locGreen]=I,this.data[m+3+this.locRed]=P,m+4}}function createInteger(d){return d.reduce((m,g)=>m<<1|g,0)}function createColor(d){return d.quad<<24|d.red<<16|d.green<<8|d.blue}class BmpEncoder{fileSize;reserved1;reserved2;offset;width;flag;height;planes;bitPP;compress;hr;vr;colors;importantColors;rawSize;headerSize;data;palette;extraBytes;buffer;bytesInColor;pos;constructor(m){switch(this.buffer=m.data,this.width=m.width,this.height=m.height,this.headerSize=HeaderTypes$1.BITMAP_INFO_HEADER,this.flag="BM",this.bitPP=m.bitPP||24,this.offset=54,this.reserved1=m.reserved1||0,this.reserved2=m.reserved2||0,this.planes=1,this.compress=0,this.hr=m.hr||0,this.vr=m.vr||0,this.importantColors=m.importantColors||0,this.colors=Math.min(2**(this.bitPP-1||1),m.colors||1/0),this.palette=m.palette||[],this.colors&&this.bitPP<16?this.offset+=4*this.colors:this.colors=0,this.bitPP){case 32:this.bytesInColor=4;break;case 16:this.bytesInColor=2;break;case 8:this.bytesInColor=1;break;case 4:this.bytesInColor=.5;break;case 1:this.bytesInColor=1/8;break;default:this.bytesInColor=3,this.bitPP=24}const g=this.width*this.bitPP/32,w=Math.ceil(g);this.extraBytes=4*(w-g),this.rawSize=this.height*w*4+2,this.fileSize=this.rawSize+this.offset,this.data=Buffer$2.alloc(this.fileSize,1),this.pos=0,this.encode()}encode(){switch(this.pos=0,this.writeHeader(),this.bitPP){case 32:this.bit32();break;case 16:this.bit16();break;case 8:this.bit8();break;case 4:this.bit4();break;case 1:this.bit1();break;default:this.bit24()}}writeHeader(){this.data.write(this.flag,this.pos,2),this.pos+=2,this.writeUInt32LE(this.fileSize),this.writeUInt32LE(this.reserved1<<16|this.reserved2),this.writeUInt32LE(this.offset),this.writeUInt32LE(this.headerSize),this.writeUInt32LE(this.width),this.writeUInt32LE(this.height),this.data.writeUInt16LE(this.planes,this.pos),this.pos+=2,this.data.writeUInt16LE(this.bitPP,this.pos),this.pos+=2,this.writeUInt32LE(this.compress),this.writeUInt32LE(this.rawSize),this.writeUInt32LE(this.hr),this.writeUInt32LE(this.vr),this.writeUInt32LE(this.colors),this.writeUInt32LE(this.importantColors)}bit1(){this.palette.length&&this.colors===2?this.initColors(1):(this.writeUInt32LE(16777215),this.writeUInt32LE(0)),this.pos+=1;let m=[];this.writeImage((g,w,I)=>{let P=w;P++;const F=this.buffer[P++],D=this.buffer[P++],U=.2126*this.buffer[P++]+.7152*D+.0722*F;return m.push(U>127?0:1),(I+1)%8==0?(this.data[g-1]=createInteger(m),m=[]):I===this.width-1&&m.length>0&&(this.data[g-1]=createInteger(m)<<4,m=[]),P})}bit4(){const m=this.initColors(4);let g=[];this.writeImage((w,I,P)=>{let F=I;const D=createColor({quad:this.buffer[F++],blue:this.buffer[F++],green:this.buffer[F++],red:this.buffer[F++]}),U=m.findIndex(Z=>Z===D);return U!==-1?g.push(U):g.push(0),(P+1)%2==0&&(this.data[w]=g[0]<<4|g[1],g=[]),F})}bit8(){const m=this.initColors(8);this.writeImage((g,w)=>{let I=w;const P=createColor({quad:this.buffer[I++],blue:this.buffer[I++],green:this.buffer[I++],red:this.buffer[I++]}),F=m.findIndex(D=>D===P);return this.data[g]=F!==-1?F:0,I})}bit16(){this.writeImage((m,g)=>{let w=g+1;const I=this.buffer[w++]/8,P=this.buffer[w++]/8,F=this.buffer[w++]/8<<10|P<<5|I;return this.data[m]=255&F,this.data[m+1]=(65280&F)>>8,w})}bit24(){this.writeImage((m,g)=>{let w=g+1;return this.data[m]=this.buffer[w++],this.data[m+1]=this.buffer[w++],this.data[m+2]=this.buffer[w++],w})}bit32(){this.writeImage((m,g)=>{let w=g;return this.data[m+3]=this.buffer[w++],this.data[m]=this.buffer[w++],this.data[m+1]=this.buffer[w++],this.data[m+2]=this.buffer[w++],w})}writeImage(m){const g=this.extraBytes+this.width*this.bytesInColor;let w=0;for(let I=0;I<this.height;I++)for(let P=0;P<this.width;P++){const F=Math.floor(this.pos+(this.height-1-I)*g+P*this.bytesInColor);w=m.call(this,F,w,P,I)}}initColors(m){const g=[];if(!this.palette.length)throw new Error(`To encode ${m}-bit BMPs a pallette is needed. Please choose up to ${this.colors} colors. Colors must be 32-bit integers.`);for(let w=0;w<this.colors;w++){const I=createColor(this.palette[w]);this.writeUInt32LE(I),g.push(I)}return g}writeUInt32LE(m){this.data.writeUInt32LE(m,this.pos),this.pos+=4}}function decode$2(d,m){return new BmpDecoder(d,m)}function encode$2(d){return new BmpEncoder(d)}function _typeof(d){return _typeof=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(m){return typeof m}:function(m){return m&&typeof Symbol=="function"&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":typeof m},_typeof(d)}var trimLeft=/^\s+/,trimRight=/\s+$/;function tinycolor(d,m){if(m=m||{},(d=d||"")instanceof tinycolor)return d;if(!(this instanceof tinycolor))return new tinycolor(d,m);var g=inputToRGB(d);this._originalInput=d,this._r=g.r,this._g=g.g,this._b=g.b,this._a=g.a,this._roundA=Math.round(100*this._a)/100,this._format=m.format||g.format,this._gradientType=m.gradientType,this._r<1&&(this._r=Math.round(this._r)),this._g<1&&(this._g=Math.round(this._g)),this._b<1&&(this._b=Math.round(this._b)),this._ok=g.ok}function inputToRGB(d){var m={r:0,g:0,b:0},g=1,w=null,I=null,P=null,F=!1,D=!1;return typeof d=="string"&&(d=stringInputToObject(d)),_typeof(d)=="object"&&(isValidCSSUnit(d.r)&&isValidCSSUnit(d.g)&&isValidCSSUnit(d.b)?(m=rgbToRgb(d.r,d.g,d.b),F=!0,D=String(d.r).substr(-1)==="%"?"prgb":"rgb"):isValidCSSUnit(d.h)&&isValidCSSUnit(d.s)&&isValidCSSUnit(d.v)?(w=convertToPercentage(d.s),I=convertToPercentage(d.v),m=hsvToRgb(d.h,w,I),F=!0,D="hsv"):isValidCSSUnit(d.h)&&isValidCSSUnit(d.s)&&isValidCSSUnit(d.l)&&(w=convertToPercentage(d.s),P=convertToPercentage(d.l),m=hslToRgb(d.h,w,P),F=!0,D="hsl"),d.hasOwnProperty("a")&&(g=d.a)),g=boundAlpha(g),{ok:F,format:d.format||D,r:Math.min(255,Math.max(m.r,0)),g:Math.min(255,Math.max(m.g,0)),b:Math.min(255,Math.max(m.b,0)),a:g}}function rgbToRgb(d,m,g){return{r:255*bound01(d,255),g:255*bound01(m,255),b:255*bound01(g,255)}}function rgbToHsl(d,m,g){d=bound01(d,255),m=bound01(m,255),g=bound01(g,255);var w,I,P=Math.max(d,m,g),F=Math.min(d,m,g),D=(P+F)/2;if(P==F)w=I=0;else{var U=P-F;switch(I=D>.5?U/(2-P-F):U/(P+F),P){case d:w=(m-g)/U+(m<g?6:0);break;case m:w=(g-d)/U+2;break;case g:w=(d-m)/U+4}w/=6}return{h:w,s:I,l:D}}function hslToRgb(d,m,g){var w,I,P;function F(Z,$,j){return j<0&&(j+=1),j>1&&(j-=1),j<1/6?Z+6*($-Z)*j:j<.5?$:j<2/3?Z+($-Z)*(2/3-j)*6:Z}if(d=bound01(d,360),m=bound01(m,100),g=bound01(g,100),m===0)w=I=P=g;else{var D=g<.5?g*(1+m):g+m-g*m,U=2*g-D;w=F(U,D,d+1/3),I=F(U,D,d),P=F(U,D,d-1/3)}return{r:255*w,g:255*I,b:255*P}}function rgbToHsv(d,m,g){d=bound01(d,255),m=bound01(m,255),g=bound01(g,255);var w,I,P=Math.max(d,m,g),F=Math.min(d,m,g),D=P,U=P-F;if(I=P===0?0:U/P,P==F)w=0;else{switch(P){case d:w=(m-g)/U+(m<g?6:0);break;case m:w=(g-d)/U+2;break;case g:w=(d-m)/U+4}w/=6}return{h:w,s:I,v:D}}function hsvToRgb(d,m,g){d=6*bound01(d,360),m=bound01(m,100),g=bound01(g,100);var w=Math.floor(d),I=d-w,P=g*(1-m),F=g*(1-I*m),D=g*(1-(1-I)*m),U=w%6;return{r:255*[g,F,P,P,D,g][U],g:255*[D,g,g,F,P,P][U],b:255*[P,P,D,g,g,F][U]}}function rgbToHex(d,m,g,w){var I=[pad2(Math.round(d).toString(16)),pad2(Math.round(m).toString(16)),pad2(Math.round(g).toString(16))];return w&&I[0].charAt(0)==I[0].charAt(1)&&I[1].charAt(0)==I[1].charAt(1)&&I[2].charAt(0)==I[2].charAt(1)?I[0].charAt(0)+I[1].charAt(0)+I[2].charAt(0):I.join("")}function rgbaToHex(d,m,g,w,I){var P=[pad2(Math.round(d).toString(16)),pad2(Math.round(m).toString(16)),pad2(Math.round(g).toString(16)),pad2(convertDecimalToHex(w))];return I&&P[0].charAt(0)==P[0].charAt(1)&&P[1].charAt(0)==P[1].charAt(1)&&P[2].charAt(0)==P[2].charAt(1)&&P[3].charAt(0)==P[3].charAt(1)?P[0].charAt(0)+P[1].charAt(0)+P[2].charAt(0)+P[3].charAt(0):P.join("")}function rgbaToArgbHex(d,m,g,w){return[pad2(convertDecimalToHex(w)),pad2(Math.round(d).toString(16)),pad2(Math.round(m).toString(16)),pad2(Math.round(g).toString(16))].join("")}function _desaturate(d,m){m=m===0?0:m||10;var g=tinycolor(d).toHsl();return g.s-=m/100,g.s=clamp01(g.s),tinycolor(g)}function _saturate(d,m){m=m===0?0:m||10;var g=tinycolor(d).toHsl();return g.s+=m/100,g.s=clamp01(g.s),tinycolor(g)}function _greyscale(d){return tinycolor(d).desaturate(100)}function _lighten(d,m){m=m===0?0:m||10;var g=tinycolor(d).toHsl();return g.l+=m/100,g.l=clamp01(g.l),tinycolor(g)}function _brighten(d,m){m=m===0?0:m||10;var g=tinycolor(d).toRgb();return g.r=Math.max(0,Math.min(255,g.r-Math.round(-m/100*255))),g.g=Math.max(0,Math.min(255,g.g-Math.round(-m/100*255))),g.b=Math.max(0,Math.min(255,g.b-Math.round(-m/100*255))),tinycolor(g)}function _darken(d,m){m=m===0?0:m||10;var g=tinycolor(d).toHsl();return g.l-=m/100,g.l=clamp01(g.l),tinycolor(g)}function _spin(d,m){var g=tinycolor(d).toHsl(),w=(g.h+m)%360;return g.h=w<0?360+w:w,tinycolor(g)}function _complement(d){var m=tinycolor(d).toHsl();return m.h=(m.h+180)%360,tinycolor(m)}function polyad(d,m){if(isNaN(m)||m<=0)throw new Error("Argument to polyad must be a positive number");for(var g=tinycolor(d).toHsl(),w=[tinycolor(d)],I=360/m,P=1;P<m;P++)w.push(tinycolor({h:(g.h+P*I)%360,s:g.s,l:g.l}));return w}function _splitcomplement(d){var m=tinycolor(d).toHsl(),g=m.h;return[tinycolor(d),tinycolor({h:(g+72)%360,s:m.s,l:m.l}),tinycolor({h:(g+216)%360,s:m.s,l:m.l})]}function _analogous(d,m,g){m=m||6,g=g||30;var w=tinycolor(d).toHsl(),I=360/g,P=[tinycolor(d)];for(w.h=(w.h-(I*m>>1)+720)%360;--m;)w.h=(w.h+I)%360,P.push(tinycolor(w));return P}function _monochromatic(d,m){m=m||6;for(var g=tinycolor(d).toHsv(),w=g.h,I=g.s,P=g.v,F=[],D=1/m;m--;)F.push(tinycolor({h:w,s:I,v:P})),P=(P+D)%1;return F}tinycolor.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var d=this.toRgb();return(299*d.r+587*d.g+114*d.b)/1e3},getLuminance:function(){var d,m,g,w=this.toRgb();return d=w.r/255,m=w.g/255,g=w.b/255,.2126*(d<=.03928?d/12.92:Math.pow((d+.055)/1.055,2.4))+.7152*(m<=.03928?m/12.92:Math.pow((m+.055)/1.055,2.4))+.0722*(g<=.03928?g/12.92:Math.pow((g+.055)/1.055,2.4))},setAlpha:function(d){return this._a=boundAlpha(d),this._roundA=Math.round(100*this._a)/100,this},toHsv:function(){var d=rgbToHsv(this._r,this._g,this._b);return{h:360*d.h,s:d.s,v:d.v,a:this._a}},toHsvString:function(){var d=rgbToHsv(this._r,this._g,this._b),m=Math.round(360*d.h),g=Math.round(100*d.s),w=Math.round(100*d.v);return this._a==1?"hsv("+m+", "+g+"%, "+w+"%)":"hsva("+m+", "+g+"%, "+w+"%, "+this._roundA+")"},toHsl:function(){var d=rgbToHsl(this._r,this._g,this._b);return{h:360*d.h,s:d.s,l:d.l,a:this._a}},toHslString:function(){var d=rgbToHsl(this._r,this._g,this._b),m=Math.round(360*d.h),g=Math.round(100*d.s),w=Math.round(100*d.l);return this._a==1?"hsl("+m+", "+g+"%, "+w+"%)":"hsla("+m+", "+g+"%, "+w+"%, "+this._roundA+")"},toHex:function(d){return rgbToHex(this._r,this._g,this._b,d)},toHexString:function(d){return"#"+this.toHex(d)},toHex8:function(d){return rgbaToHex(this._r,this._g,this._b,this._a,d)},toHex8String:function(d){return"#"+this.toHex8(d)},toRgb:function(){return{r:Math.round(this._r),g:Math.round(this._g),b:Math.round(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+")":"rgba("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:Math.round(100*bound01(this._r,255))+"%",g:Math.round(100*bound01(this._g,255))+"%",b:Math.round(100*bound01(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+Math.round(100*bound01(this._r,255))+"%, "+Math.round(100*bound01(this._g,255))+"%, "+Math.round(100*bound01(this._b,255))+"%)":"rgba("+Math.round(100*bound01(this._r,255))+"%, "+Math.round(100*bound01(this._g,255))+"%, "+Math.round(100*bound01(this._b,255))+"%, "+this._roundA+")"},toName:function(){return this._a===0?"transparent":!(this._a<1)&&(hexNames[rgbToHex(this._r,this._g,this._b,!0)]||!1)},toFilter:function(d){var m="#"+rgbaToArgbHex(this._r,this._g,this._b,this._a),g=m,w=this._gradientType?"GradientType = 1, ":"";if(d){var I=tinycolor(d);g="#"+rgbaToArgbHex(I._r,I._g,I._b,I._a)}return"progid:DXImageTransform.Microsoft.gradient("+w+"startColorstr="+m+",endColorstr="+g+")"},toString:function(d){var m=!!d;d=d||this._format;var g=!1,w=this._a<1&&this._a>=0;return m||!w||d!=="hex"&&d!=="hex6"&&d!=="hex3"&&d!=="hex4"&&d!=="hex8"&&d!=="name"?(d==="rgb"&&(g=this.toRgbString()),d==="prgb"&&(g=this.toPercentageRgbString()),d!=="hex"&&d!=="hex6"||(g=this.toHexString()),d==="hex3"&&(g=this.toHexString(!0)),d==="hex4"&&(g=this.toHex8String(!0)),d==="hex8"&&(g=this.toHex8String()),d==="name"&&(g=this.toName()),d==="hsl"&&(g=this.toHslString()),d==="hsv"&&(g=this.toHsvString()),g||this.toHexString()):d==="name"&&this._a===0?this.toName():this.toRgbString()},clone:function(){return tinycolor(this.toString())},_applyModification:function(d,m){var g=d.apply(null,[this].concat([].slice.call(m)));return this._r=g._r,this._g=g._g,this._b=g._b,this.setAlpha(g._a),this},lighten:function(){return this._applyModification(_lighten,arguments)},brighten:function(){return this._applyModification(_brighten,arguments)},darken:function(){return this._applyModification(_darken,arguments)},desaturate:function(){return this._applyModification(_desaturate,arguments)},saturate:function(){return this._applyModification(_saturate,arguments)},greyscale:function(){return this._applyModification(_greyscale,arguments)},spin:function(){return this._applyModification(_spin,arguments)},_applyCombination:function(d,m){return d.apply(null,[this].concat([].slice.call(m)))},analogous:function(){return this._applyCombination(_analogous,arguments)},complement:function(){return this._applyCombination(_complement,arguments)},monochromatic:function(){return this._applyCombination(_monochromatic,arguments)},splitcomplement:function(){return this._applyCombination(_splitcomplement,arguments)},triad:function(){return this._applyCombination(polyad,[3])},tetrad:function(){return this._applyCombination(polyad,[4])}},tinycolor.fromRatio=function(d,m){if(_typeof(d)=="object"){var g={};for(var w in d)d.hasOwnProperty(w)&&(g[w]=w==="a"?d[w]:convertToPercentage(d[w]));d=g}return tinycolor(d,m)},tinycolor.equals=function(d,m){return!(!d||!m)&&tinycolor(d).toRgbString()==tinycolor(m).toRgbString()},tinycolor.random=function(){return tinycolor.fromRatio({r:Math.random(),g:Math.random(),b:Math.random()})},tinycolor.mix=function(d,m,g){g=g===0?0:g||50;var w=tinycolor(d).toRgb(),I=tinycolor(m).toRgb(),P=g/100;return tinycolor({r:(I.r-w.r)*P+w.r,g:(I.g-w.g)*P+w.g,b:(I.b-w.b)*P+w.b,a:(I.a-w.a)*P+w.a})},tinycolor.readability=function(d,m){var g=tinycolor(d),w=tinycolor(m);return(Math.max(g.getLuminance(),w.getLuminance())+.05)/(Math.min(g.getLuminance(),w.getLuminance())+.05)},tinycolor.isReadable=function(d,m,g){var w,I,P=tinycolor.readability(d,m);switch(I=!1,(w=validateWCAG2Parms(g)).level+w.size){case"AAsmall":case"AAAlarge":I=P>=4.5;break;case"AAlarge":I=P>=3;break;case"AAAsmall":I=P>=7}return I},tinycolor.mostReadable=function(d,m,g){var w,I,P,F,D=null,U=0;I=(g=g||{}).includeFallbackColors,P=g.level,F=g.size;for(var Z=0;Z<m.length;Z++)(w=tinycolor.readability(d,m[Z]))>U&&(U=w,D=tinycolor(m[Z]));return tinycolor.isReadable(d,D,{level:P,size:F})||!I?D:(g.includeFallbackColors=!1,tinycolor.mostReadable(d,["#fff","#000"],g))};var names$1=tinycolor.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},hexNames=tinycolor.hexNames=flip(names$1);function flip(d){var m={};for(var g in d)d.hasOwnProperty(g)&&(m[d[g]]=g);return m}function boundAlpha(d){return d=parseFloat(d),(isNaN(d)||d<0||d>1)&&(d=1),d}function bound01(d,m){isOnePointZero(d)&&(d="100%");var g=isPercentage(d);return d=Math.min(m,Math.max(0,parseFloat(d))),g&&(d=parseInt(d*m,10)/100),Math.abs(d-m)<1e-6?1:d%m/parseFloat(m)}function clamp01(d){return Math.min(1,Math.max(0,d))}function parseIntFromHex(d){return parseInt(d,16)}function isOnePointZero(d){return typeof d=="string"&&d.indexOf(".")!=-1&&parseFloat(d)===1}function isPercentage(d){return typeof d=="string"&&d.indexOf("%")!=-1}function pad2(d){return d.length==1?"0"+d:""+d}function convertToPercentage(d){return d<=1&&(d=100*d+"%"),d}function convertDecimalToHex(d){return Math.round(255*parseFloat(d)).toString(16)}function convertHexToDecimal(d){return parseIntFromHex(d)/255}var matchers=(CSS_UNIT="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)",PERMISSIVE_MATCH3="[\\s|\\(]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")\\s*\\)?",PERMISSIVE_MATCH4="[\\s|\\(]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")\\s*\\)?",{CSS_UNIT:new RegExp(CSS_UNIT),rgb:new RegExp("rgb"+PERMISSIVE_MATCH3),rgba:new RegExp("rgba"+PERMISSIVE_MATCH4),hsl:new RegExp("hsl"+PERMISSIVE_MATCH3),hsla:new RegExp("hsla"+PERMISSIVE_MATCH4),hsv:new RegExp("hsv"+PERMISSIVE_MATCH3),hsva:new RegExp("hsva"+PERMISSIVE_MATCH4),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}),CSS_UNIT,PERMISSIVE_MATCH3,PERMISSIVE_MATCH4;function isValidCSSUnit(d){return!!matchers.CSS_UNIT.exec(d)}function stringInputToObject(d){d=d.replace(trimLeft,"").replace(trimRight,"").toLowerCase();var m,g=!1;if(names$1[d])d=names$1[d],g=!0;else if(d=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};return(m=matchers.rgb.exec(d))?{r:m[1],g:m[2],b:m[3]}:(m=matchers.rgba.exec(d))?{r:m[1],g:m[2],b:m[3],a:m[4]}:(m=matchers.hsl.exec(d))?{h:m[1],s:m[2],l:m[3]}:(m=matchers.hsla.exec(d))?{h:m[1],s:m[2],l:m[3],a:m[4]}:(m=matchers.hsv.exec(d))?{h:m[1],s:m[2],v:m[3]}:(m=matchers.hsva.exec(d))?{h:m[1],s:m[2],v:m[3],a:m[4]}:(m=matchers.hex8.exec(d))?{r:parseIntFromHex(m[1]),g:parseIntFromHex(m[2]),b:parseIntFromHex(m[3]),a:convertHexToDecimal(m[4]),format:g?"name":"hex8"}:(m=matchers.hex6.exec(d))?{r:parseIntFromHex(m[1]),g:parseIntFromHex(m[2]),b:parseIntFromHex(m[3]),format:g?"name":"hex"}:(m=matchers.hex4.exec(d))?{r:parseIntFromHex(m[1]+""+m[1]),g:parseIntFromHex(m[2]+""+m[2]),b:parseIntFromHex(m[3]+""+m[3]),a:convertHexToDecimal(m[4]+""+m[4]),format:g?"name":"hex8"}:!!(m=matchers.hex3.exec(d))&&{r:parseIntFromHex(m[1]+""+m[1]),g:parseIntFromHex(m[2]+""+m[2]),b:parseIntFromHex(m[3]+""+m[3]),format:g?"name":"hex"}}function validateWCAG2Parms(d){var m,g;return(m=((d=d||{level:"AA",size:"small"}).level||"AA").toUpperCase())!=="AA"&&m!=="AAA"&&(m="AA"),(g=(d.size||"small").toLowerCase())!=="small"&&g!=="large"&&(g="small"),{level:m,size:g}}function clone(d){const m={width:d.bitmap.width,height:d.bitmap.height,data:Buffer$2.from(d.bitmap.data)};return new d.constructor(m)}function scan(d,m,g,w,I,P){let F,D,U,Z,$;if(typeof m=="function")$=m,F=0,D=0,U=d.bitmap.width,Z=d.bitmap.height;else{if(F=m,typeof g!="number")throw new Error("y must be a number");if(D=g,typeof w!="number")throw new Error("w must be a number");if(U=w,typeof I!="number")throw new Error("h must be a number");if(Z=I,typeof P!="function")throw new Error("cb must be a function");$=P}F=Math.round(F),D=Math.round(D),U=Math.round(U),Z=Math.round(Z);const j=$.bind(d);for(let H=D;H<D+Z;H++)for(let W=F;W<F+U;W++)j(W,H,d.bitmap.width*H+W<<2);return d}function*scanIterator(d,m,g,w,I){m=Math.round(m),g=Math.round(g),w=Math.round(w),I=Math.round(I);for(let P=g;P<g+I;P++)for(let F=m;F<m+w;F++){const D=d.bitmap.width*P+F<<2;yield{x:F,y:P,idx:D,image:d}}}function intToRGBA$1(d){if(typeof d!="number")throw new Error("i must be a number");const m={r:0,g:0,b:0,a:0};return m.r=Math.floor(d/Math.pow(256,3)),m.g=Math.floor((d-m.r*Math.pow(256,3))/Math.pow(256,2)),m.b=Math.floor((d-m.r*Math.pow(256,3)-m.g*Math.pow(256,2))/Math.pow(256,1)),m.a=Math.floor((d-m.r*Math.pow(256,3)-m.g*Math.pow(256,2)-m.b*Math.pow(256,1))/Math.pow(256,0)),m}function colorDiff(d,m){const g=F=>Math.pow(F,2),{max:w}=Math,I="a"in d?d.a:255,P="a"in m?m.a:255;return(w(g(d.r-m.r),g(d.r-m.r-I+P))+w(g(d.g-m.g),g(d.g-m.g-I+P))+w(g(d.b-m.b),g(d.b-m.b-I+P)))/195075}function limit255(d){return d=Math.max(d,0),d=Math.min(d,255)}function cssColorToHex(d){return typeof d=="number"?d:parseInt(tinycolor(d).toHex8(),16)}function encode$1(d,m={}){return scan({bitmap:d},0,0,d.width,d.height,function(g,w,I){const P=d.data[I+0],F=d.data[I+1],D=d.data[I+2],U=d.data[I+3];d.data[I+0]=U,d.data[I+1]=D,d.data[I+2]=F,d.data[I+3]=P}),encode$2({...d,...m}).data}function decode$1(d,m){const g=decode$2(d,m);return scan({bitmap:g},0,0,g.width,g.height,function(w,I,P){const F=g.data[P+1],D=g.data[P+2],U=g.data[P+3];g.data[P+0]=U,g.data[P+1]=D,g.data[P+2]=F,g.data[P+3]=255}),g}function msBmp(){return{mime:"image/x-ms-bmp",encode:encode$1,decode:decode$1}}function bmp(){return{mime:"image/bmp",encode:encode$1,decode:decode$1}}var omggif={},GifReader_1,GifWriter_1;function GifWriter(d,m,g,w){var I=0,P=(w=w===void 0?{}:w).loop===void 0?null:w.loop,F=w.palette===void 0?null:w.palette;if(m<=0||g<=0||m>65535||g>65535)throw new Error("Width/Height invalid.");function D(Q){var K=Q.length;if(K<2||K>256||K&K-1)throw new Error("Invalid code/color length, must be power of 2 and 2 .. 256.");return K}d[I++]=71,d[I++]=73,d[I++]=70,d[I++]=56,d[I++]=57,d[I++]=97;var U=0,Z=0;if(F!==null){for(var $=D(F);$>>=1;)++U;if($=1<<U,--U,w.background!==void 0){if((Z=w.background)>=$)throw new Error("Background index out of range.");if(Z===0)throw new Error("Background index explicitly passed as 0.")}}if(d[I++]=255&m,d[I++]=m>>8&255,d[I++]=255&g,d[I++]=g>>8&255,d[I++]=(F!==null?128:0)|U,d[I++]=Z,d[I++]=0,F!==null)for(var j=0,H=F.length;j<H;++j){var W=F[j];d[I++]=W>>16&255,d[I++]=W>>8&255,d[I++]=255&W}if(P!==null){if(P<0||P>65535)throw new Error("Loop count invalid.");d[I++]=33,d[I++]=255,d[I++]=11,d[I++]=78,d[I++]=69,d[I++]=84,d[I++]=83,d[I++]=67,d[I++]=65,d[I++]=80,d[I++]=69,d[I++]=50,d[I++]=46,d[I++]=48,d[I++]=3,d[I++]=1,d[I++]=255&P,d[I++]=P>>8&255,d[I++]=0}var V=!1;this.addFrame=function(Q,K,q,et,X,tt){if(V===!0&&(--I,V=!1),tt=tt===void 0?{}:tt,Q<0||K<0||Q>65535||K>65535)throw new Error("x/y invalid.");if(q<=0||et<=0||q>65535||et>65535)throw new Error("Width/Height invalid.");if(X.length<q*et)throw new Error("Not enough pixels for the frame size.");var rt=!0,ot=tt.palette;if(ot==null&&(rt=!1,ot=F),ot==null)throw new Error("Must supply either a local or global palette.");for(var J=D(ot),lt=0;J>>=1;)++lt;J=1<<lt;var st=tt.delay===void 0?0:tt.delay,ut=tt.disposal===void 0?0:tt.disposal;if(ut<0||ut>3)throw new Error("Disposal out of range.");var it=!1,ct=0;if(tt.transparent!==void 0&&tt.transparent!==null&&(it=!0,(ct=tt.transparent)<0||ct>=J))throw new Error("Transparent color index.");if((ut!==0||it||st!==0)&&(d[I++]=33,d[I++]=249,d[I++]=4,d[I++]=ut<<2|(it===!0?1:0),d[I++]=255&st,d[I++]=st>>8&255,d[I++]=ct,d[I++]=0),d[I++]=44,d[I++]=255&Q,d[I++]=Q>>8&255,d[I++]=255&K,d[I++]=K>>8&255,d[I++]=255&q,d[I++]=q>>8&255,d[I++]=255&et,d[I++]=et>>8&255,d[I++]=rt===!0?128|lt-1:0,rt===!0)for(var At=0,Et=ot.length;At<Et;++At){var gt=ot[At];d[I++]=gt>>16&255,d[I++]=gt>>8&255,d[I++]=255&gt}return I=GifWriterOutputLZWCodeStream(d,I,lt<2?2:lt,X)},this.end=function(){return V===!1&&(d[I++]=59,V=!0),I},this.getOutputBuffer=function(){return d},this.setOutputBuffer=function(Q){d=Q},this.getOutputBufferPosition=function(){return I},this.setOutputBufferPosition=function(Q){I=Q}}function GifWriterOutputLZWCodeStream(d,m,g,w){d[m++]=g;var I=m++,P=1<<g,F=P-1,D=P+1,U=D+1,Z=g+1,$=0,j=0;function H(rt){for(;$>=rt;)d[m++]=255&j,j>>=8,$-=8,m===I+256&&(d[I]=255,I=m++)}function W(rt){j|=rt<<$,$+=Z,H(8)}var V=w[0]&F,Q={};W(P);for(var K=1,q=w.length;K<q;++K){var et=w[K]&F,X=V<<8|et,tt=Q[X];if(tt===void 0){for(j|=V<<$,$+=Z;$>=8;)d[m++]=255&j,j>>=8,$-=8,m===I+256&&(d[I]=255,I=m++);U===4096?(W(P),U=D+1,Z=g+1,Q={}):(U>=1<<Z&&++Z,Q[X]=U++),V=et}else V=tt}return W(V),W(D),H(1),I+1===m?d[I]=0:(d[I]=m-I-1,d[m++]=0),m}function GifReader(d){var m=0;if(d[m++]!==71||d[m++]!==73||d[m++]!==70||d[m++]!==56||(d[m++]+1&253)!=56||d[m++]!==97)throw new Error("Invalid GIF 87a/89a header.");var g=d[m++]|d[m++]<<8,w=d[m++]|d[m++]<<8,I=d[m++],P=I>>7,F=1<<(7&I)+1;d[m++],d[m++];var D=null,U=null;P&&(D=m,U=F,m+=3*F);var Z=!0,$=[],j=0,H=null,W=0,V=null;for(this.width=g,this.height=w;Z&&m<d.length;)switch(d[m++]){case 33:switch(d[m++]){case 255:if(d[m]!==11||d[m+1]==78&&d[m+2]==69&&d[m+3]==84&&d[m+4]==83&&d[m+5]==67&&d[m+6]==65&&d[m+7]==80&&d[m+8]==69&&d[m+9]==50&&d[m+10]==46&&d[m+11]==48&&d[m+12]==3&&d[m+13]==1&&d[m+16]==0)m+=14,V=d[m++]|d[m++]<<8,m++;else for(m+=12;;){if(!((it=d[m++])>=0))throw Error("Invalid block size");if(it===0)break;m+=it}break;case 249:if(d[m++]!==4||d[m+4]!==0)throw new Error("Invalid graphics extension block.");var Q=d[m++];j=d[m++]|d[m++]<<8,H=d[m++],1&Q||(H=null),W=Q>>2&7,m++;break;case 254:for(;;){if(!((it=d[m++])>=0))throw Error("Invalid block size");if(it===0)break;m+=it}break;default:throw new Error("Unknown graphic control label: 0x"+d[m-1].toString(16))}break;case 44:var K=d[m++]|d[m++]<<8,q=d[m++]|d[m++]<<8,et=d[m++]|d[m++]<<8,X=d[m++]|d[m++]<<8,tt=d[m++],rt=tt>>6&1,ot=1<<(7&tt)+1,J=D,lt=U,st=!1;tt>>7&&(st=!0,J=m,lt=ot,m+=3*ot);var ut=m;for(m++;;){var it;if(!((it=d[m++])>=0))throw Error("Invalid block size");if(it===0)break;m+=it}$.push({x:K,y:q,width:et,height:X,has_local_palette:st,palette_offset:J,palette_size:lt,data_offset:ut,data_length:m-ut,transparent_index:H,interlaced:!!rt,delay:j,disposal:W});break;case 59:Z=!1;break;default:throw new Error("Unknown gif block: 0x"+d[m-1].toString(16))}this.numFrames=function(){return $.length},this.loopCount=function(){return V},this.frameInfo=function(ct){if(ct<0||ct>=$.length)throw new Error("Frame index out of range.");return $[ct]},this.decodeAndBlitFrameBGRA=function(ct,At){var Et=this.frameInfo(ct),gt=Et.width*Et.height,pt=new Uint8Array(gt);GifReaderLZWOutputIndexStream(d,Et.data_offset,pt,gt);var vt=Et.palette_offset,Tt=Et.transparent_index;Tt===null&&(Tt=256);var It=Et.width,$t=g-It,Bt=It,zt=4*(Et.y*g+Et.x),Ot=4*((Et.y+Et.height)*g+Et.x),Nt=zt,Pt=4*$t;Et.interlaced===!0&&(Pt+=4*g*7);for(var Ut=8,Ft=0,Zt=pt.length;Ft<Zt;++Ft){var Ht=pt[Ft];if(Bt===0&&(Bt=It,(Nt+=Pt)>=Ot&&(Pt=4*$t+4*g*(Ut-1),Nt=zt+(It+$t)*(Ut<<1),Ut>>=1)),Ht===Tt)Nt+=4;else{var Dt=d[vt+3*Ht],dt=d[vt+3*Ht+1],Lt=d[vt+3*Ht+2];At[Nt++]=Lt,At[Nt++]=dt,At[Nt++]=Dt,At[Nt++]=255}--Bt}},this.decodeAndBlitFrameRGBA=function(ct,At){var Et=this.frameInfo(ct),gt=Et.width*Et.height,pt=new Uint8Array(gt);GifReaderLZWOutputIndexStream(d,Et.data_offset,pt,gt);var vt=Et.palette_offset,Tt=Et.transparent_index;Tt===null&&(Tt=256);var It=Et.width,$t=g-It,Bt=It,zt=4*(Et.y*g+Et.x),Ot=4*((Et.y+Et.height)*g+Et.x),Nt=zt,Pt=4*$t;Et.interlaced===!0&&(Pt+=4*g*7);for(var Ut=8,Ft=0,Zt=pt.length;Ft<Zt;++Ft){var Ht=pt[Ft];if(Bt===0&&(Bt=It,(Nt+=Pt)>=Ot&&(Pt=4*$t+4*g*(Ut-1),Nt=zt+(It+$t)*(Ut<<1),Ut>>=1)),Ht===Tt)Nt+=4;else{var Dt=d[vt+3*Ht],dt=d[vt+3*Ht+1],Lt=d[vt+3*Ht+2];At[Nt++]=Dt,At[Nt++]=dt,At[Nt++]=Lt,At[Nt++]=255}--Bt}}}function GifReaderLZWOutputIndexStream(d,m,g,w){for(var I=d[m++],P=1<<I,F=P+1,D=F+1,U=I+1,Z=(1<<U)-1,$=0,j=0,H=0,W=d[m++],V=new Int32Array(4096),Q=null;;){for(;$<16&&W!==0;)j|=d[m++]<<$,$+=8,W===1?W=d[m++]:--W;if($<U)break;var K=j&Z;if(j>>=U,$-=U,K!==P){if(K===F)break;for(var q=K<D?K:Q,et=0,X=q;X>P;)X=V[X]>>8,++et;var tt=X;if(H+et+(q!==K?1:0)>w)return void console.log("Warning, gif stream longer than expected.");g[H++]=tt;var rt=H+=et;for(q!==K&&(g[H++]=tt),X=q;et--;)X=V[X],g[--rt]=255&X,X>>=8;Q!==null&&D<4096&&(V[D++]=Q<<8|tt,D>=Z+1&&U<12&&(++U,Z=Z<<1|1)),Q=K}else D=F+1,Z=(1<<(U=I+1))-1,Q=null}return H!==w&&console.log("Warning, gif stream shorter than expected."),g}try{GifWriter_1=omggif.GifWriter=GifWriter,GifReader_1=omggif.GifReader=GifReader}catch{}let BitmapImage$2=class Pe{constructor(...m){if(m.length===0)throw new Error("constructor requires parameters");const g=m[0];if(g!==null&&typeof g=="object")if(g instanceof Pe){const w=g.bitmap;this.bitmap={width:w.width,height:w.height,data:new Buffer$2(w.width*w.height*4)},w.data.copy(this.bitmap.data)}else{if(!(g.width&&g.height&&g.data))throw new Error("unrecognized constructor parameters");this.bitmap=g}else{if(typeof g!="number"||typeof m[1]!="number")throw new Error("unrecognized constructor parameters");{const w=g,I=m[1],P=m[2];this.bitmap={width:w,height:I},Buffer$2.isBuffer(P)?this.bitmap.data=P:(this.bitmap.data=new Buffer$2(w*I*4),typeof P=="number"&&this.fillRGBA(P))}}}blit(m,g,w,I,P,F,D){if(I+F>this.bitmap.width)throw new Error("copy exceeds width of source bitmap");if(g+F>m.bitmap.width)throw new Error("copy exceeds width of target bitmap");if(P+D>this.bitmap.height)throw new Error("copy exceeds height of source bitmap");if(w+D>m.bitmap.height)throw new Erro("copy exceeds height of target bitmap");const U=this.bitmap.data,Z=m.bitmap.data,$=4*this.bitmap.width,j=4*m.bitmap.width,H=4*F;let W=P*$+4*I,V=w*j+4*g;for(;--D>=0;)U.copy(Z,V,W,W+H),W+=$,V+=j;return this}fillRGBA(m){const g=this.bitmap.data,w=4*this.bitmap.height;let I=0;for(;I<w;)g.writeUInt32BE(m,I),I+=4;for(;I<g.length;)g.copy(g,I,0,w),I+=w;return this}getRGBA(m,g){const w=4*(g*this.bitmap.width+m);return this.bitmap.data.readUInt32BE(w)}getRGBASet(){const m=new Set,g=this.bitmap.data;for(let w=0;w<g.length;w+=4)m.add(g.readUInt32BE(w,!0));return m}greyscale(){const m=this.bitmap.data;return this.scan(0,0,this.bitmap.width,this.bitmap.height,(g,w,I)=>{const P=Math.round(.299*m[I]+.587*m[I+1]+.114*m[I+2]);m[I]=P,m[I+1]=P,m[I+2]=P}),this}reframe(m,g,w,I,P){const F=m<0?0:m,D=g<0?0:g,U=w+F>this.bitmap.width?this.bitmap.width-F:w,Z=I+D>this.bitmap.height?this.bitmap.height-D:I,$=m<0?-m:0,j=g<0?-g:0;let H;if(P===void 0){if(F!==m||D!=g||U!==w||Z!==I)throw new GifError("fillRGBA required for this reframing");H=new Pe(w,I)}else H=new Pe(w,I,P);return this.blit(H,$,j,F,D,U,Z),this.bitmap=H.bitmap,this}scale(m){if(m===1)return;if(!Number.isInteger(m)||m<1)throw new Error("the scale must be an integer >= 1");const g=this.bitmap.width,w=this.bitmap.height,I=g*m*4,P=this.bitmap.data,F=new Buffer$2(w*I*m);let D,U=0,Z=0;for(let $=0;$<w;++$){D=Z;for(let j=0;j<g;++j){const H=P.readUInt32BE(U,!0);for(let W=0;W<m;++W)F.writeUInt32BE(H,Z),Z+=4;U+=4}for(let j=1;j<m;++j)F.copy(F,Z,D,Z),Z+=I,D+=I}return this.bitmap={width:g*m,height:w*m,data:F},this}scanAllCoords(m){const g=this.bitmap.width,w=this.bitmap.data.length;let I=0,P=0;for(let F=0;F<w;F+=4)m(I,P,F),++I===g&&(I=0,++P)}scanAllIndexes(m){const g=this.bitmap.data.length;for(let w=0;w<g;w+=4)m(w)}};var bitmapimage=BitmapImage$2,gif$1={};let Gif$1=class{constructor(d,m,g){this.width=g.width,this.height=g.height,this.loops=g.loops,this.usesTransparency=g.usesTransparency,this.colorScope=g.colorScope,this.frames=m,this.buffer=d}};Gif$1.GlobalColorsPreferred=0,Gif$1.GlobalColorsOnly=1,Gif$1.LocalColorsOnly=2;let GifError$2=class extends Error{constructor(d){super(d),d instanceof Error&&(this.stack="Gif"+d.stack)}};gif$1.Gif=Gif$1,gif$1.GifError=GifError$2;var gifcodec={},gifutil={},_polyfillNode_fs={},_polyfillNode_fs$1=Object.freeze({__proto__:null,default:_polyfillNode_fs}),require$$0=getAugmentedNamespace(_polyfillNode_fs$1),__defProp$3=Object.defineProperty,__getOwnPropDesc=Object.getOwnPropertyDescriptor,__getOwnPropNames=Object.getOwnPropertyNames,__hasOwnProp=Object.prototype.hasOwnProperty,__defNormalProp$3=(d,m,g)=>m in d?__defProp$3(d,m,{enumerable:!0,configurable:!0,writable:!0,value:g}):d[m]=g,__markAsModule=d=>__defProp$3(d,"__esModule",{value:!0}),__export$1=(d,m)=>{for(var g in m)__defProp$3(d,g,{get:m[g],enumerable:!0})},__reExport=(d,m,g,w)=>{if(m&&typeof m=="object"||typeof m=="function")for(let I of __getOwnPropNames(m))!__hasOwnProp.call(d,I)&&g&&__defProp$3(d,I,{get:()=>m[I],enumerable:!(w=__getOwnPropDesc(m,I))||w.enumerable});return d},__toCommonJS=(d=>(m,g)=>d&&d.get(m)||(g=__reExport(__markAsModule({}),m,1),d&&d.set(m,g),g))(typeof WeakMap<"u"?new WeakMap:0),__publicField$3=(d,m,g)=>(__defNormalProp$3(d,typeof m!="symbol"?m+"":m,g),g),src_exports={};__export$1(src_exports,{applyPalette:()=>applyPalette,applyPaletteSync:()=>applyPaletteSync$1,buildPalette:()=>buildPalette,buildPaletteSync:()=>buildPaletteSync$1,constants:()=>constants_exports$1,conversion:()=>conversion_exports$1,distance:()=>distance_exports$1,image:()=>image_exports$1,palette:()=>palette_exports$1,quality:()=>quality_exports$1,utils:()=>utils_exports$1});var constants_exports$1={};__export$1(constants_exports$1,{bt709:()=>bt709_exports$1});var bt709_exports$1={};__export$1(bt709_exports$1,{Y:()=>Y$1,x:()=>x$2,y:()=>y$2});var Y$1=(d=>(d[d.RED=.2126]="RED",d[d.GREEN=.7152]="GREEN",d[d.BLUE=.0722]="BLUE",d[d.WHITE=1]="WHITE",d))(Y$1||{}),x$2=(d=>(d[d.RED=.64]="RED",d[d.GREEN=.3]="GREEN",d[d.BLUE=.15]="BLUE",d[d.WHITE=.3127]="WHITE",d))(x$2||{}),y$2=(d=>(d[d.RED=.33]="RED",d[d.GREEN=.6]="GREEN",d[d.BLUE=.06]="BLUE",d[d.WHITE=.329]="WHITE",d))(y$2||{}),conversion_exports$1={};function correctGamma$1(d){return d>.04045?((d+.055)/1.055)**2.4:d/12.92}function rgb2xyz$1(d,m,g){return{x:.4124*(d=correctGamma$1(d/255))+.3576*(m=correctGamma$1(m/255))+.1805*(g=correctGamma$1(g/255)),y:.2126*d+.7152*m+.0722*g,z:.0193*d+.1192*m+.9505*g}}__export$1(conversion_exports$1,{lab2rgb:()=>lab2rgb$1,lab2xyz:()=>lab2xyz$1,rgb2hsl:()=>rgb2hsl$1,rgb2lab:()=>rgb2lab$1,rgb2xyz:()=>rgb2xyz$1,xyz2lab:()=>xyz2lab$1,xyz2rgb:()=>xyz2rgb$1});var arithmetic_exports$1={};function degrees2radians$1(d){return d*(Math.PI/180)}function max3$1(d,m,g){let w=d;return w<m&&(w=m),w<g&&(w=g),w}function min3$1(d,m,g){let w=d;return w>m&&(w=m),w>g&&(w=g),w}function intInRange$1(d,m,g){return d>g&&(d=g),d<m&&(d=m),0|d}function inRange0to255Rounded$1(d){return(d=Math.round(d))>255?d=255:d<0&&(d=0),d}function inRange0to255$1(d){return d>255?d=255:d<0&&(d=0),d}function stableSort$1(d,m){const g=typeof d[0];let w;if(g==="number"||g==="string"){const I=Object.create(null);for(let P=0,F=d.length;P<F;P++){const D=d[P];I[D]||I[D]===0||(I[D]=P)}w=d.sort((P,F)=>m(P,F)||I[P]-I[F])}else{const I=d.slice(0);w=d.sort((P,F)=>m(P,F)||I.indexOf(P)-I.indexOf(F))}return w}function rgb2hsl$1(d,m,g){const w=min3$1(d,m,g),I=max3$1(d,m,g),P=I-w,F=(w+I)/510;let D=0;F>0&&F<1&&(D=P/(F<.5?I+w:510-I-w));let U=0;return P>0&&(U=I===d?(m-g)/P:I===m?2+(g-d)/P:4+(d-m)/P,U*=60,U<0&&(U+=360)),{h:U,s:D,l:F}}__export$1(arithmetic_exports$1,{degrees2radians:()=>degrees2radians$1,inRange0to255:()=>inRange0to255$1,inRange0to255Rounded:()=>inRange0to255Rounded$1,intInRange:()=>intInRange$1,max3:()=>max3$1,min3:()=>min3$1,stableSort:()=>stableSort$1});var refX$1=.95047,refY$1=1,refZ$1=1.08883;function pivot$1(d){return d>.008856?d**(1/3):7.787*d+16/116}function xyz2lab$1(d,m,g){if(d=pivot$1(d/refX$1),m=pivot$1(m/refY$1),g=pivot$1(g/refZ$1),116*m-16<0)throw new Error("xxx");return{L:Math.max(0,116*m-16),a:500*(d-m),b:200*(m-g)}}function rgb2lab$1(d,m,g){const w=rgb2xyz$1(d,m,g);return xyz2lab$1(w.x,w.y,w.z)}var refX2$1=.95047,refY2$1=1,refZ2$1=1.08883;function pivot2$1(d){return d>.206893034?d**3:(d-16/116)/7.787}function lab2xyz$1(d,m,g){const w=(d+16)/116,I=w-g/200;return{x:refX2$1*pivot2$1(m/500+w),y:refY2$1*pivot2$1(w),z:refZ2$1*pivot2$1(I)}}function correctGamma2$1(d){return d>.0031308?1.055*d**(1/2.4)-.055:12.92*d}function xyz2rgb$1(d,m,g){const w=correctGamma2$1(3.2406*d+-1.5372*m+-.4986*g),I=correctGamma2$1(-.9689*d+1.8758*m+.0415*g),P=correctGamma2$1(.0557*d+-.204*m+1.057*g);return{r:inRange0to255Rounded$1(255*w),g:inRange0to255Rounded$1(255*I),b:inRange0to255Rounded$1(255*P)}}function lab2rgb$1(d,m,g){const w=lab2xyz$1(d,m,g);return xyz2rgb$1(w.x,w.y,w.z)}var distance_exports$1={};__export$1(distance_exports$1,{AbstractDistanceCalculator:()=>AbstractDistanceCalculator$1,AbstractEuclidean:()=>AbstractEuclidean$1,AbstractManhattan:()=>AbstractManhattan$1,CIE94GraphicArts:()=>CIE94GraphicArts$1,CIE94Textiles:()=>CIE94Textiles$1,CIEDE2000:()=>CIEDE2000$1,CMetric:()=>CMetric$1,Euclidean:()=>Euclidean$1,EuclideanBT709:()=>EuclideanBT709$1,EuclideanBT709NoAlpha:()=>EuclideanBT709NoAlpha$1,Manhattan:()=>Manhattan$1,ManhattanBT709:()=>ManhattanBT709$1,ManhattanNommyde:()=>ManhattanNommyde$1,PNGQuant:()=>PNGQuant$1});var AbstractDistanceCalculator$1=class{constructor(){__publicField$3(this,"_maxDistance"),__publicField$3(this,"_whitePoint"),this._setDefaults(),this.setWhitePoint(255,255,255,255)}setWhitePoint(d,m,g,w){this._whitePoint={r:d>0?255/d:0,g:m>0?255/m:0,b:g>0?255/g:0,a:w>0?255/w:0},this._maxDistance=this.calculateRaw(d,m,g,w,0,0,0,0)}calculateNormalized(d,m){return this.calculateRaw(d.r,d.g,d.b,d.a,m.r,m.g,m.b,m.a)/this._maxDistance}},AbstractCIE94$1=class extends AbstractDistanceCalculator$1{calculateRaw(d,m,g,w,I,P,F,D){const U=rgb2lab$1(inRange0to255$1(d*this._whitePoint.r),inRange0to255$1(m*this._whitePoint.g),inRange0to255$1(g*this._whitePoint.b)),Z=rgb2lab$1(inRange0to255$1(I*this._whitePoint.r),inRange0to255$1(P*this._whitePoint.g),inRange0to255$1(F*this._whitePoint.b)),$=U.L-Z.L,j=U.a-Z.a,H=U.b-Z.b,W=Math.sqrt(U.a*U.a+U.b*U.b),V=W-Math.sqrt(Z.a*Z.a+Z.b*Z.b);let Q=j*j+H*H-V*V;Q=Q<0?0:Math.sqrt(Q);const K=(D-w)*this._whitePoint.a*this._kA;return Math.sqrt(($/this._Kl)**2+(V/(1+this._K1*W))**2+(Q/(1+this._K2*W))**2+K**2)}},CIE94Textiles$1=class extends AbstractCIE94$1{_setDefaults(){this._Kl=2,this._K1=.048,this._K2=.014,this._kA=12.5/255}},CIE94GraphicArts$1=class extends AbstractCIE94$1{_setDefaults(){this._Kl=1,this._K1=.045,this._K2=.015,this._kA=25/255}},_CIEDE2000$1=class extends AbstractDistanceCalculator$1{_setDefaults(){}static _calculatehp(d,m){const g=Math.atan2(d,m);return g>=0?g:g+_CIEDE2000$1._deg360InRad}static _calculateRT(d,m){const g=m**7,w=2*Math.sqrt(g/(g+_CIEDE2000$1._pow25to7)),I=_CIEDE2000$1._deg30InRad*Math.exp(-(((d-_CIEDE2000$1._deg275InRad)/_CIEDE2000$1._deg25InRad)**2));return-Math.sin(2*I)*w}static _calculateT(d){return 1-.17*Math.cos(d-_CIEDE2000$1._deg30InRad)+.24*Math.cos(2*d)+.32*Math.cos(3*d+_CIEDE2000$1._deg6InRad)-.2*Math.cos(4*d-_CIEDE2000$1._deg63InRad)}static _calculate_ahp(d,m,g,w){const I=g+w;return d===0?I:m<=_CIEDE2000$1._deg180InRad?I/2:I<_CIEDE2000$1._deg360InRad?(I+_CIEDE2000$1._deg360InRad)/2:(I-_CIEDE2000$1._deg360InRad)/2}static _calculate_dHp(d,m,g,w){let I;return I=d===0?0:m<=_CIEDE2000$1._deg180InRad?g-w:g<=w?g-w+_CIEDE2000$1._deg360InRad:g-w-_CIEDE2000$1._deg360InRad,2*Math.sqrt(d)*Math.sin(I/2)}calculateRaw(d,m,g,w,I,P,F,D){const U=rgb2lab$1(inRange0to255$1(d*this._whitePoint.r),inRange0to255$1(m*this._whitePoint.g),inRange0to255$1(g*this._whitePoint.b)),Z=rgb2lab$1(inRange0to255$1(I*this._whitePoint.r),inRange0to255$1(P*this._whitePoint.g),inRange0to255$1(F*this._whitePoint.b)),$=(D-w)*this._whitePoint.a*_CIEDE2000$1._kA,j=this.calculateRawInLab(U,Z);return Math.sqrt(j+$*$)}calculateRawInLab(d,m){const g=d.L,w=d.a,I=d.b,P=m.L,F=m.a,D=m.b,U=((Math.sqrt(w*w+I*I)+Math.sqrt(F*F+D*D))/2)**7,Z=.5*(1-Math.sqrt(U/(U+_CIEDE2000$1._pow25to7))),$=(1+Z)*w,j=(1+Z)*F,H=Math.sqrt($*$+I*I),W=Math.sqrt(j*j+D*D),V=H*W,Q=_CIEDE2000$1._calculatehp(I,$),K=_CIEDE2000$1._calculatehp(D,j),q=Math.abs(Q-K),et=P-g,X=W-H,tt=_CIEDE2000$1._calculate_dHp(V,q,K,Q),rt=_CIEDE2000$1._calculate_ahp(V,q,Q,K),ot=(H+W)/2,J=((g+P)/2-50)**2,lt=X/(1+.045*ot),st=tt/(1+.015*_CIEDE2000$1._calculateT(rt)*ot);return(et/(1+.015*J/Math.sqrt(20+J)))**2+lt**2+st**2+_CIEDE2000$1._calculateRT(rt,ot)*lt*st}},CIEDE2000$1=_CIEDE2000$1;__publicField$3(CIEDE2000$1,"_kA",25/255),__publicField$3(CIEDE2000$1,"_pow25to7",25**7),__publicField$3(CIEDE2000$1,"_deg360InRad",degrees2radians$1(360)),__publicField$3(CIEDE2000$1,"_deg180InRad",degrees2radians$1(180)),__publicField$3(CIEDE2000$1,"_deg30InRad",degrees2radians$1(30)),__publicField$3(CIEDE2000$1,"_deg6InRad",degrees2radians$1(6)),__publicField$3(CIEDE2000$1,"_deg63InRad",degrees2radians$1(63)),__publicField$3(CIEDE2000$1,"_deg275InRad",degrees2radians$1(275)),__publicField$3(CIEDE2000$1,"_deg25InRad",degrees2radians$1(25));var CMetric$1=class extends AbstractDistanceCalculator$1{calculateRaw(d,m,g,w,I,P,F,D){const U=(d+I)/2*this._whitePoint.r,Z=(d-I)*this._whitePoint.r,$=(m-P)*this._whitePoint.g,j=(g-F)*this._whitePoint.b,H=((512+U)*Z*Z>>8)+4*$*$+((767-U)*j*j>>8),W=(D-w)*this._whitePoint.a;return Math.sqrt(H+W*W)}_setDefaults(){}},AbstractEuclidean$1=class extends AbstractDistanceCalculator$1{calculateRaw(d,m,g,w,I,P,F,D){const U=I-d,Z=P-m,$=F-g,j=D-w;return Math.sqrt(this._kR*U*U+this._kG*Z*Z+this._kB*$*$+this._kA*j*j)}},Euclidean$1=class extends AbstractEuclidean$1{_setDefaults(){this._kR=1,this._kG=1,this._kB=1,this._kA=1}},EuclideanBT709$1=class extends AbstractEuclidean$1{_setDefaults(){this._kR=.2126,this._kG=.7152,this._kB=.0722,this._kA=1}},EuclideanBT709NoAlpha$1=class extends AbstractEuclidean$1{_setDefaults(){this._kR=.2126,this._kG=.7152,this._kB=.0722,this._kA=0}},AbstractManhattan$1=class extends AbstractDistanceCalculator$1{calculateRaw(d,m,g,w,I,P,F,D){let U=I-d,Z=P-m,$=F-g,j=D-w;return U<0&&(U=0-U),Z<0&&(Z=0-Z),$<0&&($=0-$),j<0&&(j=0-j),this._kR*U+this._kG*Z+this._kB*$+this._kA*j}},Manhattan$1=class extends AbstractManhattan$1{_setDefaults(){this._kR=1,this._kG=1,this._kB=1,this._kA=1}},ManhattanNommyde$1=class extends AbstractManhattan$1{_setDefaults(){this._kR=.4984,this._kG=.8625,this._kB=.2979,this._kA=1}},ManhattanBT709$1=class extends AbstractManhattan$1{_setDefaults(){this._kR=.2126,this._kG=.7152,this._kB=.0722,this._kA=1}},PNGQuant$1=class extends AbstractDistanceCalculator$1{calculateRaw(d,m,g,w,I,P,F,D){const U=(D-w)*this._whitePoint.a;return this._colordifferenceCh(d*this._whitePoint.r,I*this._whitePoint.r,U)+this._colordifferenceCh(m*this._whitePoint.g,P*this._whitePoint.g,U)+this._colordifferenceCh(g*this._whitePoint.b,F*this._whitePoint.b,U)}_colordifferenceCh(d,m,g){const w=d-m,I=w+g;return w*w+I*I}_setDefaults(){}},palette_exports$1={};__export$1(palette_exports$1,{AbstractPaletteQuantizer:()=>AbstractPaletteQuantizer$1,ColorHistogram:()=>ColorHistogram$1,NeuQuant:()=>NeuQuant$1,NeuQuantFloat:()=>NeuQuantFloat$1,RGBQuant:()=>RGBQuant$1,WuColorCube:()=>WuColorCube$1,WuQuant:()=>WuQuant$1});var AbstractPaletteQuantizer$1=class{quantizeSync(){for(const d of this.quantize())if(d.palette)return d.palette;throw new Error("unreachable")}},Point$1=class{constructor(){__publicField$3(this,"r"),__publicField$3(this,"g"),__publicField$3(this,"b"),__publicField$3(this,"a"),__publicField$3(this,"uint32"),__publicField$3(this,"rgba"),this.uint32=-1>>>0,this.r=this.g=this.b=this.a=0,this.rgba=new Array(4),this.rgba[0]=0,this.rgba[1]=0,this.rgba[2]=0,this.rgba[3]=0}static createByQuadruplet(d){const m=new Point$1;return m.r=0|d[0],m.g=0|d[1],m.b=0|d[2],m.a=0|d[3],m._loadUINT32(),m._loadQuadruplet(),m}static createByRGBA(d,m,g,w){const I=new Point$1;return I.r=0|d,I.g=0|m,I.b=0|g,I.a=0|w,I._loadUINT32(),I._loadQuadruplet(),I}static createByUint32(d){const m=new Point$1;return m.uint32=d>>>0,m._loadRGBA(),m._loadQuadruplet(),m}from(d){this.r=d.r,this.g=d.g,this.b=d.b,this.a=d.a,this.uint32=d.uint32,this.rgba[0]=d.r,this.rgba[1]=d.g,this.rgba[2]=d.b,this.rgba[3]=d.a}getLuminosity(d){let m=this.r,g=this.g,w=this.b;return d&&(m=Math.min(255,255-this.a+this.a*m/255),g=Math.min(255,255-this.a+this.a*g/255),w=Math.min(255,255-this.a+this.a*w/255)),.2126*m+.7152*g+.0722*w}_loadUINT32(){this.uint32=(this.a<<24|this.b<<16|this.g<<8|this.r)>>>0}_loadRGBA(){this.r=255&this.uint32,this.g=this.uint32>>>8&255,this.b=this.uint32>>>16&255,this.a=this.uint32>>>24&255}_loadQuadruplet(){this.rgba[0]=this.r,this.rgba[1]=this.g,this.rgba[2]=this.b,this.rgba[3]=this.a}},PointContainer$1=class{constructor(){__publicField$3(this,"_pointArray"),__publicField$3(this,"_width"),__publicField$3(this,"_height"),this._width=0,this._height=0,this._pointArray=[]}getWidth(){return this._width}getHeight(){return this._height}setWidth(d){this._width=d}setHeight(d){this._height=d}getPointArray(){return this._pointArray}clone(){const d=new PointContainer$1;d._width=this._width,d._height=this._height;for(let m=0,g=this._pointArray.length;m<g;m++)d._pointArray[m]=Point$1.createByUint32(0|this._pointArray[m].uint32);return d}toUint32Array(){const d=this._pointArray.length,m=new Uint32Array(d);for(let g=0;g<d;g++)m[g]=this._pointArray[g].uint32;return m}toUint8Array(){return new Uint8Array(this.toUint32Array().buffer)}static fromHTMLImageElement(d){const m=d.naturalWidth,g=d.naturalHeight,w=document.createElement("canvas");return w.width=m,w.height=g,w.getContext("2d").drawImage(d,0,0,m,g,0,0,m,g),PointContainer$1.fromHTMLCanvasElement(w)}static fromHTMLCanvasElement(d){const m=d.width,g=d.height,w=d.getContext("2d").getImageData(0,0,m,g);return PointContainer$1.fromImageData(w)}static fromImageData(d){const m=d.width,g=d.height;return PointContainer$1.fromUint8Array(d.data,m,g)}static fromUint8Array(d,m,g){switch(Object.prototype.toString.call(d)){case"[object Uint8ClampedArray]":case"[object Uint8Array]":break;default:d=new Uint8Array(d)}const w=new Uint32Array(d.buffer);return PointContainer$1.fromUint32Array(w,m,g)}static fromUint32Array(d,m,g){const w=new PointContainer$1;w._width=m,w._height=g;for(let I=0,P=d.length;I<P;I++)w._pointArray[I]=Point$1.createByUint32(0|d[I]);return w}static fromBuffer(d,m,g){const w=new Uint32Array(d.buffer,d.byteOffset,d.byteLength/Uint32Array.BYTES_PER_ELEMENT);return PointContainer$1.fromUint32Array(w,m,g)}},hueGroups$1=10;function hueGroup$1(d,m){const g=360/m;for(let w=1,I=g-g/2;w<m;w++,I+=g)if(d>=I&&d<I+g)return w;return 0}var Palette$1=class{constructor(){__publicField$3(this,"_pointContainer"),__publicField$3(this,"_pointArray",[]),__publicField$3(this,"_i32idx",{}),this._pointContainer=new PointContainer$1,this._pointContainer.setHeight(1),this._pointArray=this._pointContainer.getPointArray()}add(d){this._pointArray.push(d),this._pointContainer.setWidth(this._pointArray.length)}has(d){for(let m=this._pointArray.length-1;m>=0;m--)if(d.uint32===this._pointArray[m].uint32)return!0;return!1}getNearestColor(d,m){return this._pointArray[0|this._getNearestIndex(d,m)]}getPointContainer(){return this._pointContainer}_nearestPointFromCache(d){return typeof this._i32idx[d]=="number"?this._i32idx[d]:-1}_getNearestIndex(d,m){let g=this._nearestPointFromCache(""+m.uint32);if(g>=0)return g;let w=Number.MAX_VALUE;g=0;for(let I=0,P=this._pointArray.length;I<P;I++){const F=this._pointArray[I],D=d.calculateRaw(m.r,m.g,m.b,m.a,F.r,F.g,F.b,F.a);D<w&&(w=D,g=I)}return this._i32idx[m.uint32]=g,g}sort(){this._i32idx={},this._pointArray.sort((d,m)=>{const g=rgb2hsl$1(d.r,d.g,d.b),w=rgb2hsl$1(m.r,m.g,m.b),I=d.r===d.g&&d.g===d.b?0:1+hueGroup$1(g.h,hueGroups$1),P=(m.r===m.g&&m.g===m.b?0:1+hueGroup$1(w.h,hueGroups$1))-I;if(P)return-P;const F=d.getLuminosity(!0),D=m.getLuminosity(!0);if(D-F!=0)return D-F;const U=(100*w.s|0)-(100*g.s|0);return U?-U:0})}},utils_exports$1={};__export$1(utils_exports$1,{HueStatistics:()=>HueStatistics$1,Palette:()=>Palette$1,Point:()=>Point$1,PointContainer:()=>PointContainer$1,ProgressTracker:()=>ProgressTracker$1,arithmetic:()=>arithmetic_exports$1});var HueGroup$1=class{constructor(){__publicField$3(this,"num",0),__publicField$3(this,"cols",[])}},HueStatistics$1=class{constructor(d,m){__publicField$3(this,"_numGroups"),__publicField$3(this,"_minCols"),__publicField$3(this,"_stats"),__publicField$3(this,"_groupsFull"),this._numGroups=d,this._minCols=m,this._stats=[];for(let g=0;g<=d;g++)this._stats[g]=new HueGroup$1;this._groupsFull=0}check(d){this._groupsFull===this._numGroups+1&&(this.check=()=>{});const m=255&d,g=d>>>8&255,w=d>>>16&255,I=m===g&&g===w?0:1+hueGroup$1(rgb2hsl$1(m,g,w).h,this._numGroups),P=this._stats[I],F=this._minCols;P.num++,P.num>F||(P.num===F&&this._groupsFull++,P.num<=F&&this._stats[I].cols.push(d))}injectIntoDictionary(d){for(let m=0;m<=this._numGroups;m++)this._stats[m].num<=this._minCols&&this._stats[m].cols.forEach(g=>{d[g]?d[g]++:d[g]=1})}injectIntoArray(d){for(let m=0;m<=this._numGroups;m++)this._stats[m].num<=this._minCols&&this._stats[m].cols.forEach(g=>{d.indexOf(g)===-1&&d.push(g)})}},_ProgressTracker$1=class{constructor(d,m){__publicField$3(this,"progress"),__publicField$3(this,"_step"),__publicField$3(this,"_range"),__publicField$3(this,"_last"),__publicField$3(this,"_progressRange"),this._range=d,this._progressRange=m,this._step=Math.max(1,this._range/(_ProgressTracker$1.steps+1)|0),this._last=-this._step,this.progress=0}shouldNotify(d){return d-this._last>=this._step&&(this._last=d,this.progress=Math.min(this._progressRange*this._last/this._range,this._progressRange),!0)}},ProgressTracker$1=_ProgressTracker$1;__publicField$3(ProgressTracker$1,"steps",100);var networkBiasShift$1=3,Neuron$1=class{constructor(d){__publicField$3(this,"r"),__publicField$3(this,"g"),__publicField$3(this,"b"),__publicField$3(this,"a"),this.r=this.g=this.b=this.a=d}toPoint(){return Point$1.createByRGBA(this.r>>networkBiasShift$1,this.g>>networkBiasShift$1,this.b>>networkBiasShift$1,this.a>>networkBiasShift$1)}subtract(d,m,g,w){this.r-=0|d,this.g-=0|m,this.b-=0|g,this.a-=0|w}},_NeuQuant$1=class extends AbstractPaletteQuantizer$1{constructor(d,m=256){super(),__publicField$3(this,"_pointArray"),__publicField$3(this,"_networkSize"),__publicField$3(this,"_network"),__publicField$3(this,"_sampleFactor"),__publicField$3(this,"_radPower"),__publicField$3(this,"_freq"),__publicField$3(this,"_bias"),__publicField$3(this,"_distance"),this._distance=d,this._pointArray=[],this._sampleFactor=1,this._networkSize=m,this._distance.setWhitePoint(255<<networkBiasShift$1,255<<networkBiasShift$1,255<<networkBiasShift$1,255<<networkBiasShift$1)}sample(d){this._pointArray=this._pointArray.concat(d.getPointArray())}*quantize(){this._init(),yield*this._learn(),yield{palette:this._buildPalette(),progress:100}}_init(){this._freq=[],this._bias=[],this._radPower=[],this._network=[];for(let d=0;d<this._networkSize;d++)this._network[d]=new Neuron$1((d<<networkBiasShift$1+8)/this._networkSize|0),this._freq[d]=_NeuQuant$1._initialBias/this._networkSize|0,this._bias[d]=0}*_learn(){let d=this._sampleFactor;const m=this._pointArray.length;m<_NeuQuant$1._minpicturebytes&&(d=1);const g=30+(d-1)/3|0,w=m/d|0;let I,P=w/_NeuQuant$1._nCycles|0,F=_NeuQuant$1._initAlpha,D=(this._networkSize>>3)*_NeuQuant$1._radiusBias,U=D>>_NeuQuant$1._radiusBiasShift;U<=1&&(U=0);for(let $=0;$<U;$++)this._radPower[$]=F*((U*U-$*$)*_NeuQuant$1._radBias/(U*U))>>>0;I=m<_NeuQuant$1._minpicturebytes?1:m%_NeuQuant$1._prime1!=0?_NeuQuant$1._prime1:m%_NeuQuant$1._prime2!=0?_NeuQuant$1._prime2:m%_NeuQuant$1._prime3!=0?_NeuQuant$1._prime3:_NeuQuant$1._prime4;const Z=new ProgressTracker$1(w,99);for(let $=0,j=0;$<w;){Z.shouldNotify($)&&(yield{progress:Z.progress});const H=this._pointArray[j],W=H.b<<networkBiasShift$1,V=H.g<<networkBiasShift$1,Q=H.r<<networkBiasShift$1,K=H.a<<networkBiasShift$1,q=this._contest(W,V,Q,K);if(this._alterSingle(F,q,W,V,Q,K),U!==0&&this._alterNeighbour(U,q,W,V,Q,K),j+=I,j>=m&&(j-=m),$++,P===0&&(P=1),$%P==0){F-=F/g|0,D-=D/_NeuQuant$1._radiusDecrease|0,U=D>>_NeuQuant$1._radiusBiasShift,U<=1&&(U=0);for(let et=0;et<U;et++)this._radPower[et]=F*((U*U-et*et)*_NeuQuant$1._radBias/(U*U))>>>0}}}_buildPalette(){const d=new Palette$1;return this._network.forEach(m=>{d.add(m.toPoint())}),d.sort(),d}_alterNeighbour(d,m,g,w,I,P){let F=m-d;F<-1&&(F=-1);let D=m+d;D>this._networkSize&&(D=this._networkSize);let U=m+1,Z=m-1,$=1;for(;U<D||Z>F;){const j=this._radPower[$++]/_NeuQuant$1._alphaRadBias;if(U<D){const H=this._network[U++];H.subtract(j*(H.r-I),j*(H.g-w),j*(H.b-g),j*(H.a-P))}if(Z>F){const H=this._network[Z--];H.subtract(j*(H.r-I),j*(H.g-w),j*(H.b-g),j*(H.a-P))}}}_alterSingle(d,m,g,w,I,P){d/=_NeuQuant$1._initAlpha;const F=this._network[m];F.subtract(d*(F.r-I),d*(F.g-w),d*(F.b-g),d*(F.a-P))}_contest(d,m,g,w){const I=1020<<networkBiasShift$1;let P=2147483647,F=P,D=-1,U=D;for(let Z=0;Z<this._networkSize;Z++){const $=this._network[Z],j=this._distance.calculateNormalized($,{r:g,g:m,b:d,a:w})*I|0;j<P&&(P=j,D=Z);const H=j-(this._bias[Z]>>_NeuQuant$1._initialBiasShift-networkBiasShift$1);H<F&&(F=H,U=Z);const W=this._freq[Z]>>_NeuQuant$1._betaShift;this._freq[Z]-=W,this._bias[Z]+=W<<_NeuQuant$1._gammaShift}return this._freq[D]+=_NeuQuant$1._beta,this._bias[D]-=_NeuQuant$1._betaGamma,U}},NeuQuant$1=_NeuQuant$1;__publicField$3(NeuQuant$1,"_prime1",499),__publicField$3(NeuQuant$1,"_prime2",491),__publicField$3(NeuQuant$1,"_prime3",487),__publicField$3(NeuQuant$1,"_prime4",503),__publicField$3(NeuQuant$1,"_minpicturebytes",_NeuQuant$1._prime4),__publicField$3(NeuQuant$1,"_nCycles",100),__publicField$3(NeuQuant$1,"_initialBiasShift",16),__publicField$3(NeuQuant$1,"_initialBias",1<<_NeuQuant$1._initialBiasShift),__publicField$3(NeuQuant$1,"_gammaShift",10),__publicField$3(NeuQuant$1,"_betaShift",10),__publicField$3(NeuQuant$1,"_beta",_NeuQuant$1._initialBias>>_NeuQuant$1._betaShift),__publicField$3(NeuQuant$1,"_betaGamma",_NeuQuant$1._initialBias<<_NeuQuant$1._gammaShift-_NeuQuant$1._betaShift),__publicField$3(NeuQuant$1,"_radiusBiasShift",6),__publicField$3(NeuQuant$1,"_radiusBias",1<<_NeuQuant$1._radiusBiasShift),__publicField$3(NeuQuant$1,"_radiusDecrease",30),__publicField$3(NeuQuant$1,"_alphaBiasShift",10),__publicField$3(NeuQuant$1,"_initAlpha",1<<_NeuQuant$1._alphaBiasShift),__publicField$3(NeuQuant$1,"_radBiasShift",8),__publicField$3(NeuQuant$1,"_radBias",1<<_NeuQuant$1._radBiasShift),__publicField$3(NeuQuant$1,"_alphaRadBiasShift",_NeuQuant$1._alphaBiasShift+_NeuQuant$1._radBiasShift),__publicField$3(NeuQuant$1,"_alphaRadBias",1<<_NeuQuant$1._alphaRadBiasShift);var networkBiasShift2$1=3,NeuronFloat$1=class{constructor(d){__publicField$3(this,"r"),__publicField$3(this,"g"),__publicField$3(this,"b"),__publicField$3(this,"a"),this.r=this.g=this.b=this.a=d}toPoint(){return Point$1.createByRGBA(this.r>>networkBiasShift2$1,this.g>>networkBiasShift2$1,this.b>>networkBiasShift2$1,this.a>>networkBiasShift2$1)}subtract(d,m,g,w){this.r-=d,this.g-=m,this.b-=g,this.a-=w}},_NeuQuantFloat$1=class extends AbstractPaletteQuantizer$1{constructor(d,m=256){super(),__publicField$3(this,"_pointArray"),__publicField$3(this,"_networkSize"),__publicField$3(this,"_network"),__publicField$3(this,"_sampleFactor"),__publicField$3(this,"_radPower"),__publicField$3(this,"_freq"),__publicField$3(this,"_bias"),__publicField$3(this,"_distance"),this._distance=d,this._pointArray=[],this._sampleFactor=1,this._networkSize=m,this._distance.setWhitePoint(255<<networkBiasShift2$1,255<<networkBiasShift2$1,255<<networkBiasShift2$1,255<<networkBiasShift2$1)}sample(d){this._pointArray=this._pointArray.concat(d.getPointArray())}*quantize(){this._init(),yield*this._learn(),yield{palette:this._buildPalette(),progress:100}}_init(){this._freq=[],this._bias=[],this._radPower=[],this._network=[];for(let d=0;d<this._networkSize;d++)this._network[d]=new NeuronFloat$1((d<<networkBiasShift2$1+8)/this._networkSize),this._freq[d]=_NeuQuantFloat$1._initialBias/this._networkSize,this._bias[d]=0}*_learn(){let d=this._sampleFactor;const m=this._pointArray.length;m<_NeuQuantFloat$1._minpicturebytes&&(d=1);const g=30+(d-1)/3,w=m/d;let I,P=w/_NeuQuantFloat$1._nCycles|0,F=_NeuQuantFloat$1._initAlpha,D=(this._networkSize>>3)*_NeuQuantFloat$1._radiusBias,U=D>>_NeuQuantFloat$1._radiusBiasShift;U<=1&&(U=0);for(let $=0;$<U;$++)this._radPower[$]=F*((U*U-$*$)*_NeuQuantFloat$1._radBias/(U*U));I=m<_NeuQuantFloat$1._minpicturebytes?1:m%_NeuQuantFloat$1._prime1!=0?_NeuQuantFloat$1._prime1:m%_NeuQuantFloat$1._prime2!=0?_NeuQuantFloat$1._prime2:m%_NeuQuantFloat$1._prime3!=0?_NeuQuantFloat$1._prime3:_NeuQuantFloat$1._prime4;const Z=new ProgressTracker$1(w,99);for(let $=0,j=0;$<w;){Z.shouldNotify($)&&(yield{progress:Z.progress});const H=this._pointArray[j],W=H.b<<networkBiasShift2$1,V=H.g<<networkBiasShift2$1,Q=H.r<<networkBiasShift2$1,K=H.a<<networkBiasShift2$1,q=this._contest(W,V,Q,K);if(this._alterSingle(F,q,W,V,Q,K),U!==0&&this._alterNeighbour(U,q,W,V,Q,K),j+=I,j>=m&&(j-=m),$++,P===0&&(P=1),$%P==0){F-=F/g,D-=D/_NeuQuantFloat$1._radiusDecrease,U=D>>_NeuQuantFloat$1._radiusBiasShift,U<=1&&(U=0);for(let et=0;et<U;et++)this._radPower[et]=F*((U*U-et*et)*_NeuQuantFloat$1._radBias/(U*U))}}}_buildPalette(){const d=new Palette$1;return this._network.forEach(m=>{d.add(m.toPoint())}),d.sort(),d}_alterNeighbour(d,m,g,w,I,P){let F=m-d;F<-1&&(F=-1);let D=m+d;D>this._networkSize&&(D=this._networkSize);let U=m+1,Z=m-1,$=1;for(;U<D||Z>F;){const j=this._radPower[$++]/_NeuQuantFloat$1._alphaRadBias;if(U<D){const H=this._network[U++];H.subtract(j*(H.r-I),j*(H.g-w),j*(H.b-g),j*(H.a-P))}if(Z>F){const H=this._network[Z--];H.subtract(j*(H.r-I),j*(H.g-w),j*(H.b-g),j*(H.a-P))}}}_alterSingle(d,m,g,w,I,P){d/=_NeuQuantFloat$1._initAlpha;const F=this._network[m];F.subtract(d*(F.r-I),d*(F.g-w),d*(F.b-g),d*(F.a-P))}_contest(d,m,g,w){const I=1020<<networkBiasShift2$1;let P=2147483647,F=P,D=-1,U=D;for(let Z=0;Z<this._networkSize;Z++){const $=this._network[Z],j=this._distance.calculateNormalized($,{r:g,g:m,b:d,a:w})*I;j<P&&(P=j,D=Z);const H=j-(this._bias[Z]>>_NeuQuantFloat$1._initialBiasShift-networkBiasShift2$1);H<F&&(F=H,U=Z);const W=this._freq[Z]>>_NeuQuantFloat$1._betaShift;this._freq[Z]-=W,this._bias[Z]+=W<<_NeuQuantFloat$1._gammaShift}return this._freq[D]+=_NeuQuantFloat$1._beta,this._bias[D]-=_NeuQuantFloat$1._betaGamma,U}},NeuQuantFloat$1=_NeuQuantFloat$1;__publicField$3(NeuQuantFloat$1,"_prime1",499),__publicField$3(NeuQuantFloat$1,"_prime2",491),__publicField$3(NeuQuantFloat$1,"_prime3",487),__publicField$3(NeuQuantFloat$1,"_prime4",503),__publicField$3(NeuQuantFloat$1,"_minpicturebytes",_NeuQuantFloat$1._prime4),__publicField$3(NeuQuantFloat$1,"_nCycles",100),__publicField$3(NeuQuantFloat$1,"_initialBiasShift",16),__publicField$3(NeuQuantFloat$1,"_initialBias",1<<_NeuQuantFloat$1._initialBiasShift),__publicField$3(NeuQuantFloat$1,"_gammaShift",10),__publicField$3(NeuQuantFloat$1,"_betaShift",10),__publicField$3(NeuQuantFloat$1,"_beta",_NeuQuantFloat$1._initialBias>>_NeuQuantFloat$1._betaShift),__publicField$3(NeuQuantFloat$1,"_betaGamma",_NeuQuantFloat$1._initialBias<<_NeuQuantFloat$1._gammaShift-_NeuQuantFloat$1._betaShift),__publicField$3(NeuQuantFloat$1,"_radiusBiasShift",6),__publicField$3(NeuQuantFloat$1,"_radiusBias",1<<_NeuQuantFloat$1._radiusBiasShift),__publicField$3(NeuQuantFloat$1,"_radiusDecrease",30),__publicField$3(NeuQuantFloat$1,"_alphaBiasShift",10),__publicField$3(NeuQuantFloat$1,"_initAlpha",1<<_NeuQuantFloat$1._alphaBiasShift),__publicField$3(NeuQuantFloat$1,"_radBiasShift",8),__publicField$3(NeuQuantFloat$1,"_radBias",1<<_NeuQuantFloat$1._radBiasShift),__publicField$3(NeuQuantFloat$1,"_alphaRadBiasShift",_NeuQuantFloat$1._alphaBiasShift+_NeuQuantFloat$1._radBiasShift),__publicField$3(NeuQuantFloat$1,"_alphaRadBias",1<<_NeuQuantFloat$1._alphaRadBiasShift);var _ColorHistogram$1=class{constructor(d,m){__publicField$3(this,"_method"),__publicField$3(this,"_hueStats"),__publicField$3(this,"_histogram"),__publicField$3(this,"_initColors"),__publicField$3(this,"_minHueCols"),this._method=d,this._minHueCols=m<<2,this._initColors=m<<2,this._hueStats=new HueStatistics$1(_ColorHistogram$1._hueGroups,this._minHueCols),this._histogram=Object.create(null)}sample(d){switch(this._method){case 1:this._colorStats1D(d);break;case 2:this._colorStats2D(d)}}getImportanceSortedColorsIDXI32(){const d=stableSort$1(Object.keys(this._histogram),(g,w)=>this._histogram[w]-this._histogram[g]);if(d.length===0)return[];let m;switch(this._method){case 1:const g=Math.min(d.length,this._initColors),w=d[g-1],I=this._histogram[w];m=d.slice(0,g);let P=g;const F=d.length;for(;P<F&&this._histogram[d[P]]===I;)m.push(d[P++]);this._hueStats.injectIntoArray(m);break;case 2:m=d;break;default:throw new Error("Incorrect method")}return m.map(g=>+g)}_colorStats1D(d){const m=this._histogram,g=d.getPointArray(),w=g.length;for(let I=0;I<w;I++){const P=g[I].uint32;this._hueStats.check(P),P in m?m[P]++:m[P]=1}}_colorStats2D(d){const m=d.getWidth(),g=d.getHeight(),w=d.getPointArray(),I=_ColorHistogram$1._boxSize[0],P=_ColorHistogram$1._boxSize[1],F=I*P,D=this._makeBoxes(m,g,I,P),U=this._histogram;D.forEach(Z=>{let $=Math.round(Z.w*Z.h/F)*_ColorHistogram$1._boxPixels;$<2&&($=2);const j={};this._iterateBox(Z,m,H=>{const W=w[H].uint32;this._hueStats.check(W),W in U?U[W]++:W in j?++j[W]>=$&&(U[W]=j[W]):j[W]=1})}),this._hueStats.injectIntoDictionary(U)}_iterateBox(d,m,g){const w=d,I=w.y*m+w.x,P=(w.y+w.h-1)*m+(w.x+w.w-1),F=m-w.w+1;let D=0,U=I;do g.call(this,U),U+=++D%w.w==0?F:1;while(U<=P)}_makeBoxes(d,m,g,w){const I=d%g,P=m%w,F=d-I,D=m-P,U=[];for(let Z=0;Z<m;Z+=w)for(let $=0;$<d;$+=g)U.push({x:$,y:Z,w:$===F?I:g,h:Z===D?P:w});return U}},ColorHistogram$1=_ColorHistogram$1;__publicField$3(ColorHistogram$1,"_boxSize",[64,64]),__publicField$3(ColorHistogram$1,"_boxPixels",2),__publicField$3(ColorHistogram$1,"_hueGroups",10);var RemovedColor$1=class{constructor(d,m,g){__publicField$3(this,"index"),__publicField$3(this,"color"),__publicField$3(this,"distance"),this.index=d,this.color=m,this.distance=g}},RGBQuant$1=class extends AbstractPaletteQuantizer$1{constructor(d,m=256,g=2){super(),__publicField$3(this,"_colors"),__publicField$3(this,"_initialDistance"),__publicField$3(this,"_distanceIncrement"),__publicField$3(this,"_histogram"),__publicField$3(this,"_distance"),this._distance=d,this._colors=m,this._histogram=new ColorHistogram$1(g,m),this._initialDistance=.01,this._distanceIncrement=.005}sample(d){this._histogram.sample(d)}*quantize(){const d=this._histogram.getImportanceSortedColorsIDXI32();if(d.length===0)throw new Error("No colors in image");yield*this._buildPalette(d)}*_buildPalette(d){const m=new Palette$1,g=m.getPointContainer().getPointArray(),w=new Array(d.length);for(let $=0;$<d.length;$++)g.push(Point$1.createByUint32(d[$])),w[$]=1;const I=g.length,P=[];let F=I,D=this._initialDistance;const U=new ProgressTracker$1(F-this._colors,99);for(;F>this._colors;){P.length=0;for(let $=0;$<I;$++){if(U.shouldNotify(I-F)&&(yield{progress:U.progress}),w[$]===0)continue;const j=g[$];for(let H=$+1;H<I;H++){if(w[H]===0)continue;const W=g[H],V=this._distance.calculateNormalized(j,W);V<D&&(P.push(new RemovedColor$1(H,W,V)),w[H]=0,F--)}}D+=F>3*this._colors?this._initialDistance:this._distanceIncrement}if(F<this._colors){stableSort$1(P,(j,H)=>H.distance-j.distance);let $=0;for(;F<this._colors&&$<P.length;)w[P[$].index]=1,F++,$++}let Z=g.length;for(let $=Z-1;$>=0;$--)w[$]===0&&($!==Z-1&&(g[$]=g[Z-1]),--Z);g.length=Z,m.sort(),yield{palette:m,progress:100}}};function createArray1D$1(d){const m=[];for(let g=0;g<d;g++)m[g]=0;return m}function createArray4D$1(d,m,g,w){const I=new Array(d);for(let P=0;P<d;P++){I[P]=new Array(m);for(let F=0;F<m;F++){I[P][F]=new Array(g);for(let D=0;D<g;D++){I[P][F][D]=new Array(w);for(let U=0;U<w;U++)I[P][F][D][U]=0}}}return I}function createArray3D$1(d,m,g){const w=new Array(d);for(let I=0;I<d;I++){w[I]=new Array(m);for(let P=0;P<m;P++){w[I][P]=new Array(g);for(let F=0;F<g;F++)w[I][P][F]=0}}return w}function fillArray3D$1(d,m,g,w,I){for(let P=0;P<m;P++){d[P]=[];for(let F=0;F<g;F++){d[P][F]=[];for(let D=0;D<w;D++)d[P][F][D]=I}}}function fillArray1D$1(d,m,g){for(let w=0;w<m;w++)d[w]=g}var WuColorCube$1=class{constructor(){__publicField$3(this,"redMinimum"),__publicField$3(this,"redMaximum"),__publicField$3(this,"greenMinimum"),__publicField$3(this,"greenMaximum"),__publicField$3(this,"blueMinimum"),__publicField$3(this,"blueMaximum"),__publicField$3(this,"volume"),__publicField$3(this,"alphaMinimum"),__publicField$3(this,"alphaMaximum")}},_WuQuant$1=class extends AbstractPaletteQuantizer$1{constructor(d,m=256,g=5){super(),__publicField$3(this,"_reds"),__publicField$3(this,"_greens"),__publicField$3(this,"_blues"),__publicField$3(this,"_alphas"),__publicField$3(this,"_sums"),__publicField$3(this,"_weights"),__publicField$3(this,"_momentsRed"),__publicField$3(this,"_momentsGreen"),__publicField$3(this,"_momentsBlue"),__publicField$3(this,"_momentsAlpha"),__publicField$3(this,"_moments"),__publicField$3(this,"_table"),__publicField$3(this,"_pixels"),__publicField$3(this,"_cubes"),__publicField$3(this,"_colors"),__publicField$3(this,"_significantBitsPerChannel"),__publicField$3(this,"_maxSideIndex"),__publicField$3(this,"_alphaMaxSideIndex"),__publicField$3(this,"_sideSize"),__publicField$3(this,"_alphaSideSize"),__publicField$3(this,"_distance"),this._distance=d,this._setQuality(g),this._initialize(m)}sample(d){const m=d.getPointArray();for(let g=0,w=m.length;g<w;g++)this._addColor(m[g]);this._pixels=this._pixels.concat(m)}*quantize(){yield*this._preparePalette();const d=new Palette$1;for(let m=0;m<this._colors;m++)if(this._sums[m]>0){const g=this._sums[m],w=this._reds[m]/g,I=this._greens[m]/g,P=this._blues[m]/g,F=this._alphas[m]/g,D=Point$1.createByRGBA(0|w,0|I,0|P,0|F);d.add(D)}d.sort(),yield{palette:d,progress:100}}*_preparePalette(){yield*this._calculateMoments();let d=0;const m=createArray1D$1(this._colors);for(let F=1;F<this._colors;++F){this._cut(this._cubes[d],this._cubes[F])?(m[d]=this._cubes[d].volume>1?this._calculateVariance(this._cubes[d]):0,m[F]=this._cubes[F].volume>1?this._calculateVariance(this._cubes[F]):0):(m[d]=0,F--),d=0;let D=m[0];for(let U=1;U<=F;++U)m[U]>D&&(D=m[U],d=U);if(D<=0){this._colors=F+1;break}}const g=[],w=[],I=[],P=[];for(let F=0;F<this._colors;++F){const D=_WuQuant$1._volume(this._cubes[F],this._weights);D>0?(g[F]=_WuQuant$1._volume(this._cubes[F],this._momentsRed)/D|0,w[F]=_WuQuant$1._volume(this._cubes[F],this._momentsGreen)/D|0,I[F]=_WuQuant$1._volume(this._cubes[F],this._momentsBlue)/D|0,P[F]=_WuQuant$1._volume(this._cubes[F],this._momentsAlpha)/D|0):(g[F]=0,w[F]=0,I[F]=0,P[F]=0)}this._reds=createArray1D$1(this._colors+1),this._greens=createArray1D$1(this._colors+1),this._blues=createArray1D$1(this._colors+1),this._alphas=createArray1D$1(this._colors+1),this._sums=createArray1D$1(this._colors+1);for(let F=0,D=this._pixels.length;F<D;F++){const U=this._pixels[F];let Z=-1,$=Number.MAX_VALUE;for(let j=0;j<this._colors;j++){const H=g[j],W=w[j],V=I[j],Q=P[j],K=this._distance.calculateRaw(H,W,V,Q,U.r,U.g,U.b,U.a);K<$&&($=K,Z=j)}this._reds[Z]+=U.r,this._greens[Z]+=U.g,this._blues[Z]+=U.b,this._alphas[Z]+=U.a,this._sums[Z]++}}_addColor(d){const m=8-this._significantBitsPerChannel,g=1+(d.r>>m),w=1+(d.g>>m),I=1+(d.b>>m),P=1+(d.a>>m);this._weights[P][g][w][I]++,this._momentsRed[P][g][w][I]+=d.r,this._momentsGreen[P][g][w][I]+=d.g,this._momentsBlue[P][g][w][I]+=d.b,this._momentsAlpha[P][g][w][I]+=d.a,this._moments[P][g][w][I]+=this._table[d.r]+this._table[d.g]+this._table[d.b]+this._table[d.a]}*_calculateMoments(){const d=[],m=[],g=[],w=[],I=[],P=[],F=createArray3D$1(this._sideSize,this._sideSize,this._sideSize),D=createArray3D$1(this._sideSize,this._sideSize,this._sideSize),U=createArray3D$1(this._sideSize,this._sideSize,this._sideSize),Z=createArray3D$1(this._sideSize,this._sideSize,this._sideSize),$=createArray3D$1(this._sideSize,this._sideSize,this._sideSize),j=createArray3D$1(this._sideSize,this._sideSize,this._sideSize);let H=0;const W=new ProgressTracker$1(this._alphaMaxSideIndex*this._maxSideIndex,99);for(let V=1;V<=this._alphaMaxSideIndex;++V){fillArray3D$1(F,this._sideSize,this._sideSize,this._sideSize,0),fillArray3D$1(D,this._sideSize,this._sideSize,this._sideSize,0),fillArray3D$1(U,this._sideSize,this._sideSize,this._sideSize,0),fillArray3D$1(Z,this._sideSize,this._sideSize,this._sideSize,0),fillArray3D$1($,this._sideSize,this._sideSize,this._sideSize,0),fillArray3D$1(j,this._sideSize,this._sideSize,this._sideSize,0);for(let Q=1;Q<=this._maxSideIndex;++Q,++H){W.shouldNotify(H)&&(yield{progress:W.progress}),fillArray1D$1(d,this._sideSize,0),fillArray1D$1(m,this._sideSize,0),fillArray1D$1(g,this._sideSize,0),fillArray1D$1(w,this._sideSize,0),fillArray1D$1(I,this._sideSize,0),fillArray1D$1(P,this._sideSize,0);for(let K=1;K<=this._maxSideIndex;++K){let q=0,et=0,X=0,tt=0,rt=0,ot=0;for(let J=1;J<=this._maxSideIndex;++J)q+=this._weights[V][Q][K][J],et+=this._momentsRed[V][Q][K][J],X+=this._momentsGreen[V][Q][K][J],tt+=this._momentsBlue[V][Q][K][J],rt+=this._momentsAlpha[V][Q][K][J],ot+=this._moments[V][Q][K][J],d[J]+=q,m[J]+=et,g[J]+=X,w[J]+=tt,I[J]+=rt,P[J]+=ot,F[Q][K][J]=F[Q-1][K][J]+d[J],D[Q][K][J]=D[Q-1][K][J]+m[J],U[Q][K][J]=U[Q-1][K][J]+g[J],Z[Q][K][J]=Z[Q-1][K][J]+w[J],$[Q][K][J]=$[Q-1][K][J]+I[J],j[Q][K][J]=j[Q-1][K][J]+P[J],this._weights[V][Q][K][J]=this._weights[V-1][Q][K][J]+F[Q][K][J],this._momentsRed[V][Q][K][J]=this._momentsRed[V-1][Q][K][J]+D[Q][K][J],this._momentsGreen[V][Q][K][J]=this._momentsGreen[V-1][Q][K][J]+U[Q][K][J],this._momentsBlue[V][Q][K][J]=this._momentsBlue[V-1][Q][K][J]+Z[Q][K][J],this._momentsAlpha[V][Q][K][J]=this._momentsAlpha[V-1][Q][K][J]+$[Q][K][J],this._moments[V][Q][K][J]=this._moments[V-1][Q][K][J]+j[Q][K][J]}}}}static _volumeFloat(d,m){return m[d.alphaMaximum][d.redMaximum][d.greenMaximum][d.blueMaximum]-m[d.alphaMaximum][d.redMaximum][d.greenMinimum][d.blueMaximum]-m[d.alphaMaximum][d.redMinimum][d.greenMaximum][d.blueMaximum]+m[d.alphaMaximum][d.redMinimum][d.greenMinimum][d.blueMaximum]-m[d.alphaMinimum][d.redMaximum][d.greenMaximum][d.blueMaximum]+m[d.alphaMinimum][d.redMaximum][d.greenMinimum][d.blueMaximum]+m[d.alphaMinimum][d.redMinimum][d.greenMaximum][d.blueMaximum]-m[d.alphaMinimum][d.redMinimum][d.greenMinimum][d.blueMaximum]-(m[d.alphaMaximum][d.redMaximum][d.greenMaximum][d.blueMinimum]-m[d.alphaMinimum][d.redMaximum][d.greenMaximum][d.blueMinimum]-m[d.alphaMaximum][d.redMaximum][d.greenMinimum][d.blueMinimum]+m[d.alphaMinimum][d.redMaximum][d.greenMinimum][d.blueMinimum]-m[d.alphaMaximum][d.redMinimum][d.greenMaximum][d.blueMinimum]+m[d.alphaMinimum][d.redMinimum][d.greenMaximum][d.blueMinimum]+m[d.alphaMaximum][d.redMinimum][d.greenMinimum][d.blueMinimum]-m[d.alphaMinimum][d.redMinimum][d.greenMinimum][d.blueMinimum])}static _volume(d,m){return 0|_WuQuant$1._volumeFloat(d,m)}static _top(d,m,g,w){let I;switch(m){case _WuQuant$1._alpha:I=w[g][d.redMaximum][d.greenMaximum][d.blueMaximum]-w[g][d.redMaximum][d.greenMinimum][d.blueMaximum]-w[g][d.redMinimum][d.greenMaximum][d.blueMaximum]+w[g][d.redMinimum][d.greenMinimum][d.blueMaximum]-(w[g][d.redMaximum][d.greenMaximum][d.blueMinimum]-w[g][d.redMaximum][d.greenMinimum][d.blueMinimum]-w[g][d.redMinimum][d.greenMaximum][d.blueMinimum]+w[g][d.redMinimum][d.greenMinimum][d.blueMinimum]);break;case _WuQuant$1._red:I=w[d.alphaMaximum][g][d.greenMaximum][d.blueMaximum]-w[d.alphaMaximum][g][d.greenMinimum][d.blueMaximum]-w[d.alphaMinimum][g][d.greenMaximum][d.blueMaximum]+w[d.alphaMinimum][g][d.greenMinimum][d.blueMaximum]-(w[d.alphaMaximum][g][d.greenMaximum][d.blueMinimum]-w[d.alphaMaximum][g][d.greenMinimum][d.blueMinimum]-w[d.alphaMinimum][g][d.greenMaximum][d.blueMinimum]+w[d.alphaMinimum][g][d.greenMinimum][d.blueMinimum]);break;case _WuQuant$1._green:I=w[d.alphaMaximum][d.redMaximum][g][d.blueMaximum]-w[d.alphaMaximum][d.redMinimum][g][d.blueMaximum]-w[d.alphaMinimum][d.redMaximum][g][d.blueMaximum]+w[d.alphaMinimum][d.redMinimum][g][d.blueMaximum]-(w[d.alphaMaximum][d.redMaximum][g][d.blueMinimum]-w[d.alphaMaximum][d.redMinimum][g][d.blueMinimum]-w[d.alphaMinimum][d.redMaximum][g][d.blueMinimum]+w[d.alphaMinimum][d.redMinimum][g][d.blueMinimum]);break;case _WuQuant$1._blue:I=w[d.alphaMaximum][d.redMaximum][d.greenMaximum][g]-w[d.alphaMaximum][d.redMaximum][d.greenMinimum][g]-w[d.alphaMaximum][d.redMinimum][d.greenMaximum][g]+w[d.alphaMaximum][d.redMinimum][d.greenMinimum][g]-(w[d.alphaMinimum][d.redMaximum][d.greenMaximum][g]-w[d.alphaMinimum][d.redMaximum][d.greenMinimum][g]-w[d.alphaMinimum][d.redMinimum][d.greenMaximum][g]+w[d.alphaMinimum][d.redMinimum][d.greenMinimum][g]);break;default:throw new Error("impossible")}return 0|I}static _bottom(d,m,g){switch(m){case _WuQuant$1._alpha:return-g[d.alphaMinimum][d.redMaximum][d.greenMaximum][d.blueMaximum]+g[d.alphaMinimum][d.redMaximum][d.greenMinimum][d.blueMaximum]+g[d.alphaMinimum][d.redMinimum][d.greenMaximum][d.blueMaximum]-g[d.alphaMinimum][d.redMinimum][d.greenMinimum][d.blueMaximum]-(-g[d.alphaMinimum][d.redMaximum][d.greenMaximum][d.blueMinimum]+g[d.alphaMinimum][d.redMaximum][d.greenMinimum][d.blueMinimum]+g[d.alphaMinimum][d.redMinimum][d.greenMaximum][d.blueMinimum]-g[d.alphaMinimum][d.redMinimum][d.greenMinimum][d.blueMinimum]);case _WuQuant$1._red:return-g[d.alphaMaximum][d.redMinimum][d.greenMaximum][d.blueMaximum]+g[d.alphaMaximum][d.redMinimum][d.greenMinimum][d.blueMaximum]+g[d.alphaMinimum][d.redMinimum][d.greenMaximum][d.blueMaximum]-g[d.alphaMinimum][d.redMinimum][d.greenMinimum][d.blueMaximum]-(-g[d.alphaMaximum][d.redMinimum][d.greenMaximum][d.blueMinimum]+g[d.alphaMaximum][d.redMinimum][d.greenMinimum][d.blueMinimum]+g[d.alphaMinimum][d.redMinimum][d.greenMaximum][d.blueMinimum]-g[d.alphaMinimum][d.redMinimum][d.greenMinimum][d.blueMinimum]);case _WuQuant$1._green:return-g[d.alphaMaximum][d.redMaximum][d.greenMinimum][d.blueMaximum]+g[d.alphaMaximum][d.redMinimum][d.greenMinimum][d.blueMaximum]+g[d.alphaMinimum][d.redMaximum][d.greenMinimum][d.blueMaximum]-g[d.alphaMinimum][d.redMinimum][d.greenMinimum][d.blueMaximum]-(-g[d.alphaMaximum][d.redMaximum][d.greenMinimum][d.blueMinimum]+g[d.alphaMaximum][d.redMinimum][d.greenMinimum][d.blueMinimum]+g[d.alphaMinimum][d.redMaximum][d.greenMinimum][d.blueMinimum]-g[d.alphaMinimum][d.redMinimum][d.greenMinimum][d.blueMinimum]);case _WuQuant$1._blue:return-g[d.alphaMaximum][d.redMaximum][d.greenMaximum][d.blueMinimum]+g[d.alphaMaximum][d.redMaximum][d.greenMinimum][d.blueMinimum]+g[d.alphaMaximum][d.redMinimum][d.greenMaximum][d.blueMinimum]-g[d.alphaMaximum][d.redMinimum][d.greenMinimum][d.blueMinimum]-(-g[d.alphaMinimum][d.redMaximum][d.greenMaximum][d.blueMinimum]+g[d.alphaMinimum][d.redMaximum][d.greenMinimum][d.blueMinimum]+g[d.alphaMinimum][d.redMinimum][d.greenMaximum][d.blueMinimum]-g[d.alphaMinimum][d.redMinimum][d.greenMinimum][d.blueMinimum]);default:return 0}}_calculateVariance(d){const m=_WuQuant$1._volume(d,this._momentsRed),g=_WuQuant$1._volume(d,this._momentsGreen),w=_WuQuant$1._volume(d,this._momentsBlue),I=_WuQuant$1._volume(d,this._momentsAlpha);return _WuQuant$1._volumeFloat(d,this._moments)-(m*m+g*g+w*w+I*I)/_WuQuant$1._volume(d,this._weights)}_maximize(d,m,g,w,I,P,F,D,U){const Z=0|_WuQuant$1._bottom(d,m,this._momentsRed),$=0|_WuQuant$1._bottom(d,m,this._momentsGreen),j=0|_WuQuant$1._bottom(d,m,this._momentsBlue),H=0|_WuQuant$1._bottom(d,m,this._momentsAlpha),W=0|_WuQuant$1._bottom(d,m,this._weights);let V=0,Q=-1;for(let K=g;K<w;++K){let q=Z+_WuQuant$1._top(d,m,K,this._momentsRed),et=$+_WuQuant$1._top(d,m,K,this._momentsGreen),X=j+_WuQuant$1._top(d,m,K,this._momentsBlue),tt=H+_WuQuant$1._top(d,m,K,this._momentsAlpha),rt=W+_WuQuant$1._top(d,m,K,this._weights);if(rt!==0){let ot=q*q+et*et+X*X+tt*tt,J=ot/rt;q=I-q,et=P-et,X=F-X,tt=D-tt,rt=U-rt,rt!==0&&(ot=q*q+et*et+X*X+tt*tt,J+=ot/rt,J>V&&(V=J,Q=K))}}return{max:V,position:Q}}_cut(d,m){let g;const w=_WuQuant$1._volume(d,this._momentsRed),I=_WuQuant$1._volume(d,this._momentsGreen),P=_WuQuant$1._volume(d,this._momentsBlue),F=_WuQuant$1._volume(d,this._momentsAlpha),D=_WuQuant$1._volume(d,this._weights),U=this._maximize(d,_WuQuant$1._red,d.redMinimum+1,d.redMaximum,w,I,P,F,D),Z=this._maximize(d,_WuQuant$1._green,d.greenMinimum+1,d.greenMaximum,w,I,P,F,D),$=this._maximize(d,_WuQuant$1._blue,d.blueMinimum+1,d.blueMaximum,w,I,P,F,D),j=this._maximize(d,_WuQuant$1._alpha,d.alphaMinimum+1,d.alphaMaximum,w,I,P,F,D);if(j.max>=U.max&&j.max>=Z.max&&j.max>=$.max){if(g=_WuQuant$1._alpha,j.position<0)return!1}else g=U.max>=j.max&&U.max>=Z.max&&U.max>=$.max?_WuQuant$1._red:Z.max>=j.max&&Z.max>=U.max&&Z.max>=$.max?_WuQuant$1._green:_WuQuant$1._blue;switch(m.redMaximum=d.redMaximum,m.greenMaximum=d.greenMaximum,m.blueMaximum=d.blueMaximum,m.alphaMaximum=d.alphaMaximum,g){case _WuQuant$1._red:m.redMinimum=d.redMaximum=U.position,m.greenMinimum=d.greenMinimum,m.blueMinimum=d.blueMinimum,m.alphaMinimum=d.alphaMinimum;break;case _WuQuant$1._green:m.greenMinimum=d.greenMaximum=Z.position,m.redMinimum=d.redMinimum,m.blueMinimum=d.blueMinimum,m.alphaMinimum=d.alphaMinimum;break;case _WuQuant$1._blue:m.blueMinimum=d.blueMaximum=$.position,m.redMinimum=d.redMinimum,m.greenMinimum=d.greenMinimum,m.alphaMinimum=d.alphaMinimum;break;case _WuQuant$1._alpha:m.alphaMinimum=d.alphaMaximum=j.position,m.blueMinimum=d.blueMinimum,m.redMinimum=d.redMinimum,m.greenMinimum=d.greenMinimum}return d.volume=(d.redMaximum-d.redMinimum)*(d.greenMaximum-d.greenMinimum)*(d.blueMaximum-d.blueMinimum)*(d.alphaMaximum-d.alphaMinimum),m.volume=(m.redMaximum-m.redMinimum)*(m.greenMaximum-m.greenMinimum)*(m.blueMaximum-m.blueMinimum)*(m.alphaMaximum-m.alphaMinimum),!0}_initialize(d){this._colors=d,this._cubes=[];for(let m=0;m<d;m++)this._cubes[m]=new WuColorCube$1;this._cubes[0].redMinimum=0,this._cubes[0].greenMinimum=0,this._cubes[0].blueMinimum=0,this._cubes[0].alphaMinimum=0,this._cubes[0].redMaximum=this._maxSideIndex,this._cubes[0].greenMaximum=this._maxSideIndex,this._cubes[0].blueMaximum=this._maxSideIndex,this._cubes[0].alphaMaximum=this._alphaMaxSideIndex,this._weights=createArray4D$1(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._momentsRed=createArray4D$1(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._momentsGreen=createArray4D$1(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._momentsBlue=createArray4D$1(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._momentsAlpha=createArray4D$1(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._moments=createArray4D$1(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._table=[];for(let m=0;m<256;++m)this._table[m]=m*m;this._pixels=[]}_setQuality(d=5){this._significantBitsPerChannel=d,this._maxSideIndex=1<<this._significantBitsPerChannel,this._alphaMaxSideIndex=this._maxSideIndex,this._sideSize=this._maxSideIndex+1,this._alphaSideSize=this._alphaMaxSideIndex+1}},WuQuant$1=_WuQuant$1;__publicField$3(WuQuant$1,"_alpha",3),__publicField$3(WuQuant$1,"_red",2),__publicField$3(WuQuant$1,"_green",1),__publicField$3(WuQuant$1,"_blue",0);var image_exports$1={};__export$1(image_exports$1,{AbstractImageQuantizer:()=>AbstractImageQuantizer$1,ErrorDiffusionArray:()=>ErrorDiffusionArray$1,ErrorDiffusionArrayKernel:()=>ErrorDiffusionArrayKernel$1,ErrorDiffusionRiemersma:()=>ErrorDiffusionRiemersma$1,NearestColor:()=>NearestColor$1});var AbstractImageQuantizer$1=class{quantizeSync(d,m){for(const g of this.quantize(d,m))if(g.pointContainer)return g.pointContainer;throw new Error("unreachable")}},NearestColor$1=class extends AbstractImageQuantizer$1{constructor(d){super(),__publicField$3(this,"_distance"),this._distance=d}*quantize(d,m){const g=d.getPointArray(),w=d.getWidth(),I=d.getHeight(),P=new ProgressTracker$1(I,99);for(let F=0;F<I;F++){P.shouldNotify(F)&&(yield{progress:P.progress});for(let D=0,U=F*w;D<w;D++,U++){const Z=g[U];Z.from(m.getNearestColor(this._distance,Z))}}yield{pointContainer:d,progress:100}}},ErrorDiffusionArrayKernel$1=(d=>(d[d.FloydSteinberg=0]="FloydSteinberg",d[d.FalseFloydSteinberg=1]="FalseFloydSteinberg",d[d.Stucki=2]="Stucki",d[d.Atkinson=3]="Atkinson",d[d.Jarvis=4]="Jarvis",d[d.Burkes=5]="Burkes",d[d.Sierra=6]="Sierra",d[d.TwoSierra=7]="TwoSierra",d[d.SierraLite=8]="SierraLite",d))(ErrorDiffusionArrayKernel$1||{}),ErrorDiffusionArray$1=class extends AbstractImageQuantizer$1{constructor(d,m,g=!0,w=0,I=!1){super(),__publicField$3(this,"_minColorDistance"),__publicField$3(this,"_serpentine"),__publicField$3(this,"_kernel"),__publicField$3(this,"_calculateErrorLikeGIMP"),__publicField$3(this,"_distance"),this._setKernel(m),this._distance=d,this._minColorDistance=w,this._serpentine=g,this._calculateErrorLikeGIMP=I}*quantize(d,m){const g=d.getPointArray(),w=new Point$1,I=d.getWidth(),P=d.getHeight(),F=[];let D=1,U=1;for(const $ of this._kernel){const j=$[2]+1;U<j&&(U=j)}for(let $=0;$<U;$++)this._fillErrorLine(F[$]=[],I);const Z=new ProgressTracker$1(P,99);for(let $=0;$<P;$++){Z.shouldNotify($)&&(yield{progress:Z.progress}),this._serpentine&&(D*=-1);const j=$*I,H=D===1?0:I-1,W=D===1?I:-1;this._fillErrorLine(F[0],I),F.push(F.shift());const V=F[0];for(let Q=H,K=j+H;Q!==W;Q+=D,K+=D){const q=g[K],et=V[Q];w.from(q);const X=Point$1.createByRGBA(inRange0to255Rounded$1(q.r+et[0]),inRange0to255Rounded$1(q.g+et[1]),inRange0to255Rounded$1(q.b+et[2]),inRange0to255Rounded$1(q.a+et[3])),tt=m.getNearestColor(this._distance,X);if(q.from(tt),this._minColorDistance&&this._distance.calculateNormalized(w,tt)<this._minColorDistance)continue;let rt,ot,J,lt;this._calculateErrorLikeGIMP?(rt=X.r-tt.r,ot=X.g-tt.g,J=X.b-tt.b,lt=X.a-tt.a):(rt=w.r-tt.r,ot=w.g-tt.g,J=w.b-tt.b,lt=w.a-tt.a);const st=D===1?0:this._kernel.length-1,ut=D===1?this._kernel.length:-1;for(let it=st;it!==ut;it+=D){const ct=this._kernel[it][1]*D,At=this._kernel[it][2];if(ct+Q>=0&&ct+Q<I&&At+$>=0&&At+$<P){const Et=this._kernel[it][0],gt=F[At][ct+Q];gt[0]+=rt*Et,gt[1]+=ot*Et,gt[2]+=J*Et,gt[3]+=lt*Et}}}}yield{pointContainer:d,progress:100}}_fillErrorLine(d,m){d.length>m&&(d.length=m);const g=d.length;for(let w=0;w<g;w++){const I=d[w];I[0]=I[1]=I[2]=I[3]=0}for(let w=g;w<m;w++)d[w]=[0,0,0,0]}_setKernel(d){switch(d){case 0:this._kernel=[[7/16,1,0],[3/16,-1,1],[5/16,0,1],[1/16,1,1]];break;case 1:this._kernel=[[3/8,1,0],[3/8,0,1],[2/8,1,1]];break;case 2:this._kernel=[[8/42,1,0],[4/42,2,0],[2/42,-2,1],[4/42,-1,1],[8/42,0,1],[4/42,1,1],[2/42,2,1],[1/42,-2,2],[2/42,-1,2],[4/42,0,2],[2/42,1,2],[1/42,2,2]];break;case 3:this._kernel=[[1/8,1,0],[1/8,2,0],[1/8,-1,1],[1/8,0,1],[1/8,1,1],[1/8,0,2]];break;case 4:this._kernel=[[7/48,1,0],[5/48,2,0],[3/48,-2,1],[5/48,-1,1],[7/48,0,1],[5/48,1,1],[3/48,2,1],[1/48,-2,2],[3/48,-1,2],[5/48,0,2],[3/48,1,2],[1/48,2,2]];break;case 5:this._kernel=[[.25,1,0],[4/32,2,0],[2/32,-2,1],[4/32,-1,1],[.25,0,1],[4/32,1,1],[2/32,2,1]];break;case 6:this._kernel=[[5/32,1,0],[3/32,2,0],[2/32,-2,1],[4/32,-1,1],[5/32,0,1],[4/32,1,1],[2/32,2,1],[2/32,-1,2],[3/32,0,2],[2/32,1,2]];break;case 7:this._kernel=[[.25,1,0],[3/16,2,0],[1/16,-2,1],[2/16,-1,1],[3/16,0,1],[2/16,1,1],[1/16,2,1]];break;case 8:this._kernel=[[.5,1,0],[1/4,-1,1],[1/4,0,1]];break;default:throw new Error(`ErrorDiffusionArray: unknown kernel = ${d}`)}}};function*hilbertCurve$1(d,m,g){const w=Math.max(d,m),I={width:d,height:m,level:Math.floor(Math.log(w)/Math.log(2)+1),callback:g,tracker:new ProgressTracker$1(d*m,99),index:0,x:0,y:0};yield*walkHilbert$1(I,1),visit$1(I,0)}function*walkHilbert$1(d,m){if(!(d.level<1)){switch(d.tracker.shouldNotify(d.index)&&(yield{progress:d.tracker.progress}),d.level--,m){case 2:yield*walkHilbert$1(d,1),visit$1(d,3),yield*walkHilbert$1(d,2),visit$1(d,4),yield*walkHilbert$1(d,2),visit$1(d,2),yield*walkHilbert$1(d,4);break;case 3:yield*walkHilbert$1(d,4),visit$1(d,2),yield*walkHilbert$1(d,3),visit$1(d,1),yield*walkHilbert$1(d,3),visit$1(d,3),yield*walkHilbert$1(d,1);break;case 1:yield*walkHilbert$1(d,2),visit$1(d,4),yield*walkHilbert$1(d,1),visit$1(d,3),yield*walkHilbert$1(d,1),visit$1(d,1),yield*walkHilbert$1(d,3);break;case 4:yield*walkHilbert$1(d,3),visit$1(d,1),yield*walkHilbert$1(d,4),visit$1(d,2),yield*walkHilbert$1(d,4),visit$1(d,4),yield*walkHilbert$1(d,2)}d.level++}}function visit$1(d,m){switch(d.x>=0&&d.x<d.width&&d.y>=0&&d.y<d.height&&(d.callback(d.x,d.y),d.index++),m){case 2:d.x--;break;case 3:d.x++;break;case 1:d.y--;break;case 4:d.y++}}var ErrorDiffusionRiemersma$1=class extends AbstractImageQuantizer$1{constructor(d,m=16,g=1){super(),__publicField$3(this,"_distance"),__publicField$3(this,"_weights"),__publicField$3(this,"_errorQueueSize"),this._distance=d,this._errorQueueSize=m,this._weights=ErrorDiffusionRiemersma$1._createWeights(g,m)}*quantize(d,m){const g=d.getPointArray(),w=d.getWidth(),I=d.getHeight(),P=[];let F=0;for(let D=0;D<this._errorQueueSize;D++)P[D]={r:0,g:0,b:0,a:0};yield*hilbertCurve$1(w,I,(D,U)=>{const Z=g[D+U*w];let{r:$,g:j,b:H,a:W}=Z;for(let q=0;q<this._errorQueueSize;q++){const et=this._weights[q],X=P[(q+F)%this._errorQueueSize];$+=X.r*et,j+=X.g*et,H+=X.b*et,W+=X.a*et}const V=Point$1.createByRGBA(inRange0to255Rounded$1($),inRange0to255Rounded$1(j),inRange0to255Rounded$1(H),inRange0to255Rounded$1(W)),Q=m.getNearestColor(this._distance,V);F=(F+1)%this._errorQueueSize;const K=(F+this._errorQueueSize-1)%this._errorQueueSize;P[K].r=Z.r-Q.r,P[K].g=Z.g-Q.g,P[K].b=Z.b-Q.b,P[K].a=Z.a-Q.a,Z.from(Q)}),yield{pointContainer:d,progress:100}}static _createWeights(d,m){const g=[],w=Math.exp(Math.log(m)/(m-1));for(let I=0,P=1;I<m;I++)g[I]=(P+.5|0)/m*d,P*=w;return g}},quality_exports$1={};__export$1(quality_exports$1,{ssim:()=>ssim$1});var K1$1=.01,K2$1=.03;function ssim$1(d,m){if(d.getHeight()!==m.getHeight()||d.getWidth()!==m.getWidth())throw new Error("Images have different sizes!");const g=(255*K1$1)**2,w=(255*K2$1)**2;let I=0,P=0;return iterate$1(d,m,(F,D,U,Z)=>{let $=0,j=0,H=0;for(let V=0;V<F.length;V++)j+=(F[V]-U)**2,H+=(D[V]-Z)**2,$+=(F[V]-U)*(D[V]-Z);const W=F.length-1;j/=W,H/=W,$/=W,P+=(2*U*Z+g)*(2*$+w)/((U**2+Z**2+g)*(j+H+w)),I++}),P/I}function iterate$1(d,m,g){const w=d.getWidth(),I=d.getHeight();for(let P=0;P<I;P+=8)for(let F=0;F<w;F+=8){const D=Math.min(8,w-F),U=Math.min(8,I-P),Z=calculateLumaValuesForWindow$1(d,F,P,D,U),$=calculateLumaValuesForWindow$1(m,F,P,D,U);g(Z,$,calculateAverageLuma$1(Z),calculateAverageLuma$1($))}}function calculateLumaValuesForWindow$1(d,m,g,w,I){const P=d.getPointArray(),F=[];let D=0;for(let U=g;U<g+I;U++){const Z=U*d.getWidth();for(let $=m;$<m+w;$++){const j=P[Z+$];F[D]=.2126*j.r+.7152*j.g+.0722*j.b,D++}}return F}function calculateAverageLuma$1(d){let m=0;for(const g of d)m+=g;return m/d.length}var setImmediateImpl=typeof setImmediate=="function"?setImmediate:typeof process<"u"&&typeof(process==null?void 0:process.nextTick)=="function"?d=>process.nextTick(d):d=>setTimeout(d,0);function buildPaletteSync$1(d,{colorDistanceFormula:m,paletteQuantization:g,colors:w}={}){const I=paletteQuantizationToPaletteQuantizer$1(colorDistanceFormulaToColorDistance$1(m),g,w);return d.forEach(P=>I.sample(P)),I.quantizeSync()}async function buildPalette(d,{colorDistanceFormula:m,paletteQuantization:g,colors:w,onProgress:I}={}){return new Promise((P,F)=>{const D=paletteQuantizationToPaletteQuantizer$1(colorDistanceFormulaToColorDistance$1(m),g,w);let U;d.forEach(j=>D.sample(j));const Z=D.quantize(),$=()=>{try{const j=Z.next();j.done?P(U):(j.value.palette&&(U=j.value.palette),I&&I(j.value.progress),setImmediateImpl($))}catch(j){F(j)}};setImmediateImpl($)})}function applyPaletteSync$1(d,m,{colorDistanceFormula:g,imageQuantization:w}={}){return imageQuantizationToImageQuantizer$1(colorDistanceFormulaToColorDistance$1(g),w).quantizeSync(d,m)}async function applyPalette(d,m,{colorDistanceFormula:g,imageQuantization:w,onProgress:I}={}){return new Promise((P,F)=>{let D;const U=imageQuantizationToImageQuantizer$1(colorDistanceFormulaToColorDistance$1(g),w).quantize(d,m),Z=()=>{try{const $=U.next();$.done?P(D):($.value.pointContainer&&(D=$.value.pointContainer),I&&I($.value.progress),setImmediateImpl(Z))}catch($){F($)}};setImmediateImpl(Z)})}function colorDistanceFormulaToColorDistance$1(d="euclidean-bt709"){switch(d){case"cie94-graphic-arts":return new CIE94GraphicArts$1;case"cie94-textiles":return new CIE94Textiles$1;case"ciede2000":return new CIEDE2000$1;case"color-metric":return new CMetric$1;case"euclidean":return new Euclidean$1;case"euclidean-bt709":return new EuclideanBT709$1;case"euclidean-bt709-noalpha":return new EuclideanBT709NoAlpha$1;case"manhattan":return new Manhattan$1;case"manhattan-bt709":return new ManhattanBT709$1;case"manhattan-nommyde":return new ManhattanNommyde$1;case"pngquant":return new PNGQuant$1;default:throw new Error(`Unknown colorDistanceFormula ${d}`)}}function imageQuantizationToImageQuantizer$1(d,m="floyd-steinberg"){switch(m){case"nearest":return new NearestColor$1(d);case"riemersma":return new ErrorDiffusionRiemersma$1(d);case"floyd-steinberg":return new ErrorDiffusionArray$1(d,0);case"false-floyd-steinberg":return new ErrorDiffusionArray$1(d,1);case"stucki":return new ErrorDiffusionArray$1(d,2);case"atkinson":return new ErrorDiffusionArray$1(d,3);case"jarvis":return new ErrorDiffusionArray$1(d,4);case"burkes":return new ErrorDiffusionArray$1(d,5);case"sierra":return new ErrorDiffusionArray$1(d,6);case"two-sierra":return new ErrorDiffusionArray$1(d,7);case"sierra-lite":return new ErrorDiffusionArray$1(d,8);default:throw new Error(`Unknown imageQuantization ${m}`)}}function paletteQuantizationToPaletteQuantizer$1(d,m="wuquant",g=256){switch(m){case"neuquant":return new NeuQuant$1(d,g);case"rgbquant":return new RGBQuant$1(d,g);case"wuquant":return new WuQuant$1(d,g);case"neuquant-float":return new NeuQuantFloat$1(d,g);default:throw new Error(`Unknown paletteQuantization ${m}`)}}var imageQ=__toCommonJS(src_exports),gifframe={};const BitmapImage$1=bitmapimage;let GifFrame$1=class Ce extends BitmapImage$1{constructor(...m){if(super(...m),m[0]instanceof Ce){const g=m[0];this.xOffset=g.xOffset,this.yOffset=g.yOffset,this.disposalMethod=g.disposalMethod,this.delayCentisecs=g.delayCentisecs,this.interlaced=g.interlaced}else{const g=m[m.length-1];let w={};typeof g!="object"||g instanceof BitmapImage$1||(w=g),this.xOffset=w.xOffset||0,this.yOffset=w.yOffset||0,this.disposalMethod=w.disposalMethod!==void 0?w.disposalMethod:Ce.DisposeToBackgroundColor,this.delayCentisecs=w.delayCentisecs||8,this.interlaced=w.interlaced||!1}}getPalette(){const m=new Set,g=this.bitmap.data;let w=0,I=!1;for(;w<g.length;){if(g[w+3]===0)I=!0;else{const U=g.readUInt32BE(w,!0)>>8&16777215;m.add(U)}w+=4}const P=new Array(m.size),F=m.values();for(w=0;w<P.length;++w)P[w]=F.next().value;P.sort((U,Z)=>U-Z);let D=P.length;return I&&++D,{colors:P,usesTransparency:I,indexCount:D}}};var hasRequiredGifutil,hasRequiredGifcodec;function requireGifutil(){return hasRequiredGifutil||(hasRequiredGifutil=1,function(d){const m=require$$0,g=imageQ,w=bitmapimage,{GifFrame:I}=gifframe,{GifError:P}=gif$1,{GifCodec:F}=requireGifcodec(),D=[".jpg",".jpeg",".png",".bmp"],U=new F;function Z($,j,H,W,V){const Q=Array.isArray($)?$:[$];if(V){if(["FloydSteinberg","FalseFloydSteinberg","Stucki","Atkinson","Jarvis","Burkes","Sierra","TwoSierra","SierraLite"].indexOf(V.ditherAlgorithm)<0)throw new Error(`Invalid ditherAlgorithm '${V.ditherAlgorithm}'`);V.serpentine===void 0&&(V.serpentine=!0),V.minimumColorDistanceToDither===void 0&&(V.minimumColorDistanceToDither=0),V.calculateErrorLikeGIMP===void 0&&(V.calculateErrorLikeGIMP=!1)}const K=new g.distance.Euclidean,q=new g.palette[j](K,H,W);let et;et=V?new g.image.ErrorDiffusionArray(K,g.image.ErrorDiffusionArrayKernel[V.ditherAlgorithm],V.serpentine,V.minimumColorDistanceToDither,V.calculateErrorLikeGIMP):new g.image.NearestColor(K);const X=[];Q.forEach(rt=>{const ot=rt.bitmap.data,J=new ArrayBuffer(ot.length),lt=new Uint32Array(J);for(let ut=0,it=0;ut<ot.length;ut+=4,++it)lt[it]=ot.readUInt32LE(ut,!0);const st=g.utils.PointContainer.fromUint32Array(lt,rt.bitmap.width,rt.bitmap.height);q.sample(st),X.push(st)});const tt=q.quantizeSync();for(let rt=0;rt<Q.length;++rt){const ot=Q[rt].bitmap.data,J=et.quantizeSync(X[rt],tt).toUint32Array();for(let lt=0,st=0;lt<ot.length;lt+=4,++st)ot.writeUInt32LE(J[st],lt)}}d.cloneFrames=function($){let j=[];return $.forEach(H=>{j.push(new I(H))}),j},d.getColorInfo=function($,j){let H=!1;const W=[];for(let et=0;et<$.length;++et){let X=$[et].getPalette();if(X.usesTransparency&&(H=!0),X.indexCount>256)throw new P(`Frame ${et} uses more than 256 color indexes`);W.push(X)}if(j===0)return{usesTransparency:H,palettes:W};const V=new Set;W.forEach(et=>{et.colors.forEach(X=>{V.add(X)})});let Q=V.size;if(H&&++Q,j&&Q>j)return{usesTransparency:H,palettes:W};const K=new Array(V.size),q=V.values();for(let et=0;et<K.length;++et)K[et]=q.next().value;return K.sort((et,X)=>et-X),{colors:K,indexCount:Q,usesTransparency:H,palettes:W}},d.copyAsJimp=function($,j){return d.shareAsJimp($,new w(j))},d.getMaxDimensions=function($){let j=0,H=0;return $.forEach(W=>{const V=W.xOffset+W.bitmap.width;V>j&&(j=V);const Q=W.yOffset+W.bitmap.height;Q>H&&(H=Q)}),{maxWidth:j,maxHeight:H}},d.quantizeDekker=function($,j,H){Z($,"NeuQuantFloat",j=j||256,0,H)},d.quantizeSorokin=function($,j,H,W){let V;switch(j=j||256,H=H||"min-pop"){case"min-pop":V=2;break;case"top-pop":V=1;break;default:throw new Error(`Invalid quantizeSorokin histogram '${H}'`)}Z($,"RGBQuant",j,V,W)},d.quantizeWu=function($,j,H,W){if(j=j||256,(H=H||5)<1||H>8)throw new Error("Invalid quantization quality");Z($,"WuQuant",j,H,W)},d.read=function($,j){return j=j||U,Buffer$2.isBuffer($)?j.decodeGif($):function(H){return new Promise((W,V)=>{m.readFile(H,(Q,K)=>Q?V(Q):W(K))})}($).then(H=>j.decodeGif(H))},d.shareAsJimp=function($,j){const H=new $(j.bitmap.width,j.bitmap.height,0);return H.bitmap.data=j.bitmap.data,H},d.write=function($,j,H,W){W=W||U;const V=$.match(/\.[a-zA-Z]+$/);if(V!==null&&D.includes(V[0].toLowerCase()))throw new Error(`GIF '${$}' has an unexpected suffix`);return W.encodeGif(j,H).then(Q=>function(K,q){return new Promise((et,X)=>{m.writeFile(K,q,tt=>tt?X(tt):et())})}($,Q.buffer).then(()=>Q))}}(gifutil)),gifutil}function requireGifcodec(){if(hasRequiredGifcodec)return gifcodec;hasRequiredGifcodec=1;const d=omggif,{Gif:m,GifError:g}=gif$1;function w(){const j=requireGifutil();return w=function(){return j},j}const{GifFrame:I}=gifframe;function P(j,H){const W=j.indexOf(H);return W===-1?null:W}function F(j,H){for(var W,V=0,Q=j.length-1;V<=Q;)if(j[W=Math.floor((V+Q)/2)]>H)Q=W-1;else{if(!(j[W]<H))return W;V=W+1}return null}function D(j){const H=j.colors;j.usesTransparency&&H.push(0);const W=H.length;let V=2;for(;W>V;)V<<=1;H.length=V,H.fill(0,W)}function U(j,H){let W=j.bitmap.width*j.bitmap.height;return W=Math.ceil(W*H/8),W+=Math.ceil(W/255),100+W+768}function Z(j){let H=j.indexCount,W=0;for(--H;H;)++W,H>>=1;return W>0?W:1}function $(j,H,W,V,Q){if(W.interlaced)throw new g("writing interlaced GIFs is not supported");const K=function(et,X,tt){const rt=tt.colors,ot=rt.length<=8?P:F,J=X.bitmap.data,lt=new Buffer$2(J.length/4);let st=rt.length,ut=0,it=0;for(;ut<J.length;){if(J[ut+3]!==0){const ct=J.readUInt32BE(ut,!0)>>8&16777215;lt[it]=ot(rt,ct)}else lt[it]=st;ut+=4,++it}if(tt.usesTransparency){if(st===256)throw new g(`Frame ${et} already has 256 colorsand so can't use transparency`)}else st=null;return{buffer:lt,transparentIndex:st}}(H,W,V),q={delay:W.delayCentisecs,disposal:W.disposalMethod,transparent:K.transparentIndex};Q&&(D(V),q.palette=V.colors);try{let et,X=j.getOutputBuffer(),tt=j.getOutputBufferPosition(),rt=!0;for(;rt;)if(et=j.addFrame(W.xOffset,W.yOffset,W.bitmap.width,W.bitmap.height,K.buffer,q),rt=!1,et>=X.length-1){const ot=new Buffer$2(1.5*X.length);X.copy(ot),j.setOutputBuffer(ot),j.setOutputBufferPosition(tt),X=ot,rt=!0}return X}catch(et){throw new g(et)}}return gifcodec.GifCodec=class{constructor(j={}){this._transparentRGB=null,typeof j.transparentRGB=="number"&&j.transparentRGB!==0&&(this._transparentRGBA=256*j.transparentRGB),this._testInitialBufferSize=0}decodeGif(j){try{let H;try{H=new d.GifReader(j)}catch(K){throw new g(K)}const W=H.numFrames(),V=[],Q={width:H.width,height:H.height,loops:H.loopCount(),usesTransparency:!1};for(let K=0;K<W;++K){const q=this._decodeFrame(H,K,Q.usesTransparency);V.push(q.frame),q.usesTransparency&&(Q.usesTransparency=!0)}return Promise.resolve(new m(j,V,Q))}catch(H){return Promise.reject(H)}}encodeGif(j,H={}){try{if(j===null||j.length===0)throw new g("there are no frames");const W=w().getMaxDimensions(j);return(H=Object.assign({},H)).width=W.maxWidth,H.height=W.maxHeight,H.loops===void 0&&(H.loops=0),H.colorScope=H.colorScope||m.GlobalColorsPreferred,Promise.resolve(this._encodeGif(j,H))}catch(W){return Promise.reject(W)}}_decodeFrame(j,H,W){let V,Q;try{if(V=j.frameInfo(H),Q=new Buffer$2(j.width*j.height*4),j.decodeAndBlitFrameRGBA(H,Q),V.width!==j.width||V.height!==j.height){if(V.y&&(Q=Q.slice(V.y*j.width*4)),j.width>V.width)for(let q=0;q<V.height;++q)Q.copy(Q,q*V.width*4,4*(V.x+q*j.width),4*(V.x+q*j.width)+4*V.width);Q=Q.slice(0,V.width*V.height*4)}}catch(q){throw new g(q)}let K=!1;if(this._transparentRGBA===null){if(!W)for(let q=3;q<Q.length;q+=4)Q[q]===0&&(K=!0,q=Q.length)}else for(let q=3;q<Q.length;q+=4)Q[q]===0&&(Q.writeUInt32BE(this._transparentRGBA,q-3),K=!0);return{frame:new I(V.width,V.height,Q,{xOffset:V.x,yOffset:V.y,disposalMethod:V.disposal,interlaced:V.interlaced,delayCentisecs:V.delay}),usesTransparency:K}}_encodeGif(j,H){let W;if(H.colorScope===m.LocalColorsOnly)W=w().getColorInfo(j,0);else if(W=w().getColorInfo(j,256),!W.colors){if(H.colorScope===m.GlobalColorsOnly)throw new g("Too many color indexes for global color table");H.colorScope=m.LocalColorsOnly}H.usesTransparency=W.usesTransparency;const V=W.palettes;return H.colorScope===m.LocalColorsOnly?function(Q,K,q,et){const X={loop:K.loops};let tt,rt=new Buffer$2(q);try{tt=new d.GifWriter(rt,K.width,K.height,X)}catch(ot){throw new g(ot)}for(let ot=0;ot<Q.length;++ot)rt=$(tt,ot,Q[ot],et[ot],!0);return new m(rt.slice(0,tt.end()),Q,K)}(j,H,2e3,V):function(Q,K,q,et){const X={colors:et.colors.slice(),usesTransparency:et.usesTransparency};D(X);const tt={palette:X.colors,loop:K.loops};let rt,ot=new Buffer$2(q);try{rt=new d.GifWriter(ot,K.width,K.height,tt)}catch(J){throw new g(J)}for(let J=0;J<Q.length;++J)ot=$(rt,J,Q[J],et,!1);return new m(ot.slice(0,rt.end()),Q,K)}(j,H,2e3,W)}_getSizeEstimateGlobal(j,H){if(this._testInitialBufferSize>0)return this._testInitialBufferSize;let W=968;const V=Z(j);return H.forEach(Q=>{W+=U(Q,V)}),W}_getSizeEstimateLocal(j,H){if(this._testInitialBufferSize>0)return this._testInitialBufferSize;let W=200;for(let V=0;V<H.length;++V){const Q=Z(j[V]);W+=U(H[V],Q)}return W}},gifcodec}GifFrame$1.DisposeToAnything=0,GifFrame$1.DisposeNothing=1,GifFrame$1.DisposeToBackgroundColor=2,GifFrame$1.DisposeToPrevious=3,gifframe.GifFrame=GifFrame$1;const BitmapImage=bitmapimage,{GifCodec}=requireGifcodec(),{GifFrame}=gifframe,GifUtil=requireGifutil();var src={BitmapImage,GifCodec,GifFrame,GifUtil};function gif(){return{mime:"image/gif",encode:async d=>{const m=new src.BitmapImage(d);src.GifUtil.quantizeDekker(m,256);const g=new src.GifFrame(d);return(await new src.GifCodec().encodeGif([g],{})).buffer},decode:d=>{const m=new omggif.GifReader(d),g=Buffer$2.alloc(m.width*m.height*4);return m.decodeAndBlitFrameRGBA(0,g),{data:g,width:m.width,height:m.height}}}}var encoder={exports:{}};(function(d){function m(g){var w,I,P,F,D,U=Math.floor,Z=new Array(64),$=new Array(64),j=new Array(64),H=new Array(64),W=new Array(65535),V=new Array(65535),Q=new Array(64),K=new Array(64),q=[],et=0,X=7,tt=new Array(64),rt=new Array(64),ot=new Array(64),J=new Array(256),lt=new Array(2048),st=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],ut=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],it=[0,1,2,3,4,5,6,7,8,9,10,11],ct=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],At=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],Et=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],gt=[0,1,2,3,4,5,6,7,8,9,10,11],pt=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],vt=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function Tt(Nt,Pt){for(var Ut=0,Ft=0,Zt=new Array,Ht=1;Ht<=16;Ht++){for(var Dt=1;Dt<=Nt[Ht];Dt++)Zt[Pt[Ft]]=[],Zt[Pt[Ft]][0]=Ut,Zt[Pt[Ft]][1]=Ht,Ft++,Ut++;Ut*=2}return Zt}function It(Nt){for(var Pt=Nt[0],Ut=Nt[1]-1;Ut>=0;)Pt&1<<Ut&&(et|=1<<X),Ut--,--X<0&&(et==255?($t(255),$t(0)):$t(et),X=7,et=0)}function $t(Nt){q.push(Nt)}function Bt(Nt){$t(Nt>>8&255),$t(255&Nt)}function zt(Nt,Pt,Ut,Ft,Zt){for(var Ht,Dt=Zt[0],dt=Zt[240],Lt=function(at,_t){var St,Vt,ee,Jt,se,ae,fe,le,ue,me,he=0;for(ue=0;ue<8;++ue){St=at[he],Vt=at[he+1],ee=at[he+2],Jt=at[he+3],se=at[he+4],ae=at[he+5],fe=at[he+6];var Wt=St+(le=at[he+7]),oe=St-le,kt=Vt+fe,Xt=Vt-fe,Ct=ee+ae,re=ee-ae,te=Jt+se,yt=Jt-se,Mt=Wt+te,Yt=Wt-te,Qt=kt+Ct,mt=kt-Ct;at[he]=Mt+Qt,at[he+4]=Mt-Qt;var qt=.707106781*(mt+Yt);at[he+2]=Yt+qt,at[he+6]=Yt-qt;var ie=.382683433*((Mt=yt+re)-(mt=Xt+oe)),jt=.5411961*Mt+ie,Kt=1.306562965*mt+ie,ne=.707106781*(Qt=re+Xt),pe=oe+ne,ce=oe-ne;at[he+5]=ce+jt,at[he+3]=ce-jt,at[he+1]=pe+Kt,at[he+7]=pe-Kt,he+=8}for(he=0,ue=0;ue<8;++ue){St=at[he],Vt=at[he+8],ee=at[he+16],Jt=at[he+24],se=at[he+32],ae=at[he+40],fe=at[he+48];var de=St+(le=at[he+56]),ge=St-le,ve=Vt+fe,Ee=Vt-fe,ye=ee+ae,_e=ee-ae,we=Jt+se,xe=Jt-se,Se=de+we,Ae=de-we,be=ve+ye,Ie=ve-ye;at[he]=Se+be,at[he+32]=Se-be;var Te=.707106781*(Ie+Ae);at[he+16]=Ae+Te,at[he+48]=Ae-Te;var Re=.382683433*((Se=xe+_e)-(Ie=Ee+ge)),ke=.5411961*Se+Re,Me=1.306562965*Ie+Re,Be=.707106781*(be=_e+Ee),Oe=ge+Be,Ne=ge-Be;at[he+40]=Ne+ke,at[he+24]=Ne-ke,at[he+8]=Oe+Me,at[he+56]=Oe-Me,he++}for(ue=0;ue<64;++ue)me=at[ue]*_t[ue],Q[ue]=me>0?me+.5|0:me-.5|0;return Q}(Nt,Pt),bt=0;bt<64;++bt)K[st[bt]]=Lt[bt];var wt=K[0]-Ut;Ut=K[0],wt==0?It(Ft[0]):(It(Ft[V[Ht=32767+wt]]),It(W[Ht]));for(var xt=63;xt>0&&K[xt]==0;xt--);if(xt==0)return It(Dt),Ut;for(var Rt,Gt=1;Gt<=xt;){for(var nt=Gt;K[Gt]==0&&Gt<=xt;++Gt);var ht=Gt-nt;if(ht>=16){Rt=ht>>4;for(var ft=1;ft<=Rt;++ft)It(dt);ht&=15}Ht=32767+K[Gt],It(Zt[(ht<<4)+V[Ht]]),It(W[Ht]),Gt++}return xt!=63&&It(Dt),Ut}function Ot(Nt){Nt<=0&&(Nt=1),Nt>100&&(Nt=100),D!=Nt&&(function(Pt){for(var Ut=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],Ft=0;Ft<64;Ft++){var Zt=U((Ut[Ft]*Pt+50)/100);Zt<1?Zt=1:Zt>255&&(Zt=255),Z[st[Ft]]=Zt}for(var Ht=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],Dt=0;Dt<64;Dt++){var dt=U((Ht[Dt]*Pt+50)/100);dt<1?dt=1:dt>255&&(dt=255),$[st[Dt]]=dt}for(var Lt=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],bt=0,wt=0;wt<8;wt++)for(var xt=0;xt<8;xt++)j[bt]=1/(Z[st[bt]]*Lt[wt]*Lt[xt]*8),H[bt]=1/($[st[bt]]*Lt[wt]*Lt[xt]*8),bt++}(Nt<50?Math.floor(5e3/Nt):Math.floor(200-2*Nt)),D=Nt)}this.encode=function(Nt,Pt){var Ut;new Date().getTime(),Pt&&Ot(Pt),q=new Array,et=0,X=7,Bt(65496),Bt(65504),Bt(16),$t(74),$t(70),$t(73),$t(70),$t(0),$t(1),$t(1),$t(0),Bt(1),Bt(1),$t(0),$t(0),(Ut=Nt.comments)!==void 0&&Ut.constructor===Array&&Ut.forEach(ee=>{if(typeof ee=="string"){Bt(65534);var Jt,se=ee.length;for(Bt(se+2),Jt=0;Jt<se;Jt++)$t(ee.charCodeAt(Jt))}}),function(ee){if(ee){Bt(65505),ee[0]===69&&ee[1]===120&&ee[2]===105&&ee[3]===102?Bt(ee.length+2):(Bt(ee.length+5+2),$t(69),$t(120),$t(105),$t(102),$t(0));for(var Jt=0;Jt<ee.length;Jt++)$t(ee[Jt])}}(Nt.exifBuffer),function(){Bt(65499),Bt(132),$t(0);for(var ee=0;ee<64;ee++)$t(Z[ee]);$t(1);for(var Jt=0;Jt<64;Jt++)$t($[Jt])}(),function(ee,Jt){Bt(65472),Bt(17),$t(8),Bt(Jt),Bt(ee),$t(3),$t(1),$t(17),$t(0),$t(2),$t(17),$t(1),$t(3),$t(17),$t(1)}(Nt.width,Nt.height),function(){Bt(65476),Bt(418),$t(0);for(var ee=0;ee<16;ee++)$t(ut[ee+1]);for(var Jt=0;Jt<=11;Jt++)$t(it[Jt]);$t(16);for(var se=0;se<16;se++)$t(ct[se+1]);for(var ae=0;ae<=161;ae++)$t(At[ae]);$t(1);for(var fe=0;fe<16;fe++)$t(Et[fe+1]);for(var le=0;le<=11;le++)$t(gt[le]);$t(17);for(var ue=0;ue<16;ue++)$t(pt[ue+1]);for(var me=0;me<=161;me++)$t(vt[me])}(),Bt(65498),Bt(12),$t(3),$t(1),$t(0),$t(2),$t(17),$t(3),$t(17),$t(0),$t(63),$t(0);var Ft=0,Zt=0,Ht=0;et=0,X=7,this.encode.displayName="_encode_";for(var Dt,dt,Lt,bt,wt,xt,Rt,Gt,nt,ht=Nt.data,ft=Nt.width,at=Nt.height,_t=4*ft,St=0;St<at;){for(Dt=0;Dt<_t;){for(xt=wt=_t*St+Dt,Rt=-1,Gt=0,nt=0;nt<64;nt++)xt=wt+(Gt=nt>>3)*_t+(Rt=4*(7&nt)),St+Gt>=at&&(xt-=_t*(St+1+Gt-at)),Dt+Rt>=_t&&(xt-=Dt+Rt-_t+4),dt=ht[xt++],Lt=ht[xt++],bt=ht[xt++],tt[nt]=(lt[dt]+lt[Lt+256|0]+lt[bt+512|0]>>16)-128,rt[nt]=(lt[dt+768|0]+lt[Lt+1024|0]+lt[bt+1280|0]>>16)-128,ot[nt]=(lt[dt+1280|0]+lt[Lt+1536|0]+lt[bt+1792|0]>>16)-128;Ft=zt(tt,j,Ft,w,P),Zt=zt(rt,H,Zt,I,F),Ht=zt(ot,H,Ht,I,F),Dt+=32}St+=8}if(X>=0){var Vt=[];Vt[1]=X+1,Vt[0]=(1<<X+1)-1,It(Vt)}return Bt(65497),Buffer$2.from(q)},new Date().getTime(),g||(g=50),function(){for(var Nt=String.fromCharCode,Pt=0;Pt<256;Pt++)J[Pt]=Nt(Pt)}(),w=Tt(ut,it),I=Tt(Et,gt),P=Tt(ct,At),F=Tt(pt,vt),function(){for(var Nt=1,Pt=2,Ut=1;Ut<=15;Ut++){for(var Ft=Nt;Ft<Pt;Ft++)V[32767+Ft]=Ut,W[32767+Ft]=[],W[32767+Ft][1]=Ut,W[32767+Ft][0]=Ft;for(var Zt=-(Pt-1);Zt<=-Nt;Zt++)V[32767+Zt]=Ut,W[32767+Zt]=[],W[32767+Zt][1]=Ut,W[32767+Zt][0]=Pt-1+Zt;Nt<<=1,Pt<<=1}}(),function(){for(var Nt=0;Nt<256;Nt++)lt[Nt]=19595*Nt,lt[Nt+256|0]=38470*Nt,lt[Nt+512|0]=7471*Nt+32768,lt[Nt+768|0]=-11059*Nt,lt[Nt+1024|0]=-21709*Nt,lt[Nt+1280|0]=32768*Nt+8421375,lt[Nt+1536|0]=-27439*Nt,lt[Nt+1792|0]=-5329*Nt}(),Ot(g),new Date().getTime()}encoder.exports=function(g,w){w===void 0&&(w=50);var I=new m(w),P=I.encode(g,w);return{data:P,width:g.width,height:g.height}}})();var encoderExports=encoder.exports,decoder={exports:{}},module,JpegImage;module=decoder,JpegImage=function(){var d=new Int32Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),m=4017,g=799,w=3406,I=2276,P=1567,F=3784,D=5793,U=2896;function Z(){}function $(q,et){for(var X,tt,rt=0,ot=[],J=16;J>0&&!q[J-1];)J--;ot.push({children:[],index:0});var lt,st=ot[0];for(X=0;X<J;X++){for(tt=0;tt<q[X];tt++){for((st=ot.pop()).children[st.index]=et[rt];st.index>0;){if(ot.length===0)throw new Error("Could not recreate Huffman Table");st=ot.pop()}for(st.index++,ot.push(st);ot.length<=X;)ot.push(lt={children:[],index:0}),st.children[st.index]=lt.children,st=lt;rt++}X+1<J&&(ot.push(lt={children:[],index:0}),st.children[st.index]=lt.children,st=lt)}return ot[0].children}function j(q,et,X,tt,rt,ot,J,lt,st,ut){X.precision,X.samplesPerLine,X.scanLines;var it=X.mcusPerLine,ct=X.progressive;X.maxH,X.maxV;var At=et,Et=0,gt=0;function pt(){if(gt>0)return gt--,Et>>gt&1;if((Et=q[et++])==255){var Gt=q[et++];if(Gt)throw new Error("unexpected marker: "+(Et<<8|Gt).toString(16))}return gt=7,Et>>>7}function vt(Gt){for(var nt,ht=Gt;(nt=pt())!==null;){if(typeof(ht=ht[nt])=="number")return ht;if(typeof ht!="object")throw new Error("invalid huffman sequence")}return null}function Tt(Gt){for(var nt=0;Gt>0;){var ht=pt();if(ht===null)return;nt=nt<<1|ht,Gt--}return nt}function It(Gt){var nt=Tt(Gt);return nt>=1<<Gt-1?nt:nt+(-1<<Gt)+1}var $t,Bt=0,zt=0;function Ot(Gt,nt,ht,ft,at){var _t=ht%it,St=(ht/it|0)*Gt.v+ft,Vt=_t*Gt.h+at;Gt.blocks[St]===void 0&&ut.tolerantDecoding||nt(Gt,Gt.blocks[St][Vt])}function Nt(Gt,nt,ht){var ft=ht/Gt.blocksPerLine|0,at=ht%Gt.blocksPerLine;Gt.blocks[ft]===void 0&&ut.tolerantDecoding||nt(Gt,Gt.blocks[ft][at])}var Pt,Ut,Ft,Zt,Ht,Dt,dt=tt.length;Dt=ct?ot===0?lt===0?function(Gt,nt){var ht=vt(Gt.huffmanTableDC),ft=ht===0?0:It(ht)<<st;nt[0]=Gt.pred+=ft}:function(Gt,nt){nt[0]|=pt()<<st}:lt===0?function(Gt,nt){if(Bt>0)Bt--;else for(var ht=ot,ft=J;ht<=ft;){var at=vt(Gt.huffmanTableAC),_t=15&at,St=at>>4;if(_t!==0)nt[d[ht+=St]]=It(_t)*(1<<st),ht++;else{if(St<15){Bt=Tt(St)+(1<<St)-1;break}ht+=16}}}:function(Gt,nt){for(var ht=ot,ft=J,at=0;ht<=ft;){var _t=d[ht],St=nt[_t]<0?-1:1;switch(zt){case 0:var Vt=vt(Gt.huffmanTableAC),ee=15&Vt;if(at=Vt>>4,ee===0)at<15?(Bt=Tt(at)+(1<<at),zt=4):(at=16,zt=1);else{if(ee!==1)throw new Error("invalid ACn encoding");$t=It(ee),zt=at?2:3}continue;case 1:case 2:nt[_t]?nt[_t]+=(pt()<<st)*St:--at==0&&(zt=zt==2?3:0);break;case 3:nt[_t]?nt[_t]+=(pt()<<st)*St:(nt[_t]=$t<<st,zt=0);break;case 4:nt[_t]&&(nt[_t]+=(pt()<<st)*St)}ht++}zt===4&&--Bt==0&&(zt=0)}:function(Gt,nt){var ht=vt(Gt.huffmanTableDC),ft=ht===0?0:It(ht);nt[0]=Gt.pred+=ft;for(var at=1;at<64;){var _t=vt(Gt.huffmanTableAC),St=15&_t,Vt=_t>>4;if(St!==0)nt[d[at+=Vt]]=It(St),at++;else{if(Vt<15)break;at+=16}}};var Lt,bt,wt,xt,Rt=0;for(bt=dt==1?tt[0].blocksPerLine*tt[0].blocksPerColumn:it*X.mcusPerColumn,rt||(rt=bt);Rt<bt;){for(Ut=0;Ut<dt;Ut++)tt[Ut].pred=0;if(Bt=0,dt==1)for(Pt=tt[0],Ht=0;Ht<rt;Ht++)Nt(Pt,Dt,Rt),Rt++;else for(Ht=0;Ht<rt;Ht++){for(Ut=0;Ut<dt;Ut++)for(wt=(Pt=tt[Ut]).h,xt=Pt.v,Ft=0;Ft<xt;Ft++)for(Zt=0;Zt<wt;Zt++)Ot(Pt,Dt,Rt,Ft,Zt);if(++Rt===bt)break}if(Rt===bt)do{if(q[et]===255&&q[et+1]!==0)break;et+=1}while(et<q.length-2);if(gt=0,(Lt=q[et]<<8|q[et+1])<65280)throw new Error("marker was not found");if(!(Lt>=65488&&Lt<=65495))break;et+=2}return et-At}function H(q,et){var X,tt,rt=[],ot=et.blocksPerLine,J=et.blocksPerColumn,lt=ot<<3,st=new Int32Array(64),ut=new Uint8Array(64);function it(Tt,It,$t){var Bt,zt,Ot,Nt,Pt,Ut,Ft,Zt,Ht,Dt,dt=et.quantizationTable,Lt=$t;for(Dt=0;Dt<64;Dt++)Lt[Dt]=Tt[Dt]*dt[Dt];for(Dt=0;Dt<8;++Dt){var bt=8*Dt;Lt[1+bt]!=0||Lt[2+bt]!=0||Lt[3+bt]!=0||Lt[4+bt]!=0||Lt[5+bt]!=0||Lt[6+bt]!=0||Lt[7+bt]!=0?(Bt=D*Lt[0+bt]+128>>8,zt=D*Lt[4+bt]+128>>8,Ot=Lt[2+bt],Nt=Lt[6+bt],Pt=U*(Lt[1+bt]-Lt[7+bt])+128>>8,Zt=U*(Lt[1+bt]+Lt[7+bt])+128>>8,Ut=Lt[3+bt]<<4,Ft=Lt[5+bt]<<4,Ht=Bt-zt+1>>1,Bt=Bt+zt+1>>1,zt=Ht,Ht=Ot*F+Nt*P+128>>8,Ot=Ot*P-Nt*F+128>>8,Nt=Ht,Ht=Pt-Ft+1>>1,Pt=Pt+Ft+1>>1,Ft=Ht,Ht=Zt+Ut+1>>1,Ut=Zt-Ut+1>>1,Zt=Ht,Ht=Bt-Nt+1>>1,Bt=Bt+Nt+1>>1,Nt=Ht,Ht=zt-Ot+1>>1,zt=zt+Ot+1>>1,Ot=Ht,Ht=Pt*I+Zt*w+2048>>12,Pt=Pt*w-Zt*I+2048>>12,Zt=Ht,Ht=Ut*g+Ft*m+2048>>12,Ut=Ut*m-Ft*g+2048>>12,Ft=Ht,Lt[0+bt]=Bt+Zt,Lt[7+bt]=Bt-Zt,Lt[1+bt]=zt+Ft,Lt[6+bt]=zt-Ft,Lt[2+bt]=Ot+Ut,Lt[5+bt]=Ot-Ut,Lt[3+bt]=Nt+Pt,Lt[4+bt]=Nt-Pt):(Ht=D*Lt[0+bt]+512>>10,Lt[0+bt]=Ht,Lt[1+bt]=Ht,Lt[2+bt]=Ht,Lt[3+bt]=Ht,Lt[4+bt]=Ht,Lt[5+bt]=Ht,Lt[6+bt]=Ht,Lt[7+bt]=Ht)}for(Dt=0;Dt<8;++Dt){var wt=Dt;Lt[8+wt]!=0||Lt[16+wt]!=0||Lt[24+wt]!=0||Lt[32+wt]!=0||Lt[40+wt]!=0||Lt[48+wt]!=0||Lt[56+wt]!=0?(Bt=D*Lt[0+wt]+2048>>12,zt=D*Lt[32+wt]+2048>>12,Ot=Lt[16+wt],Nt=Lt[48+wt],Pt=U*(Lt[8+wt]-Lt[56+wt])+2048>>12,Zt=U*(Lt[8+wt]+Lt[56+wt])+2048>>12,Ut=Lt[24+wt],Ft=Lt[40+wt],Ht=Bt-zt+1>>1,Bt=Bt+zt+1>>1,zt=Ht,Ht=Ot*F+Nt*P+2048>>12,Ot=Ot*P-Nt*F+2048>>12,Nt=Ht,Ht=Pt-Ft+1>>1,Pt=Pt+Ft+1>>1,Ft=Ht,Ht=Zt+Ut+1>>1,Ut=Zt-Ut+1>>1,Zt=Ht,Ht=Bt-Nt+1>>1,Bt=Bt+Nt+1>>1,Nt=Ht,Ht=zt-Ot+1>>1,zt=zt+Ot+1>>1,Ot=Ht,Ht=Pt*I+Zt*w+2048>>12,Pt=Pt*w-Zt*I+2048>>12,Zt=Ht,Ht=Ut*g+Ft*m+2048>>12,Ut=Ut*m-Ft*g+2048>>12,Ft=Ht,Lt[0+wt]=Bt+Zt,Lt[56+wt]=Bt-Zt,Lt[8+wt]=zt+Ft,Lt[48+wt]=zt-Ft,Lt[16+wt]=Ot+Ut,Lt[40+wt]=Ot-Ut,Lt[24+wt]=Nt+Pt,Lt[32+wt]=Nt-Pt):(Ht=D*$t[Dt+0]+8192>>14,Lt[0+wt]=Ht,Lt[8+wt]=Ht,Lt[16+wt]=Ht,Lt[24+wt]=Ht,Lt[32+wt]=Ht,Lt[40+wt]=Ht,Lt[48+wt]=Ht,Lt[56+wt]=Ht)}for(Dt=0;Dt<64;++Dt){var xt=128+(Lt[Dt]+8>>4);It[Dt]=xt<0?0:xt>255?255:xt}}K(lt*J*8);for(var ct=0;ct<J;ct++){var At=ct<<3;for(X=0;X<8;X++)rt.push(new Uint8Array(lt));for(var Et=0;Et<ot;Et++){it(et.blocks[ct][Et],ut,st);var gt=0,pt=Et<<3;for(tt=0;tt<8;tt++){var vt=rt[At+tt];for(X=0;X<8;X++)vt[pt+X]=ut[gt++]}}}return rt}function W(q){return q<0?0:q>255?255:q}Z.prototype={load:function(q){var et=new XMLHttpRequest;et.open("GET",q,!0),et.responseType="arraybuffer",et.onload=function(){var X=new Uint8Array(et.response||et.mozResponseArrayBuffer);this.parse(X),this.onload&&this.onload()}.bind(this),et.send(null)},parse:function(q){var et=1e3*this.opts.maxResolutionInMP*1e3,X=0;function tt(){var Jt=q[X]<<8|q[X+1];return X+=2,Jt}function rt(Jt){var se,ae,fe=1,le=1;for(ae in Jt.components)Jt.components.hasOwnProperty(ae)&&(fe<(se=Jt.components[ae]).h&&(fe=se.h),le<se.v&&(le=se.v));var ue=Math.ceil(Jt.samplesPerLine/8/fe),me=Math.ceil(Jt.scanLines/8/le);for(ae in Jt.components)if(Jt.components.hasOwnProperty(ae)){se=Jt.components[ae];var he=Math.ceil(Math.ceil(Jt.samplesPerLine/8)*se.h/fe),Wt=Math.ceil(Math.ceil(Jt.scanLines/8)*se.v/le),oe=ue*se.h,kt=me*se.v,Xt=[];K(kt*oe*256);for(var Ct=0;Ct<kt;Ct++){for(var re=[],te=0;te<oe;te++)re.push(new Int32Array(64));Xt.push(re)}se.blocksPerLine=he,se.blocksPerColumn=Wt,se.blocks=Xt}Jt.maxH=fe,Jt.maxV=le,Jt.mcusPerLine=ue,Jt.mcusPerColumn=me}q.length;var ot,J,lt,st,ut=null,it=null,ct=[],At=[],Et=[],gt=[],pt=tt(),vt=-1;if(this.comments=[],pt!=65496)throw new Error("SOI not found");for(pt=tt();pt!=65497;){switch(pt){case 65280:break;case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var Tt=(lt=void 0,st=void 0,lt=tt(),st=q.subarray(X,X+lt-2),X+=st.length,st);if(pt===65534){var It=String.fromCharCode.apply(null,Tt);this.comments.push(It)}pt===65504&&Tt[0]===74&&Tt[1]===70&&Tt[2]===73&&Tt[3]===70&&Tt[4]===0&&(ut={version:{major:Tt[5],minor:Tt[6]},densityUnits:Tt[7],xDensity:Tt[8]<<8|Tt[9],yDensity:Tt[10]<<8|Tt[11],thumbWidth:Tt[12],thumbHeight:Tt[13],thumbData:Tt.subarray(14,14+3*Tt[12]*Tt[13])}),pt===65505&&Tt[0]===69&&Tt[1]===120&&Tt[2]===105&&Tt[3]===102&&Tt[4]===0&&(this.exifBuffer=Tt.subarray(5,Tt.length)),pt===65518&&Tt[0]===65&&Tt[1]===100&&Tt[2]===111&&Tt[3]===98&&Tt[4]===101&&Tt[5]===0&&(it={version:Tt[6],flags0:Tt[7]<<8|Tt[8],flags1:Tt[9]<<8|Tt[10],transformCode:Tt[11]});break;case 65499:for(var $t=tt()+X-2;X<$t;){var Bt=q[X++];K(256);var zt=new Int32Array(64);if(Bt>>4){if(Bt>>4!=1)throw new Error("DQT: invalid table spec");for(Vt=0;Vt<64;Vt++)zt[d[Vt]]=tt()}else for(Vt=0;Vt<64;Vt++)zt[d[Vt]]=q[X++];ct[15&Bt]=zt}break;case 65472:case 65473:case 65474:tt(),(ot={}).extended=pt===65473,ot.progressive=pt===65474,ot.precision=q[X++],ot.scanLines=tt(),ot.samplesPerLine=tt(),ot.components={},ot.componentsOrder=[];var Ot=ot.scanLines*ot.samplesPerLine;if(Ot>et){var Nt=Math.ceil((Ot-et)/1e6);throw new Error(`maxResolutionInMP limit exceeded by ${Nt}MP`)}var Pt,Ut=q[X++];for(_t=0;_t<Ut;_t++){Pt=q[X];var Ft=q[X+1]>>4,Zt=15&q[X+1],Ht=q[X+2];if(Ft<=0||Zt<=0)throw new Error("Invalid sampling factor, expected values above 0");ot.componentsOrder.push(Pt),ot.components[Pt]={h:Ft,v:Zt,quantizationIdx:Ht},X+=3}rt(ot),At.push(ot);break;case 65476:var Dt=tt();for(_t=2;_t<Dt;){var dt=q[X++],Lt=new Uint8Array(16),bt=0;for(Vt=0;Vt<16;Vt++,X++)bt+=Lt[Vt]=q[X];K(16+bt);var wt=new Uint8Array(bt);for(Vt=0;Vt<bt;Vt++,X++)wt[Vt]=q[X];_t+=17+bt,(dt>>4?Et:gt)[15&dt]=$(Lt,wt)}break;case 65501:tt(),J=tt();break;case 65500:tt(),tt();break;case 65498:tt();var xt=q[X++],Rt=[];for(_t=0;_t<xt;_t++){ee=ot.components[q[X++]];var Gt=q[X++];ee.huffmanTableDC=gt[Gt>>4],ee.huffmanTableAC=Et[15&Gt],Rt.push(ee)}var nt=q[X++],ht=q[X++],ft=q[X++],at=j(q,X,ot,Rt,J,nt,ht,ft>>4,15&ft,this.opts);X+=at;break;case 65535:q[X]!==255&&X--;break;default:if(q[X-3]==255&&q[X-2]>=192&&q[X-2]<=254){X-=3;break}if(pt===224||pt==225){if(vt!==-1)throw new Error(`first unknown JPEG marker at offset ${vt.toString(16)}, second unknown JPEG marker ${pt.toString(16)} at offset ${(X-1).toString(16)}`);vt=X-1;const Jt=tt();if(q[X+Jt-2]===255){X+=Jt-2;break}}throw new Error("unknown JPEG marker "+pt.toString(16))}pt=tt()}if(At.length!=1)throw new Error("only single frame JPEGs supported");for(var _t=0;_t<At.length;_t++){var St=At[_t].components;for(var Vt in St)St[Vt].quantizationTable=ct[St[Vt].quantizationIdx],delete St[Vt].quantizationIdx}for(this.width=ot.samplesPerLine,this.height=ot.scanLines,this.jfif=ut,this.adobe=it,this.components=[],_t=0;_t<ot.componentsOrder.length;_t++){var ee=ot.components[ot.componentsOrder[_t]];this.components.push({lines:H(0,ee),scaleX:ee.h/ot.maxH,scaleY:ee.v/ot.maxV})}},getData:function(q,et){var X,tt,rt,ot,J,lt,st,ut,it,ct,At,Et,gt,pt,vt,Tt,It,$t,Bt,zt,Ot,Nt=this.width/q,Pt=this.height/et,Ut=0,Ft=q*et*this.components.length;K(Ft);var Zt=new Uint8Array(Ft);switch(this.components.length){case 1:for(X=this.components[0],ct=0;ct<et;ct++)for(J=X.lines[0|ct*X.scaleY*Pt],it=0;it<q;it++)At=J[0|it*X.scaleX*Nt],Zt[Ut++]=At;break;case 2:for(X=this.components[0],tt=this.components[1],ct=0;ct<et;ct++)for(J=X.lines[0|ct*X.scaleY*Pt],lt=tt.lines[0|ct*tt.scaleY*Pt],it=0;it<q;it++)At=J[0|it*X.scaleX*Nt],Zt[Ut++]=At,At=lt[0|it*tt.scaleX*Nt],Zt[Ut++]=At;break;case 3:for(Ot=!0,this.adobe&&this.adobe.transformCode?Ot=!0:this.opts.colorTransform!==void 0&&(Ot=!!this.opts.colorTransform),X=this.components[0],tt=this.components[1],rt=this.components[2],ct=0;ct<et;ct++)for(J=X.lines[0|ct*X.scaleY*Pt],lt=tt.lines[0|ct*tt.scaleY*Pt],st=rt.lines[0|ct*rt.scaleY*Pt],it=0;it<q;it++)Ot?(At=J[0|it*X.scaleX*Nt],Et=lt[0|it*tt.scaleX*Nt],$t=W(At+1.402*((gt=st[0|it*rt.scaleX*Nt])-128)),Bt=W(At-.3441363*(Et-128)-.71413636*(gt-128)),zt=W(At+1.772*(Et-128))):($t=J[0|it*X.scaleX*Nt],Bt=lt[0|it*tt.scaleX*Nt],zt=st[0|it*rt.scaleX*Nt]),Zt[Ut++]=$t,Zt[Ut++]=Bt,Zt[Ut++]=zt;break;case 4:if(!this.adobe)throw new Error("Unsupported color mode (4 components)");for(Ot=!1,this.adobe&&this.adobe.transformCode?Ot=!0:this.opts.colorTransform!==void 0&&(Ot=!!this.opts.colorTransform),X=this.components[0],tt=this.components[1],rt=this.components[2],ot=this.components[3],ct=0;ct<et;ct++)for(J=X.lines[0|ct*X.scaleY*Pt],lt=tt.lines[0|ct*tt.scaleY*Pt],st=rt.lines[0|ct*rt.scaleY*Pt],ut=ot.lines[0|ct*ot.scaleY*Pt],it=0;it<q;it++)Ot?(At=J[0|it*X.scaleX*Nt],Et=lt[0|it*tt.scaleX*Nt],gt=st[0|it*rt.scaleX*Nt],pt=ut[0|it*ot.scaleX*Nt],vt=255-W(At+1.402*(gt-128)),Tt=255-W(At-.3441363*(Et-128)-.71413636*(gt-128)),It=255-W(At+1.772*(Et-128))):(vt=J[0|it*X.scaleX*Nt],Tt=lt[0|it*tt.scaleX*Nt],It=st[0|it*rt.scaleX*Nt],pt=ut[0|it*ot.scaleX*Nt]),Zt[Ut++]=255-vt,Zt[Ut++]=255-Tt,Zt[Ut++]=255-It,Zt[Ut++]=255-pt;break;default:throw new Error("Unsupported color mode")}return Zt},copyToImageData:function(q,et){var X,tt,rt,ot,J,lt,st,ut,it,ct=q.width,At=q.height,Et=q.data,gt=this.getData(ct,At),pt=0,vt=0;switch(this.components.length){case 1:for(tt=0;tt<At;tt++)for(X=0;X<ct;X++)rt=gt[pt++],Et[vt++]=rt,Et[vt++]=rt,Et[vt++]=rt,et&&(Et[vt++]=255);break;case 3:for(tt=0;tt<At;tt++)for(X=0;X<ct;X++)st=gt[pt++],ut=gt[pt++],it=gt[pt++],Et[vt++]=st,Et[vt++]=ut,Et[vt++]=it,et&&(Et[vt++]=255);break;case 4:for(tt=0;tt<At;tt++)for(X=0;X<ct;X++)J=gt[pt++],lt=gt[pt++],rt=gt[pt++],st=255-W(J*(1-(ot=gt[pt++])/255)+ot),ut=255-W(lt*(1-ot/255)+ot),it=255-W(rt*(1-ot/255)+ot),Et[vt++]=st,Et[vt++]=ut,Et[vt++]=it,et&&(Et[vt++]=255);break;default:throw new Error("Unsupported color mode")}}};var V=0,Q=0;function K(q=0){var et=V+q;if(et>Q){var X=Math.ceil((et-Q)/1024/1024);throw new Error(`maxMemoryUsageInMB limit exceeded by at least ${X}MB`)}V=et}return Z.resetMaxMemoryUsage=function(q){V=0,Q=q},Z.getBytesAllocated=function(){return V},Z.requestMemoryAllocation=K,Z}(),module.exports=function(d,m={}){var g={colorTransform:void 0,useTArray:!1,formatAsRGBA:!0,tolerantDecoding:!0,maxResolutionInMP:100,maxMemoryUsageInMB:512,...m},w=new Uint8Array(d),I=new JpegImage;I.opts=g,JpegImage.resetMaxMemoryUsage(1024*g.maxMemoryUsageInMB*1024),I.parse(w);var P=g.formatAsRGBA?4:3,F=I.width*I.height*P;try{JpegImage.requestMemoryAllocation(F);var D={width:I.width,height:I.height,exifBuffer:I.exifBuffer,data:g.useTArray?new Uint8Array(F):Buffer$2.alloc(F)};I.comments.length>0&&(D.comments=I.comments)}catch(U){throw U instanceof RangeError?new Error("Could not allocate enough memory for the image. Required: "+F):U instanceof ReferenceError&&U.message==="Buffer is not defined"?new Error("Buffer is not globally defined in this environment. Consider setting useTArray to true"):U}return I.copyToImageData(D,g.formatAsRGBA),D};var decoderExports=decoder.exports,encode=encoderExports,decode=decoderExports,jpegJs={encode,decode},JPEG=getDefaultExportFromCjs(jpegJs);function jpeg$2(){return{mime:"image/jpeg",encode:(d,{quality:m=100}={})=>JPEG.encode(d,m).data,decode:(d,m)=>JPEG.decode(d,m)}}function commonjsRequire(d){throw new Error('Could not dynamically require "'+d+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var browser$1={exports:{}};browser$1.exports=function(){function d(m,g,w){function I(D,U){if(!g[D]){if(!m[D]){var Z=typeof commonjsRequire=="function"&&commonjsRequire;if(!U&&Z)return Z(D,!0);if(P)return P(D,!0);var $=new Error("Cannot find module '"+D+"'");throw $.code="MODULE_NOT_FOUND",$}var j=g[D]={exports:{}};m[D][0].call(j.exports,function(H){return I(m[D][1][H]||H)},j,j.exports,d,m,g,w)}return g[D].exports}for(var P=typeof commonjsRequire=="function"&&commonjsRequire,F=0;F<w.length;F++)I(w[F]);return I}return d}()({1:[function(d,m,g){(function(w){(function(){let I=d("./interlace"),P=[function(){},function($,j,H,W){if(W===j.length)throw new Error("Ran out of data");let V=j[W];$[H]=V,$[H+1]=V,$[H+2]=V,$[H+3]=255},function($,j,H,W){if(W+1>=j.length)throw new Error("Ran out of data");let V=j[W];$[H]=V,$[H+1]=V,$[H+2]=V,$[H+3]=j[W+1]},function($,j,H,W){if(W+2>=j.length)throw new Error("Ran out of data");$[H]=j[W],$[H+1]=j[W+1],$[H+2]=j[W+2],$[H+3]=255},function($,j,H,W){if(W+3>=j.length)throw new Error("Ran out of data");$[H]=j[W],$[H+1]=j[W+1],$[H+2]=j[W+2],$[H+3]=j[W+3]}],F=[function(){},function($,j,H,W){let V=j[0];$[H]=V,$[H+1]=V,$[H+2]=V,$[H+3]=W},function($,j,H){let W=j[0];$[H]=W,$[H+1]=W,$[H+2]=W,$[H+3]=j[1]},function($,j,H,W){$[H]=j[0],$[H+1]=j[1],$[H+2]=j[2],$[H+3]=W},function($,j,H){$[H]=j[0],$[H+1]=j[1],$[H+2]=j[2],$[H+3]=j[3]}];function D($,j){let H=[],W=0;function V(){if(W===$.length)throw new Error("Ran out of data");let Q,K,q,et,X,tt,rt,ot,J=$[W];switch(W++,j){default:throw new Error("unrecognised depth");case 16:rt=$[W],W++,H.push((J<<8)+rt);break;case 4:rt=15&J,ot=J>>4,H.push(ot,rt);break;case 2:X=3&J,tt=J>>2&3,rt=J>>4&3,ot=J>>6&3,H.push(ot,rt,tt,X);break;case 1:Q=1&J,K=J>>1&1,q=J>>2&1,et=J>>3&1,X=J>>4&1,tt=J>>5&1,rt=J>>6&1,ot=J>>7&1,H.push(ot,rt,tt,X,et,q,K,Q)}}return{get:function(Q){for(;H.length<Q;)V();let K=H.slice(0,Q);return H=H.slice(Q),K},resetAfterLine:function(){H.length=0},end:function(){if(W!==$.length)throw new Error("extra data found")}}}function U($,j,H,W,V,Q){let K=$.width,q=$.height,et=$.index;for(let X=0;X<q;X++)for(let tt=0;tt<K;tt++){let rt=H(tt,X,et);P[W](j,V,rt,Q),Q+=W}return Q}function Z($,j,H,W,V,Q){let K=$.width,q=$.height,et=$.index;for(let X=0;X<q;X++){for(let tt=0;tt<K;tt++){let rt=V.get(W),ot=H(tt,X,et);F[W](j,rt,ot,Q)}V.resetAfterLine()}}g.dataToBitMap=function($,j){let H,W,V=j.width,Q=j.height,K=j.depth,q=j.bpp,et=j.interlace;K!==8&&(H=D($,K)),W=K<=8?w.alloc(V*Q*4):new Uint16Array(V*Q*4);let X,tt,rt=Math.pow(2,K)-1,ot=0;if(et)X=I.getImagePasses(V,Q),tt=I.getInterlaceIterator(V,Q);else{let J=0;tt=function(){let lt=J;return J+=4,lt},X=[{width:V,height:Q}]}for(let J=0;J<X.length;J++)K===8?ot=U(X[J],W,tt,q,$,ot):Z(X[J],W,tt,q,H,rt);if(K===8){if(ot!==$.length)throw new Error("extra data found")}else H.end();return W}}).call(this)}).call(this,d("buffer").Buffer)},{"./interlace":11,buffer:32}],2:[function(d,m,g){(function(w){(function(){let I=d("./constants");m.exports=function(P,F,D,U){let Z=[I.COLORTYPE_COLOR_ALPHA,I.COLORTYPE_ALPHA].indexOf(U.colorType)!==-1;if(U.colorType===U.inputColorType){let X=function(){let tt=new ArrayBuffer(2);return new DataView(tt).setInt16(0,256,!0),new Int16Array(tt)[0]!==256}();if(U.bitDepth===8||U.bitDepth===16&&X)return P}let $=U.bitDepth!==16?P:new Uint16Array(P.buffer),j=255,H=I.COLORTYPE_TO_BPP_MAP[U.inputColorType];H!==4||U.inputHasAlpha||(H=3);let W=I.COLORTYPE_TO_BPP_MAP[U.colorType];U.bitDepth===16&&(j=65535,W*=2);let V=w.alloc(F*D*W),Q=0,K=0,q=U.bgColor||{};function et(){let X,tt,rt,ot=j;switch(U.inputColorType){case I.COLORTYPE_COLOR_ALPHA:ot=$[Q+3],X=$[Q],tt=$[Q+1],rt=$[Q+2];break;case I.COLORTYPE_COLOR:X=$[Q],tt=$[Q+1],rt=$[Q+2];break;case I.COLORTYPE_ALPHA:ot=$[Q+1],X=$[Q],tt=X,rt=X;break;case I.COLORTYPE_GRAYSCALE:X=$[Q],tt=X,rt=X;break;default:throw new Error("input color type:"+U.inputColorType+" is not supported at present")}return U.inputHasAlpha&&(Z||(ot/=j,X=Math.min(Math.max(Math.round((1-ot)*q.red+ot*X),0),j),tt=Math.min(Math.max(Math.round((1-ot)*q.green+ot*tt),0),j),rt=Math.min(Math.max(Math.round((1-ot)*q.blue+ot*rt),0),j))),{red:X,green:tt,blue:rt,alpha:ot}}q.red===void 0&&(q.red=j),q.green===void 0&&(q.green=j),q.blue===void 0&&(q.blue=j);for(let X=0;X<D;X++)for(let tt=0;tt<F;tt++){let rt=et();switch(U.colorType){case I.COLORTYPE_COLOR_ALPHA:case I.COLORTYPE_COLOR:U.bitDepth===8?(V[K]=rt.red,V[K+1]=rt.green,V[K+2]=rt.blue,Z&&(V[K+3]=rt.alpha)):(V.writeUInt16BE(rt.red,K),V.writeUInt16BE(rt.green,K+2),V.writeUInt16BE(rt.blue,K+4),Z&&V.writeUInt16BE(rt.alpha,K+6));break;case I.COLORTYPE_ALPHA:case I.COLORTYPE_GRAYSCALE:{let ot=(rt.red+rt.green+rt.blue)/3;U.bitDepth===8?(V[K]=ot,Z&&(V[K+1]=rt.alpha)):(V.writeUInt16BE(ot,K),Z&&V.writeUInt16BE(rt.alpha,K+2));break}default:throw new Error("unrecognised color Type "+U.colorType)}Q+=H,K+=W}return V}}).call(this)}).call(this,d("buffer").Buffer)},{"./constants":4,buffer:32}],3:[function(d,m,g){(function(w,I){(function(){let P=d("util"),F=d("stream"),D=m.exports=function(){F.call(this),this._buffers=[],this._buffered=0,this._reads=[],this._paused=!1,this._encoding="utf8",this.writable=!0};P.inherits(D,F),D.prototype.read=function(U,Z){this._reads.push({length:Math.abs(U),allowLess:U<0,func:Z}),w.nextTick(function(){this._process(),this._paused&&this._reads&&this._reads.length>0&&(this._paused=!1,this.emit("drain"))}.bind(this))},D.prototype.write=function(U,Z){if(!this.writable)return this.emit("error",new Error("Stream not writable")),!1;let $;return $=I.isBuffer(U)?U:I.from(U,Z||this._encoding),this._buffers.push($),this._buffered+=$.length,this._process(),this._reads&&this._reads.length===0&&(this._paused=!0),this.writable&&!this._paused},D.prototype.end=function(U,Z){U&&this.write(U,Z),this.writable=!1,this._buffers&&(this._buffers.length===0?this._end():(this._buffers.push(null),this._process()))},D.prototype.destroySoon=D.prototype.end,D.prototype._end=function(){this._reads.length>0&&this.emit("error",new Error("Unexpected end of input")),this.destroy()},D.prototype.destroy=function(){this._buffers&&(this.writable=!1,this._reads=null,this._buffers=null,this.emit("close"))},D.prototype._processReadAllowingLess=function(U){this._reads.shift();let Z=this._buffers[0];Z.length>U.length?(this._buffered-=U.length,this._buffers[0]=Z.slice(U.length),U.func.call(this,Z.slice(0,U.length))):(this._buffered-=Z.length,this._buffers.shift(),U.func.call(this,Z))},D.prototype._processRead=function(U){this._reads.shift();let Z=0,$=0,j=I.alloc(U.length);for(;Z<U.length;){let H=this._buffers[$++],W=Math.min(H.length,U.length-Z);H.copy(j,Z,0,W),Z+=W,W!==H.length&&(this._buffers[--$]=H.slice(W))}$>0&&this._buffers.splice(0,$),this._buffered-=U.length,U.func.call(this,j)},D.prototype._process=function(){try{for(;this._buffered>0&&this._reads&&this._reads.length>0;){let U=this._reads[0];if(U.allowLess)this._processReadAllowingLess(U);else{if(!(this._buffered>=U.length))break;this._processRead(U)}}this._buffers&&!this.writable&&this._end()}catch(U){this.emit("error",U)}}}).call(this)}).call(this,d("_process"),d("buffer").Buffer)},{_process:63,buffer:32,stream:65,util:84}],4:[function(d,m,g){m.exports={PNG_SIGNATURE:[137,80,78,71,13,10,26,10],TYPE_IHDR:1229472850,TYPE_IEND:1229278788,TYPE_IDAT:1229209940,TYPE_PLTE:1347179589,TYPE_tRNS:1951551059,TYPE_gAMA:1732332865,COLORTYPE_GRAYSCALE:0,COLORTYPE_PALETTE:1,COLORTYPE_COLOR:2,COLORTYPE_ALPHA:4,COLORTYPE_PALETTE_COLOR:3,COLORTYPE_COLOR_ALPHA:6,COLORTYPE_TO_BPP_MAP:{0:1,2:3,3:1,4:2,6:4},GAMMA_DIVISION:1e5}},{}],5:[function(d,m,g){let w=[];(function(){for(let P=0;P<256;P++){let F=P;for(let D=0;D<8;D++)1&F?F=3988292384^F>>>1:F>>>=1;w[P]=F}})();let I=m.exports=function(){this._crc=-1};I.prototype.write=function(P){for(let F=0;F<P.length;F++)this._crc=w[255&(this._crc^P[F])]^this._crc>>>8;return!0},I.prototype.crc32=function(){return~this._crc},I.crc32=function(P){let F=-1;for(let D=0;D<P.length;D++)F=w[255&(F^P[D])]^F>>>8;return~F}},{}],6:[function(d,m,g){(function(w){(function(){let I=d("./paeth-predictor");function P(q,et,X,tt,rt){for(let ot=0;ot<X;ot++)tt[rt+ot]=q[et+ot]}function F(q,et,X){let tt=0,rt=et+X;for(let ot=et;ot<rt;ot++)tt+=Math.abs(q[ot]);return tt}function D(q,et,X,tt,rt,ot){for(let J=0;J<X;J++){let lt=J>=ot?q[et+J-ot]:0,st=q[et+J]-lt;tt[rt+J]=st}}function U(q,et,X,tt){let rt=0;for(let ot=0;ot<X;ot++){let J=ot>=tt?q[et+ot-tt]:0,lt=q[et+ot]-J;rt+=Math.abs(lt)}return rt}function Z(q,et,X,tt,rt){for(let ot=0;ot<X;ot++){let J=et>0?q[et+ot-X]:0,lt=q[et+ot]-J;tt[rt+ot]=lt}}function $(q,et,X){let tt=0,rt=et+X;for(let ot=et;ot<rt;ot++){let J=et>0?q[ot-X]:0,lt=q[ot]-J;tt+=Math.abs(lt)}return tt}function j(q,et,X,tt,rt,ot){for(let J=0;J<X;J++){let lt=J>=ot?q[et+J-ot]:0,st=et>0?q[et+J-X]:0,ut=q[et+J]-(lt+st>>1);tt[rt+J]=ut}}function H(q,et,X,tt){let rt=0;for(let ot=0;ot<X;ot++){let J=ot>=tt?q[et+ot-tt]:0,lt=et>0?q[et+ot-X]:0,st=q[et+ot]-(J+lt>>1);rt+=Math.abs(st)}return rt}function W(q,et,X,tt,rt,ot){for(let J=0;J<X;J++){let lt=J>=ot?q[et+J-ot]:0,st=et>0?q[et+J-X]:0,ut=et>0&&J>=ot?q[et+J-(X+ot)]:0,it=q[et+J]-I(lt,st,ut);tt[rt+J]=it}}function V(q,et,X,tt){let rt=0;for(let ot=0;ot<X;ot++){let J=ot>=tt?q[et+ot-tt]:0,lt=et>0?q[et+ot-X]:0,st=et>0&&ot>=tt?q[et+ot-(X+tt)]:0,ut=q[et+ot]-I(J,lt,st);rt+=Math.abs(ut)}return rt}let Q={0:P,1:D,2:Z,3:j,4:W},K={0:F,1:U,2:$,3:H,4:V};m.exports=function(q,et,X,tt,rt){let ot;if("filterType"in tt&&tt.filterType!==-1){if(typeof tt.filterType!="number")throw new Error("unrecognised filter types");ot=[tt.filterType]}else ot=[0,1,2,3,4];tt.bitDepth===16&&(rt*=2);let J=et*rt,lt=0,st=0,ut=w.alloc((J+1)*X),it=ot[0];for(let ct=0;ct<X;ct++){if(ot.length>1){let At=1/0;for(let Et=0;Et<ot.length;Et++){let gt=K[ot[Et]](q,st,J,rt);gt<At&&(it=ot[Et],At=gt)}}ut[lt]=it,lt++,Q[it](q,st,J,ut,lt,rt),lt+=J,st+=J}return ut}}).call(this)}).call(this,d("buffer").Buffer)},{"./paeth-predictor":15,buffer:32}],7:[function(d,m,g){(function(w){(function(){let I=d("util"),P=d("./chunkstream"),F=d("./filter-parse"),D=m.exports=function(U){P.call(this);let Z=[],$=this;this._filter=new F(U,{read:this.read.bind(this),write:function(j){Z.push(j)},complete:function(){$.emit("complete",w.concat(Z))}}),this._filter.start()};I.inherits(D,P)}).call(this)}).call(this,d("buffer").Buffer)},{"./chunkstream":3,"./filter-parse":9,buffer:32,util:84}],8:[function(d,m,g){(function(w){(function(){let I=d("./sync-reader"),P=d("./filter-parse");g.process=function(F,D){let U=[],Z=new I(F);return new P(D,{read:Z.read.bind(Z),write:function($){U.push($)},complete:function(){}}).start(),Z.process(),w.concat(U)}}).call(this)}).call(this,d("buffer").Buffer)},{"./filter-parse":9,"./sync-reader":22,buffer:32}],9:[function(d,m,g){(function(w){(function(){let I=d("./interlace"),P=d("./paeth-predictor");function F(U,Z,$){let j=U*Z;return $!==8&&(j=Math.ceil(j/(8/$))),j}let D=m.exports=function(U,Z){let $=U.width,j=U.height,H=U.interlace,W=U.bpp,V=U.depth;if(this.read=Z.read,this.write=Z.write,this.complete=Z.complete,this._imageIndex=0,this._images=[],H){let Q=I.getImagePasses($,j);for(let K=0;K<Q.length;K++)this._images.push({byteWidth:F(Q[K].width,W,V),height:Q[K].height,lineIndex:0})}else this._images.push({byteWidth:F($,W,V),height:j,lineIndex:0});this._xComparison=V===8?W:V===16?2*W:1};D.prototype.start=function(){this.read(this._images[this._imageIndex].byteWidth+1,this._reverseFilterLine.bind(this))},D.prototype._unFilterType1=function(U,Z,$){let j=this._xComparison,H=j-1;for(let W=0;W<$;W++){let V=U[1+W],Q=W>H?Z[W-j]:0;Z[W]=V+Q}},D.prototype._unFilterType2=function(U,Z,$){let j=this._lastLine;for(let H=0;H<$;H++){let W=U[1+H],V=j?j[H]:0;Z[H]=W+V}},D.prototype._unFilterType3=function(U,Z,$){let j=this._xComparison,H=j-1,W=this._lastLine;for(let V=0;V<$;V++){let Q=U[1+V],K=W?W[V]:0,q=V>H?Z[V-j]:0,et=Math.floor((q+K)/2);Z[V]=Q+et}},D.prototype._unFilterType4=function(U,Z,$){let j=this._xComparison,H=j-1,W=this._lastLine;for(let V=0;V<$;V++){let Q=U[1+V],K=W?W[V]:0,q=V>H?Z[V-j]:0,et=V>H&&W?W[V-j]:0,X=P(q,K,et);Z[V]=Q+X}},D.prototype._reverseFilterLine=function(U){let Z,$=U[0],j=this._images[this._imageIndex],H=j.byteWidth;if($===0)Z=U.slice(1,H+1);else switch(Z=w.alloc(H),$){case 1:this._unFilterType1(U,Z,H);break;case 2:this._unFilterType2(U,Z,H);break;case 3:this._unFilterType3(U,Z,H);break;case 4:this._unFilterType4(U,Z,H);break;default:throw new Error("Unrecognised filter type - "+$)}this.write(Z),j.lineIndex++,j.lineIndex>=j.height?(this._lastLine=null,this._imageIndex++,j=this._images[this._imageIndex]):this._lastLine=Z,j?this.read(j.byteWidth+1,this._reverseFilterLine.bind(this)):(this._lastLine=null,this.complete())}}).call(this)}).call(this,d("buffer").Buffer)},{"./interlace":11,"./paeth-predictor":15,buffer:32}],10:[function(d,m,g){(function(w){(function(){function I(D,U,Z,$,j){let H=0;for(let W=0;W<$;W++)for(let V=0;V<Z;V++){let Q=j[D[H]];if(!Q)throw new Error("index "+D[H]+" not in palette");for(let K=0;K<4;K++)U[H+K]=Q[K];H+=4}}function P(D,U,Z,$,j){let H=0;for(let W=0;W<$;W++)for(let V=0;V<Z;V++){let Q=!1;if(j.length===1?j[0]===D[H]&&(Q=!0):j[0]===D[H]&&j[1]===D[H+1]&&j[2]===D[H+2]&&(Q=!0),Q)for(let K=0;K<4;K++)U[H+K]=0;H+=4}}function F(D,U,Z,$,j){let H=255,W=Math.pow(2,j)-1,V=0;for(let Q=0;Q<$;Q++)for(let K=0;K<Z;K++){for(let q=0;q<4;q++)U[V+q]=Math.floor(D[V+q]*H/W+.5);V+=4}}m.exports=function(D,U,Z=!1){let $=U.depth,j=U.width,H=U.height,W=U.colorType,V=U.transColor,Q=U.palette,K=D;return W===3?I(D,K,j,H,Q):(V&&P(D,K,j,H,V),$===8||Z||($===16&&(K=w.alloc(j*H*4)),F(D,K,j,H,$))),K}}).call(this)}).call(this,d("buffer").Buffer)},{buffer:32}],11:[function(d,m,g){let w=[{x:[0],y:[0]},{x:[4],y:[0]},{x:[0,4],y:[4]},{x:[2,6],y:[0,4]},{x:[0,2,4,6],y:[2,6]},{x:[1,3,5,7],y:[0,2,4,6]},{x:[0,1,2,3,4,5,6,7],y:[1,3,5,7]}];g.getImagePasses=function(I,P){let F=[],D=I%8,U=P%8,Z=(I-D)/8,$=(P-U)/8;for(let j=0;j<w.length;j++){let H=w[j],W=Z*H.x.length,V=$*H.y.length;for(let Q=0;Q<H.x.length&&H.x[Q]<D;Q++)W++;for(let Q=0;Q<H.y.length&&H.y[Q]<U;Q++)V++;W>0&&V>0&&F.push({width:W,height:V,index:j})}return F},g.getInterlaceIterator=function(I){return function(P,F,D){let U=P%w[D].x.length,Z=(P-U)/w[D].x.length*8+w[D].x[U],$=F%w[D].y.length;return 4*Z+((F-$)/w[D].y.length*8+w[D].y[$])*I*4}}},{}],12:[function(d,m,g){(function(w){(function(){let I=d("util"),P=d("stream"),F=d("./constants"),D=d("./packer"),U=m.exports=function(Z){P.call(this);let $=Z||{};this._packer=new D($),this._deflate=this._packer.createDeflate(),this.readable=!0};I.inherits(U,P),U.prototype.pack=function(Z,$,j,H){this.emit("data",w.from(F.PNG_SIGNATURE)),this.emit("data",this._packer.packIHDR($,j)),H&&this.emit("data",this._packer.packGAMA(H));let W=this._packer.filterData(Z,$,j);this._deflate.on("error",this.emit.bind(this,"error")),this._deflate.on("data",function(V){this.emit("data",this._packer.packIDAT(V))}.bind(this)),this._deflate.on("end",function(){this.emit("data",this._packer.packIEND()),this.emit("end")}.bind(this)),this._deflate.end(W)}}).call(this)}).call(this,d("buffer").Buffer)},{"./constants":4,"./packer":14,buffer:32,stream:65,util:84}],13:[function(d,m,g){(function(w){(function(){let I=!0,P=d("zlib");P.deflateSync||(I=!1);let F=d("./constants"),D=d("./packer");m.exports=function(U,Z){if(!I)throw new Error("To use the sync capability of this library in old node versions, please pin pngjs to v2.3.0");let $=new D(Z||{}),j=[];j.push(w.from(F.PNG_SIGNATURE)),j.push($.packIHDR(U.width,U.height)),U.gamma&&j.push($.packGAMA(U.gamma));let H=$.filterData(U.data,U.width,U.height),W=P.deflateSync(H,$.getDeflateOptions());if(H=null,!W||!W.length)throw new Error("bad png - invalid compressed data response");return j.push($.packIDAT(W)),j.push($.packIEND()),w.concat(j)}}).call(this)}).call(this,d("buffer").Buffer)},{"./constants":4,"./packer":14,buffer:32,zlib:31}],14:[function(d,m,g){(function(w){(function(){let I=d("./constants"),P=d("./crc"),F=d("./bitpacker"),D=d("./filter-pack"),U=d("zlib"),Z=m.exports=function($){if(this._options=$,$.deflateChunkSize=$.deflateChunkSize||32768,$.deflateLevel=$.deflateLevel!=null?$.deflateLevel:9,$.deflateStrategy=$.deflateStrategy!=null?$.deflateStrategy:3,$.inputHasAlpha=$.inputHasAlpha==null||$.inputHasAlpha,$.deflateFactory=$.deflateFactory||U.createDeflate,$.bitDepth=$.bitDepth||8,$.colorType=typeof $.colorType=="number"?$.colorType:I.COLORTYPE_COLOR_ALPHA,$.inputColorType=typeof $.inputColorType=="number"?$.inputColorType:I.COLORTYPE_COLOR_ALPHA,[I.COLORTYPE_GRAYSCALE,I.COLORTYPE_COLOR,I.COLORTYPE_COLOR_ALPHA,I.COLORTYPE_ALPHA].indexOf($.colorType)===-1)throw new Error("option color type:"+$.colorType+" is not supported at present");if([I.COLORTYPE_GRAYSCALE,I.COLORTYPE_COLOR,I.COLORTYPE_COLOR_ALPHA,I.COLORTYPE_ALPHA].indexOf($.inputColorType)===-1)throw new Error("option input color type:"+$.inputColorType+" is not supported at present");if($.bitDepth!==8&&$.bitDepth!==16)throw new Error("option bit depth:"+$.bitDepth+" is not supported at present")};Z.prototype.getDeflateOptions=function(){return{chunkSize:this._options.deflateChunkSize,level:this._options.deflateLevel,strategy:this._options.deflateStrategy}},Z.prototype.createDeflate=function(){return this._options.deflateFactory(this.getDeflateOptions())},Z.prototype.filterData=function($,j,H){let W=F($,j,H,this._options),V=I.COLORTYPE_TO_BPP_MAP[this._options.colorType];return D(W,j,H,this._options,V)},Z.prototype._packChunk=function($,j){let H=j?j.length:0,W=w.alloc(H+12);return W.writeUInt32BE(H,0),W.writeUInt32BE($,4),j&&j.copy(W,8),W.writeInt32BE(P.crc32(W.slice(4,W.length-4)),W.length-4),W},Z.prototype.packGAMA=function($){let j=w.alloc(4);return j.writeUInt32BE(Math.floor($*I.GAMMA_DIVISION),0),this._packChunk(I.TYPE_gAMA,j)},Z.prototype.packIHDR=function($,j){let H=w.alloc(13);return H.writeUInt32BE($,0),H.writeUInt32BE(j,4),H[8]=this._options.bitDepth,H[9]=this._options.colorType,H[10]=0,H[11]=0,H[12]=0,this._packChunk(I.TYPE_IHDR,H)},Z.prototype.packIDAT=function($){return this._packChunk(I.TYPE_IDAT,$)},Z.prototype.packIEND=function(){return this._packChunk(I.TYPE_IEND,null)}}).call(this)}).call(this,d("buffer").Buffer)},{"./bitpacker":2,"./constants":4,"./crc":5,"./filter-pack":6,buffer:32,zlib:31}],15:[function(d,m,g){m.exports=function(w,I,P){let F=w+I-P,D=Math.abs(F-w),U=Math.abs(F-I),Z=Math.abs(F-P);return D<=U&&D<=Z?w:U<=Z?I:P}},{}],16:[function(d,m,g){let w=d("util"),I=d("zlib"),P=d("./chunkstream"),F=d("./filter-parse-async"),D=d("./parser"),U=d("./bitmapper"),Z=d("./format-normaliser"),$=m.exports=function(j){P.call(this),this._parser=new D(j,{read:this.read.bind(this),error:this._handleError.bind(this),metadata:this._handleMetaData.bind(this),gamma:this.emit.bind(this,"gamma"),palette:this._handlePalette.bind(this),transColor:this._handleTransColor.bind(this),finished:this._finished.bind(this),inflateData:this._inflateData.bind(this),simpleTransparency:this._simpleTransparency.bind(this),headersFinished:this._headersFinished.bind(this)}),this._options=j,this.writable=!0,this._parser.start()};w.inherits($,P),$.prototype._handleError=function(j){this.emit("error",j),this.writable=!1,this.destroy(),this._inflate&&this._inflate.destroy&&this._inflate.destroy(),this._filter&&(this._filter.destroy(),this._filter.on("error",function(){})),this.errord=!0},$.prototype._inflateData=function(j){if(!this._inflate)if(this._bitmapInfo.interlace)this._inflate=I.createInflate(),this._inflate.on("error",this.emit.bind(this,"error")),this._filter.on("complete",this._complete.bind(this)),this._inflate.pipe(this._filter);else{let H=(1+(this._bitmapInfo.width*this._bitmapInfo.bpp*this._bitmapInfo.depth+7>>3))*this._bitmapInfo.height,W=Math.max(H,I.Z_MIN_CHUNK);this._inflate=I.createInflate({chunkSize:W});let V=H,Q=this.emit.bind(this,"error");this._inflate.on("error",function(q){V&&Q(q)}),this._filter.on("complete",this._complete.bind(this));let K=this._filter.write.bind(this._filter);this._inflate.on("data",function(q){V&&(q.length>V&&(q=q.slice(0,V)),V-=q.length,K(q))}),this._inflate.on("end",this._filter.end.bind(this._filter))}this._inflate.write(j)},$.prototype._handleMetaData=function(j){this._metaData=j,this._bitmapInfo=Object.create(j),this._filter=new F(this._bitmapInfo)},$.prototype._handleTransColor=function(j){this._bitmapInfo.transColor=j},$.prototype._handlePalette=function(j){this._bitmapInfo.palette=j},$.prototype._simpleTransparency=function(){this._metaData.alpha=!0},$.prototype._headersFinished=function(){this.emit("metadata",this._metaData)},$.prototype._finished=function(){this.errord||(this._inflate?this._inflate.end():this.emit("error","No Inflate block"))},$.prototype._complete=function(j){if(this.errord)return;let H;try{let W=U.dataToBitMap(j,this._bitmapInfo);H=Z(W,this._bitmapInfo,this._options.skipRescale),W=null}catch(W){return void this._handleError(W)}this.emit("parsed",H)}},{"./bitmapper":1,"./chunkstream":3,"./filter-parse-async":7,"./format-normaliser":10,"./parser":18,util:84,zlib:31}],17:[function(d,m,g){(function(w){(function(){let I=!0,P=d("zlib"),F=d("./sync-inflate");P.deflateSync||(I=!1);let D=d("./sync-reader"),U=d("./filter-parse-sync"),Z=d("./parser"),$=d("./bitmapper"),j=d("./format-normaliser");m.exports=function(H,W){if(!I)throw new Error("To use the sync capability of this library in old node versions, please pin pngjs to v2.3.0");let V,Q,K;function q(gt){V=gt}function et(gt){Q=gt}function X(gt){Q.transColor=gt}function tt(gt){Q.palette=gt}function rt(){Q.alpha=!0}function ot(gt){K=gt}let J=[];function lt(gt){J.push(gt)}let st=new D(H);if(new Z(W,{read:st.read.bind(st),error:q,metadata:et,gamma:ot,palette:tt,transColor:X,inflateData:lt,simpleTransparency:rt}).start(),st.process(),V)throw V;let ut,it=w.concat(J);if(J.length=0,Q.interlace)ut=P.inflateSync(it);else{let gt=(1+(Q.width*Q.bpp*Q.depth+7>>3))*Q.height;ut=F(it,{chunkSize:gt,maxLength:gt})}if(it=null,!ut||!ut.length)throw new Error("bad png - invalid inflate data response");let ct=U.process(ut,Q);it=null;let At=$.dataToBitMap(ct,Q);ct=null;let Et=j(At,Q,W.skipRescale);return Q.data=Et,Q.gamma=K||0,Q}}).call(this)}).call(this,d("buffer").Buffer)},{"./bitmapper":1,"./filter-parse-sync":8,"./format-normaliser":10,"./parser":18,"./sync-inflate":21,"./sync-reader":22,buffer:32,zlib:31}],18:[function(d,m,g){(function(w){(function(){let I=d("./constants"),P=d("./crc"),F=m.exports=function(D,U){this._options=D,D.checkCRC=D.checkCRC!==!1,this._hasIHDR=!1,this._hasIEND=!1,this._emittedHeadersFinished=!1,this._palette=[],this._colorType=0,this._chunks={},this._chunks[I.TYPE_IHDR]=this._handleIHDR.bind(this),this._chunks[I.TYPE_IEND]=this._handleIEND.bind(this),this._chunks[I.TYPE_IDAT]=this._handleIDAT.bind(this),this._chunks[I.TYPE_PLTE]=this._handlePLTE.bind(this),this._chunks[I.TYPE_tRNS]=this._handleTRNS.bind(this),this._chunks[I.TYPE_gAMA]=this._handleGAMA.bind(this),this.read=U.read,this.error=U.error,this.metadata=U.metadata,this.gamma=U.gamma,this.transColor=U.transColor,this.palette=U.palette,this.parsed=U.parsed,this.inflateData=U.inflateData,this.finished=U.finished,this.simpleTransparency=U.simpleTransparency,this.headersFinished=U.headersFinished||function(){}};F.prototype.start=function(){this.read(I.PNG_SIGNATURE.length,this._parseSignature.bind(this))},F.prototype._parseSignature=function(D){let U=I.PNG_SIGNATURE;for(let Z=0;Z<U.length;Z++)if(D[Z]!==U[Z])return void this.error(new Error("Invalid file signature"));this.read(8,this._parseChunkBegin.bind(this))},F.prototype._parseChunkBegin=function(D){let U=D.readUInt32BE(0),Z=D.readUInt32BE(4),$="";for(let H=4;H<8;H++)$+=String.fromCharCode(D[H]);let j=!!(32&D[4]);if(this._hasIHDR||Z===I.TYPE_IHDR){if(this._crc=new P,this._crc.write(w.from($)),this._chunks[Z])return this._chunks[Z](U);j?this.read(U+4,this._skipChunk.bind(this)):this.error(new Error("Unsupported critical chunk type "+$))}else this.error(new Error("Expected IHDR on beggining"))},F.prototype._skipChunk=function(){this.read(8,this._parseChunkBegin.bind(this))},F.prototype._handleChunkEnd=function(){this.read(4,this._parseChunkEnd.bind(this))},F.prototype._parseChunkEnd=function(D){let U=D.readInt32BE(0),Z=this._crc.crc32();this._options.checkCRC&&Z!==U?this.error(new Error("Crc error - "+U+" - "+Z)):this._hasIEND||this.read(8,this._parseChunkBegin.bind(this))},F.prototype._handleIHDR=function(D){this.read(D,this._parseIHDR.bind(this))},F.prototype._parseIHDR=function(D){this._crc.write(D);let U=D.readUInt32BE(0),Z=D.readUInt32BE(4),$=D[8],j=D[9],H=D[10],W=D[11],V=D[12];if($!==8&&$!==4&&$!==2&&$!==1&&$!==16)return void this.error(new Error("Unsupported bit depth "+$));if(!(j in I.COLORTYPE_TO_BPP_MAP))return void this.error(new Error("Unsupported color type"));if(H!==0)return void this.error(new Error("Unsupported compression method"));if(W!==0)return void this.error(new Error("Unsupported filter method"));if(V!==0&&V!==1)return void this.error(new Error("Unsupported interlace method"));this._colorType=j;let Q=I.COLORTYPE_TO_BPP_MAP[this._colorType];this._hasIHDR=!0,this.metadata({width:U,height:Z,depth:$,interlace:!!V,palette:!!(j&I.COLORTYPE_PALETTE),color:!!(j&I.COLORTYPE_COLOR),alpha:!!(j&I.COLORTYPE_ALPHA),bpp:Q,colorType:j}),this._handleChunkEnd()},F.prototype._handlePLTE=function(D){this.read(D,this._parsePLTE.bind(this))},F.prototype._parsePLTE=function(D){this._crc.write(D);let U=Math.floor(D.length/3);for(let Z=0;Z<U;Z++)this._palette.push([D[3*Z],D[3*Z+1],D[3*Z+2],255]);this.palette(this._palette),this._handleChunkEnd()},F.prototype._handleTRNS=function(D){this.simpleTransparency(),this.read(D,this._parseTRNS.bind(this))},F.prototype._parseTRNS=function(D){if(this._crc.write(D),this._colorType===I.COLORTYPE_PALETTE_COLOR){if(this._palette.length===0)return void this.error(new Error("Transparency chunk must be after palette"));if(D.length>this._palette.length)return void this.error(new Error("More transparent colors than palette size"));for(let U=0;U<D.length;U++)this._palette[U][3]=D[U];this.palette(this._palette)}this._colorType===I.COLORTYPE_GRAYSCALE&&this.transColor([D.readUInt16BE(0)]),this._colorType===I.COLORTYPE_COLOR&&this.transColor([D.readUInt16BE(0),D.readUInt16BE(2),D.readUInt16BE(4)]),this._handleChunkEnd()},F.prototype._handleGAMA=function(D){this.read(D,this._parseGAMA.bind(this))},F.prototype._parseGAMA=function(D){this._crc.write(D),this.gamma(D.readUInt32BE(0)/I.GAMMA_DIVISION),this._handleChunkEnd()},F.prototype._handleIDAT=function(D){this._emittedHeadersFinished||(this._emittedHeadersFinished=!0,this.headersFinished()),this.read(-D,this._parseIDAT.bind(this,D))},F.prototype._parseIDAT=function(D,U){if(this._crc.write(U),this._colorType===I.COLORTYPE_PALETTE_COLOR&&this._palette.length===0)throw new Error("Expected palette not found");this.inflateData(U);let Z=D-U.length;Z>0?this._handleIDAT(Z):this._handleChunkEnd()},F.prototype._handleIEND=function(D){this.read(D,this._parseIEND.bind(this))},F.prototype._parseIEND=function(D){this._crc.write(D),this._hasIEND=!0,this._handleChunkEnd(),this.finished&&this.finished()}}).call(this)}).call(this,d("buffer").Buffer)},{"./constants":4,"./crc":5,buffer:32}],19:[function(d,m,g){let w=d("./parser-sync"),I=d("./packer-sync");g.read=function(P,F){return w(P,F||{})},g.write=function(P,F){return I(P,F)}},{"./packer-sync":13,"./parser-sync":17}],20:[function(d,m,g){(function(w,I){(function(){let P=d("util"),F=d("stream"),D=d("./parser-async"),U=d("./packer-async"),Z=d("./png-sync"),$=g.PNG=function(j){F.call(this),j=j||{},this.width=0|j.width,this.height=0|j.height,this.data=this.width>0&&this.height>0?I.alloc(4*this.width*this.height):null,j.fill&&this.data&&this.data.fill(0),this.gamma=0,this.readable=this.writable=!0,this._parser=new D(j),this._parser.on("error",this.emit.bind(this,"error")),this._parser.on("close",this._handleClose.bind(this)),this._parser.on("metadata",this._metadata.bind(this)),this._parser.on("gamma",this._gamma.bind(this)),this._parser.on("parsed",function(H){this.data=H,this.emit("parsed",H)}.bind(this)),this._packer=new U(j),this._packer.on("data",this.emit.bind(this,"data")),this._packer.on("end",this.emit.bind(this,"end")),this._parser.on("close",this._handleClose.bind(this)),this._packer.on("error",this.emit.bind(this,"error"))};P.inherits($,F),$.sync=Z,$.prototype.pack=function(){return this.data&&this.data.length?(w.nextTick(function(){this._packer.pack(this.data,this.width,this.height,this.gamma)}.bind(this)),this):(this.emit("error","No data provided"),this)},$.prototype.parse=function(j,H){if(H){let W,V;W=function(Q){this.removeListener("error",V),this.data=Q,H(null,this)}.bind(this),V=function(Q){this.removeListener("parsed",W),H(Q,null)}.bind(this),this.once("parsed",W),this.once("error",V)}return this.end(j),this},$.prototype.write=function(j){return this._parser.write(j),!0},$.prototype.end=function(j){this._parser.end(j)},$.prototype._metadata=function(j){this.width=j.width,this.height=j.height,this.emit("metadata",j)},$.prototype._gamma=function(j){this.gamma=j},$.prototype._handleClose=function(){this._parser.writable||this._packer.readable||this.emit("close")},$.bitblt=function(j,H,W,V,Q,K,q,et){if(V|=0,Q|=0,K|=0,q|=0,et|=0,(W|=0)>j.width||V>j.height||W+Q>j.width||V+K>j.height)throw new Error("bitblt reading outside image");if(q>H.width||et>H.height||q+Q>H.width||et+K>H.height)throw new Error("bitblt writing outside image");for(let X=0;X<K;X++)j.data.copy(H.data,(et+X)*H.width+q<<2,(V+X)*j.width+W<<2,(V+X)*j.width+W+Q<<2)},$.prototype.bitblt=function(j,H,W,V,Q,K,q){return $.bitblt(this,j,H,W,V,Q,K,q),this},$.adjustGamma=function(j){if(j.gamma){for(let H=0;H<j.height;H++)for(let W=0;W<j.width;W++){let V=j.width*H+W<<2;for(let Q=0;Q<3;Q++){let K=j.data[V+Q]/255;K=Math.pow(K,1/2.2/j.gamma),j.data[V+Q]=Math.round(255*K)}}j.gamma=0}},$.prototype.adjustGamma=function(){$.adjustGamma(this)}}).call(this)}).call(this,d("_process"),d("buffer").Buffer)},{"./packer-async":12,"./parser-async":16,"./png-sync":19,_process:63,buffer:32,stream:65,util:84}],21:[function(d,m,g){(function(w,I){(function(){let P=d("assert").ok,F=d("zlib"),D=d("util"),U=d("buffer").kMaxLength;function Z(V){if(!(this instanceof Z))return new Z(V);V&&V.chunkSize<F.Z_MIN_CHUNK&&(V.chunkSize=F.Z_MIN_CHUNK),F.Inflate.call(this,V),this._offset=this._offset===void 0?this._outOffset:this._offset,this._buffer=this._buffer||this._outBuffer,V&&V.maxLength!=null&&(this._maxLength=V.maxLength)}function $(V){return new Z(V)}function j(V,Q){V._handle&&(V._handle.close(),V._handle=null)}function H(V,Q){if(typeof Q=="string"&&(Q=I.from(Q)),!(Q instanceof I))throw new TypeError("Not a string or buffer");let K=V._finishFlushFlag;return K==null&&(K=F.Z_FINISH),V._processChunk(Q,K)}function W(V,Q){return H(new Z(Q),V)}Z.prototype._processChunk=function(V,Q,K){if(typeof K=="function")return F.Inflate._processChunk.call(this,V,Q,K);let q,et,X=this,tt=V&&V.length,rt=this._chunkSize-this._offset,ot=this._maxLength,J=0,lt=[],st=0;function ut(ct,At){if(X._hadError)return;let Et=rt-At;if(P(Et>=0,"have should not go down"),Et>0){let gt=X._buffer.slice(X._offset,X._offset+Et);if(X._offset+=Et,gt.length>ot&&(gt=gt.slice(0,ot)),lt.push(gt),st+=gt.length,ot-=gt.length,ot===0)return!1}return(At===0||X._offset>=X._chunkSize)&&(rt=X._chunkSize,X._offset=0,X._buffer=I.allocUnsafe(X._chunkSize)),At===0&&(J+=tt-ct,tt=ct,!0)}this.on("error",function(ct){q=ct}),P(this._handle,"zlib binding closed");do et=this._handle.writeSync(Q,V,J,tt,this._buffer,this._offset,rt),et=et||this._writeState;while(!this._hadError&&ut(et[0],et[1]));if(this._hadError)throw q;if(st>=U)throw j(this),new RangeError("Cannot create final Buffer. It would be larger than 0x"+U.toString(16)+" bytes");let it=I.concat(lt,st);return j(this),it},D.inherits(Z,F.Inflate),m.exports=g=W,g.Inflate=Z,g.createInflate=$,g.inflateSync=W}).call(this)}).call(this,d("_process"),d("buffer").Buffer)},{_process:63,assert:23,buffer:32,util:84,zlib:31}],22:[function(d,m,g){let w=m.exports=function(I){this._buffer=I,this._reads=[]};w.prototype.read=function(I,P){this._reads.push({length:Math.abs(I),allowLess:I<0,func:P})},w.prototype.process=function(){for(;this._reads.length>0&&this._buffer.length;){let I=this._reads[0];if(!this._buffer.length||!(this._buffer.length>=I.length||I.allowLess))break;{this._reads.shift();let P=this._buffer;this._buffer=P.slice(I.length),I.func.call(this,P.slice(0,I.length))}}if(this._reads.length>0)throw new Error("There are some read requests waitng on finished stream");if(this._buffer.length>0)throw new Error("unrecognised content at end of stream")}},{}],23:[function(d,m,g){(function(w){(function(){var I=d("object-assign");/*!
	 * The buffer module from node.js, for the browser.
	 *
	 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
	 * @license  MIT
	 */function P(Et,gt){if(Et===gt)return 0;for(var pt=Et.length,vt=gt.length,Tt=0,It=Math.min(pt,vt);Tt<It;++Tt)if(Et[Tt]!==gt[Tt]){pt=Et[Tt],vt=gt[Tt];break}return pt<vt?-1:vt<pt?1:0}function F(Et){return w.Buffer&&typeof w.Buffer.isBuffer=="function"?w.Buffer.isBuffer(Et):!(Et==null||!Et._isBuffer)}var D=d("util/"),U=Object.prototype.hasOwnProperty,Z=Array.prototype.slice,$=function(){}.name==="foo";function j(Et){return Object.prototype.toString.call(Et)}function H(Et){return!F(Et)&&typeof w.ArrayBuffer=="function"&&(typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(Et):!!Et&&(Et instanceof DataView||!!(Et.buffer&&Et.buffer instanceof ArrayBuffer)))}var W=m.exports=tt,V=/\s*function\s+([^\(\s]*)\s*/;function Q(Et){if(D.isFunction(Et)){if($)return Et.name;var gt=Et.toString().match(V);return gt&&gt[1]}}function K(Et,gt){return typeof Et=="string"?Et.length<gt?Et:Et.slice(0,gt):Et}function q(Et){if($||!D.isFunction(Et))return D.inspect(Et);var gt=Q(Et);return"[Function"+(gt?": "+gt:"")+"]"}function et(Et){return K(q(Et.actual),128)+" "+Et.operator+" "+K(q(Et.expected),128)}function X(Et,gt,pt,vt,Tt){throw new W.AssertionError({message:pt,actual:Et,expected:gt,operator:vt,stackStartFunction:Tt})}function tt(Et,gt){Et||X(Et,!0,gt,"==",W.ok)}function rt(Et,gt,pt,vt){if(Et===gt)return!0;if(F(Et)&&F(gt))return P(Et,gt)===0;if(D.isDate(Et)&&D.isDate(gt))return Et.getTime()===gt.getTime();if(D.isRegExp(Et)&&D.isRegExp(gt))return Et.source===gt.source&&Et.global===gt.global&&Et.multiline===gt.multiline&&Et.lastIndex===gt.lastIndex&&Et.ignoreCase===gt.ignoreCase;if(Et!==null&&typeof Et=="object"||gt!==null&&typeof gt=="object"){if(H(Et)&&H(gt)&&j(Et)===j(gt)&&!(Et instanceof Float32Array||Et instanceof Float64Array))return P(new Uint8Array(Et.buffer),new Uint8Array(gt.buffer))===0;if(F(Et)!==F(gt))return!1;var Tt=(vt=vt||{actual:[],expected:[]}).actual.indexOf(Et);return Tt!==-1&&Tt===vt.expected.indexOf(gt)||(vt.actual.push(Et),vt.expected.push(gt),J(Et,gt,pt,vt))}return pt?Et===gt:Et==gt}function ot(Et){return Object.prototype.toString.call(Et)=="[object Arguments]"}function J(Et,gt,pt,vt){if(Et==null||gt==null)return!1;if(D.isPrimitive(Et)||D.isPrimitive(gt))return Et===gt;if(pt&&Object.getPrototypeOf(Et)!==Object.getPrototypeOf(gt))return!1;var Tt=ot(Et),It=ot(gt);if(Tt&&!It||!Tt&&It)return!1;if(Tt)return rt(Et=Z.call(Et),gt=Z.call(gt),pt);var $t,Bt,zt=At(Et),Ot=At(gt);if(zt.length!==Ot.length)return!1;for(zt.sort(),Ot.sort(),Bt=zt.length-1;Bt>=0;Bt--)if(zt[Bt]!==Ot[Bt])return!1;for(Bt=zt.length-1;Bt>=0;Bt--)if(!rt(Et[$t=zt[Bt]],gt[$t],pt,vt))return!1;return!0}function lt(Et,gt,pt){rt(Et,gt,!0)&&X(Et,gt,pt,"notDeepStrictEqual",lt)}function st(Et,gt){if(!Et||!gt)return!1;if(Object.prototype.toString.call(gt)=="[object RegExp]")return gt.test(Et);try{if(Et instanceof gt)return!0}catch{}return!Error.isPrototypeOf(gt)&&gt.call({},Et)===!0}function ut(Et){var gt;try{Et()}catch(pt){gt=pt}return gt}function it(Et,gt,pt,vt){var Tt;if(typeof gt!="function")throw new TypeError('"block" argument must be a function');typeof pt=="string"&&(vt=pt,pt=null),Tt=ut(gt),vt=(pt&&pt.name?" ("+pt.name+").":".")+(vt?" "+vt:"."),Et&&!Tt&&X(Tt,pt,"Missing expected exception"+vt);var It=typeof vt=="string",$t=!Et&&Tt&&!pt;if((!Et&&D.isError(Tt)&&It&&st(Tt,pt)||$t)&&X(Tt,pt,"Got unwanted exception"+vt),Et&&Tt&&pt&&!st(Tt,pt)||!Et&&Tt)throw Tt}function ct(Et,gt){Et||X(Et,!0,gt,"==",ct)}W.AssertionError=function(Et){this.name="AssertionError",this.actual=Et.actual,this.expected=Et.expected,this.operator=Et.operator,Et.message?(this.message=Et.message,this.generatedMessage=!1):(this.message=et(this),this.generatedMessage=!0);var gt=Et.stackStartFunction||X;if(Error.captureStackTrace)Error.captureStackTrace(this,gt);else{var pt=new Error;if(pt.stack){var vt=pt.stack,Tt=Q(gt),It=vt.indexOf(`
`+Tt);if(It>=0){var $t=vt.indexOf(`
`,It+1);vt=vt.substring($t+1)}this.stack=vt}}},D.inherits(W.AssertionError,Error),W.fail=X,W.ok=tt,W.equal=function(Et,gt,pt){Et!=gt&&X(Et,gt,pt,"==",W.equal)},W.notEqual=function(Et,gt,pt){Et==gt&&X(Et,gt,pt,"!=",W.notEqual)},W.deepEqual=function(Et,gt,pt){rt(Et,gt,!1)||X(Et,gt,pt,"deepEqual",W.deepEqual)},W.deepStrictEqual=function(Et,gt,pt){rt(Et,gt,!0)||X(Et,gt,pt,"deepStrictEqual",W.deepStrictEqual)},W.notDeepEqual=function(Et,gt,pt){rt(Et,gt,!1)&&X(Et,gt,pt,"notDeepEqual",W.notDeepEqual)},W.notDeepStrictEqual=lt,W.strictEqual=function(Et,gt,pt){Et!==gt&&X(Et,gt,pt,"===",W.strictEqual)},W.notStrictEqual=function(Et,gt,pt){Et===gt&&X(Et,gt,pt,"!==",W.notStrictEqual)},W.throws=function(Et,gt,pt){it(!0,Et,gt,pt)},W.doesNotThrow=function(Et,gt,pt){it(!1,Et,gt,pt)},W.ifError=function(Et){if(Et)throw Et},W.strict=I(ct,W,{equal:W.strictEqual,deepEqual:W.deepStrictEqual,notEqual:W.notStrictEqual,notDeepEqual:W.notDeepStrictEqual}),W.strict.strict=W.strict;var At=Object.keys||function(Et){var gt=[];for(var pt in Et)U.call(Et,pt)&&gt.push(pt);return gt}}).call(this)}).call(this,commonjsGlobal!==void 0?commonjsGlobal:typeof self<"u"?self:typeof window<"u"?window:{})},{"object-assign":51,"util/":26}],24:[function(d,m,g){typeof Object.create=="function"?m.exports=function(w,I){w.super_=I,w.prototype=Object.create(I.prototype,{constructor:{value:w,enumerable:!1,writable:!0,configurable:!0}})}:m.exports=function(w,I){w.super_=I;var P=function(){};P.prototype=I.prototype,w.prototype=new P,w.prototype.constructor=w}},{}],25:[function(d,m,g){m.exports=function(w){return w&&typeof w=="object"&&typeof w.copy=="function"&&typeof w.fill=="function"&&typeof w.readUInt8=="function"}},{}],26:[function(d,m,g){(function(w,I){(function(){var P=/%[sdj%]/g;g.format=function(Bt){if(!J(Bt)){for(var zt=[],Ot=0;Ot<arguments.length;Ot++)zt.push(U(arguments[Ot]));return zt.join(" ")}Ot=1;for(var Nt=arguments,Pt=Nt.length,Ut=String(Bt).replace(P,function(Zt){if(Zt==="%%")return"%";if(Ot>=Pt)return Zt;switch(Zt){case"%s":return String(Nt[Ot++]);case"%d":return Number(Nt[Ot++]);case"%j":try{return JSON.stringify(Nt[Ot++])}catch{return"[Circular]"}default:return Zt}}),Ft=Nt[Ot];Ot<Pt;Ft=Nt[++Ot])tt(Ft)||!it(Ft)?Ut+=" "+Ft:Ut+=" "+U(Ft);return Ut},g.deprecate=function(Bt,zt){if(st(I.process))return function(){return g.deprecate(Bt,zt).apply(this,arguments)};if(w.noDeprecation===!0)return Bt;var Ot=!1;function Nt(){if(!Ot){if(w.throwDeprecation)throw new Error(zt);w.traceDeprecation?console.trace(zt):console.error(zt),Ot=!0}return Bt.apply(this,arguments)}return Nt};var F,D={};function U(Bt,zt){var Ot={seen:[],stylize:$};return arguments.length>=3&&(Ot.depth=arguments[2]),arguments.length>=4&&(Ot.colors=arguments[3]),X(zt)?Ot.showHidden=zt:zt&&g._extend(Ot,zt),st(Ot.showHidden)&&(Ot.showHidden=!1),st(Ot.depth)&&(Ot.depth=2),st(Ot.colors)&&(Ot.colors=!1),st(Ot.customInspect)&&(Ot.customInspect=!0),Ot.colors&&(Ot.stylize=Z),H(Ot,Bt,Ot.depth)}function Z(Bt,zt){var Ot=U.styles[zt];return Ot?"\x1B["+U.colors[Ot][0]+"m"+Bt+"\x1B["+U.colors[Ot][1]+"m":Bt}function $(Bt,zt){return Bt}function j(Bt){var zt={};return Bt.forEach(function(Ot,Nt){zt[Ot]=!0}),zt}function H(Bt,zt,Ot){if(Bt.customInspect&&zt&&Et(zt.inspect)&&zt.inspect!==g.inspect&&(!zt.constructor||zt.constructor.prototype!==zt)){var Nt=zt.inspect(Ot,Bt);return J(Nt)||(Nt=H(Bt,Nt,Ot)),Nt}var Pt=W(Bt,zt);if(Pt)return Pt;var Ut=Object.keys(zt),Ft=j(Ut);if(Bt.showHidden&&(Ut=Object.getOwnPropertyNames(zt)),At(zt)&&(Ut.indexOf("message")>=0||Ut.indexOf("description")>=0))return V(zt);if(Ut.length===0){if(Et(zt)){var Zt=zt.name?": "+zt.name:"";return Bt.stylize("[Function"+Zt+"]","special")}if(ut(zt))return Bt.stylize(RegExp.prototype.toString.call(zt),"regexp");if(ct(zt))return Bt.stylize(Date.prototype.toString.call(zt),"date");if(At(zt))return V(zt)}var Ht,Dt="",dt=!1,Lt=["{","}"];return et(zt)&&(dt=!0,Lt=["[","]"]),Et(zt)&&(Dt=" [Function"+(zt.name?": "+zt.name:"")+"]"),ut(zt)&&(Dt=" "+RegExp.prototype.toString.call(zt)),ct(zt)&&(Dt=" "+Date.prototype.toUTCString.call(zt)),At(zt)&&(Dt=" "+V(zt)),Ut.length!==0||dt&&zt.length!=0?Ot<0?ut(zt)?Bt.stylize(RegExp.prototype.toString.call(zt),"regexp"):Bt.stylize("[Object]","special"):(Bt.seen.push(zt),Ht=dt?Q(Bt,zt,Ot,Ft,Ut):Ut.map(function(bt){return K(Bt,zt,Ot,Ft,bt,dt)}),Bt.seen.pop(),q(Ht,Dt,Lt)):Lt[0]+Dt+Lt[1]}function W(Bt,zt){if(st(zt))return Bt.stylize("undefined","undefined");if(J(zt)){var Ot="'"+JSON.stringify(zt).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return Bt.stylize(Ot,"string")}return ot(zt)?Bt.stylize(""+zt,"number"):X(zt)?Bt.stylize(""+zt,"boolean"):tt(zt)?Bt.stylize("null","null"):void 0}function V(Bt){return"["+Error.prototype.toString.call(Bt)+"]"}function Q(Bt,zt,Ot,Nt,Pt){for(var Ut=[],Ft=0,Zt=zt.length;Ft<Zt;++Ft)$t(zt,String(Ft))?Ut.push(K(Bt,zt,Ot,Nt,String(Ft),!0)):Ut.push("");return Pt.forEach(function(Ht){Ht.match(/^\d+$/)||Ut.push(K(Bt,zt,Ot,Nt,Ht,!0))}),Ut}function K(Bt,zt,Ot,Nt,Pt,Ut){var Ft,Zt,Ht;if((Ht=Object.getOwnPropertyDescriptor(zt,Pt)||{value:zt[Pt]}).get?Zt=Ht.set?Bt.stylize("[Getter/Setter]","special"):Bt.stylize("[Getter]","special"):Ht.set&&(Zt=Bt.stylize("[Setter]","special")),$t(Nt,Pt)||(Ft="["+Pt+"]"),Zt||(Bt.seen.indexOf(Ht.value)<0?(Zt=tt(Ot)?H(Bt,Ht.value,null):H(Bt,Ht.value,Ot-1)).indexOf(`
`)>-1&&(Zt=Ut?Zt.split(`
`).map(function(Dt){return"  "+Dt}).join(`
`).substr(2):`
`+Zt.split(`
`).map(function(Dt){return"   "+Dt}).join(`
`)):Zt=Bt.stylize("[Circular]","special")),st(Ft)){if(Ut&&Pt.match(/^\d+$/))return Zt;(Ft=JSON.stringify(""+Pt)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(Ft=Ft.substr(1,Ft.length-2),Ft=Bt.stylize(Ft,"name")):(Ft=Ft.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),Ft=Bt.stylize(Ft,"string"))}return Ft+": "+Zt}function q(Bt,zt,Ot){return Bt.reduce(function(Nt,Pt){return Pt.indexOf(`
`),Nt+Pt.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?Ot[0]+(zt===""?"":zt+`
 `)+" "+Bt.join(`,
  `)+" "+Ot[1]:Ot[0]+zt+" "+Bt.join(", ")+" "+Ot[1]}function et(Bt){return Array.isArray(Bt)}function X(Bt){return typeof Bt=="boolean"}function tt(Bt){return Bt===null}function rt(Bt){return Bt==null}function ot(Bt){return typeof Bt=="number"}function J(Bt){return typeof Bt=="string"}function lt(Bt){return typeof Bt=="symbol"}function st(Bt){return Bt===void 0}function ut(Bt){return it(Bt)&&pt(Bt)==="[object RegExp]"}function it(Bt){return typeof Bt=="object"&&Bt!==null}function ct(Bt){return it(Bt)&&pt(Bt)==="[object Date]"}function At(Bt){return it(Bt)&&(pt(Bt)==="[object Error]"||Bt instanceof Error)}function Et(Bt){return typeof Bt=="function"}function gt(Bt){return Bt===null||typeof Bt=="boolean"||typeof Bt=="number"||typeof Bt=="string"||typeof Bt=="symbol"||Bt===void 0}function pt(Bt){return Object.prototype.toString.call(Bt)}function vt(Bt){return Bt<10?"0"+Bt.toString(10):Bt.toString(10)}g.debuglog=function(Bt){if(st(F)&&(F=w.env.NODE_DEBUG||""),Bt=Bt.toUpperCase(),!D[Bt])if(new RegExp("\\b"+Bt+"\\b","i").test(F)){var zt=w.pid;D[Bt]=function(){var Ot=g.format.apply(g,arguments);console.error("%s %d: %s",Bt,zt,Ot)}}else D[Bt]=function(){};return D[Bt]},g.inspect=U,U.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},U.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},g.isArray=et,g.isBoolean=X,g.isNull=tt,g.isNullOrUndefined=rt,g.isNumber=ot,g.isString=J,g.isSymbol=lt,g.isUndefined=st,g.isRegExp=ut,g.isObject=it,g.isDate=ct,g.isError=At,g.isFunction=Et,g.isPrimitive=gt,g.isBuffer=d("./support/isBuffer");var Tt=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function It(){var Bt=new Date,zt=[vt(Bt.getHours()),vt(Bt.getMinutes()),vt(Bt.getSeconds())].join(":");return[Bt.getDate(),Tt[Bt.getMonth()],zt].join(" ")}function $t(Bt,zt){return Object.prototype.hasOwnProperty.call(Bt,zt)}g.log=function(){console.log("%s - %s",It(),g.format.apply(g,arguments))},g.inherits=d("inherits"),g._extend=function(Bt,zt){if(!zt||!it(zt))return Bt;for(var Ot=Object.keys(zt),Nt=Ot.length;Nt--;)Bt[Ot[Nt]]=zt[Ot[Nt]];return Bt}}).call(this)}).call(this,d("_process"),commonjsGlobal!==void 0?commonjsGlobal:typeof self<"u"?self:typeof window<"u"?window:{})},{"./support/isBuffer":25,_process:63,inherits:24}],27:[function(d,m,g){(function(w){(function(){var I=["BigInt64Array","BigUint64Array","Float32Array","Float64Array","Int16Array","Int32Array","Int8Array","Uint16Array","Uint32Array","Uint8Array","Uint8ClampedArray"],P=typeof globalThis>"u"?w:globalThis;m.exports=function(){for(var F=[],D=0;D<I.length;D++)typeof P[I[D]]=="function"&&(F[F.length]=I[D]);return F}}).call(this)}).call(this,commonjsGlobal!==void 0?commonjsGlobal:typeof self<"u"?self:typeof window<"u"?window:{})},{}],28:[function(d,m,g){g.byteLength=$,g.toByteArray=H,g.fromByteArray=Q;for(var w=[],I=[],P=typeof Uint8Array<"u"?Uint8Array:Array,F="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",D=0,U=F.length;D<U;++D)w[D]=F[D],I[F.charCodeAt(D)]=D;function Z(K){var q=K.length;if(q%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var et=K.indexOf("=");return et===-1&&(et=q),[et,et===q?0:4-et%4]}function $(K){var q=Z(K),et=q[0],X=q[1];return 3*(et+X)/4-X}function j(K,q,et){return 3*(q+et)/4-et}function H(K){var q,et,X=Z(K),tt=X[0],rt=X[1],ot=new P(j(K,tt,rt)),J=0,lt=rt>0?tt-4:tt;for(et=0;et<lt;et+=4)q=I[K.charCodeAt(et)]<<18|I[K.charCodeAt(et+1)]<<12|I[K.charCodeAt(et+2)]<<6|I[K.charCodeAt(et+3)],ot[J++]=q>>16&255,ot[J++]=q>>8&255,ot[J++]=255&q;return rt===2&&(q=I[K.charCodeAt(et)]<<2|I[K.charCodeAt(et+1)]>>4,ot[J++]=255&q),rt===1&&(q=I[K.charCodeAt(et)]<<10|I[K.charCodeAt(et+1)]<<4|I[K.charCodeAt(et+2)]>>2,ot[J++]=q>>8&255,ot[J++]=255&q),ot}function W(K){return w[K>>18&63]+w[K>>12&63]+w[K>>6&63]+w[63&K]}function V(K,q,et){for(var X,tt=[],rt=q;rt<et;rt+=3)X=(K[rt]<<16&16711680)+(K[rt+1]<<8&65280)+(255&K[rt+2]),tt.push(W(X));return tt.join("")}function Q(K){for(var q,et=K.length,X=et%3,tt=[],rt=16383,ot=0,J=et-X;ot<J;ot+=rt)tt.push(V(K,ot,ot+rt>J?J:ot+rt));return X===1?(q=K[et-1],tt.push(w[q>>2]+w[q<<4&63]+"==")):X===2&&(q=(K[et-2]<<8)+K[et-1],tt.push(w[q>>10]+w[q>>4&63]+w[q<<2&63]+"=")),tt.join("")}I[45]=62,I[95]=63},{}],29:[function(d,m,g){},{}],30:[function(d,m,g){(function(w,I){(function(){var P=d("assert"),F=d("pako/lib/zlib/zstream"),D=d("pako/lib/zlib/deflate.js"),U=d("pako/lib/zlib/inflate.js"),Z=d("pako/lib/zlib/constants");for(var $ in Z)g[$]=Z[$];g.NONE=0,g.DEFLATE=1,g.INFLATE=2,g.GZIP=3,g.GUNZIP=4,g.DEFLATERAW=5,g.INFLATERAW=6,g.UNZIP=7;var j=31,H=139;function W(V){if(typeof V!="number"||V<g.DEFLATE||V>g.UNZIP)throw new TypeError("Bad argument");this.dictionary=null,this.err=0,this.flush=0,this.init_done=!1,this.level=0,this.memLevel=0,this.mode=V,this.strategy=0,this.windowBits=0,this.write_in_progress=!1,this.pending_close=!1,this.gzip_id_bytes_read=0}W.prototype.close=function(){this.write_in_progress?this.pending_close=!0:(this.pending_close=!1,P(this.init_done,"close before init"),P(this.mode<=g.UNZIP),this.mode===g.DEFLATE||this.mode===g.GZIP||this.mode===g.DEFLATERAW?D.deflateEnd(this.strm):this.mode!==g.INFLATE&&this.mode!==g.GUNZIP&&this.mode!==g.INFLATERAW&&this.mode!==g.UNZIP||U.inflateEnd(this.strm),this.mode=g.NONE,this.dictionary=null)},W.prototype.write=function(V,Q,K,q,et,X,tt){return this._write(!0,V,Q,K,q,et,X,tt)},W.prototype.writeSync=function(V,Q,K,q,et,X,tt){return this._write(!1,V,Q,K,q,et,X,tt)},W.prototype._write=function(V,Q,K,q,et,X,tt,rt){if(P.equal(arguments.length,8),P(this.init_done,"write before init"),P(this.mode!==g.NONE,"already finalized"),P.equal(!1,this.write_in_progress,"write already in progress"),P.equal(!1,this.pending_close,"close is pending"),this.write_in_progress=!0,P.equal(!1,Q===void 0,"must provide flush value"),this.write_in_progress=!0,Q!==g.Z_NO_FLUSH&&Q!==g.Z_PARTIAL_FLUSH&&Q!==g.Z_SYNC_FLUSH&&Q!==g.Z_FULL_FLUSH&&Q!==g.Z_FINISH&&Q!==g.Z_BLOCK)throw new Error("Invalid flush value");if(K==null&&(K=I.alloc(0),et=0,q=0),this.strm.avail_in=et,this.strm.input=K,this.strm.next_in=q,this.strm.avail_out=rt,this.strm.output=X,this.strm.next_out=tt,this.flush=Q,!V)return this._process(),this._checkError()?this._afterSync():void 0;var ot=this;return w.nextTick(function(){ot._process(),ot._after()}),this},W.prototype._afterSync=function(){var V=this.strm.avail_out,Q=this.strm.avail_in;return this.write_in_progress=!1,[Q,V]},W.prototype._process=function(){var V=null;switch(this.mode){case g.DEFLATE:case g.GZIP:case g.DEFLATERAW:this.err=D.deflate(this.strm,this.flush);break;case g.UNZIP:switch(this.strm.avail_in>0&&(V=this.strm.next_in),this.gzip_id_bytes_read){case 0:if(V===null)break;if(this.strm.input[V]!==j){this.mode=g.INFLATE;break}if(this.gzip_id_bytes_read=1,V++,this.strm.avail_in===1)break;case 1:if(V===null)break;this.strm.input[V]===H?(this.gzip_id_bytes_read=2,this.mode=g.GUNZIP):this.mode=g.INFLATE;break;default:throw new Error("invalid number of gzip magic number bytes read")}case g.INFLATE:case g.GUNZIP:case g.INFLATERAW:for(this.err=U.inflate(this.strm,this.flush),this.err===g.Z_NEED_DICT&&this.dictionary&&(this.err=U.inflateSetDictionary(this.strm,this.dictionary),this.err===g.Z_OK?this.err=U.inflate(this.strm,this.flush):this.err===g.Z_DATA_ERROR&&(this.err=g.Z_NEED_DICT));this.strm.avail_in>0&&this.mode===g.GUNZIP&&this.err===g.Z_STREAM_END&&this.strm.next_in[0]!==0;)this.reset(),this.err=U.inflate(this.strm,this.flush);break;default:throw new Error("Unknown mode "+this.mode)}},W.prototype._checkError=function(){switch(this.err){case g.Z_OK:case g.Z_BUF_ERROR:if(this.strm.avail_out!==0&&this.flush===g.Z_FINISH)return this._error("unexpected end of file"),!1;break;case g.Z_STREAM_END:break;case g.Z_NEED_DICT:return this.dictionary==null?this._error("Missing dictionary"):this._error("Bad dictionary"),!1;default:return this._error("Zlib error"),!1}return!0},W.prototype._after=function(){if(this._checkError()){var V=this.strm.avail_out,Q=this.strm.avail_in;this.write_in_progress=!1,this.callback(Q,V),this.pending_close&&this.close()}},W.prototype._error=function(V){this.strm.msg&&(V=this.strm.msg),this.onerror(V,this.err),this.write_in_progress=!1,this.pending_close&&this.close()},W.prototype.init=function(V,Q,K,q,et){P(arguments.length===4||arguments.length===5,"init(windowBits, level, memLevel, strategy, [dictionary])"),P(V>=8&&V<=15,"invalid windowBits"),P(Q>=-1&&Q<=9,"invalid compression level"),P(K>=1&&K<=9,"invalid memlevel"),P(q===g.Z_FILTERED||q===g.Z_HUFFMAN_ONLY||q===g.Z_RLE||q===g.Z_FIXED||q===g.Z_DEFAULT_STRATEGY,"invalid strategy"),this._init(Q,V,K,q,et),this._setDictionary()},W.prototype.params=function(){throw new Error("deflateParams Not supported")},W.prototype.reset=function(){this._reset(),this._setDictionary()},W.prototype._init=function(V,Q,K,q,et){switch(this.level=V,this.windowBits=Q,this.memLevel=K,this.strategy=q,this.flush=g.Z_NO_FLUSH,this.err=g.Z_OK,this.mode!==g.GZIP&&this.mode!==g.GUNZIP||(this.windowBits+=16),this.mode===g.UNZIP&&(this.windowBits+=32),this.mode!==g.DEFLATERAW&&this.mode!==g.INFLATERAW||(this.windowBits=-1*this.windowBits),this.strm=new F,this.mode){case g.DEFLATE:case g.GZIP:case g.DEFLATERAW:this.err=D.deflateInit2(this.strm,this.level,g.Z_DEFLATED,this.windowBits,this.memLevel,this.strategy);break;case g.INFLATE:case g.GUNZIP:case g.INFLATERAW:case g.UNZIP:this.err=U.inflateInit2(this.strm,this.windowBits);break;default:throw new Error("Unknown mode "+this.mode)}this.err!==g.Z_OK&&this._error("Init error"),this.dictionary=et,this.write_in_progress=!1,this.init_done=!0},W.prototype._setDictionary=function(){if(this.dictionary!=null){switch(this.err=g.Z_OK,this.mode){case g.DEFLATE:case g.DEFLATERAW:this.err=D.deflateSetDictionary(this.strm,this.dictionary)}this.err!==g.Z_OK&&this._error("Failed to set dictionary")}},W.prototype._reset=function(){switch(this.err=g.Z_OK,this.mode){case g.DEFLATE:case g.DEFLATERAW:case g.GZIP:this.err=D.deflateReset(this.strm);break;case g.INFLATE:case g.INFLATERAW:case g.GUNZIP:this.err=U.inflateReset(this.strm)}this.err!==g.Z_OK&&this._error("Failed to reset stream")},g.Zlib=W}).call(this)}).call(this,d("_process"),d("buffer").Buffer)},{_process:63,assert:23,buffer:32,"pako/lib/zlib/constants":54,"pako/lib/zlib/deflate.js":56,"pako/lib/zlib/inflate.js":58,"pako/lib/zlib/zstream":62}],31:[function(d,m,g){(function(w){(function(){var I=d("buffer").Buffer,P=d("stream").Transform,F=d("./binding"),D=d("util"),U=d("assert").ok,Z=d("buffer").kMaxLength,$="Cannot create final Buffer. It would be larger than 0x"+Z.toString(16)+" bytes";F.Z_MIN_WINDOWBITS=8,F.Z_MAX_WINDOWBITS=15,F.Z_DEFAULT_WINDOWBITS=15,F.Z_MIN_CHUNK=64,F.Z_MAX_CHUNK=1/0,F.Z_DEFAULT_CHUNK=16384,F.Z_MIN_MEMLEVEL=1,F.Z_MAX_MEMLEVEL=9,F.Z_DEFAULT_MEMLEVEL=8,F.Z_MIN_LEVEL=-1,F.Z_MAX_LEVEL=9,F.Z_DEFAULT_LEVEL=F.Z_DEFAULT_COMPRESSION;for(var j=Object.keys(F),H=0;H<j.length;H++){var W=j[H];W.match(/^Z/)&&Object.defineProperty(g,W,{enumerable:!0,value:F[W],writable:!1})}for(var V={Z_OK:F.Z_OK,Z_STREAM_END:F.Z_STREAM_END,Z_NEED_DICT:F.Z_NEED_DICT,Z_ERRNO:F.Z_ERRNO,Z_STREAM_ERROR:F.Z_STREAM_ERROR,Z_DATA_ERROR:F.Z_DATA_ERROR,Z_MEM_ERROR:F.Z_MEM_ERROR,Z_BUF_ERROR:F.Z_BUF_ERROR,Z_VERSION_ERROR:F.Z_VERSION_ERROR},Q=Object.keys(V),K=0;K<Q.length;K++){var q=Q[K];V[V[q]]=q}function et(gt,pt,vt){var Tt=[],It=0;function $t(){for(var Ot;(Ot=gt.read())!==null;)Tt.push(Ot),It+=Ot.length;gt.once("readable",$t)}function Bt(Ot){gt.removeListener("end",zt),gt.removeListener("readable",$t),vt(Ot)}function zt(){var Ot,Nt=null;It>=Z?Nt=new RangeError($):Ot=I.concat(Tt,It),Tt=[],gt.close(),vt(Nt,Ot)}gt.on("error",Bt),gt.on("end",zt),gt.end(pt),$t()}function X(gt,pt){if(typeof pt=="string"&&(pt=I.from(pt)),!I.isBuffer(pt))throw new TypeError("Not a string or buffer");var vt=gt._finishFlushFlag;return gt._processChunk(pt,vt)}function tt(gt){if(!(this instanceof tt))return new tt(gt);ct.call(this,gt,F.DEFLATE)}function rt(gt){if(!(this instanceof rt))return new rt(gt);ct.call(this,gt,F.INFLATE)}function ot(gt){if(!(this instanceof ot))return new ot(gt);ct.call(this,gt,F.GZIP)}function J(gt){if(!(this instanceof J))return new J(gt);ct.call(this,gt,F.GUNZIP)}function lt(gt){if(!(this instanceof lt))return new lt(gt);ct.call(this,gt,F.DEFLATERAW)}function st(gt){if(!(this instanceof st))return new st(gt);ct.call(this,gt,F.INFLATERAW)}function ut(gt){if(!(this instanceof ut))return new ut(gt);ct.call(this,gt,F.UNZIP)}function it(gt){return gt===F.Z_NO_FLUSH||gt===F.Z_PARTIAL_FLUSH||gt===F.Z_SYNC_FLUSH||gt===F.Z_FULL_FLUSH||gt===F.Z_FINISH||gt===F.Z_BLOCK}function ct(gt,pt){var vt=this;if(this._opts=gt=gt||{},this._chunkSize=gt.chunkSize||g.Z_DEFAULT_CHUNK,P.call(this,gt),gt.flush&&!it(gt.flush))throw new Error("Invalid flush flag: "+gt.flush);if(gt.finishFlush&&!it(gt.finishFlush))throw new Error("Invalid flush flag: "+gt.finishFlush);if(this._flushFlag=gt.flush||F.Z_NO_FLUSH,this._finishFlushFlag=gt.finishFlush!==void 0?gt.finishFlush:F.Z_FINISH,gt.chunkSize&&(gt.chunkSize<g.Z_MIN_CHUNK||gt.chunkSize>g.Z_MAX_CHUNK))throw new Error("Invalid chunk size: "+gt.chunkSize);if(gt.windowBits&&(gt.windowBits<g.Z_MIN_WINDOWBITS||gt.windowBits>g.Z_MAX_WINDOWBITS))throw new Error("Invalid windowBits: "+gt.windowBits);if(gt.level&&(gt.level<g.Z_MIN_LEVEL||gt.level>g.Z_MAX_LEVEL))throw new Error("Invalid compression level: "+gt.level);if(gt.memLevel&&(gt.memLevel<g.Z_MIN_MEMLEVEL||gt.memLevel>g.Z_MAX_MEMLEVEL))throw new Error("Invalid memLevel: "+gt.memLevel);if(gt.strategy&&gt.strategy!=g.Z_FILTERED&&gt.strategy!=g.Z_HUFFMAN_ONLY&&gt.strategy!=g.Z_RLE&&gt.strategy!=g.Z_FIXED&&gt.strategy!=g.Z_DEFAULT_STRATEGY)throw new Error("Invalid strategy: "+gt.strategy);if(gt.dictionary&&!I.isBuffer(gt.dictionary))throw new Error("Invalid dictionary: it should be a Buffer instance");this._handle=new F.Zlib(pt);var Tt=this;this._hadError=!1,this._handle.onerror=function(Bt,zt){At(Tt),Tt._hadError=!0;var Ot=new Error(Bt);Ot.errno=zt,Ot.code=g.codes[zt],Tt.emit("error",Ot)};var It=g.Z_DEFAULT_COMPRESSION;typeof gt.level=="number"&&(It=gt.level);var $t=g.Z_DEFAULT_STRATEGY;typeof gt.strategy=="number"&&($t=gt.strategy),this._handle.init(gt.windowBits||g.Z_DEFAULT_WINDOWBITS,It,gt.memLevel||g.Z_DEFAULT_MEMLEVEL,$t,gt.dictionary),this._buffer=I.allocUnsafe(this._chunkSize),this._offset=0,this._level=It,this._strategy=$t,this.once("end",this.close),Object.defineProperty(this,"_closed",{get:function(){return!vt._handle},configurable:!0,enumerable:!0})}function At(gt,pt){pt&&w.nextTick(pt),gt._handle&&(gt._handle.close(),gt._handle=null)}function Et(gt){gt.emit("close")}Object.defineProperty(g,"codes",{enumerable:!0,value:Object.freeze(V),writable:!1}),g.Deflate=tt,g.Inflate=rt,g.Gzip=ot,g.Gunzip=J,g.DeflateRaw=lt,g.InflateRaw=st,g.Unzip=ut,g.createDeflate=function(gt){return new tt(gt)},g.createInflate=function(gt){return new rt(gt)},g.createDeflateRaw=function(gt){return new lt(gt)},g.createInflateRaw=function(gt){return new st(gt)},g.createGzip=function(gt){return new ot(gt)},g.createGunzip=function(gt){return new J(gt)},g.createUnzip=function(gt){return new ut(gt)},g.deflate=function(gt,pt,vt){return typeof pt=="function"&&(vt=pt,pt={}),et(new tt(pt),gt,vt)},g.deflateSync=function(gt,pt){return X(new tt(pt),gt)},g.gzip=function(gt,pt,vt){return typeof pt=="function"&&(vt=pt,pt={}),et(new ot(pt),gt,vt)},g.gzipSync=function(gt,pt){return X(new ot(pt),gt)},g.deflateRaw=function(gt,pt,vt){return typeof pt=="function"&&(vt=pt,pt={}),et(new lt(pt),gt,vt)},g.deflateRawSync=function(gt,pt){return X(new lt(pt),gt)},g.unzip=function(gt,pt,vt){return typeof pt=="function"&&(vt=pt,pt={}),et(new ut(pt),gt,vt)},g.unzipSync=function(gt,pt){return X(new ut(pt),gt)},g.inflate=function(gt,pt,vt){return typeof pt=="function"&&(vt=pt,pt={}),et(new rt(pt),gt,vt)},g.inflateSync=function(gt,pt){return X(new rt(pt),gt)},g.gunzip=function(gt,pt,vt){return typeof pt=="function"&&(vt=pt,pt={}),et(new J(pt),gt,vt)},g.gunzipSync=function(gt,pt){return X(new J(pt),gt)},g.inflateRaw=function(gt,pt,vt){return typeof pt=="function"&&(vt=pt,pt={}),et(new st(pt),gt,vt)},g.inflateRawSync=function(gt,pt){return X(new st(pt),gt)},D.inherits(ct,P),ct.prototype.params=function(gt,pt,vt){if(gt<g.Z_MIN_LEVEL||gt>g.Z_MAX_LEVEL)throw new RangeError("Invalid compression level: "+gt);if(pt!=g.Z_FILTERED&&pt!=g.Z_HUFFMAN_ONLY&&pt!=g.Z_RLE&&pt!=g.Z_FIXED&&pt!=g.Z_DEFAULT_STRATEGY)throw new TypeError("Invalid strategy: "+pt);if(this._level!==gt||this._strategy!==pt){var Tt=this;this.flush(F.Z_SYNC_FLUSH,function(){U(Tt._handle,"zlib binding closed"),Tt._handle.params(gt,pt),Tt._hadError||(Tt._level=gt,Tt._strategy=pt,vt&&vt())})}else w.nextTick(vt)},ct.prototype.reset=function(){return U(this._handle,"zlib binding closed"),this._handle.reset()},ct.prototype._flush=function(gt){this._transform(I.alloc(0),"",gt)},ct.prototype.flush=function(gt,pt){var vt=this,Tt=this._writableState;(typeof gt=="function"||gt===void 0&&!pt)&&(pt=gt,gt=F.Z_FULL_FLUSH),Tt.ended?pt&&w.nextTick(pt):Tt.ending?pt&&this.once("end",pt):Tt.needDrain?pt&&this.once("drain",function(){return vt.flush(gt,pt)}):(this._flushFlag=gt,this.write(I.alloc(0),"",pt))},ct.prototype.close=function(gt){At(this,gt),w.nextTick(Et,this)},ct.prototype._transform=function(gt,pt,vt){var Tt,It=this._writableState,$t=(It.ending||It.ended)&&(!gt||It.length===gt.length);return gt===null||I.isBuffer(gt)?this._handle?($t?Tt=this._finishFlushFlag:(Tt=this._flushFlag,gt.length>=It.length&&(this._flushFlag=this._opts.flush||F.Z_NO_FLUSH)),void this._processChunk(gt,Tt,vt)):vt(new Error("zlib binding closed")):vt(new Error("invalid input"))},ct.prototype._processChunk=function(gt,pt,vt){var Tt=gt&&gt.length,It=this._chunkSize-this._offset,$t=0,Bt=this,zt=typeof vt=="function";if(!zt){var Ot,Nt=[],Pt=0;this.on("error",function(Dt){Ot=Dt}),U(this._handle,"zlib binding closed");do var Ut=this._handle.writeSync(pt,gt,$t,Tt,this._buffer,this._offset,It);while(!this._hadError&&Ht(Ut[0],Ut[1]));if(this._hadError)throw Ot;if(Pt>=Z)throw At(this),new RangeError($);var Ft=I.concat(Nt,Pt);return At(this),Ft}U(this._handle,"zlib binding closed");var Zt=this._handle.write(pt,gt,$t,Tt,this._buffer,this._offset,It);function Ht(Dt,dt){if(this&&(this.buffer=null,this.callback=null),!Bt._hadError){var Lt=It-dt;if(U(Lt>=0,"have should not go down"),Lt>0){var bt=Bt._buffer.slice(Bt._offset,Bt._offset+Lt);Bt._offset+=Lt,zt?Bt.push(bt):(Nt.push(bt),Pt+=bt.length)}if((dt===0||Bt._offset>=Bt._chunkSize)&&(It=Bt._chunkSize,Bt._offset=0,Bt._buffer=I.allocUnsafe(Bt._chunkSize)),dt===0){if($t+=Tt-Dt,Tt=Dt,!zt)return!0;var wt=Bt._handle.write(pt,gt,$t,Tt,Bt._buffer,Bt._offset,Bt._chunkSize);return wt.callback=Ht,void(wt.buffer=gt)}if(!zt)return!1;vt()}}Zt.buffer=gt,Zt.callback=Ht},D.inherits(tt,ct),D.inherits(rt,ct),D.inherits(ot,ct),D.inherits(J,ct),D.inherits(lt,ct),D.inherits(st,ct),D.inherits(ut,ct)}).call(this)}).call(this,d("_process"))},{"./binding":30,_process:63,assert:23,buffer:32,stream:65,util:84}],32:[function(d,m,g){(function(w){(function(){var I=d("base64-js"),P=d("ieee754");g.Buffer=Z,g.SlowBuffer=X,g.INSPECT_MAX_BYTES=50;var F=2147483647;function D(){try{var nt=new Uint8Array(1);return nt.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},nt.foo()===42}catch{return!1}}function U(nt){if(nt>F)throw new RangeError('The value "'+nt+'" is invalid for option "size"');var ht=new Uint8Array(nt);return ht.__proto__=Z.prototype,ht}function Z(nt,ht,ft){if(typeof nt=="number"){if(typeof ht=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return W(nt)}return $(nt,ht,ft)}function $(nt,ht,ft){if(typeof nt=="string")return V(nt,ht);if(ArrayBuffer.isView(nt))return Q(nt);if(nt==null)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof nt);if(Rt(nt,ArrayBuffer)||nt&&Rt(nt.buffer,ArrayBuffer))return K(nt,ht,ft);if(typeof nt=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var at=nt.valueOf&&nt.valueOf();if(at!=null&&at!==nt)return Z.from(at,ht,ft);var _t=q(nt);if(_t)return _t;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof nt[Symbol.toPrimitive]=="function")return Z.from(nt[Symbol.toPrimitive]("string"),ht,ft);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof nt)}function j(nt){if(typeof nt!="number")throw new TypeError('"size" argument must be of type number');if(nt<0)throw new RangeError('The value "'+nt+'" is invalid for option "size"')}function H(nt,ht,ft){return j(nt),nt<=0?U(nt):ht!==void 0?typeof ft=="string"?U(nt).fill(ht,ft):U(nt).fill(ht):U(nt)}function W(nt){return j(nt),U(nt<0?0:0|et(nt))}function V(nt,ht){if(typeof ht=="string"&&ht!==""||(ht="utf8"),!Z.isEncoding(ht))throw new TypeError("Unknown encoding: "+ht);var ft=0|tt(nt,ht),at=U(ft),_t=at.write(nt,ht);return _t!==ft&&(at=at.slice(0,_t)),at}function Q(nt){for(var ht=nt.length<0?0:0|et(nt.length),ft=U(ht),at=0;at<ht;at+=1)ft[at]=255&nt[at];return ft}function K(nt,ht,ft){if(ht<0||nt.byteLength<ht)throw new RangeError('"offset" is outside of buffer bounds');if(nt.byteLength<ht+(ft||0))throw new RangeError('"length" is outside of buffer bounds');var at;return(at=ht===void 0&&ft===void 0?new Uint8Array(nt):ft===void 0?new Uint8Array(nt,ht):new Uint8Array(nt,ht,ft)).__proto__=Z.prototype,at}function q(nt){if(Z.isBuffer(nt)){var ht=0|et(nt.length),ft=U(ht);return ft.length===0||nt.copy(ft,0,0,ht),ft}return nt.length!==void 0?typeof nt.length!="number"||Gt(nt.length)?U(0):Q(nt):nt.type==="Buffer"&&Array.isArray(nt.data)?Q(nt.data):void 0}function et(nt){if(nt>=F)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+F.toString(16)+" bytes");return 0|nt}function X(nt){return+nt!=nt&&(nt=0),Z.alloc(+nt)}function tt(nt,ht){if(Z.isBuffer(nt))return nt.length;if(ArrayBuffer.isView(nt)||Rt(nt,ArrayBuffer))return nt.byteLength;if(typeof nt!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof nt);var ft=nt.length,at=arguments.length>2&&arguments[2]===!0;if(!at&&ft===0)return 0;for(var _t=!1;;)switch(ht){case"ascii":case"latin1":case"binary":return ft;case"utf8":case"utf-8":return dt(nt).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*ft;case"hex":return ft>>>1;case"base64":return wt(nt).length;default:if(_t)return at?-1:dt(nt).length;ht=(""+ht).toLowerCase(),_t=!0}}function rt(nt,ht,ft){var at=!1;if((ht===void 0||ht<0)&&(ht=0),ht>this.length||((ft===void 0||ft>this.length)&&(ft=this.length),ft<=0)||(ft>>>=0)<=(ht>>>=0))return"";for(nt||(nt="utf8");;)switch(nt){case"hex":return Bt(this,ht,ft);case"utf8":case"utf-8":return pt(this,ht,ft);case"ascii":return It(this,ht,ft);case"latin1":case"binary":return $t(this,ht,ft);case"base64":return gt(this,ht,ft);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return zt(this,ht,ft);default:if(at)throw new TypeError("Unknown encoding: "+nt);nt=(nt+"").toLowerCase(),at=!0}}function ot(nt,ht,ft){var at=nt[ht];nt[ht]=nt[ft],nt[ft]=at}function J(nt,ht,ft,at,_t){if(nt.length===0)return-1;if(typeof ft=="string"?(at=ft,ft=0):ft>2147483647?ft=2147483647:ft<-2147483648&&(ft=-2147483648),Gt(ft=+ft)&&(ft=_t?0:nt.length-1),ft<0&&(ft=nt.length+ft),ft>=nt.length){if(_t)return-1;ft=nt.length-1}else if(ft<0){if(!_t)return-1;ft=0}if(typeof ht=="string"&&(ht=Z.from(ht,at)),Z.isBuffer(ht))return ht.length===0?-1:lt(nt,ht,ft,at,_t);if(typeof ht=="number")return ht&=255,typeof Uint8Array.prototype.indexOf=="function"?_t?Uint8Array.prototype.indexOf.call(nt,ht,ft):Uint8Array.prototype.lastIndexOf.call(nt,ht,ft):lt(nt,[ht],ft,at,_t);throw new TypeError("val must be string, number or Buffer")}function lt(nt,ht,ft,at,_t){var St,Vt=1,ee=nt.length,Jt=ht.length;if(at!==void 0&&((at=String(at).toLowerCase())==="ucs2"||at==="ucs-2"||at==="utf16le"||at==="utf-16le")){if(nt.length<2||ht.length<2)return-1;Vt=2,ee/=2,Jt/=2,ft/=2}function se(ue,me){return Vt===1?ue[me]:ue.readUInt16BE(me*Vt)}if(_t){var ae=-1;for(St=ft;St<ee;St++)if(se(nt,St)===se(ht,ae===-1?0:St-ae)){if(ae===-1&&(ae=St),St-ae+1===Jt)return ae*Vt}else ae!==-1&&(St-=St-ae),ae=-1}else for(ft+Jt>ee&&(ft=ee-Jt),St=ft;St>=0;St--){for(var fe=!0,le=0;le<Jt;le++)if(se(nt,St+le)!==se(ht,le)){fe=!1;break}if(fe)return St}return-1}function st(nt,ht,ft,at){ft=Number(ft)||0;var _t=nt.length-ft;at?(at=Number(at))>_t&&(at=_t):at=_t;var St=ht.length;at>St/2&&(at=St/2);for(var Vt=0;Vt<at;++Vt){var ee=parseInt(ht.substr(2*Vt,2),16);if(Gt(ee))return Vt;nt[ft+Vt]=ee}return Vt}function ut(nt,ht,ft,at){return xt(dt(ht,nt.length-ft),nt,ft,at)}function it(nt,ht,ft,at){return xt(Lt(ht),nt,ft,at)}function ct(nt,ht,ft,at){return it(nt,ht,ft,at)}function At(nt,ht,ft,at){return xt(wt(ht),nt,ft,at)}function Et(nt,ht,ft,at){return xt(bt(ht,nt.length-ft),nt,ft,at)}function gt(nt,ht,ft){return ht===0&&ft===nt.length?I.fromByteArray(nt):I.fromByteArray(nt.slice(ht,ft))}function pt(nt,ht,ft){ft=Math.min(nt.length,ft);for(var at=[],_t=ht;_t<ft;){var St,Vt,ee,Jt,se=nt[_t],ae=null,fe=se>239?4:se>223?3:se>191?2:1;if(_t+fe<=ft)switch(fe){case 1:se<128&&(ae=se);break;case 2:(192&(St=nt[_t+1]))==128&&(Jt=(31&se)<<6|63&St)>127&&(ae=Jt);break;case 3:St=nt[_t+1],Vt=nt[_t+2],(192&St)==128&&(192&Vt)==128&&(Jt=(15&se)<<12|(63&St)<<6|63&Vt)>2047&&(Jt<55296||Jt>57343)&&(ae=Jt);break;case 4:St=nt[_t+1],Vt=nt[_t+2],ee=nt[_t+3],(192&St)==128&&(192&Vt)==128&&(192&ee)==128&&(Jt=(15&se)<<18|(63&St)<<12|(63&Vt)<<6|63&ee)>65535&&Jt<1114112&&(ae=Jt)}ae===null?(ae=65533,fe=1):ae>65535&&(ae-=65536,at.push(ae>>>10&1023|55296),ae=56320|1023&ae),at.push(ae),_t+=fe}return Tt(at)}g.kMaxLength=F,Z.TYPED_ARRAY_SUPPORT=D(),Z.TYPED_ARRAY_SUPPORT||typeof console>"u"||typeof console.error!="function"||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(Z.prototype,"parent",{enumerable:!0,get:function(){if(Z.isBuffer(this))return this.buffer}}),Object.defineProperty(Z.prototype,"offset",{enumerable:!0,get:function(){if(Z.isBuffer(this))return this.byteOffset}}),typeof Symbol<"u"&&Symbol.species!=null&&Z[Symbol.species]===Z&&Object.defineProperty(Z,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),Z.poolSize=8192,Z.from=function(nt,ht,ft){return $(nt,ht,ft)},Z.prototype.__proto__=Uint8Array.prototype,Z.__proto__=Uint8Array,Z.alloc=function(nt,ht,ft){return H(nt,ht,ft)},Z.allocUnsafe=function(nt){return W(nt)},Z.allocUnsafeSlow=function(nt){return W(nt)},Z.isBuffer=function(nt){return nt!=null&&nt._isBuffer===!0&&nt!==Z.prototype},Z.compare=function(nt,ht){if(Rt(nt,Uint8Array)&&(nt=Z.from(nt,nt.offset,nt.byteLength)),Rt(ht,Uint8Array)&&(ht=Z.from(ht,ht.offset,ht.byteLength)),!Z.isBuffer(nt)||!Z.isBuffer(ht))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(nt===ht)return 0;for(var ft=nt.length,at=ht.length,_t=0,St=Math.min(ft,at);_t<St;++_t)if(nt[_t]!==ht[_t]){ft=nt[_t],at=ht[_t];break}return ft<at?-1:at<ft?1:0},Z.isEncoding=function(nt){switch(String(nt).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Z.concat=function(nt,ht){if(!Array.isArray(nt))throw new TypeError('"list" argument must be an Array of Buffers');if(nt.length===0)return Z.alloc(0);var ft;if(ht===void 0)for(ht=0,ft=0;ft<nt.length;++ft)ht+=nt[ft].length;var at=Z.allocUnsafe(ht),_t=0;for(ft=0;ft<nt.length;++ft){var St=nt[ft];if(Rt(St,Uint8Array)&&(St=Z.from(St)),!Z.isBuffer(St))throw new TypeError('"list" argument must be an Array of Buffers');St.copy(at,_t),_t+=St.length}return at},Z.byteLength=tt,Z.prototype._isBuffer=!0,Z.prototype.swap16=function(){var nt=this.length;if(nt%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var ht=0;ht<nt;ht+=2)ot(this,ht,ht+1);return this},Z.prototype.swap32=function(){var nt=this.length;if(nt%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var ht=0;ht<nt;ht+=4)ot(this,ht,ht+3),ot(this,ht+1,ht+2);return this},Z.prototype.swap64=function(){var nt=this.length;if(nt%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var ht=0;ht<nt;ht+=8)ot(this,ht,ht+7),ot(this,ht+1,ht+6),ot(this,ht+2,ht+5),ot(this,ht+3,ht+4);return this},Z.prototype.toString=function(){var nt=this.length;return nt===0?"":arguments.length===0?pt(this,0,nt):rt.apply(this,arguments)},Z.prototype.toLocaleString=Z.prototype.toString,Z.prototype.equals=function(nt){if(!Z.isBuffer(nt))throw new TypeError("Argument must be a Buffer");return this===nt||Z.compare(this,nt)===0},Z.prototype.inspect=function(){var nt="",ht=g.INSPECT_MAX_BYTES;return nt=this.toString("hex",0,ht).replace(/(.{2})/g,"$1 ").trim(),this.length>ht&&(nt+=" ... "),"<Buffer "+nt+">"},Z.prototype.compare=function(nt,ht,ft,at,_t){if(Rt(nt,Uint8Array)&&(nt=Z.from(nt,nt.offset,nt.byteLength)),!Z.isBuffer(nt))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof nt);if(ht===void 0&&(ht=0),ft===void 0&&(ft=nt?nt.length:0),at===void 0&&(at=0),_t===void 0&&(_t=this.length),ht<0||ft>nt.length||at<0||_t>this.length)throw new RangeError("out of range index");if(at>=_t&&ht>=ft)return 0;if(at>=_t)return-1;if(ht>=ft)return 1;if(this===nt)return 0;for(var St=(_t>>>=0)-(at>>>=0),Vt=(ft>>>=0)-(ht>>>=0),ee=Math.min(St,Vt),Jt=this.slice(at,_t),se=nt.slice(ht,ft),ae=0;ae<ee;++ae)if(Jt[ae]!==se[ae]){St=Jt[ae],Vt=se[ae];break}return St<Vt?-1:Vt<St?1:0},Z.prototype.includes=function(nt,ht,ft){return this.indexOf(nt,ht,ft)!==-1},Z.prototype.indexOf=function(nt,ht,ft){return J(this,nt,ht,ft,!0)},Z.prototype.lastIndexOf=function(nt,ht,ft){return J(this,nt,ht,ft,!1)},Z.prototype.write=function(nt,ht,ft,at){if(ht===void 0)at="utf8",ft=this.length,ht=0;else if(ft===void 0&&typeof ht=="string")at=ht,ft=this.length,ht=0;else{if(!isFinite(ht))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");ht>>>=0,isFinite(ft)?(ft>>>=0,at===void 0&&(at="utf8")):(at=ft,ft=void 0)}var _t=this.length-ht;if((ft===void 0||ft>_t)&&(ft=_t),nt.length>0&&(ft<0||ht<0)||ht>this.length)throw new RangeError("Attempt to write outside buffer bounds");at||(at="utf8");for(var St=!1;;)switch(at){case"hex":return st(this,nt,ht,ft);case"utf8":case"utf-8":return ut(this,nt,ht,ft);case"ascii":return it(this,nt,ht,ft);case"latin1":case"binary":return ct(this,nt,ht,ft);case"base64":return At(this,nt,ht,ft);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Et(this,nt,ht,ft);default:if(St)throw new TypeError("Unknown encoding: "+at);at=(""+at).toLowerCase(),St=!0}},Z.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var vt=4096;function Tt(nt){var ht=nt.length;if(ht<=vt)return String.fromCharCode.apply(String,nt);for(var ft="",at=0;at<ht;)ft+=String.fromCharCode.apply(String,nt.slice(at,at+=vt));return ft}function It(nt,ht,ft){var at="";ft=Math.min(nt.length,ft);for(var _t=ht;_t<ft;++_t)at+=String.fromCharCode(127&nt[_t]);return at}function $t(nt,ht,ft){var at="";ft=Math.min(nt.length,ft);for(var _t=ht;_t<ft;++_t)at+=String.fromCharCode(nt[_t]);return at}function Bt(nt,ht,ft){var at=nt.length;(!ht||ht<0)&&(ht=0),(!ft||ft<0||ft>at)&&(ft=at);for(var _t="",St=ht;St<ft;++St)_t+=Dt(nt[St]);return _t}function zt(nt,ht,ft){for(var at=nt.slice(ht,ft),_t="",St=0;St<at.length;St+=2)_t+=String.fromCharCode(at[St]+256*at[St+1]);return _t}function Ot(nt,ht,ft){if(nt%1!=0||nt<0)throw new RangeError("offset is not uint");if(nt+ht>ft)throw new RangeError("Trying to access beyond buffer length")}function Nt(nt,ht,ft,at,_t,St){if(!Z.isBuffer(nt))throw new TypeError('"buffer" argument must be a Buffer instance');if(ht>_t||ht<St)throw new RangeError('"value" argument is out of bounds');if(ft+at>nt.length)throw new RangeError("Index out of range")}function Pt(nt,ht,ft,at,_t,St){if(ft+at>nt.length)throw new RangeError("Index out of range");if(ft<0)throw new RangeError("Index out of range")}function Ut(nt,ht,ft,at,_t){return ht=+ht,ft>>>=0,_t||Pt(nt,ht,ft,4),P.write(nt,ht,ft,at,23,4),ft+4}function Ft(nt,ht,ft,at,_t){return ht=+ht,ft>>>=0,_t||Pt(nt,ht,ft,8),P.write(nt,ht,ft,at,52,8),ft+8}Z.prototype.slice=function(nt,ht){var ft=this.length;(nt=~~nt)<0?(nt+=ft)<0&&(nt=0):nt>ft&&(nt=ft),(ht=ht===void 0?ft:~~ht)<0?(ht+=ft)<0&&(ht=0):ht>ft&&(ht=ft),ht<nt&&(ht=nt);var at=this.subarray(nt,ht);return at.__proto__=Z.prototype,at},Z.prototype.readUIntLE=function(nt,ht,ft){nt>>>=0,ht>>>=0,ft||Ot(nt,ht,this.length);for(var at=this[nt],_t=1,St=0;++St<ht&&(_t*=256);)at+=this[nt+St]*_t;return at},Z.prototype.readUIntBE=function(nt,ht,ft){nt>>>=0,ht>>>=0,ft||Ot(nt,ht,this.length);for(var at=this[nt+--ht],_t=1;ht>0&&(_t*=256);)at+=this[nt+--ht]*_t;return at},Z.prototype.readUInt8=function(nt,ht){return nt>>>=0,ht||Ot(nt,1,this.length),this[nt]},Z.prototype.readUInt16LE=function(nt,ht){return nt>>>=0,ht||Ot(nt,2,this.length),this[nt]|this[nt+1]<<8},Z.prototype.readUInt16BE=function(nt,ht){return nt>>>=0,ht||Ot(nt,2,this.length),this[nt]<<8|this[nt+1]},Z.prototype.readUInt32LE=function(nt,ht){return nt>>>=0,ht||Ot(nt,4,this.length),(this[nt]|this[nt+1]<<8|this[nt+2]<<16)+16777216*this[nt+3]},Z.prototype.readUInt32BE=function(nt,ht){return nt>>>=0,ht||Ot(nt,4,this.length),16777216*this[nt]+(this[nt+1]<<16|this[nt+2]<<8|this[nt+3])},Z.prototype.readIntLE=function(nt,ht,ft){nt>>>=0,ht>>>=0,ft||Ot(nt,ht,this.length);for(var at=this[nt],_t=1,St=0;++St<ht&&(_t*=256);)at+=this[nt+St]*_t;return at>=(_t*=128)&&(at-=Math.pow(2,8*ht)),at},Z.prototype.readIntBE=function(nt,ht,ft){nt>>>=0,ht>>>=0,ft||Ot(nt,ht,this.length);for(var at=ht,_t=1,St=this[nt+--at];at>0&&(_t*=256);)St+=this[nt+--at]*_t;return St>=(_t*=128)&&(St-=Math.pow(2,8*ht)),St},Z.prototype.readInt8=function(nt,ht){return nt>>>=0,ht||Ot(nt,1,this.length),128&this[nt]?-1*(255-this[nt]+1):this[nt]},Z.prototype.readInt16LE=function(nt,ht){nt>>>=0,ht||Ot(nt,2,this.length);var ft=this[nt]|this[nt+1]<<8;return 32768&ft?4294901760|ft:ft},Z.prototype.readInt16BE=function(nt,ht){nt>>>=0,ht||Ot(nt,2,this.length);var ft=this[nt+1]|this[nt]<<8;return 32768&ft?4294901760|ft:ft},Z.prototype.readInt32LE=function(nt,ht){return nt>>>=0,ht||Ot(nt,4,this.length),this[nt]|this[nt+1]<<8|this[nt+2]<<16|this[nt+3]<<24},Z.prototype.readInt32BE=function(nt,ht){return nt>>>=0,ht||Ot(nt,4,this.length),this[nt]<<24|this[nt+1]<<16|this[nt+2]<<8|this[nt+3]},Z.prototype.readFloatLE=function(nt,ht){return nt>>>=0,ht||Ot(nt,4,this.length),P.read(this,nt,!0,23,4)},Z.prototype.readFloatBE=function(nt,ht){return nt>>>=0,ht||Ot(nt,4,this.length),P.read(this,nt,!1,23,4)},Z.prototype.readDoubleLE=function(nt,ht){return nt>>>=0,ht||Ot(nt,8,this.length),P.read(this,nt,!0,52,8)},Z.prototype.readDoubleBE=function(nt,ht){return nt>>>=0,ht||Ot(nt,8,this.length),P.read(this,nt,!1,52,8)},Z.prototype.writeUIntLE=function(nt,ht,ft,at){nt=+nt,ht>>>=0,ft>>>=0,at||Nt(this,nt,ht,ft,Math.pow(2,8*ft)-1,0);var _t=1,St=0;for(this[ht]=255&nt;++St<ft&&(_t*=256);)this[ht+St]=nt/_t&255;return ht+ft},Z.prototype.writeUIntBE=function(nt,ht,ft,at){nt=+nt,ht>>>=0,ft>>>=0,at||Nt(this,nt,ht,ft,Math.pow(2,8*ft)-1,0);var _t=ft-1,St=1;for(this[ht+_t]=255&nt;--_t>=0&&(St*=256);)this[ht+_t]=nt/St&255;return ht+ft},Z.prototype.writeUInt8=function(nt,ht,ft){return nt=+nt,ht>>>=0,ft||Nt(this,nt,ht,1,255,0),this[ht]=255&nt,ht+1},Z.prototype.writeUInt16LE=function(nt,ht,ft){return nt=+nt,ht>>>=0,ft||Nt(this,nt,ht,2,65535,0),this[ht]=255&nt,this[ht+1]=nt>>>8,ht+2},Z.prototype.writeUInt16BE=function(nt,ht,ft){return nt=+nt,ht>>>=0,ft||Nt(this,nt,ht,2,65535,0),this[ht]=nt>>>8,this[ht+1]=255&nt,ht+2},Z.prototype.writeUInt32LE=function(nt,ht,ft){return nt=+nt,ht>>>=0,ft||Nt(this,nt,ht,4,4294967295,0),this[ht+3]=nt>>>24,this[ht+2]=nt>>>16,this[ht+1]=nt>>>8,this[ht]=255&nt,ht+4},Z.prototype.writeUInt32BE=function(nt,ht,ft){return nt=+nt,ht>>>=0,ft||Nt(this,nt,ht,4,4294967295,0),this[ht]=nt>>>24,this[ht+1]=nt>>>16,this[ht+2]=nt>>>8,this[ht+3]=255&nt,ht+4},Z.prototype.writeIntLE=function(nt,ht,ft,at){if(nt=+nt,ht>>>=0,!at){var _t=Math.pow(2,8*ft-1);Nt(this,nt,ht,ft,_t-1,-_t)}var St=0,Vt=1,ee=0;for(this[ht]=255&nt;++St<ft&&(Vt*=256);)nt<0&&ee===0&&this[ht+St-1]!==0&&(ee=1),this[ht+St]=(nt/Vt|0)-ee&255;return ht+ft},Z.prototype.writeIntBE=function(nt,ht,ft,at){if(nt=+nt,ht>>>=0,!at){var _t=Math.pow(2,8*ft-1);Nt(this,nt,ht,ft,_t-1,-_t)}var St=ft-1,Vt=1,ee=0;for(this[ht+St]=255&nt;--St>=0&&(Vt*=256);)nt<0&&ee===0&&this[ht+St+1]!==0&&(ee=1),this[ht+St]=(nt/Vt|0)-ee&255;return ht+ft},Z.prototype.writeInt8=function(nt,ht,ft){return nt=+nt,ht>>>=0,ft||Nt(this,nt,ht,1,127,-128),nt<0&&(nt=255+nt+1),this[ht]=255&nt,ht+1},Z.prototype.writeInt16LE=function(nt,ht,ft){return nt=+nt,ht>>>=0,ft||Nt(this,nt,ht,2,32767,-32768),this[ht]=255&nt,this[ht+1]=nt>>>8,ht+2},Z.prototype.writeInt16BE=function(nt,ht,ft){return nt=+nt,ht>>>=0,ft||Nt(this,nt,ht,2,32767,-32768),this[ht]=nt>>>8,this[ht+1]=255&nt,ht+2},Z.prototype.writeInt32LE=function(nt,ht,ft){return nt=+nt,ht>>>=0,ft||Nt(this,nt,ht,4,2147483647,-2147483648),this[ht]=255&nt,this[ht+1]=nt>>>8,this[ht+2]=nt>>>16,this[ht+3]=nt>>>24,ht+4},Z.prototype.writeInt32BE=function(nt,ht,ft){return nt=+nt,ht>>>=0,ft||Nt(this,nt,ht,4,2147483647,-2147483648),nt<0&&(nt=4294967295+nt+1),this[ht]=nt>>>24,this[ht+1]=nt>>>16,this[ht+2]=nt>>>8,this[ht+3]=255&nt,ht+4},Z.prototype.writeFloatLE=function(nt,ht,ft){return Ut(this,nt,ht,!0,ft)},Z.prototype.writeFloatBE=function(nt,ht,ft){return Ut(this,nt,ht,!1,ft)},Z.prototype.writeDoubleLE=function(nt,ht,ft){return Ft(this,nt,ht,!0,ft)},Z.prototype.writeDoubleBE=function(nt,ht,ft){return Ft(this,nt,ht,!1,ft)},Z.prototype.copy=function(nt,ht,ft,at){if(!Z.isBuffer(nt))throw new TypeError("argument should be a Buffer");if(ft||(ft=0),at||at===0||(at=this.length),ht>=nt.length&&(ht=nt.length),ht||(ht=0),at>0&&at<ft&&(at=ft),at===ft||nt.length===0||this.length===0)return 0;if(ht<0)throw new RangeError("targetStart out of bounds");if(ft<0||ft>=this.length)throw new RangeError("Index out of range");if(at<0)throw new RangeError("sourceEnd out of bounds");at>this.length&&(at=this.length),nt.length-ht<at-ft&&(at=nt.length-ht+ft);var _t=at-ft;if(this===nt&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(ht,ft,at);else if(this===nt&&ft<ht&&ht<at)for(var St=_t-1;St>=0;--St)nt[St+ht]=this[St+ft];else Uint8Array.prototype.set.call(nt,this.subarray(ft,at),ht);return _t},Z.prototype.fill=function(nt,ht,ft,at){if(typeof nt=="string"){if(typeof ht=="string"?(at=ht,ht=0,ft=this.length):typeof ft=="string"&&(at=ft,ft=this.length),at!==void 0&&typeof at!="string")throw new TypeError("encoding must be a string");if(typeof at=="string"&&!Z.isEncoding(at))throw new TypeError("Unknown encoding: "+at);if(nt.length===1){var _t=nt.charCodeAt(0);(at==="utf8"&&_t<128||at==="latin1")&&(nt=_t)}}else typeof nt=="number"&&(nt&=255);if(ht<0||this.length<ht||this.length<ft)throw new RangeError("Out of range index");if(ft<=ht)return this;var St;if(ht>>>=0,ft=ft===void 0?this.length:ft>>>0,nt||(nt=0),typeof nt=="number")for(St=ht;St<ft;++St)this[St]=nt;else{var Vt=Z.isBuffer(nt)?nt:Z.from(nt,at),ee=Vt.length;if(ee===0)throw new TypeError('The value "'+nt+'" is invalid for argument "value"');for(St=0;St<ft-ht;++St)this[St+ht]=Vt[St%ee]}return this};var Zt=/[^+/0-9A-Za-z-_]/g;function Ht(nt){if((nt=(nt=nt.split("=")[0]).trim().replace(Zt,"")).length<2)return"";for(;nt.length%4!=0;)nt+="=";return nt}function Dt(nt){return nt<16?"0"+nt.toString(16):nt.toString(16)}function dt(nt,ht){var ft;ht=ht||1/0;for(var at=nt.length,_t=null,St=[],Vt=0;Vt<at;++Vt){if((ft=nt.charCodeAt(Vt))>55295&&ft<57344){if(!_t){if(ft>56319){(ht-=3)>-1&&St.push(239,191,189);continue}if(Vt+1===at){(ht-=3)>-1&&St.push(239,191,189);continue}_t=ft;continue}if(ft<56320){(ht-=3)>-1&&St.push(239,191,189),_t=ft;continue}ft=65536+(_t-55296<<10|ft-56320)}else _t&&(ht-=3)>-1&&St.push(239,191,189);if(_t=null,ft<128){if((ht-=1)<0)break;St.push(ft)}else if(ft<2048){if((ht-=2)<0)break;St.push(ft>>6|192,63&ft|128)}else if(ft<65536){if((ht-=3)<0)break;St.push(ft>>12|224,ft>>6&63|128,63&ft|128)}else{if(!(ft<1114112))throw new Error("Invalid code point");if((ht-=4)<0)break;St.push(ft>>18|240,ft>>12&63|128,ft>>6&63|128,63&ft|128)}}return St}function Lt(nt){for(var ht=[],ft=0;ft<nt.length;++ft)ht.push(255&nt.charCodeAt(ft));return ht}function bt(nt,ht){for(var ft,at,_t,St=[],Vt=0;Vt<nt.length&&!((ht-=2)<0);++Vt)at=(ft=nt.charCodeAt(Vt))>>8,_t=ft%256,St.push(_t),St.push(at);return St}function wt(nt){return I.toByteArray(Ht(nt))}function xt(nt,ht,ft,at){for(var _t=0;_t<at&&!(_t+ft>=ht.length||_t>=nt.length);++_t)ht[_t+ft]=nt[_t];return _t}function Rt(nt,ht){return nt instanceof ht||nt!=null&&nt.constructor!=null&&nt.constructor.name!=null&&nt.constructor.name===ht.name}function Gt(nt){return nt!=nt}}).call(this)}).call(this,d("buffer").Buffer)},{"base64-js":28,buffer:32,ieee754:45}],33:[function(d,m,g){var w=d("get-intrinsic"),I=d("./"),P=I(w("String.prototype.indexOf"));m.exports=function(F,D){var U=w(F,!!D);return typeof U=="function"&&P(F,".prototype.")>-1?I(U):U}},{"./":34,"get-intrinsic":39}],34:[function(d,m,g){var w=d("function-bind"),I=d("get-intrinsic"),P=I("%Function.prototype.apply%"),F=I("%Function.prototype.call%"),D=I("%Reflect.apply%",!0)||w.call(F,P),U=I("%Object.getOwnPropertyDescriptor%",!0),Z=I("%Object.defineProperty%",!0),$=I("%Math.max%");if(Z)try{Z({},"a",{value:1})}catch{Z=null}m.exports=function(H){var W=D(w,F,arguments);return U&&Z&&U(W,"length").configurable&&Z(W,"length",{value:1+$(0,H.length-(arguments.length-1))}),W};var j=function(){return D(w,P,arguments)};Z?Z(m.exports,"apply",{value:j}):m.exports.apply=j},{"function-bind":38,"get-intrinsic":39}],35:[function(d,m,g){var w,I=typeof Reflect=="object"?Reflect:null,P=I&&typeof I.apply=="function"?I.apply:function(J,lt,st){return Function.prototype.apply.call(J,lt,st)};function F(J){console&&console.warn&&console.warn(J)}w=I&&typeof I.ownKeys=="function"?I.ownKeys:Object.getOwnPropertySymbols?function(J){return Object.getOwnPropertyNames(J).concat(Object.getOwnPropertySymbols(J))}:function(J){return Object.getOwnPropertyNames(J)};var D=Number.isNaN||function(J){return J!=J};function U(){U.init.call(this)}m.exports=U,m.exports.once=tt,U.EventEmitter=U,U.prototype._events=void 0,U.prototype._eventsCount=0,U.prototype._maxListeners=void 0;var Z=10;function $(J){if(typeof J!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof J)}function j(J){return J._maxListeners===void 0?U.defaultMaxListeners:J._maxListeners}function H(J,lt,st,ut){var it,ct,At;if($(st),(ct=J._events)===void 0?(ct=J._events=Object.create(null),J._eventsCount=0):(ct.newListener!==void 0&&(J.emit("newListener",lt,st.listener?st.listener:st),ct=J._events),At=ct[lt]),At===void 0)At=ct[lt]=st,++J._eventsCount;else if(typeof At=="function"?At=ct[lt]=ut?[st,At]:[At,st]:ut?At.unshift(st):At.push(st),(it=j(J))>0&&At.length>it&&!At.warned){At.warned=!0;var Et=new Error("Possible EventEmitter memory leak detected. "+At.length+" "+String(lt)+" listeners added. Use emitter.setMaxListeners() to increase limit");Et.name="MaxListenersExceededWarning",Et.emitter=J,Et.type=lt,Et.count=At.length,F(Et)}return J}function W(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function V(J,lt,st){var ut={fired:!1,wrapFn:void 0,target:J,type:lt,listener:st},it=W.bind(ut);return it.listener=st,ut.wrapFn=it,it}function Q(J,lt,st){var ut=J._events;if(ut===void 0)return[];var it=ut[lt];return it===void 0?[]:typeof it=="function"?st?[it.listener||it]:[it]:st?X(it):q(it,it.length)}function K(J){var lt=this._events;if(lt!==void 0){var st=lt[J];if(typeof st=="function")return 1;if(st!==void 0)return st.length}return 0}function q(J,lt){for(var st=new Array(lt),ut=0;ut<lt;++ut)st[ut]=J[ut];return st}function et(J,lt){for(;lt+1<J.length;lt++)J[lt]=J[lt+1];J.pop()}function X(J){for(var lt=new Array(J.length),st=0;st<lt.length;++st)lt[st]=J[st].listener||J[st];return lt}function tt(J,lt){return new Promise(function(st,ut){function it(At){J.removeListener(lt,ct),ut(At)}function ct(){typeof J.removeListener=="function"&&J.removeListener("error",it),st([].slice.call(arguments))}ot(J,lt,ct,{once:!0}),lt!=="error"&&rt(J,it,{once:!0})})}function rt(J,lt,st){typeof J.on=="function"&&ot(J,"error",lt,st)}function ot(J,lt,st,ut){if(typeof J.on=="function")ut.once?J.once(lt,st):J.on(lt,st);else{if(typeof J.addEventListener!="function")throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof J);J.addEventListener(lt,function it(ct){ut.once&&J.removeEventListener(lt,it),st(ct)})}}Object.defineProperty(U,"defaultMaxListeners",{enumerable:!0,get:function(){return Z},set:function(J){if(typeof J!="number"||J<0||D(J))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+J+".");Z=J}}),U.init=function(){this._events!==void 0&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},U.prototype.setMaxListeners=function(J){if(typeof J!="number"||J<0||D(J))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+J+".");return this._maxListeners=J,this},U.prototype.getMaxListeners=function(){return j(this)},U.prototype.emit=function(J){for(var lt=[],st=1;st<arguments.length;st++)lt.push(arguments[st]);var ut=J==="error",it=this._events;if(it!==void 0)ut=ut&&it.error===void 0;else if(!ut)return!1;if(ut){var ct;if(lt.length>0&&(ct=lt[0]),ct instanceof Error)throw ct;var At=new Error("Unhandled error."+(ct?" ("+ct.message+")":""));throw At.context=ct,At}var Et=it[J];if(Et===void 0)return!1;if(typeof Et=="function")P(Et,this,lt);else{var gt=Et.length,pt=q(Et,gt);for(st=0;st<gt;++st)P(pt[st],this,lt)}return!0},U.prototype.addListener=function(J,lt){return H(this,J,lt,!1)},U.prototype.on=U.prototype.addListener,U.prototype.prependListener=function(J,lt){return H(this,J,lt,!0)},U.prototype.once=function(J,lt){return $(lt),this.on(J,V(this,J,lt)),this},U.prototype.prependOnceListener=function(J,lt){return $(lt),this.prependListener(J,V(this,J,lt)),this},U.prototype.removeListener=function(J,lt){var st,ut,it,ct,At;if($(lt),(ut=this._events)===void 0)return this;if((st=ut[J])===void 0)return this;if(st===lt||st.listener===lt)--this._eventsCount==0?this._events=Object.create(null):(delete ut[J],ut.removeListener&&this.emit("removeListener",J,st.listener||lt));else if(typeof st!="function"){for(it=-1,ct=st.length-1;ct>=0;ct--)if(st[ct]===lt||st[ct].listener===lt){At=st[ct].listener,it=ct;break}if(it<0)return this;it===0?st.shift():et(st,it),st.length===1&&(ut[J]=st[0]),ut.removeListener!==void 0&&this.emit("removeListener",J,At||lt)}return this},U.prototype.off=U.prototype.removeListener,U.prototype.removeAllListeners=function(J){var lt,st,ut;if((st=this._events)===void 0)return this;if(st.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):st[J]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete st[J]),this;if(arguments.length===0){var it,ct=Object.keys(st);for(ut=0;ut<ct.length;++ut)(it=ct[ut])!=="removeListener"&&this.removeAllListeners(it);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(typeof(lt=st[J])=="function")this.removeListener(J,lt);else if(lt!==void 0)for(ut=lt.length-1;ut>=0;ut--)this.removeListener(J,lt[ut]);return this},U.prototype.listeners=function(J){return Q(this,J,!0)},U.prototype.rawListeners=function(J){return Q(this,J,!1)},U.listenerCount=function(J,lt){return typeof J.listenerCount=="function"?J.listenerCount(lt):K.call(J,lt)},U.prototype.listenerCount=K,U.prototype.eventNames=function(){return this._eventsCount>0?w(this._events):[]}},{}],36:[function(d,m,g){var w=d("is-callable"),I=Object.prototype.toString,P=Object.prototype.hasOwnProperty,F=function($,j,H){for(var W=0,V=$.length;W<V;W++)P.call($,W)&&(H==null?j($[W],W,$):j.call(H,$[W],W,$))},D=function($,j,H){for(var W=0,V=$.length;W<V;W++)H==null?j($.charAt(W),W,$):j.call(H,$.charAt(W),W,$)},U=function($,j,H){for(var W in $)P.call($,W)&&(H==null?j($[W],W,$):j.call(H,$[W],W,$))},Z=function($,j,H){if(!w(j))throw new TypeError("iterator must be a function");var W;arguments.length>=3&&(W=H),I.call($)==="[object Array]"?F($,j,W):typeof $=="string"?D($,j,W):U($,j,W)};m.exports=Z},{"is-callable":48}],37:[function(d,m,g){var w="Function.prototype.bind called on incompatible ",I=Array.prototype.slice,P=Object.prototype.toString,F="[object Function]";m.exports=function(D){var U=this;if(typeof U!="function"||P.call(U)!==F)throw new TypeError(w+U);for(var Z,$=I.call(arguments,1),j=function(){if(this instanceof Z){var K=U.apply(this,$.concat(I.call(arguments)));return Object(K)===K?K:this}return U.apply(D,$.concat(I.call(arguments)))},H=Math.max(0,U.length-$.length),W=[],V=0;V<H;V++)W.push("$"+V);if(Z=Function("binder","return function ("+W.join(",")+"){ return binder.apply(this,arguments); }")(j),U.prototype){var Q=function(){};Q.prototype=U.prototype,Z.prototype=new Q,Q.prototype=null}return Z}},{}],38:[function(d,m,g){var w=d("./implementation");m.exports=Function.prototype.bind||w},{"./implementation":37}],39:[function(d,m,g){var w,I=SyntaxError,P=Function,F=TypeError,D=function(Et){try{return P('"use strict"; return ('+Et+").constructor;")()}catch{}},U=Object.getOwnPropertyDescriptor;if(U)try{U({},"")}catch{U=null}var Z=function(){throw new F},$=U?function(){try{return Z}catch{try{return U(arguments,"callee").get}catch{return Z}}}():Z,j=d("has-symbols")(),H=Object.getPrototypeOf||function(Et){return Et.__proto__},W={},V=typeof Uint8Array>"u"?w:H(Uint8Array),Q={"%AggregateError%":typeof AggregateError>"u"?w:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?w:ArrayBuffer,"%ArrayIteratorPrototype%":j?H([][Symbol.iterator]()):w,"%AsyncFromSyncIteratorPrototype%":w,"%AsyncFunction%":W,"%AsyncGenerator%":W,"%AsyncGeneratorFunction%":W,"%AsyncIteratorPrototype%":W,"%Atomics%":typeof Atomics>"u"?w:Atomics,"%BigInt%":typeof BigInt>"u"?w:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?w:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?w:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?w:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array>"u"?w:Float32Array,"%Float64Array%":typeof Float64Array>"u"?w:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?w:FinalizationRegistry,"%Function%":P,"%GeneratorFunction%":W,"%Int8Array%":typeof Int8Array>"u"?w:Int8Array,"%Int16Array%":typeof Int16Array>"u"?w:Int16Array,"%Int32Array%":typeof Int32Array>"u"?w:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":j?H(H([][Symbol.iterator]())):w,"%JSON%":typeof JSON=="object"?JSON:w,"%Map%":typeof Map>"u"?w:Map,"%MapIteratorPrototype%":typeof Map<"u"&&j?H(new Map()[Symbol.iterator]()):w,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?w:Promise,"%Proxy%":typeof Proxy>"u"?w:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect>"u"?w:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?w:Set,"%SetIteratorPrototype%":typeof Set<"u"&&j?H(new Set()[Symbol.iterator]()):w,"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?w:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":j?H(""[Symbol.iterator]()):w,"%Symbol%":j?Symbol:w,"%SyntaxError%":I,"%ThrowTypeError%":$,"%TypedArray%":V,"%TypeError%":F,"%Uint8Array%":typeof Uint8Array>"u"?w:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?w:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?w:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?w:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap>"u"?w:WeakMap,"%WeakRef%":typeof WeakRef>"u"?w:WeakRef,"%WeakSet%":typeof WeakSet>"u"?w:WeakSet};try{null.error}catch(Et){var K=H(H(Et));Q["%Error.prototype%"]=K}var q=function Et(gt){var pt;if(gt==="%AsyncFunction%")pt=D("async function () {}");else if(gt==="%GeneratorFunction%")pt=D("function* () {}");else if(gt==="%AsyncGeneratorFunction%")pt=D("async function* () {}");else if(gt==="%AsyncGenerator%"){var vt=Et("%AsyncGeneratorFunction%");vt&&(pt=vt.prototype)}else if(gt==="%AsyncIteratorPrototype%"){var Tt=Et("%AsyncGenerator%");Tt&&(pt=H(Tt.prototype))}return Q[gt]=pt,pt},et={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},X=d("function-bind"),tt=d("has"),rt=X.call(Function.call,Array.prototype.concat),ot=X.call(Function.apply,Array.prototype.splice),J=X.call(Function.call,String.prototype.replace),lt=X.call(Function.call,String.prototype.slice),st=X.call(Function.call,RegExp.prototype.exec),ut=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,it=/\\(\\)?/g,ct=function(Et){var gt=lt(Et,0,1),pt=lt(Et,-1);if(gt==="%"&&pt!=="%")throw new I("invalid intrinsic syntax, expected closing `%`");if(pt==="%"&&gt!=="%")throw new I("invalid intrinsic syntax, expected opening `%`");var vt=[];return J(Et,ut,function(Tt,It,$t,Bt){vt[vt.length]=$t?J(Bt,it,"$1"):It||Tt}),vt},At=function(Et,gt){var pt,vt=Et;if(tt(et,vt)&&(vt="%"+(pt=et[vt])[0]+"%"),tt(Q,vt)){var Tt=Q[vt];if(Tt===W&&(Tt=q(vt)),Tt===void 0&&!gt)throw new F("intrinsic "+Et+" exists, but is not available. Please file an issue!");return{alias:pt,name:vt,value:Tt}}throw new I("intrinsic "+Et+" does not exist!")};m.exports=function(Et,gt){if(typeof Et!="string"||Et.length===0)throw new F("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof gt!="boolean")throw new F('"allowMissing" argument must be a boolean');if(st(/^%?[^%]*%?$/,Et)===null)throw new I("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var pt=ct(Et),vt=pt.length>0?pt[0]:"",Tt=At("%"+vt+"%",gt),It=Tt.name,$t=Tt.value,Bt=!1,zt=Tt.alias;zt&&(vt=zt[0],ot(pt,rt([0,1],zt)));for(var Ot=1,Nt=!0;Ot<pt.length;Ot+=1){var Pt=pt[Ot],Ut=lt(Pt,0,1),Ft=lt(Pt,-1);if((Ut==='"'||Ut==="'"||Ut==="`"||Ft==='"'||Ft==="'"||Ft==="`")&&Ut!==Ft)throw new I("property names with quotes must have matching quotes");if(Pt!=="constructor"&&Nt||(Bt=!0),tt(Q,It="%"+(vt+="."+Pt)+"%"))$t=Q[It];else if($t!=null){if(!(Pt in $t)){if(!gt)throw new F("base intrinsic for "+Et+" exists, but the property is not available.");return}if(U&&Ot+1>=pt.length){var Zt=U($t,Pt);$t=(Nt=!!Zt)&&"get"in Zt&&!("originalValue"in Zt.get)?Zt.get:$t[Pt]}else Nt=tt($t,Pt),$t=$t[Pt];Nt&&!Bt&&(Q[It]=$t)}}return $t}},{"function-bind":38,has:44,"has-symbols":41}],40:[function(d,m,g){var w=d("get-intrinsic")("%Object.getOwnPropertyDescriptor%",!0);if(w)try{w([],"length")}catch{w=null}m.exports=w},{"get-intrinsic":39}],41:[function(d,m,g){var w=typeof Symbol<"u"&&Symbol,I=d("./shams");m.exports=function(){return typeof w=="function"&&typeof Symbol=="function"&&typeof w("foo")=="symbol"&&typeof Symbol("bar")=="symbol"&&I()}},{"./shams":42}],42:[function(d,m,g){m.exports=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var w={},I=Symbol("test"),P=Object(I);if(typeof I=="string"||Object.prototype.toString.call(I)!=="[object Symbol]"||Object.prototype.toString.call(P)!=="[object Symbol]")return!1;var F=42;for(I in w[I]=F,w)return!1;if(typeof Object.keys=="function"&&Object.keys(w).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(w).length!==0)return!1;var D=Object.getOwnPropertySymbols(w);if(D.length!==1||D[0]!==I||!Object.prototype.propertyIsEnumerable.call(w,I))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var U=Object.getOwnPropertyDescriptor(w,I);if(U.value!==F||U.enumerable!==!0)return!1}return!0}},{}],43:[function(d,m,g){var w=d("has-symbols/shams");m.exports=function(){return w()&&!!Symbol.toStringTag}},{"has-symbols/shams":42}],44:[function(d,m,g){var w=d("function-bind");m.exports=w.call(Function.call,Object.prototype.hasOwnProperty)},{"function-bind":38}],45:[function(d,m,g){/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */g.read=function(w,I,P,F,D){var U,Z,$=8*D-F-1,j=(1<<$)-1,H=j>>1,W=-7,V=P?D-1:0,Q=P?-1:1,K=w[I+V];for(V+=Q,U=K&(1<<-W)-1,K>>=-W,W+=$;W>0;U=256*U+w[I+V],V+=Q,W-=8);for(Z=U&(1<<-W)-1,U>>=-W,W+=F;W>0;Z=256*Z+w[I+V],V+=Q,W-=8);if(U===0)U=1-H;else{if(U===j)return Z?NaN:1/0*(K?-1:1);Z+=Math.pow(2,F),U-=H}return(K?-1:1)*Z*Math.pow(2,U-F)},g.write=function(w,I,P,F,D,U){var Z,$,j,H=8*U-D-1,W=(1<<H)-1,V=W>>1,Q=D===23?Math.pow(2,-24)-Math.pow(2,-77):0,K=F?0:U-1,q=F?1:-1,et=I<0||I===0&&1/I<0?1:0;for(I=Math.abs(I),isNaN(I)||I===1/0?($=isNaN(I)?1:0,Z=W):(Z=Math.floor(Math.log(I)/Math.LN2),I*(j=Math.pow(2,-Z))<1&&(Z--,j*=2),(I+=Z+V>=1?Q/j:Q*Math.pow(2,1-V))*j>=2&&(Z++,j/=2),Z+V>=W?($=0,Z=W):Z+V>=1?($=(I*j-1)*Math.pow(2,D),Z+=V):($=I*Math.pow(2,V-1)*Math.pow(2,D),Z=0));D>=8;w[P+K]=255&$,K+=q,$/=256,D-=8);for(Z=Z<<D|$,H+=D;H>0;w[P+K]=255&Z,K+=q,Z/=256,H-=8);w[P+K-q]|=128*et}},{}],46:[function(d,m,g){typeof Object.create=="function"?m.exports=function(w,I){I&&(w.super_=I,w.prototype=Object.create(I.prototype,{constructor:{value:w,enumerable:!1,writable:!0,configurable:!0}}))}:m.exports=function(w,I){if(I){w.super_=I;var P=function(){};P.prototype=I.prototype,w.prototype=new P,w.prototype.constructor=w}}},{}],47:[function(d,m,g){var w=d("has-tostringtag/shams")(),I=d("call-bind/callBound")("Object.prototype.toString"),P=function(U){return!(w&&U&&typeof U=="object"&&Symbol.toStringTag in U)&&I(U)==="[object Arguments]"},F=function(U){return!!P(U)||U!==null&&typeof U=="object"&&typeof U.length=="number"&&U.length>=0&&I(U)!=="[object Array]"&&I(U.callee)==="[object Function]"},D=function(){return P(arguments)}();P.isLegacyArguments=F,m.exports=D?P:F},{"call-bind/callBound":33,"has-tostringtag/shams":43}],48:[function(d,m,g){var w,I,P=Function.prototype.toString,F=typeof Reflect=="object"&&Reflect!==null&&Reflect.apply;if(typeof F=="function"&&typeof Object.defineProperty=="function")try{w=Object.defineProperty({},"length",{get:function(){throw I}}),I={},F(function(){throw 42},null,w)}catch(rt){rt!==I&&(F=null)}else F=null;var D=/^\s*class\b/,U=function(rt){try{var ot=P.call(rt);return D.test(ot)}catch{return!1}},Z=function(rt){try{return!U(rt)&&(P.call(rt),!0)}catch{return!1}},$=Object.prototype.toString,j="[object Object]",H="[object Function]",W="[object GeneratorFunction]",V="[object HTMLAllCollection]",Q="[object HTML document.all class]",K="[object HTMLCollection]",q=typeof Symbol=="function"&&!!Symbol.toStringTag,et=!(0 in[,]),X=function(){return!1};if(typeof document=="object"){var tt=document.all;$.call(tt)===$.call(document.all)&&(X=function(rt){if((et||!rt)&&(rt===void 0||typeof rt=="object"))try{var ot=$.call(rt);return(ot===V||ot===Q||ot===K||ot===j)&&rt("")==null}catch{}return!1})}m.exports=F?function(rt){if(X(rt))return!0;if(!rt||typeof rt!="function"&&typeof rt!="object")return!1;try{F(rt,null,w)}catch(ot){if(ot!==I)return!1}return!U(rt)&&Z(rt)}:function(rt){if(X(rt))return!0;if(!rt||typeof rt!="function"&&typeof rt!="object")return!1;if(q)return Z(rt);if(U(rt))return!1;var ot=$.call(rt);return!(ot!==H&&ot!==W&&!/^\[object HTML/.test(ot))&&Z(rt)}},{}],49:[function(d,m,g){var w,I=Object.prototype.toString,P=Function.prototype.toString,F=/^\s*(?:function)?\*/,D=d("has-tostringtag/shams")(),U=Object.getPrototypeOf,Z=function(){if(!D)return!1;try{return Function("return function*() {}")()}catch{}};m.exports=function($){if(typeof $!="function")return!1;if(F.test(P.call($)))return!0;if(!D)return I.call($)==="[object GeneratorFunction]";if(!U)return!1;if(w===void 0){var j=Z();w=!!j&&U(j)}return U($)===w}},{"has-tostringtag/shams":43}],50:[function(d,m,g){(function(w){(function(){var I=d("for-each"),P=d("available-typed-arrays"),F=d("call-bind/callBound"),D=F("Object.prototype.toString"),U=d("has-tostringtag/shams")(),Z=d("gopd"),$=typeof globalThis>"u"?w:globalThis,j=P(),H=F("Array.prototype.indexOf",!0)||function(q,et){for(var X=0;X<q.length;X+=1)if(q[X]===et)return X;return-1},W=F("String.prototype.slice"),V={},Q=Object.getPrototypeOf;U&&Z&&Q&&I(j,function(q){var et=new $[q];if(Symbol.toStringTag in et){var X=Q(et),tt=Z(X,Symbol.toStringTag);if(!tt){var rt=Q(X);tt=Z(rt,Symbol.toStringTag)}V[q]=tt.get}});var K=function(q){var et=!1;return I(V,function(X,tt){if(!et)try{et=X.call(q)===tt}catch{}}),et};m.exports=function(q){if(!q||typeof q!="object")return!1;if(!U||!(Symbol.toStringTag in q)){var et=W(D(q),8,-1);return H(j,et)>-1}return!!Z&&K(q)}}).call(this)}).call(this,commonjsGlobal!==void 0?commonjsGlobal:typeof self<"u"?self:typeof window<"u"?window:{})},{"available-typed-arrays":27,"call-bind/callBound":33,"for-each":36,gopd:40,"has-tostringtag/shams":43}],51:[function(d,m,g){var w=Object.getOwnPropertySymbols,I=Object.prototype.hasOwnProperty,P=Object.prototype.propertyIsEnumerable;function F(U){if(U==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(U)}function D(){try{if(!Object.assign)return!1;var U=new String("abc");if(U[5]="de",Object.getOwnPropertyNames(U)[0]==="5")return!1;for(var Z={},$=0;$<10;$++)Z["_"+String.fromCharCode($)]=$;var j=Object.getOwnPropertyNames(Z).map(function(W){return Z[W]});if(j.join("")!=="0123456789")return!1;var H={};return"abcdefghijklmnopqrst".split("").forEach(function(W){H[W]=W}),Object.keys(Object.assign({},H)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}m.exports=D()?Object.assign:function(U,Z){for(var $,j,H=F(U),W=1;W<arguments.length;W++){for(var V in $=Object(arguments[W]))I.call($,V)&&(H[V]=$[V]);if(w){j=w($);for(var Q=0;Q<j.length;Q++)P.call($,j[Q])&&(H[j[Q]]=$[j[Q]])}}return H}},{}],52:[function(d,m,g){var w=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";function I(D,U){return Object.prototype.hasOwnProperty.call(D,U)}g.assign=function(D){for(var U=Array.prototype.slice.call(arguments,1);U.length;){var Z=U.shift();if(Z){if(typeof Z!="object")throw new TypeError(Z+"must be non-object");for(var $ in Z)I(Z,$)&&(D[$]=Z[$])}}return D},g.shrinkBuf=function(D,U){return D.length===U?D:D.subarray?D.subarray(0,U):(D.length=U,D)};var P={arraySet:function(D,U,Z,$,j){if(U.subarray&&D.subarray)D.set(U.subarray(Z,Z+$),j);else for(var H=0;H<$;H++)D[j+H]=U[Z+H]},flattenChunks:function(D){var U,Z,$,j,H,W;for($=0,U=0,Z=D.length;U<Z;U++)$+=D[U].length;for(W=new Uint8Array($),j=0,U=0,Z=D.length;U<Z;U++)H=D[U],W.set(H,j),j+=H.length;return W}},F={arraySet:function(D,U,Z,$,j){for(var H=0;H<$;H++)D[j+H]=U[Z+H]},flattenChunks:function(D){return[].concat.apply([],D)}};g.setTyped=function(D){D?(g.Buf8=Uint8Array,g.Buf16=Uint16Array,g.Buf32=Int32Array,g.assign(g,P)):(g.Buf8=Array,g.Buf16=Array,g.Buf32=Array,g.assign(g,F))},g.setTyped(w)},{}],53:[function(d,m,g){function w(I,P,F,D){for(var U=65535&I,Z=I>>>16&65535,$=0;F!==0;){F-=$=F>2e3?2e3:F;do Z=Z+(U=U+P[D++]|0)|0;while(--$);U%=65521,Z%=65521}return U|Z<<16}m.exports=w},{}],54:[function(d,m,g){m.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],55:[function(d,m,g){function w(){for(var F,D=[],U=0;U<256;U++){F=U;for(var Z=0;Z<8;Z++)F=1&F?3988292384^F>>>1:F>>>1;D[U]=F}return D}var I=w();function P(F,D,U,Z){var $=I,j=Z+U;F^=-1;for(var H=Z;H<j;H++)F=F>>>8^$[255&(F^D[H])];return~F}m.exports=P},{}],56:[function(d,m,g){var w,I=d("../utils/common"),P=d("./trees"),F=d("./adler32"),D=d("./crc32"),U=d("./messages"),Z=0,$=1,j=3,H=4,W=5,V=0,Q=1,K=-2,q=-3,et=-5,X=-1,tt=1,rt=2,ot=3,J=4,lt=0,st=2,ut=8,it=9,ct=15,At=8,Et=286,gt=30,pt=19,vt=2*Et+1,Tt=15,It=3,$t=258,Bt=$t+It+1,zt=32,Ot=42,Nt=69,Pt=73,Ut=91,Ft=103,Zt=113,Ht=666,Dt=1,dt=2,Lt=3,bt=4,wt=3;function xt(yt,Mt){return yt.msg=U[Mt],Mt}function Rt(yt){return(yt<<1)-(yt>4?9:0)}function Gt(yt){for(var Mt=yt.length;--Mt>=0;)yt[Mt]=0}function nt(yt){var Mt=yt.state,Yt=Mt.pending;Yt>yt.avail_out&&(Yt=yt.avail_out),Yt!==0&&(I.arraySet(yt.output,Mt.pending_buf,Mt.pending_out,Yt,yt.next_out),yt.next_out+=Yt,Mt.pending_out+=Yt,yt.total_out+=Yt,yt.avail_out-=Yt,Mt.pending-=Yt,Mt.pending===0&&(Mt.pending_out=0))}function ht(yt,Mt){P._tr_flush_block(yt,yt.block_start>=0?yt.block_start:-1,yt.strstart-yt.block_start,Mt),yt.block_start=yt.strstart,nt(yt.strm)}function ft(yt,Mt){yt.pending_buf[yt.pending++]=Mt}function at(yt,Mt){yt.pending_buf[yt.pending++]=Mt>>>8&255,yt.pending_buf[yt.pending++]=255&Mt}function _t(yt,Mt,Yt,Qt){var mt=yt.avail_in;return mt>Qt&&(mt=Qt),mt===0?0:(yt.avail_in-=mt,I.arraySet(Mt,yt.input,yt.next_in,mt,Yt),yt.state.wrap===1?yt.adler=F(yt.adler,Mt,mt,Yt):yt.state.wrap===2&&(yt.adler=D(yt.adler,Mt,mt,Yt)),yt.next_in+=mt,yt.total_in+=mt,mt)}function St(yt,Mt){var Yt,Qt,mt=yt.max_chain_length,qt=yt.strstart,ie=yt.prev_length,jt=yt.nice_match,Kt=yt.strstart>yt.w_size-Bt?yt.strstart-(yt.w_size-Bt):0,ne=yt.window,pe=yt.w_mask,ce=yt.prev,de=yt.strstart+$t,ge=ne[qt+ie-1],ve=ne[qt+ie];yt.prev_length>=yt.good_match&&(mt>>=2),jt>yt.lookahead&&(jt=yt.lookahead);do if(ne[(Yt=Mt)+ie]===ve&&ne[Yt+ie-1]===ge&&ne[Yt]===ne[qt]&&ne[++Yt]===ne[qt+1]){qt+=2,Yt++;do;while(ne[++qt]===ne[++Yt]&&ne[++qt]===ne[++Yt]&&ne[++qt]===ne[++Yt]&&ne[++qt]===ne[++Yt]&&ne[++qt]===ne[++Yt]&&ne[++qt]===ne[++Yt]&&ne[++qt]===ne[++Yt]&&ne[++qt]===ne[++Yt]&&qt<de);if(Qt=$t-(de-qt),qt=de-$t,Qt>ie){if(yt.match_start=Mt,ie=Qt,Qt>=jt)break;ge=ne[qt+ie-1],ve=ne[qt+ie]}}while((Mt=ce[Mt&pe])>Kt&&--mt!=0);return ie<=yt.lookahead?ie:yt.lookahead}function Vt(yt){var Mt,Yt,Qt,mt,qt,ie=yt.w_size;do{if(mt=yt.window_size-yt.lookahead-yt.strstart,yt.strstart>=ie+(ie-Bt)){I.arraySet(yt.window,yt.window,ie,ie,0),yt.match_start-=ie,yt.strstart-=ie,yt.block_start-=ie,Mt=Yt=yt.hash_size;do Qt=yt.head[--Mt],yt.head[Mt]=Qt>=ie?Qt-ie:0;while(--Yt);Mt=Yt=ie;do Qt=yt.prev[--Mt],yt.prev[Mt]=Qt>=ie?Qt-ie:0;while(--Yt);mt+=ie}if(yt.strm.avail_in===0)break;if(Yt=_t(yt.strm,yt.window,yt.strstart+yt.lookahead,mt),yt.lookahead+=Yt,yt.lookahead+yt.insert>=It)for(qt=yt.strstart-yt.insert,yt.ins_h=yt.window[qt],yt.ins_h=(yt.ins_h<<yt.hash_shift^yt.window[qt+1])&yt.hash_mask;yt.insert&&(yt.ins_h=(yt.ins_h<<yt.hash_shift^yt.window[qt+It-1])&yt.hash_mask,yt.prev[qt&yt.w_mask]=yt.head[yt.ins_h],yt.head[yt.ins_h]=qt,qt++,yt.insert--,!(yt.lookahead+yt.insert<It)););}while(yt.lookahead<Bt&&yt.strm.avail_in!==0)}function ee(yt,Mt){var Yt=65535;for(Yt>yt.pending_buf_size-5&&(Yt=yt.pending_buf_size-5);;){if(yt.lookahead<=1){if(Vt(yt),yt.lookahead===0&&Mt===Z)return Dt;if(yt.lookahead===0)break}yt.strstart+=yt.lookahead,yt.lookahead=0;var Qt=yt.block_start+Yt;if((yt.strstart===0||yt.strstart>=Qt)&&(yt.lookahead=yt.strstart-Qt,yt.strstart=Qt,ht(yt,!1),yt.strm.avail_out===0)||yt.strstart-yt.block_start>=yt.w_size-Bt&&(ht(yt,!1),yt.strm.avail_out===0))return Dt}return yt.insert=0,Mt===H?(ht(yt,!0),yt.strm.avail_out===0?Lt:bt):(yt.strstart>yt.block_start&&(ht(yt,!1),yt.strm.avail_out),Dt)}function Jt(yt,Mt){for(var Yt,Qt;;){if(yt.lookahead<Bt){if(Vt(yt),yt.lookahead<Bt&&Mt===Z)return Dt;if(yt.lookahead===0)break}if(Yt=0,yt.lookahead>=It&&(yt.ins_h=(yt.ins_h<<yt.hash_shift^yt.window[yt.strstart+It-1])&yt.hash_mask,Yt=yt.prev[yt.strstart&yt.w_mask]=yt.head[yt.ins_h],yt.head[yt.ins_h]=yt.strstart),Yt!==0&&yt.strstart-Yt<=yt.w_size-Bt&&(yt.match_length=St(yt,Yt)),yt.match_length>=It)if(Qt=P._tr_tally(yt,yt.strstart-yt.match_start,yt.match_length-It),yt.lookahead-=yt.match_length,yt.match_length<=yt.max_lazy_match&&yt.lookahead>=It){yt.match_length--;do yt.strstart++,yt.ins_h=(yt.ins_h<<yt.hash_shift^yt.window[yt.strstart+It-1])&yt.hash_mask,Yt=yt.prev[yt.strstart&yt.w_mask]=yt.head[yt.ins_h],yt.head[yt.ins_h]=yt.strstart;while(--yt.match_length!=0);yt.strstart++}else yt.strstart+=yt.match_length,yt.match_length=0,yt.ins_h=yt.window[yt.strstart],yt.ins_h=(yt.ins_h<<yt.hash_shift^yt.window[yt.strstart+1])&yt.hash_mask;else Qt=P._tr_tally(yt,0,yt.window[yt.strstart]),yt.lookahead--,yt.strstart++;if(Qt&&(ht(yt,!1),yt.strm.avail_out===0))return Dt}return yt.insert=yt.strstart<It-1?yt.strstart:It-1,Mt===H?(ht(yt,!0),yt.strm.avail_out===0?Lt:bt):yt.last_lit&&(ht(yt,!1),yt.strm.avail_out===0)?Dt:dt}function se(yt,Mt){for(var Yt,Qt,mt;;){if(yt.lookahead<Bt){if(Vt(yt),yt.lookahead<Bt&&Mt===Z)return Dt;if(yt.lookahead===0)break}if(Yt=0,yt.lookahead>=It&&(yt.ins_h=(yt.ins_h<<yt.hash_shift^yt.window[yt.strstart+It-1])&yt.hash_mask,Yt=yt.prev[yt.strstart&yt.w_mask]=yt.head[yt.ins_h],yt.head[yt.ins_h]=yt.strstart),yt.prev_length=yt.match_length,yt.prev_match=yt.match_start,yt.match_length=It-1,Yt!==0&&yt.prev_length<yt.max_lazy_match&&yt.strstart-Yt<=yt.w_size-Bt&&(yt.match_length=St(yt,Yt),yt.match_length<=5&&(yt.strategy===tt||yt.match_length===It&&yt.strstart-yt.match_start>4096)&&(yt.match_length=It-1)),yt.prev_length>=It&&yt.match_length<=yt.prev_length){mt=yt.strstart+yt.lookahead-It,Qt=P._tr_tally(yt,yt.strstart-1-yt.prev_match,yt.prev_length-It),yt.lookahead-=yt.prev_length-1,yt.prev_length-=2;do++yt.strstart<=mt&&(yt.ins_h=(yt.ins_h<<yt.hash_shift^yt.window[yt.strstart+It-1])&yt.hash_mask,Yt=yt.prev[yt.strstart&yt.w_mask]=yt.head[yt.ins_h],yt.head[yt.ins_h]=yt.strstart);while(--yt.prev_length!=0);if(yt.match_available=0,yt.match_length=It-1,yt.strstart++,Qt&&(ht(yt,!1),yt.strm.avail_out===0))return Dt}else if(yt.match_available){if((Qt=P._tr_tally(yt,0,yt.window[yt.strstart-1]))&&ht(yt,!1),yt.strstart++,yt.lookahead--,yt.strm.avail_out===0)return Dt}else yt.match_available=1,yt.strstart++,yt.lookahead--}return yt.match_available&&(Qt=P._tr_tally(yt,0,yt.window[yt.strstart-1]),yt.match_available=0),yt.insert=yt.strstart<It-1?yt.strstart:It-1,Mt===H?(ht(yt,!0),yt.strm.avail_out===0?Lt:bt):yt.last_lit&&(ht(yt,!1),yt.strm.avail_out===0)?Dt:dt}function ae(yt,Mt){for(var Yt,Qt,mt,qt,ie=yt.window;;){if(yt.lookahead<=$t){if(Vt(yt),yt.lookahead<=$t&&Mt===Z)return Dt;if(yt.lookahead===0)break}if(yt.match_length=0,yt.lookahead>=It&&yt.strstart>0&&(Qt=ie[mt=yt.strstart-1])===ie[++mt]&&Qt===ie[++mt]&&Qt===ie[++mt]){qt=yt.strstart+$t;do;while(Qt===ie[++mt]&&Qt===ie[++mt]&&Qt===ie[++mt]&&Qt===ie[++mt]&&Qt===ie[++mt]&&Qt===ie[++mt]&&Qt===ie[++mt]&&Qt===ie[++mt]&&mt<qt);yt.match_length=$t-(qt-mt),yt.match_length>yt.lookahead&&(yt.match_length=yt.lookahead)}if(yt.match_length>=It?(Yt=P._tr_tally(yt,1,yt.match_length-It),yt.lookahead-=yt.match_length,yt.strstart+=yt.match_length,yt.match_length=0):(Yt=P._tr_tally(yt,0,yt.window[yt.strstart]),yt.lookahead--,yt.strstart++),Yt&&(ht(yt,!1),yt.strm.avail_out===0))return Dt}return yt.insert=0,Mt===H?(ht(yt,!0),yt.strm.avail_out===0?Lt:bt):yt.last_lit&&(ht(yt,!1),yt.strm.avail_out===0)?Dt:dt}function fe(yt,Mt){for(var Yt;;){if(yt.lookahead===0&&(Vt(yt),yt.lookahead===0)){if(Mt===Z)return Dt;break}if(yt.match_length=0,Yt=P._tr_tally(yt,0,yt.window[yt.strstart]),yt.lookahead--,yt.strstart++,Yt&&(ht(yt,!1),yt.strm.avail_out===0))return Dt}return yt.insert=0,Mt===H?(ht(yt,!0),yt.strm.avail_out===0?Lt:bt):yt.last_lit&&(ht(yt,!1),yt.strm.avail_out===0)?Dt:dt}function le(yt,Mt,Yt,Qt,mt){this.good_length=yt,this.max_lazy=Mt,this.nice_length=Yt,this.max_chain=Qt,this.func=mt}function ue(yt){yt.window_size=2*yt.w_size,Gt(yt.head),yt.max_lazy_match=w[yt.level].max_lazy,yt.good_match=w[yt.level].good_length,yt.nice_match=w[yt.level].nice_length,yt.max_chain_length=w[yt.level].max_chain,yt.strstart=0,yt.block_start=0,yt.lookahead=0,yt.insert=0,yt.match_length=yt.prev_length=It-1,yt.match_available=0,yt.ins_h=0}function me(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=ut,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new I.Buf16(2*vt),this.dyn_dtree=new I.Buf16(2*(2*gt+1)),this.bl_tree=new I.Buf16(2*(2*pt+1)),Gt(this.dyn_ltree),Gt(this.dyn_dtree),Gt(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new I.Buf16(Tt+1),this.heap=new I.Buf16(2*Et+1),Gt(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new I.Buf16(2*Et+1),Gt(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function he(yt){var Mt;return yt&&yt.state?(yt.total_in=yt.total_out=0,yt.data_type=st,(Mt=yt.state).pending=0,Mt.pending_out=0,Mt.wrap<0&&(Mt.wrap=-Mt.wrap),Mt.status=Mt.wrap?Ot:Zt,yt.adler=Mt.wrap===2?0:1,Mt.last_flush=Z,P._tr_init(Mt),V):xt(yt,K)}function Wt(yt){var Mt=he(yt);return Mt===V&&ue(yt.state),Mt}function oe(yt,Mt){return yt&&yt.state?yt.state.wrap!==2?K:(yt.state.gzhead=Mt,V):K}function kt(yt,Mt,Yt,Qt,mt,qt){if(!yt)return K;var ie=1;if(Mt===X&&(Mt=6),Qt<0?(ie=0,Qt=-Qt):Qt>15&&(ie=2,Qt-=16),mt<1||mt>it||Yt!==ut||Qt<8||Qt>15||Mt<0||Mt>9||qt<0||qt>J)return xt(yt,K);Qt===8&&(Qt=9);var jt=new me;return yt.state=jt,jt.strm=yt,jt.wrap=ie,jt.gzhead=null,jt.w_bits=Qt,jt.w_size=1<<jt.w_bits,jt.w_mask=jt.w_size-1,jt.hash_bits=mt+7,jt.hash_size=1<<jt.hash_bits,jt.hash_mask=jt.hash_size-1,jt.hash_shift=~~((jt.hash_bits+It-1)/It),jt.window=new I.Buf8(2*jt.w_size),jt.head=new I.Buf16(jt.hash_size),jt.prev=new I.Buf16(jt.w_size),jt.lit_bufsize=1<<mt+6,jt.pending_buf_size=4*jt.lit_bufsize,jt.pending_buf=new I.Buf8(jt.pending_buf_size),jt.d_buf=1*jt.lit_bufsize,jt.l_buf=3*jt.lit_bufsize,jt.level=Mt,jt.strategy=qt,jt.method=Yt,Wt(yt)}function Xt(yt,Mt){return kt(yt,Mt,ut,ct,At,lt)}function Ct(yt,Mt){var Yt,Qt,mt,qt;if(!yt||!yt.state||Mt>W||Mt<0)return yt?xt(yt,K):K;if(Qt=yt.state,!yt.output||!yt.input&&yt.avail_in!==0||Qt.status===Ht&&Mt!==H)return xt(yt,yt.avail_out===0?et:K);if(Qt.strm=yt,Yt=Qt.last_flush,Qt.last_flush=Mt,Qt.status===Ot)if(Qt.wrap===2)yt.adler=0,ft(Qt,31),ft(Qt,139),ft(Qt,8),Qt.gzhead?(ft(Qt,(Qt.gzhead.text?1:0)+(Qt.gzhead.hcrc?2:0)+(Qt.gzhead.extra?4:0)+(Qt.gzhead.name?8:0)+(Qt.gzhead.comment?16:0)),ft(Qt,255&Qt.gzhead.time),ft(Qt,Qt.gzhead.time>>8&255),ft(Qt,Qt.gzhead.time>>16&255),ft(Qt,Qt.gzhead.time>>24&255),ft(Qt,Qt.level===9?2:Qt.strategy>=rt||Qt.level<2?4:0),ft(Qt,255&Qt.gzhead.os),Qt.gzhead.extra&&Qt.gzhead.extra.length&&(ft(Qt,255&Qt.gzhead.extra.length),ft(Qt,Qt.gzhead.extra.length>>8&255)),Qt.gzhead.hcrc&&(yt.adler=D(yt.adler,Qt.pending_buf,Qt.pending,0)),Qt.gzindex=0,Qt.status=Nt):(ft(Qt,0),ft(Qt,0),ft(Qt,0),ft(Qt,0),ft(Qt,0),ft(Qt,Qt.level===9?2:Qt.strategy>=rt||Qt.level<2?4:0),ft(Qt,wt),Qt.status=Zt);else{var ie=ut+(Qt.w_bits-8<<4)<<8;ie|=(Qt.strategy>=rt||Qt.level<2?0:Qt.level<6?1:Qt.level===6?2:3)<<6,Qt.strstart!==0&&(ie|=zt),ie+=31-ie%31,Qt.status=Zt,at(Qt,ie),Qt.strstart!==0&&(at(Qt,yt.adler>>>16),at(Qt,65535&yt.adler)),yt.adler=1}if(Qt.status===Nt)if(Qt.gzhead.extra){for(mt=Qt.pending;Qt.gzindex<(65535&Qt.gzhead.extra.length)&&(Qt.pending!==Qt.pending_buf_size||(Qt.gzhead.hcrc&&Qt.pending>mt&&(yt.adler=D(yt.adler,Qt.pending_buf,Qt.pending-mt,mt)),nt(yt),mt=Qt.pending,Qt.pending!==Qt.pending_buf_size));)ft(Qt,255&Qt.gzhead.extra[Qt.gzindex]),Qt.gzindex++;Qt.gzhead.hcrc&&Qt.pending>mt&&(yt.adler=D(yt.adler,Qt.pending_buf,Qt.pending-mt,mt)),Qt.gzindex===Qt.gzhead.extra.length&&(Qt.gzindex=0,Qt.status=Pt)}else Qt.status=Pt;if(Qt.status===Pt)if(Qt.gzhead.name){mt=Qt.pending;do{if(Qt.pending===Qt.pending_buf_size&&(Qt.gzhead.hcrc&&Qt.pending>mt&&(yt.adler=D(yt.adler,Qt.pending_buf,Qt.pending-mt,mt)),nt(yt),mt=Qt.pending,Qt.pending===Qt.pending_buf_size)){qt=1;break}qt=Qt.gzindex<Qt.gzhead.name.length?255&Qt.gzhead.name.charCodeAt(Qt.gzindex++):0,ft(Qt,qt)}while(qt!==0);Qt.gzhead.hcrc&&Qt.pending>mt&&(yt.adler=D(yt.adler,Qt.pending_buf,Qt.pending-mt,mt)),qt===0&&(Qt.gzindex=0,Qt.status=Ut)}else Qt.status=Ut;if(Qt.status===Ut)if(Qt.gzhead.comment){mt=Qt.pending;do{if(Qt.pending===Qt.pending_buf_size&&(Qt.gzhead.hcrc&&Qt.pending>mt&&(yt.adler=D(yt.adler,Qt.pending_buf,Qt.pending-mt,mt)),nt(yt),mt=Qt.pending,Qt.pending===Qt.pending_buf_size)){qt=1;break}qt=Qt.gzindex<Qt.gzhead.comment.length?255&Qt.gzhead.comment.charCodeAt(Qt.gzindex++):0,ft(Qt,qt)}while(qt!==0);Qt.gzhead.hcrc&&Qt.pending>mt&&(yt.adler=D(yt.adler,Qt.pending_buf,Qt.pending-mt,mt)),qt===0&&(Qt.status=Ft)}else Qt.status=Ft;if(Qt.status===Ft&&(Qt.gzhead.hcrc?(Qt.pending+2>Qt.pending_buf_size&&nt(yt),Qt.pending+2<=Qt.pending_buf_size&&(ft(Qt,255&yt.adler),ft(Qt,yt.adler>>8&255),yt.adler=0,Qt.status=Zt)):Qt.status=Zt),Qt.pending!==0){if(nt(yt),yt.avail_out===0)return Qt.last_flush=-1,V}else if(yt.avail_in===0&&Rt(Mt)<=Rt(Yt)&&Mt!==H)return xt(yt,et);if(Qt.status===Ht&&yt.avail_in!==0)return xt(yt,et);if(yt.avail_in!==0||Qt.lookahead!==0||Mt!==Z&&Qt.status!==Ht){var jt=Qt.strategy===rt?fe(Qt,Mt):Qt.strategy===ot?ae(Qt,Mt):w[Qt.level].func(Qt,Mt);if(jt!==Lt&&jt!==bt||(Qt.status=Ht),jt===Dt||jt===Lt)return yt.avail_out===0&&(Qt.last_flush=-1),V;if(jt===dt&&(Mt===$?P._tr_align(Qt):Mt!==W&&(P._tr_stored_block(Qt,0,0,!1),Mt===j&&(Gt(Qt.head),Qt.lookahead===0&&(Qt.strstart=0,Qt.block_start=0,Qt.insert=0))),nt(yt),yt.avail_out===0))return Qt.last_flush=-1,V}return Mt!==H?V:Qt.wrap<=0?Q:(Qt.wrap===2?(ft(Qt,255&yt.adler),ft(Qt,yt.adler>>8&255),ft(Qt,yt.adler>>16&255),ft(Qt,yt.adler>>24&255),ft(Qt,255&yt.total_in),ft(Qt,yt.total_in>>8&255),ft(Qt,yt.total_in>>16&255),ft(Qt,yt.total_in>>24&255)):(at(Qt,yt.adler>>>16),at(Qt,65535&yt.adler)),nt(yt),Qt.wrap>0&&(Qt.wrap=-Qt.wrap),Qt.pending!==0?V:Q)}function re(yt){var Mt;return yt&&yt.state?(Mt=yt.state.status)!==Ot&&Mt!==Nt&&Mt!==Pt&&Mt!==Ut&&Mt!==Ft&&Mt!==Zt&&Mt!==Ht?xt(yt,K):(yt.state=null,Mt===Zt?xt(yt,q):V):K}function te(yt,Mt){var Yt,Qt,mt,qt,ie,jt,Kt,ne,pe=Mt.length;if(!yt||!yt.state||(qt=(Yt=yt.state).wrap)===2||qt===1&&Yt.status!==Ot||Yt.lookahead)return K;for(qt===1&&(yt.adler=F(yt.adler,Mt,pe,0)),Yt.wrap=0,pe>=Yt.w_size&&(qt===0&&(Gt(Yt.head),Yt.strstart=0,Yt.block_start=0,Yt.insert=0),ne=new I.Buf8(Yt.w_size),I.arraySet(ne,Mt,pe-Yt.w_size,Yt.w_size,0),Mt=ne,pe=Yt.w_size),ie=yt.avail_in,jt=yt.next_in,Kt=yt.input,yt.avail_in=pe,yt.next_in=0,yt.input=Mt,Vt(Yt);Yt.lookahead>=It;){Qt=Yt.strstart,mt=Yt.lookahead-(It-1);do Yt.ins_h=(Yt.ins_h<<Yt.hash_shift^Yt.window[Qt+It-1])&Yt.hash_mask,Yt.prev[Qt&Yt.w_mask]=Yt.head[Yt.ins_h],Yt.head[Yt.ins_h]=Qt,Qt++;while(--mt);Yt.strstart=Qt,Yt.lookahead=It-1,Vt(Yt)}return Yt.strstart+=Yt.lookahead,Yt.block_start=Yt.strstart,Yt.insert=Yt.lookahead,Yt.lookahead=0,Yt.match_length=Yt.prev_length=It-1,Yt.match_available=0,yt.next_in=jt,yt.input=Kt,yt.avail_in=ie,Yt.wrap=qt,V}w=[new le(0,0,0,0,ee),new le(4,4,8,4,Jt),new le(4,5,16,8,Jt),new le(4,6,32,32,Jt),new le(4,4,16,16,se),new le(8,16,32,32,se),new le(8,16,128,128,se),new le(8,32,128,256,se),new le(32,128,258,1024,se),new le(32,258,258,4096,se)],g.deflateInit=Xt,g.deflateInit2=kt,g.deflateReset=Wt,g.deflateResetKeep=he,g.deflateSetHeader=oe,g.deflate=Ct,g.deflateEnd=re,g.deflateSetDictionary=te,g.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":52,"./adler32":53,"./crc32":55,"./messages":60,"./trees":61}],57:[function(d,m,g){var w=30,I=12;m.exports=function(P,F){var D,U,Z,$,j,H,W,V,Q,K,q,et,X,tt,rt,ot,J,lt,st,ut,it,ct,At,Et,gt;D=P.state,U=P.next_in,Et=P.input,Z=U+(P.avail_in-5),$=P.next_out,gt=P.output,j=$-(F-P.avail_out),H=$+(P.avail_out-257),W=D.dmax,V=D.wsize,Q=D.whave,K=D.wnext,q=D.window,et=D.hold,X=D.bits,tt=D.lencode,rt=D.distcode,ot=(1<<D.lenbits)-1,J=(1<<D.distbits)-1;t:do{X<15&&(et+=Et[U++]<<X,X+=8,et+=Et[U++]<<X,X+=8),lt=tt[et&ot];e:for(;;){if(et>>>=st=lt>>>24,X-=st,(st=lt>>>16&255)==0)gt[$++]=65535&lt;else{if(!(16&st)){if(64&st){if(32&st){D.mode=I;break t}P.msg="invalid literal/length code",D.mode=w;break t}lt=tt[(65535&lt)+(et&(1<<st)-1)];continue e}for(ut=65535&lt,(st&=15)&&(X<st&&(et+=Et[U++]<<X,X+=8),ut+=et&(1<<st)-1,et>>>=st,X-=st),X<15&&(et+=Et[U++]<<X,X+=8,et+=Et[U++]<<X,X+=8),lt=rt[et&J];;){if(et>>>=st=lt>>>24,X-=st,16&(st=lt>>>16&255)){if(it=65535&lt,X<(st&=15)&&(et+=Et[U++]<<X,(X+=8)<st&&(et+=Et[U++]<<X,X+=8)),(it+=et&(1<<st)-1)>W){P.msg="invalid distance too far back",D.mode=w;break t}if(et>>>=st,X-=st,it>(st=$-j)){if((st=it-st)>Q&&D.sane){P.msg="invalid distance too far back",D.mode=w;break t}if(ct=0,At=q,K===0){if(ct+=V-st,st<ut){ut-=st;do gt[$++]=q[ct++];while(--st);ct=$-it,At=gt}}else if(K<st){if(ct+=V+K-st,(st-=K)<ut){ut-=st;do gt[$++]=q[ct++];while(--st);if(ct=0,K<ut){ut-=st=K;do gt[$++]=q[ct++];while(--st);ct=$-it,At=gt}}}else if(ct+=K-st,st<ut){ut-=st;do gt[$++]=q[ct++];while(--st);ct=$-it,At=gt}for(;ut>2;)gt[$++]=At[ct++],gt[$++]=At[ct++],gt[$++]=At[ct++],ut-=3;ut&&(gt[$++]=At[ct++],ut>1&&(gt[$++]=At[ct++]))}else{ct=$-it;do gt[$++]=gt[ct++],gt[$++]=gt[ct++],gt[$++]=gt[ct++],ut-=3;while(ut>2);ut&&(gt[$++]=gt[ct++],ut>1&&(gt[$++]=gt[ct++]))}break}if(64&st){P.msg="invalid distance code",D.mode=w;break t}lt=rt[(65535&lt)+(et&(1<<st)-1)]}}break}}while(U<Z&&$<H);U-=ut=X>>3,et&=(1<<(X-=ut<<3))-1,P.next_in=U,P.next_out=$,P.avail_in=U<Z?Z-U+5:5-(U-Z),P.avail_out=$<H?H-$+257:257-($-H),D.hold=et,D.bits=X}},{}],58:[function(d,m,g){var w=d("../utils/common"),I=d("./adler32"),P=d("./crc32"),F=d("./inffast"),D=d("./inftrees"),U=0,Z=1,$=2,j=4,H=5,W=6,V=0,Q=1,K=2,q=-2,et=-3,X=-4,tt=-5,rt=8,ot=1,J=2,lt=3,st=4,ut=5,it=6,ct=7,At=8,Et=9,gt=10,pt=11,vt=12,Tt=13,It=14,$t=15,Bt=16,zt=17,Ot=18,Nt=19,Pt=20,Ut=21,Ft=22,Zt=23,Ht=24,Dt=25,dt=26,Lt=27,bt=28,wt=29,xt=30,Rt=31,Gt=852,nt=592,ht=15;function ft(kt){return(kt>>>24&255)+(kt>>>8&65280)+((65280&kt)<<8)+((255&kt)<<24)}function at(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new w.Buf16(320),this.work=new w.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function _t(kt){var Xt;return kt&&kt.state?(Xt=kt.state,kt.total_in=kt.total_out=Xt.total=0,kt.msg="",Xt.wrap&&(kt.adler=1&Xt.wrap),Xt.mode=ot,Xt.last=0,Xt.havedict=0,Xt.dmax=32768,Xt.head=null,Xt.hold=0,Xt.bits=0,Xt.lencode=Xt.lendyn=new w.Buf32(Gt),Xt.distcode=Xt.distdyn=new w.Buf32(nt),Xt.sane=1,Xt.back=-1,V):q}function St(kt){var Xt;return kt&&kt.state?((Xt=kt.state).wsize=0,Xt.whave=0,Xt.wnext=0,_t(kt)):q}function Vt(kt,Xt){var Ct,re;return kt&&kt.state?(re=kt.state,Xt<0?(Ct=0,Xt=-Xt):(Ct=1+(Xt>>4),Xt<48&&(Xt&=15)),Xt&&(Xt<8||Xt>15)?q:(re.window!==null&&re.wbits!==Xt&&(re.window=null),re.wrap=Ct,re.wbits=Xt,St(kt))):q}function ee(kt,Xt){var Ct,re;return kt?(re=new at,kt.state=re,re.window=null,(Ct=Vt(kt,Xt))!==V&&(kt.state=null),Ct):q}function Jt(kt){return ee(kt,ht)}var se,ae,fe=!0;function le(kt){if(fe){var Xt;for(se=new w.Buf32(512),ae=new w.Buf32(32),Xt=0;Xt<144;)kt.lens[Xt++]=8;for(;Xt<256;)kt.lens[Xt++]=9;for(;Xt<280;)kt.lens[Xt++]=7;for(;Xt<288;)kt.lens[Xt++]=8;for(D(Z,kt.lens,0,288,se,0,kt.work,{bits:9}),Xt=0;Xt<32;)kt.lens[Xt++]=5;D($,kt.lens,0,32,ae,0,kt.work,{bits:5}),fe=!1}kt.lencode=se,kt.lenbits=9,kt.distcode=ae,kt.distbits=5}function ue(kt,Xt,Ct,re){var te,yt=kt.state;return yt.window===null&&(yt.wsize=1<<yt.wbits,yt.wnext=0,yt.whave=0,yt.window=new w.Buf8(yt.wsize)),re>=yt.wsize?(w.arraySet(yt.window,Xt,Ct-yt.wsize,yt.wsize,0),yt.wnext=0,yt.whave=yt.wsize):((te=yt.wsize-yt.wnext)>re&&(te=re),w.arraySet(yt.window,Xt,Ct-re,te,yt.wnext),(re-=te)?(w.arraySet(yt.window,Xt,Ct-re,re,0),yt.wnext=re,yt.whave=yt.wsize):(yt.wnext+=te,yt.wnext===yt.wsize&&(yt.wnext=0),yt.whave<yt.wsize&&(yt.whave+=te))),0}function me(kt,Xt){var Ct,re,te,yt,Mt,Yt,Qt,mt,qt,ie,jt,Kt,ne,pe,ce,de,ge,ve,Ee,ye,_e,we,xe,Se,Ae=0,be=new w.Buf8(4),Ie=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!kt||!kt.state||!kt.output||!kt.input&&kt.avail_in!==0)return q;(Ct=kt.state).mode===vt&&(Ct.mode=Tt),Mt=kt.next_out,te=kt.output,Qt=kt.avail_out,yt=kt.next_in,re=kt.input,Yt=kt.avail_in,mt=Ct.hold,qt=Ct.bits,ie=Yt,jt=Qt,we=V;t:for(;;)switch(Ct.mode){case ot:if(Ct.wrap===0){Ct.mode=Tt;break}for(;qt<16;){if(Yt===0)break t;Yt--,mt+=re[yt++]<<qt,qt+=8}if(2&Ct.wrap&&mt===35615){Ct.check=0,be[0]=255&mt,be[1]=mt>>>8&255,Ct.check=P(Ct.check,be,2,0),mt=0,qt=0,Ct.mode=J;break}if(Ct.flags=0,Ct.head&&(Ct.head.done=!1),!(1&Ct.wrap)||(((255&mt)<<8)+(mt>>8))%31){kt.msg="incorrect header check",Ct.mode=xt;break}if((15&mt)!==rt){kt.msg="unknown compression method",Ct.mode=xt;break}if(qt-=4,_e=8+(15&(mt>>>=4)),Ct.wbits===0)Ct.wbits=_e;else if(_e>Ct.wbits){kt.msg="invalid window size",Ct.mode=xt;break}Ct.dmax=1<<_e,kt.adler=Ct.check=1,Ct.mode=512&mt?gt:vt,mt=0,qt=0;break;case J:for(;qt<16;){if(Yt===0)break t;Yt--,mt+=re[yt++]<<qt,qt+=8}if(Ct.flags=mt,(255&Ct.flags)!==rt){kt.msg="unknown compression method",Ct.mode=xt;break}if(57344&Ct.flags){kt.msg="unknown header flags set",Ct.mode=xt;break}Ct.head&&(Ct.head.text=mt>>8&1),512&Ct.flags&&(be[0]=255&mt,be[1]=mt>>>8&255,Ct.check=P(Ct.check,be,2,0)),mt=0,qt=0,Ct.mode=lt;case lt:for(;qt<32;){if(Yt===0)break t;Yt--,mt+=re[yt++]<<qt,qt+=8}Ct.head&&(Ct.head.time=mt),512&Ct.flags&&(be[0]=255&mt,be[1]=mt>>>8&255,be[2]=mt>>>16&255,be[3]=mt>>>24&255,Ct.check=P(Ct.check,be,4,0)),mt=0,qt=0,Ct.mode=st;case st:for(;qt<16;){if(Yt===0)break t;Yt--,mt+=re[yt++]<<qt,qt+=8}Ct.head&&(Ct.head.xflags=255&mt,Ct.head.os=mt>>8),512&Ct.flags&&(be[0]=255&mt,be[1]=mt>>>8&255,Ct.check=P(Ct.check,be,2,0)),mt=0,qt=0,Ct.mode=ut;case ut:if(1024&Ct.flags){for(;qt<16;){if(Yt===0)break t;Yt--,mt+=re[yt++]<<qt,qt+=8}Ct.length=mt,Ct.head&&(Ct.head.extra_len=mt),512&Ct.flags&&(be[0]=255&mt,be[1]=mt>>>8&255,Ct.check=P(Ct.check,be,2,0)),mt=0,qt=0}else Ct.head&&(Ct.head.extra=null);Ct.mode=it;case it:if(1024&Ct.flags&&((Kt=Ct.length)>Yt&&(Kt=Yt),Kt&&(Ct.head&&(_e=Ct.head.extra_len-Ct.length,Ct.head.extra||(Ct.head.extra=new Array(Ct.head.extra_len)),w.arraySet(Ct.head.extra,re,yt,Kt,_e)),512&Ct.flags&&(Ct.check=P(Ct.check,re,Kt,yt)),Yt-=Kt,yt+=Kt,Ct.length-=Kt),Ct.length))break t;Ct.length=0,Ct.mode=ct;case ct:if(2048&Ct.flags){if(Yt===0)break t;Kt=0;do _e=re[yt+Kt++],Ct.head&&_e&&Ct.length<65536&&(Ct.head.name+=String.fromCharCode(_e));while(_e&&Kt<Yt);if(512&Ct.flags&&(Ct.check=P(Ct.check,re,Kt,yt)),Yt-=Kt,yt+=Kt,_e)break t}else Ct.head&&(Ct.head.name=null);Ct.length=0,Ct.mode=At;case At:if(4096&Ct.flags){if(Yt===0)break t;Kt=0;do _e=re[yt+Kt++],Ct.head&&_e&&Ct.length<65536&&(Ct.head.comment+=String.fromCharCode(_e));while(_e&&Kt<Yt);if(512&Ct.flags&&(Ct.check=P(Ct.check,re,Kt,yt)),Yt-=Kt,yt+=Kt,_e)break t}else Ct.head&&(Ct.head.comment=null);Ct.mode=Et;case Et:if(512&Ct.flags){for(;qt<16;){if(Yt===0)break t;Yt--,mt+=re[yt++]<<qt,qt+=8}if(mt!==(65535&Ct.check)){kt.msg="header crc mismatch",Ct.mode=xt;break}mt=0,qt=0}Ct.head&&(Ct.head.hcrc=Ct.flags>>9&1,Ct.head.done=!0),kt.adler=Ct.check=0,Ct.mode=vt;break;case gt:for(;qt<32;){if(Yt===0)break t;Yt--,mt+=re[yt++]<<qt,qt+=8}kt.adler=Ct.check=ft(mt),mt=0,qt=0,Ct.mode=pt;case pt:if(Ct.havedict===0)return kt.next_out=Mt,kt.avail_out=Qt,kt.next_in=yt,kt.avail_in=Yt,Ct.hold=mt,Ct.bits=qt,K;kt.adler=Ct.check=1,Ct.mode=vt;case vt:if(Xt===H||Xt===W)break t;case Tt:if(Ct.last){mt>>>=7&qt,qt-=7&qt,Ct.mode=Lt;break}for(;qt<3;){if(Yt===0)break t;Yt--,mt+=re[yt++]<<qt,qt+=8}switch(Ct.last=1&mt,qt-=1,3&(mt>>>=1)){case 0:Ct.mode=It;break;case 1:if(le(Ct),Ct.mode=Pt,Xt===W){mt>>>=2,qt-=2;break t}break;case 2:Ct.mode=zt;break;case 3:kt.msg="invalid block type",Ct.mode=xt}mt>>>=2,qt-=2;break;case It:for(mt>>>=7&qt,qt-=7&qt;qt<32;){if(Yt===0)break t;Yt--,mt+=re[yt++]<<qt,qt+=8}if((65535&mt)!=(mt>>>16^65535)){kt.msg="invalid stored block lengths",Ct.mode=xt;break}if(Ct.length=65535&mt,mt=0,qt=0,Ct.mode=$t,Xt===W)break t;case $t:Ct.mode=Bt;case Bt:if(Kt=Ct.length){if(Kt>Yt&&(Kt=Yt),Kt>Qt&&(Kt=Qt),Kt===0)break t;w.arraySet(te,re,yt,Kt,Mt),Yt-=Kt,yt+=Kt,Qt-=Kt,Mt+=Kt,Ct.length-=Kt;break}Ct.mode=vt;break;case zt:for(;qt<14;){if(Yt===0)break t;Yt--,mt+=re[yt++]<<qt,qt+=8}if(Ct.nlen=257+(31&mt),mt>>>=5,qt-=5,Ct.ndist=1+(31&mt),mt>>>=5,qt-=5,Ct.ncode=4+(15&mt),mt>>>=4,qt-=4,Ct.nlen>286||Ct.ndist>30){kt.msg="too many length or distance symbols",Ct.mode=xt;break}Ct.have=0,Ct.mode=Ot;case Ot:for(;Ct.have<Ct.ncode;){for(;qt<3;){if(Yt===0)break t;Yt--,mt+=re[yt++]<<qt,qt+=8}Ct.lens[Ie[Ct.have++]]=7&mt,mt>>>=3,qt-=3}for(;Ct.have<19;)Ct.lens[Ie[Ct.have++]]=0;if(Ct.lencode=Ct.lendyn,Ct.lenbits=7,xe={bits:Ct.lenbits},we=D(U,Ct.lens,0,19,Ct.lencode,0,Ct.work,xe),Ct.lenbits=xe.bits,we){kt.msg="invalid code lengths set",Ct.mode=xt;break}Ct.have=0,Ct.mode=Nt;case Nt:for(;Ct.have<Ct.nlen+Ct.ndist;){for(;de=(Ae=Ct.lencode[mt&(1<<Ct.lenbits)-1])>>>16&255,ge=65535&Ae,!((ce=Ae>>>24)<=qt);){if(Yt===0)break t;Yt--,mt+=re[yt++]<<qt,qt+=8}if(ge<16)mt>>>=ce,qt-=ce,Ct.lens[Ct.have++]=ge;else{if(ge===16){for(Se=ce+2;qt<Se;){if(Yt===0)break t;Yt--,mt+=re[yt++]<<qt,qt+=8}if(mt>>>=ce,qt-=ce,Ct.have===0){kt.msg="invalid bit length repeat",Ct.mode=xt;break}_e=Ct.lens[Ct.have-1],Kt=3+(3&mt),mt>>>=2,qt-=2}else if(ge===17){for(Se=ce+3;qt<Se;){if(Yt===0)break t;Yt--,mt+=re[yt++]<<qt,qt+=8}qt-=ce,_e=0,Kt=3+(7&(mt>>>=ce)),mt>>>=3,qt-=3}else{for(Se=ce+7;qt<Se;){if(Yt===0)break t;Yt--,mt+=re[yt++]<<qt,qt+=8}qt-=ce,_e=0,Kt=11+(127&(mt>>>=ce)),mt>>>=7,qt-=7}if(Ct.have+Kt>Ct.nlen+Ct.ndist){kt.msg="invalid bit length repeat",Ct.mode=xt;break}for(;Kt--;)Ct.lens[Ct.have++]=_e}}if(Ct.mode===xt)break;if(Ct.lens[256]===0){kt.msg="invalid code -- missing end-of-block",Ct.mode=xt;break}if(Ct.lenbits=9,xe={bits:Ct.lenbits},we=D(Z,Ct.lens,0,Ct.nlen,Ct.lencode,0,Ct.work,xe),Ct.lenbits=xe.bits,we){kt.msg="invalid literal/lengths set",Ct.mode=xt;break}if(Ct.distbits=6,Ct.distcode=Ct.distdyn,xe={bits:Ct.distbits},we=D($,Ct.lens,Ct.nlen,Ct.ndist,Ct.distcode,0,Ct.work,xe),Ct.distbits=xe.bits,we){kt.msg="invalid distances set",Ct.mode=xt;break}if(Ct.mode=Pt,Xt===W)break t;case Pt:Ct.mode=Ut;case Ut:if(Yt>=6&&Qt>=258){kt.next_out=Mt,kt.avail_out=Qt,kt.next_in=yt,kt.avail_in=Yt,Ct.hold=mt,Ct.bits=qt,F(kt,jt),Mt=kt.next_out,te=kt.output,Qt=kt.avail_out,yt=kt.next_in,re=kt.input,Yt=kt.avail_in,mt=Ct.hold,qt=Ct.bits,Ct.mode===vt&&(Ct.back=-1);break}for(Ct.back=0;de=(Ae=Ct.lencode[mt&(1<<Ct.lenbits)-1])>>>16&255,ge=65535&Ae,!((ce=Ae>>>24)<=qt);){if(Yt===0)break t;Yt--,mt+=re[yt++]<<qt,qt+=8}if(de&&!(240&de)){for(ve=ce,Ee=de,ye=ge;de=(Ae=Ct.lencode[ye+((mt&(1<<ve+Ee)-1)>>ve)])>>>16&255,ge=65535&Ae,!(ve+(ce=Ae>>>24)<=qt);){if(Yt===0)break t;Yt--,mt+=re[yt++]<<qt,qt+=8}mt>>>=ve,qt-=ve,Ct.back+=ve}if(mt>>>=ce,qt-=ce,Ct.back+=ce,Ct.length=ge,de===0){Ct.mode=dt;break}if(32&de){Ct.back=-1,Ct.mode=vt;break}if(64&de){kt.msg="invalid literal/length code",Ct.mode=xt;break}Ct.extra=15&de,Ct.mode=Ft;case Ft:if(Ct.extra){for(Se=Ct.extra;qt<Se;){if(Yt===0)break t;Yt--,mt+=re[yt++]<<qt,qt+=8}Ct.length+=mt&(1<<Ct.extra)-1,mt>>>=Ct.extra,qt-=Ct.extra,Ct.back+=Ct.extra}Ct.was=Ct.length,Ct.mode=Zt;case Zt:for(;de=(Ae=Ct.distcode[mt&(1<<Ct.distbits)-1])>>>16&255,ge=65535&Ae,!((ce=Ae>>>24)<=qt);){if(Yt===0)break t;Yt--,mt+=re[yt++]<<qt,qt+=8}if(!(240&de)){for(ve=ce,Ee=de,ye=ge;de=(Ae=Ct.distcode[ye+((mt&(1<<ve+Ee)-1)>>ve)])>>>16&255,ge=65535&Ae,!(ve+(ce=Ae>>>24)<=qt);){if(Yt===0)break t;Yt--,mt+=re[yt++]<<qt,qt+=8}mt>>>=ve,qt-=ve,Ct.back+=ve}if(mt>>>=ce,qt-=ce,Ct.back+=ce,64&de){kt.msg="invalid distance code",Ct.mode=xt;break}Ct.offset=ge,Ct.extra=15&de,Ct.mode=Ht;case Ht:if(Ct.extra){for(Se=Ct.extra;qt<Se;){if(Yt===0)break t;Yt--,mt+=re[yt++]<<qt,qt+=8}Ct.offset+=mt&(1<<Ct.extra)-1,mt>>>=Ct.extra,qt-=Ct.extra,Ct.back+=Ct.extra}if(Ct.offset>Ct.dmax){kt.msg="invalid distance too far back",Ct.mode=xt;break}Ct.mode=Dt;case Dt:if(Qt===0)break t;if(Kt=jt-Qt,Ct.offset>Kt){if((Kt=Ct.offset-Kt)>Ct.whave&&Ct.sane){kt.msg="invalid distance too far back",Ct.mode=xt;break}Kt>Ct.wnext?(Kt-=Ct.wnext,ne=Ct.wsize-Kt):ne=Ct.wnext-Kt,Kt>Ct.length&&(Kt=Ct.length),pe=Ct.window}else pe=te,ne=Mt-Ct.offset,Kt=Ct.length;Kt>Qt&&(Kt=Qt),Qt-=Kt,Ct.length-=Kt;do te[Mt++]=pe[ne++];while(--Kt);Ct.length===0&&(Ct.mode=Ut);break;case dt:if(Qt===0)break t;te[Mt++]=Ct.length,Qt--,Ct.mode=Ut;break;case Lt:if(Ct.wrap){for(;qt<32;){if(Yt===0)break t;Yt--,mt|=re[yt++]<<qt,qt+=8}if(jt-=Qt,kt.total_out+=jt,Ct.total+=jt,jt&&(kt.adler=Ct.check=Ct.flags?P(Ct.check,te,jt,Mt-jt):I(Ct.check,te,jt,Mt-jt)),jt=Qt,(Ct.flags?mt:ft(mt))!==Ct.check){kt.msg="incorrect data check",Ct.mode=xt;break}mt=0,qt=0}Ct.mode=bt;case bt:if(Ct.wrap&&Ct.flags){for(;qt<32;){if(Yt===0)break t;Yt--,mt+=re[yt++]<<qt,qt+=8}if(mt!==(4294967295&Ct.total)){kt.msg="incorrect length check",Ct.mode=xt;break}mt=0,qt=0}Ct.mode=wt;case wt:we=Q;break t;case xt:we=et;break t;case Rt:return X;default:return q}return kt.next_out=Mt,kt.avail_out=Qt,kt.next_in=yt,kt.avail_in=Yt,Ct.hold=mt,Ct.bits=qt,(Ct.wsize||jt!==kt.avail_out&&Ct.mode<xt&&(Ct.mode<Lt||Xt!==j))&&ue(kt,kt.output,kt.next_out,jt-kt.avail_out),ie-=kt.avail_in,jt-=kt.avail_out,kt.total_in+=ie,kt.total_out+=jt,Ct.total+=jt,Ct.wrap&&jt&&(kt.adler=Ct.check=Ct.flags?P(Ct.check,te,jt,kt.next_out-jt):I(Ct.check,te,jt,kt.next_out-jt)),kt.data_type=Ct.bits+(Ct.last?64:0)+(Ct.mode===vt?128:0)+(Ct.mode===Pt||Ct.mode===$t?256:0),(ie===0&&jt===0||Xt===j)&&we===V&&(we=tt),we}function he(kt){if(!kt||!kt.state)return q;var Xt=kt.state;return Xt.window&&(Xt.window=null),kt.state=null,V}function Wt(kt,Xt){var Ct;return kt&&kt.state&&2&(Ct=kt.state).wrap?(Ct.head=Xt,Xt.done=!1,V):q}function oe(kt,Xt){var Ct,re=Xt.length;return kt&&kt.state?(Ct=kt.state).wrap!==0&&Ct.mode!==pt?q:Ct.mode===pt&&I(1,Xt,re,0)!==Ct.check?et:ue(kt,Xt,re,re)?(Ct.mode=Rt,X):(Ct.havedict=1,V):q}g.inflateReset=St,g.inflateReset2=Vt,g.inflateResetKeep=_t,g.inflateInit=Jt,g.inflateInit2=ee,g.inflate=me,g.inflateEnd=he,g.inflateGetHeader=Wt,g.inflateSetDictionary=oe,g.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":52,"./adler32":53,"./crc32":55,"./inffast":57,"./inftrees":59}],59:[function(d,m,g){var w=d("../utils/common"),I=15,P=852,F=592,D=0,U=1,Z=2,$=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],j=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],H=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],W=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];m.exports=function(V,Q,K,q,et,X,tt,rt){var ot,J,lt,st,ut,it,ct,At,Et,gt=rt.bits,pt=0,vt=0,Tt=0,It=0,$t=0,Bt=0,zt=0,Ot=0,Nt=0,Pt=0,Ut=null,Ft=0,Zt=new w.Buf16(I+1),Ht=new w.Buf16(I+1),Dt=null,dt=0;for(pt=0;pt<=I;pt++)Zt[pt]=0;for(vt=0;vt<q;vt++)Zt[Q[K+vt]]++;for($t=gt,It=I;It>=1&&Zt[It]===0;It--);if($t>It&&($t=It),It===0)return et[X++]=20971520,et[X++]=20971520,rt.bits=1,0;for(Tt=1;Tt<It&&Zt[Tt]===0;Tt++);for($t<Tt&&($t=Tt),Ot=1,pt=1;pt<=I;pt++)if(Ot<<=1,(Ot-=Zt[pt])<0)return-1;if(Ot>0&&(V===D||It!==1))return-1;for(Ht[1]=0,pt=1;pt<I;pt++)Ht[pt+1]=Ht[pt]+Zt[pt];for(vt=0;vt<q;vt++)Q[K+vt]!==0&&(tt[Ht[Q[K+vt]]++]=vt);if(V===D?(Ut=Dt=tt,it=19):V===U?(Ut=$,Ft-=257,Dt=j,dt-=257,it=256):(Ut=H,Dt=W,it=-1),Pt=0,vt=0,pt=Tt,ut=X,Bt=$t,zt=0,lt=-1,st=(Nt=1<<$t)-1,V===U&&Nt>P||V===Z&&Nt>F)return 1;for(;;){ct=pt-zt,tt[vt]<it?(At=0,Et=tt[vt]):tt[vt]>it?(At=Dt[dt+tt[vt]],Et=Ut[Ft+tt[vt]]):(At=96,Et=0),ot=1<<pt-zt,Tt=J=1<<Bt;do et[ut+(Pt>>zt)+(J-=ot)]=ct<<24|At<<16|Et;while(J!==0);for(ot=1<<pt-1;Pt&ot;)ot>>=1;if(ot!==0?(Pt&=ot-1,Pt+=ot):Pt=0,vt++,--Zt[pt]==0){if(pt===It)break;pt=Q[K+tt[vt]]}if(pt>$t&&(Pt&st)!==lt){for(zt===0&&(zt=$t),ut+=Tt,Ot=1<<(Bt=pt-zt);Bt+zt<It&&!((Ot-=Zt[Bt+zt])<=0);)Bt++,Ot<<=1;if(Nt+=1<<Bt,V===U&&Nt>P||V===Z&&Nt>F)return 1;et[lt=Pt&st]=$t<<24|Bt<<16|ut-X}}return Pt!==0&&(et[ut+Pt]=pt-zt<<24|64<<16),rt.bits=$t,0}},{"../utils/common":52}],60:[function(d,m,g){m.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],61:[function(d,m,g){var w=d("../utils/common"),I=4,P=0,F=1,D=2;function U(Wt){for(var oe=Wt.length;--oe>=0;)Wt[oe]=0}var Z=0,$=1,j=2,H=3,W=258,V=29,Q=256,K=Q+1+V,q=30,et=19,X=2*K+1,tt=15,rt=16,ot=7,J=256,lt=16,st=17,ut=18,it=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],ct=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],At=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],Et=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],gt=512,pt=new Array(2*(K+2));U(pt);var vt=new Array(2*q);U(vt);var Tt=new Array(gt);U(Tt);var It=new Array(W-H+1);U(It);var $t=new Array(V);U($t);var Bt,zt,Ot,Nt=new Array(q);function Pt(Wt,oe,kt,Xt,Ct){this.static_tree=Wt,this.extra_bits=oe,this.extra_base=kt,this.elems=Xt,this.max_length=Ct,this.has_stree=Wt&&Wt.length}function Ut(Wt,oe){this.dyn_tree=Wt,this.max_code=0,this.stat_desc=oe}function Ft(Wt){return Wt<256?Tt[Wt]:Tt[256+(Wt>>>7)]}function Zt(Wt,oe){Wt.pending_buf[Wt.pending++]=255&oe,Wt.pending_buf[Wt.pending++]=oe>>>8&255}function Ht(Wt,oe,kt){Wt.bi_valid>rt-kt?(Wt.bi_buf|=oe<<Wt.bi_valid&65535,Zt(Wt,Wt.bi_buf),Wt.bi_buf=oe>>rt-Wt.bi_valid,Wt.bi_valid+=kt-rt):(Wt.bi_buf|=oe<<Wt.bi_valid&65535,Wt.bi_valid+=kt)}function Dt(Wt,oe,kt){Ht(Wt,kt[2*oe],kt[2*oe+1])}function dt(Wt,oe){var kt=0;do kt|=1&Wt,Wt>>>=1,kt<<=1;while(--oe>0);return kt>>>1}function Lt(Wt){Wt.bi_valid===16?(Zt(Wt,Wt.bi_buf),Wt.bi_buf=0,Wt.bi_valid=0):Wt.bi_valid>=8&&(Wt.pending_buf[Wt.pending++]=255&Wt.bi_buf,Wt.bi_buf>>=8,Wt.bi_valid-=8)}function bt(Wt,oe){var kt,Xt,Ct,re,te,yt,Mt=oe.dyn_tree,Yt=oe.max_code,Qt=oe.stat_desc.static_tree,mt=oe.stat_desc.has_stree,qt=oe.stat_desc.extra_bits,ie=oe.stat_desc.extra_base,jt=oe.stat_desc.max_length,Kt=0;for(re=0;re<=tt;re++)Wt.bl_count[re]=0;for(Mt[2*Wt.heap[Wt.heap_max]+1]=0,kt=Wt.heap_max+1;kt<X;kt++)(re=Mt[2*Mt[2*(Xt=Wt.heap[kt])+1]+1]+1)>jt&&(re=jt,Kt++),Mt[2*Xt+1]=re,Xt>Yt||(Wt.bl_count[re]++,te=0,Xt>=ie&&(te=qt[Xt-ie]),yt=Mt[2*Xt],Wt.opt_len+=yt*(re+te),mt&&(Wt.static_len+=yt*(Qt[2*Xt+1]+te)));if(Kt!==0){do{for(re=jt-1;Wt.bl_count[re]===0;)re--;Wt.bl_count[re]--,Wt.bl_count[re+1]+=2,Wt.bl_count[jt]--,Kt-=2}while(Kt>0);for(re=jt;re!==0;re--)for(Xt=Wt.bl_count[re];Xt!==0;)(Ct=Wt.heap[--kt])>Yt||(Mt[2*Ct+1]!==re&&(Wt.opt_len+=(re-Mt[2*Ct+1])*Mt[2*Ct],Mt[2*Ct+1]=re),Xt--)}}function wt(Wt,oe,kt){var Xt,Ct,re=new Array(tt+1),te=0;for(Xt=1;Xt<=tt;Xt++)re[Xt]=te=te+kt[Xt-1]<<1;for(Ct=0;Ct<=oe;Ct++){var yt=Wt[2*Ct+1];yt!==0&&(Wt[2*Ct]=dt(re[yt]++,yt))}}function xt(){var Wt,oe,kt,Xt,Ct,re=new Array(tt+1);for(kt=0,Xt=0;Xt<V-1;Xt++)for($t[Xt]=kt,Wt=0;Wt<1<<it[Xt];Wt++)It[kt++]=Xt;for(It[kt-1]=Xt,Ct=0,Xt=0;Xt<16;Xt++)for(Nt[Xt]=Ct,Wt=0;Wt<1<<ct[Xt];Wt++)Tt[Ct++]=Xt;for(Ct>>=7;Xt<q;Xt++)for(Nt[Xt]=Ct<<7,Wt=0;Wt<1<<ct[Xt]-7;Wt++)Tt[256+Ct++]=Xt;for(oe=0;oe<=tt;oe++)re[oe]=0;for(Wt=0;Wt<=143;)pt[2*Wt+1]=8,Wt++,re[8]++;for(;Wt<=255;)pt[2*Wt+1]=9,Wt++,re[9]++;for(;Wt<=279;)pt[2*Wt+1]=7,Wt++,re[7]++;for(;Wt<=287;)pt[2*Wt+1]=8,Wt++,re[8]++;for(wt(pt,K+1,re),Wt=0;Wt<q;Wt++)vt[2*Wt+1]=5,vt[2*Wt]=dt(Wt,5);Bt=new Pt(pt,it,Q+1,K,tt),zt=new Pt(vt,ct,0,q,tt),Ot=new Pt(new Array(0),At,0,et,ot)}function Rt(Wt){var oe;for(oe=0;oe<K;oe++)Wt.dyn_ltree[2*oe]=0;for(oe=0;oe<q;oe++)Wt.dyn_dtree[2*oe]=0;for(oe=0;oe<et;oe++)Wt.bl_tree[2*oe]=0;Wt.dyn_ltree[2*J]=1,Wt.opt_len=Wt.static_len=0,Wt.last_lit=Wt.matches=0}function Gt(Wt){Wt.bi_valid>8?Zt(Wt,Wt.bi_buf):Wt.bi_valid>0&&(Wt.pending_buf[Wt.pending++]=Wt.bi_buf),Wt.bi_buf=0,Wt.bi_valid=0}function nt(Wt,oe,kt,Xt){Gt(Wt),Zt(Wt,kt),Zt(Wt,~kt),w.arraySet(Wt.pending_buf,Wt.window,oe,kt,Wt.pending),Wt.pending+=kt}function ht(Wt,oe,kt,Xt){var Ct=2*oe,re=2*kt;return Wt[Ct]<Wt[re]||Wt[Ct]===Wt[re]&&Xt[oe]<=Xt[kt]}function ft(Wt,oe,kt){for(var Xt=Wt.heap[kt],Ct=kt<<1;Ct<=Wt.heap_len&&(Ct<Wt.heap_len&&ht(oe,Wt.heap[Ct+1],Wt.heap[Ct],Wt.depth)&&Ct++,!ht(oe,Xt,Wt.heap[Ct],Wt.depth));)Wt.heap[kt]=Wt.heap[Ct],kt=Ct,Ct<<=1;Wt.heap[kt]=Xt}function at(Wt,oe,kt){var Xt,Ct,re,te,yt=0;if(Wt.last_lit!==0)do Xt=Wt.pending_buf[Wt.d_buf+2*yt]<<8|Wt.pending_buf[Wt.d_buf+2*yt+1],Ct=Wt.pending_buf[Wt.l_buf+yt],yt++,Xt===0?Dt(Wt,Ct,oe):(Dt(Wt,(re=It[Ct])+Q+1,oe),(te=it[re])!==0&&Ht(Wt,Ct-=$t[re],te),Dt(Wt,re=Ft(--Xt),kt),(te=ct[re])!==0&&Ht(Wt,Xt-=Nt[re],te));while(yt<Wt.last_lit);Dt(Wt,J,oe)}function _t(Wt,oe){var kt,Xt,Ct,re=oe.dyn_tree,te=oe.stat_desc.static_tree,yt=oe.stat_desc.has_stree,Mt=oe.stat_desc.elems,Yt=-1;for(Wt.heap_len=0,Wt.heap_max=X,kt=0;kt<Mt;kt++)re[2*kt]!==0?(Wt.heap[++Wt.heap_len]=Yt=kt,Wt.depth[kt]=0):re[2*kt+1]=0;for(;Wt.heap_len<2;)re[2*(Ct=Wt.heap[++Wt.heap_len]=Yt<2?++Yt:0)]=1,Wt.depth[Ct]=0,Wt.opt_len--,yt&&(Wt.static_len-=te[2*Ct+1]);for(oe.max_code=Yt,kt=Wt.heap_len>>1;kt>=1;kt--)ft(Wt,re,kt);Ct=Mt;do kt=Wt.heap[1],Wt.heap[1]=Wt.heap[Wt.heap_len--],ft(Wt,re,1),Xt=Wt.heap[1],Wt.heap[--Wt.heap_max]=kt,Wt.heap[--Wt.heap_max]=Xt,re[2*Ct]=re[2*kt]+re[2*Xt],Wt.depth[Ct]=(Wt.depth[kt]>=Wt.depth[Xt]?Wt.depth[kt]:Wt.depth[Xt])+1,re[2*kt+1]=re[2*Xt+1]=Ct,Wt.heap[1]=Ct++,ft(Wt,re,1);while(Wt.heap_len>=2);Wt.heap[--Wt.heap_max]=Wt.heap[1],bt(Wt,oe),wt(re,Yt,Wt.bl_count)}function St(Wt,oe,kt){var Xt,Ct,re=-1,te=oe[1],yt=0,Mt=7,Yt=4;for(te===0&&(Mt=138,Yt=3),oe[2*(kt+1)+1]=65535,Xt=0;Xt<=kt;Xt++)Ct=te,te=oe[2*(Xt+1)+1],++yt<Mt&&Ct===te||(yt<Yt?Wt.bl_tree[2*Ct]+=yt:Ct!==0?(Ct!==re&&Wt.bl_tree[2*Ct]++,Wt.bl_tree[2*lt]++):yt<=10?Wt.bl_tree[2*st]++:Wt.bl_tree[2*ut]++,yt=0,re=Ct,te===0?(Mt=138,Yt=3):Ct===te?(Mt=6,Yt=3):(Mt=7,Yt=4))}function Vt(Wt,oe,kt){var Xt,Ct,re=-1,te=oe[1],yt=0,Mt=7,Yt=4;for(te===0&&(Mt=138,Yt=3),Xt=0;Xt<=kt;Xt++)if(Ct=te,te=oe[2*(Xt+1)+1],!(++yt<Mt&&Ct===te)){if(yt<Yt)do Dt(Wt,Ct,Wt.bl_tree);while(--yt!=0);else Ct!==0?(Ct!==re&&(Dt(Wt,Ct,Wt.bl_tree),yt--),Dt(Wt,lt,Wt.bl_tree),Ht(Wt,yt-3,2)):yt<=10?(Dt(Wt,st,Wt.bl_tree),Ht(Wt,yt-3,3)):(Dt(Wt,ut,Wt.bl_tree),Ht(Wt,yt-11,7));yt=0,re=Ct,te===0?(Mt=138,Yt=3):Ct===te?(Mt=6,Yt=3):(Mt=7,Yt=4)}}function ee(Wt){var oe;for(St(Wt,Wt.dyn_ltree,Wt.l_desc.max_code),St(Wt,Wt.dyn_dtree,Wt.d_desc.max_code),_t(Wt,Wt.bl_desc),oe=et-1;oe>=3&&Wt.bl_tree[2*Et[oe]+1]===0;oe--);return Wt.opt_len+=3*(oe+1)+5+5+4,oe}function Jt(Wt,oe,kt,Xt){var Ct;for(Ht(Wt,oe-257,5),Ht(Wt,kt-1,5),Ht(Wt,Xt-4,4),Ct=0;Ct<Xt;Ct++)Ht(Wt,Wt.bl_tree[2*Et[Ct]+1],3);Vt(Wt,Wt.dyn_ltree,oe-1),Vt(Wt,Wt.dyn_dtree,kt-1)}function se(Wt){var oe,kt=4093624447;for(oe=0;oe<=31;oe++,kt>>>=1)if(1&kt&&Wt.dyn_ltree[2*oe]!==0)return P;if(Wt.dyn_ltree[18]!==0||Wt.dyn_ltree[20]!==0||Wt.dyn_ltree[26]!==0)return F;for(oe=32;oe<Q;oe++)if(Wt.dyn_ltree[2*oe]!==0)return F;return P}U(Nt);var ae=!1;function fe(Wt){ae||(xt(),ae=!0),Wt.l_desc=new Ut(Wt.dyn_ltree,Bt),Wt.d_desc=new Ut(Wt.dyn_dtree,zt),Wt.bl_desc=new Ut(Wt.bl_tree,Ot),Wt.bi_buf=0,Wt.bi_valid=0,Rt(Wt)}function le(Wt,oe,kt,Xt){Ht(Wt,(Z<<1)+(Xt?1:0),3),nt(Wt,oe,kt)}function ue(Wt){Ht(Wt,$<<1,3),Dt(Wt,J,pt),Lt(Wt)}function me(Wt,oe,kt,Xt){var Ct,re,te=0;Wt.level>0?(Wt.strm.data_type===D&&(Wt.strm.data_type=se(Wt)),_t(Wt,Wt.l_desc),_t(Wt,Wt.d_desc),te=ee(Wt),Ct=Wt.opt_len+3+7>>>3,(re=Wt.static_len+3+7>>>3)<=Ct&&(Ct=re)):Ct=re=kt+5,kt+4<=Ct&&oe!==-1?le(Wt,oe,kt,Xt):Wt.strategy===I||re===Ct?(Ht(Wt,($<<1)+(Xt?1:0),3),at(Wt,pt,vt)):(Ht(Wt,(j<<1)+(Xt?1:0),3),Jt(Wt,Wt.l_desc.max_code+1,Wt.d_desc.max_code+1,te+1),at(Wt,Wt.dyn_ltree,Wt.dyn_dtree)),Rt(Wt),Xt&&Gt(Wt)}function he(Wt,oe,kt){return Wt.pending_buf[Wt.d_buf+2*Wt.last_lit]=oe>>>8&255,Wt.pending_buf[Wt.d_buf+2*Wt.last_lit+1]=255&oe,Wt.pending_buf[Wt.l_buf+Wt.last_lit]=255&kt,Wt.last_lit++,oe===0?Wt.dyn_ltree[2*kt]++:(Wt.matches++,oe--,Wt.dyn_ltree[2*(It[kt]+Q+1)]++,Wt.dyn_dtree[2*Ft(oe)]++),Wt.last_lit===Wt.lit_bufsize-1}g._tr_init=fe,g._tr_stored_block=le,g._tr_flush_block=me,g._tr_tally=he,g._tr_align=ue},{"../utils/common":52}],62:[function(d,m,g){function w(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}m.exports=w},{}],63:[function(d,m,g){var w,I,P=m.exports={};function F(){throw new Error("setTimeout has not been defined")}function D(){throw new Error("clearTimeout has not been defined")}function U(et){if(w===setTimeout)return setTimeout(et,0);if((w===F||!w)&&setTimeout)return w=setTimeout,setTimeout(et,0);try{return w(et,0)}catch{try{return w.call(null,et,0)}catch{return w.call(this,et,0)}}}function Z(et){if(I===clearTimeout)return clearTimeout(et);if((I===D||!I)&&clearTimeout)return I=clearTimeout,clearTimeout(et);try{return I(et)}catch{try{return I.call(null,et)}catch{return I.call(this,et)}}}(function(){try{w=typeof setTimeout=="function"?setTimeout:F}catch{w=F}try{I=typeof clearTimeout=="function"?clearTimeout:D}catch{I=D}})();var $,j=[],H=!1,W=-1;function V(){H&&$&&(H=!1,$.length?j=$.concat(j):W=-1,j.length&&Q())}function Q(){if(!H){var et=U(V);H=!0;for(var X=j.length;X;){for($=j,j=[];++W<X;)$&&$[W].run();W=-1,X=j.length}$=null,H=!1,Z(et)}}function K(et,X){this.fun=et,this.array=X}function q(){}P.nextTick=function(et){var X=new Array(arguments.length-1);if(arguments.length>1)for(var tt=1;tt<arguments.length;tt++)X[tt-1]=arguments[tt];j.push(new K(et,X)),j.length!==1||H||U(Q)},K.prototype.run=function(){this.fun.apply(null,this.array)},P.title="browser",P.browser=!0,P.env={},P.argv=[],P.version="",P.versions={},P.on=q,P.addListener=q,P.once=q,P.off=q,P.removeListener=q,P.removeAllListeners=q,P.emit=q,P.prependListener=q,P.prependOnceListener=q,P.listeners=function(et){return[]},P.binding=function(et){throw new Error("process.binding is not supported")},P.cwd=function(){return"/"},P.chdir=function(et){throw new Error("process.chdir is not supported")},P.umask=function(){return 0}},{}],64:[function(d,m,g){/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var w=d("buffer"),I=w.Buffer;function P(D,U){for(var Z in D)U[Z]=D[Z]}function F(D,U,Z){return I(D,U,Z)}I.from&&I.alloc&&I.allocUnsafe&&I.allocUnsafeSlow?m.exports=w:(P(w,g),g.Buffer=F),F.prototype=Object.create(I.prototype),P(I,F),F.from=function(D,U,Z){if(typeof D=="number")throw new TypeError("Argument must not be a number");return I(D,U,Z)},F.alloc=function(D,U,Z){if(typeof D!="number")throw new TypeError("Argument must be a number");var $=I(D);return U!==void 0?typeof Z=="string"?$.fill(U,Z):$.fill(U):$.fill(0),$},F.allocUnsafe=function(D){if(typeof D!="number")throw new TypeError("Argument must be a number");return I(D)},F.allocUnsafeSlow=function(D){if(typeof D!="number")throw new TypeError("Argument must be a number");return w.SlowBuffer(D)}},{buffer:32}],65:[function(d,m,g){m.exports=I;var w=d("events").EventEmitter;function I(){w.call(this)}d("inherits")(I,w),I.Readable=d("readable-stream/lib/_stream_readable.js"),I.Writable=d("readable-stream/lib/_stream_writable.js"),I.Duplex=d("readable-stream/lib/_stream_duplex.js"),I.Transform=d("readable-stream/lib/_stream_transform.js"),I.PassThrough=d("readable-stream/lib/_stream_passthrough.js"),I.finished=d("readable-stream/lib/internal/streams/end-of-stream.js"),I.pipeline=d("readable-stream/lib/internal/streams/pipeline.js"),I.Stream=I,I.prototype.pipe=function(P,F){var D=this;function U(Q){P.writable&&P.write(Q)===!1&&D.pause&&D.pause()}function Z(){D.readable&&D.resume&&D.resume()}D.on("data",U),P.on("drain",Z),P._isStdio||F&&F.end===!1||(D.on("end",j),D.on("close",H));var $=!1;function j(){$||($=!0,P.end())}function H(){$||($=!0,typeof P.destroy=="function"&&P.destroy())}function W(Q){if(V(),w.listenerCount(this,"error")===0)throw Q}function V(){D.removeListener("data",U),P.removeListener("drain",Z),D.removeListener("end",j),D.removeListener("close",H),D.removeListener("error",W),P.removeListener("error",W),D.removeListener("end",V),D.removeListener("close",V),P.removeListener("close",V)}return D.on("error",W),P.on("error",W),D.on("end",V),D.on("close",V),P.on("close",V),P.emit("pipe",D),P}},{events:35,inherits:46,"readable-stream/lib/_stream_duplex.js":67,"readable-stream/lib/_stream_passthrough.js":68,"readable-stream/lib/_stream_readable.js":69,"readable-stream/lib/_stream_transform.js":70,"readable-stream/lib/_stream_writable.js":71,"readable-stream/lib/internal/streams/end-of-stream.js":75,"readable-stream/lib/internal/streams/pipeline.js":77}],66:[function(d,m,g){function w($,j){$.prototype=Object.create(j.prototype),$.prototype.constructor=$,$.__proto__=j}var I={};function P($,j,H){function W(Q,K,q){return typeof j=="string"?j:j(Q,K,q)}H||(H=Error);var V=function(Q){function K(q,et,X){return Q.call(this,W(q,et,X))||this}return w(K,Q),K}(H);V.prototype.name=H.name,V.prototype.code=$,I[$]=V}function F($,j){if(Array.isArray($)){var H=$.length;return $=$.map(function(W){return String(W)}),H>2?"one of ".concat(j," ").concat($.slice(0,H-1).join(", "),", or ")+$[H-1]:H===2?"one of ".concat(j," ").concat($[0]," or ").concat($[1]):"of ".concat(j," ").concat($[0])}return"of ".concat(j," ").concat(String($))}function D($,j,H){return $.substr(0,j.length)===j}function U($,j,H){return(H===void 0||H>$.length)&&(H=$.length),$.substring(H-j.length,H)===j}function Z($,j,H){return typeof H!="number"&&(H=0),!(H+j.length>$.length)&&$.indexOf(j,H)!==-1}P("ERR_INVALID_OPT_VALUE",function($,j){return'The value "'+j+'" is invalid for option "'+$+'"'},TypeError),P("ERR_INVALID_ARG_TYPE",function($,j,H){var W,V;if(typeof j=="string"&&D(j,"not ")?(W="must not be",j=j.replace(/^not /,"")):W="must be",U($," argument"))V="The ".concat($," ").concat(W," ").concat(F(j,"type"));else{var Q=Z($,".")?"property":"argument";V='The "'.concat($,'" ').concat(Q," ").concat(W," ").concat(F(j,"type"))}return V+=". Received type ".concat(typeof H)},TypeError),P("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),P("ERR_METHOD_NOT_IMPLEMENTED",function($){return"The "+$+" method is not implemented"}),P("ERR_STREAM_PREMATURE_CLOSE","Premature close"),P("ERR_STREAM_DESTROYED",function($){return"Cannot call "+$+" after a stream was destroyed"}),P("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),P("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),P("ERR_STREAM_WRITE_AFTER_END","write after end"),P("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),P("ERR_UNKNOWN_ENCODING",function($){return"Unknown encoding: "+$},TypeError),P("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),m.exports.codes=I},{}],67:[function(d,m,g){(function(w){(function(){var I=Object.keys||function(W){var V=[];for(var Q in W)V.push(Q);return V};m.exports=$;var P=d("./_stream_readable"),F=d("./_stream_writable");d("inherits")($,P);for(var D=I(F.prototype),U=0;U<D.length;U++){var Z=D[U];$.prototype[Z]||($.prototype[Z]=F.prototype[Z])}function $(W){if(!(this instanceof $))return new $(W);P.call(this,W),F.call(this,W),this.allowHalfOpen=!0,W&&(W.readable===!1&&(this.readable=!1),W.writable===!1&&(this.writable=!1),W.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",j)))}function j(){this._writableState.ended||w.nextTick(H,this)}function H(W){W.end()}Object.defineProperty($.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty($.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty($.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty($.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._writableState!==void 0&&this._readableState.destroyed&&this._writableState.destroyed},set:function(W){this._readableState!==void 0&&this._writableState!==void 0&&(this._readableState.destroyed=W,this._writableState.destroyed=W)}})}).call(this)}).call(this,d("_process"))},{"./_stream_readable":69,"./_stream_writable":71,_process:63,inherits:46}],68:[function(d,m,g){m.exports=I;var w=d("./_stream_transform");function I(P){if(!(this instanceof I))return new I(P);w.call(this,P)}d("inherits")(I,w),I.prototype._transform=function(P,F,D){D(null,P)}},{"./_stream_transform":70,inherits:46}],69:[function(d,m,g){(function(w,I){(function(){var P;m.exports=At,At.ReadableState=ct,d("events").EventEmitter;var F=function(xt,Rt){return xt.listeners(Rt).length},D=d("./internal/streams/stream"),U=d("buffer").Buffer,Z=I.Uint8Array||function(){};function $(xt){return U.from(xt)}function j(xt){return U.isBuffer(xt)||xt instanceof Z}var H,W=d("util");H=W&&W.debuglog?W.debuglog("stream"):function(){};var V,Q,K,q=d("./internal/streams/buffer_list"),et=d("./internal/streams/destroy"),X=d("./internal/streams/state").getHighWaterMark,tt=d("../errors").codes,rt=tt.ERR_INVALID_ARG_TYPE,ot=tt.ERR_STREAM_PUSH_AFTER_EOF,J=tt.ERR_METHOD_NOT_IMPLEMENTED,lt=tt.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;d("inherits")(At,D);var st=et.errorOrDestroy,ut=["error","close","destroy","pause","resume"];function it(xt,Rt,Gt){if(typeof xt.prependListener=="function")return xt.prependListener(Rt,Gt);xt._events&&xt._events[Rt]?Array.isArray(xt._events[Rt])?xt._events[Rt].unshift(Gt):xt._events[Rt]=[Gt,xt._events[Rt]]:xt.on(Rt,Gt)}function ct(xt,Rt,Gt){P=P||d("./_stream_duplex"),xt=xt||{},typeof Gt!="boolean"&&(Gt=Rt instanceof P),this.objectMode=!!xt.objectMode,Gt&&(this.objectMode=this.objectMode||!!xt.readableObjectMode),this.highWaterMark=X(this,xt,"readableHighWaterMark",Gt),this.buffer=new q,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=xt.emitClose!==!1,this.autoDestroy=!!xt.autoDestroy,this.destroyed=!1,this.defaultEncoding=xt.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,xt.encoding&&(V||(V=d("string_decoder/").StringDecoder),this.decoder=new V(xt.encoding),this.encoding=xt.encoding)}function At(xt){if(P=P||d("./_stream_duplex"),!(this instanceof At))return new At(xt);var Rt=this instanceof P;this._readableState=new ct(xt,this,Rt),this.readable=!0,xt&&(typeof xt.read=="function"&&(this._read=xt.read),typeof xt.destroy=="function"&&(this._destroy=xt.destroy)),D.call(this)}function Et(xt,Rt,Gt,nt,ht){H("readableAddChunk",Rt);var ft,at=xt._readableState;if(Rt===null)at.reading=!1,$t(xt,at);else if(ht||(ft=pt(at,Rt)),ft)st(xt,ft);else if(at.objectMode||Rt&&Rt.length>0)if(typeof Rt=="string"||at.objectMode||Object.getPrototypeOf(Rt)===U.prototype||(Rt=$(Rt)),nt)at.endEmitted?st(xt,new lt):gt(xt,at,Rt,!0);else if(at.ended)st(xt,new ot);else{if(at.destroyed)return!1;at.reading=!1,at.decoder&&!Gt?(Rt=at.decoder.write(Rt),at.objectMode||Rt.length!==0?gt(xt,at,Rt,!1):Ot(xt,at)):gt(xt,at,Rt,!1)}else nt||(at.reading=!1,Ot(xt,at));return!at.ended&&(at.length<at.highWaterMark||at.length===0)}function gt(xt,Rt,Gt,nt){Rt.flowing&&Rt.length===0&&!Rt.sync?(Rt.awaitDrain=0,xt.emit("data",Gt)):(Rt.length+=Rt.objectMode?1:Gt.length,nt?Rt.buffer.unshift(Gt):Rt.buffer.push(Gt),Rt.needReadable&&Bt(xt)),Ot(xt,Rt)}function pt(xt,Rt){var Gt;return j(Rt)||typeof Rt=="string"||Rt===void 0||xt.objectMode||(Gt=new rt("chunk",["string","Buffer","Uint8Array"],Rt)),Gt}Object.defineProperty(At.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._readableState.destroyed},set:function(xt){this._readableState&&(this._readableState.destroyed=xt)}}),At.prototype.destroy=et.destroy,At.prototype._undestroy=et.undestroy,At.prototype._destroy=function(xt,Rt){Rt(xt)},At.prototype.push=function(xt,Rt){var Gt,nt=this._readableState;return nt.objectMode?Gt=!0:typeof xt=="string"&&((Rt=Rt||nt.defaultEncoding)!==nt.encoding&&(xt=U.from(xt,Rt),Rt=""),Gt=!0),Et(this,xt,Rt,!1,Gt)},At.prototype.unshift=function(xt){return Et(this,xt,null,!0,!1)},At.prototype.isPaused=function(){return this._readableState.flowing===!1},At.prototype.setEncoding=function(xt){V||(V=d("string_decoder/").StringDecoder);var Rt=new V(xt);this._readableState.decoder=Rt,this._readableState.encoding=this._readableState.decoder.encoding;for(var Gt=this._readableState.buffer.head,nt="";Gt!==null;)nt+=Rt.write(Gt.data),Gt=Gt.next;return this._readableState.buffer.clear(),nt!==""&&this._readableState.buffer.push(nt),this._readableState.length=nt.length,this};var vt=1073741824;function Tt(xt){return xt>=vt?xt=vt:(xt--,xt|=xt>>>1,xt|=xt>>>2,xt|=xt>>>4,xt|=xt>>>8,xt|=xt>>>16,xt++),xt}function It(xt,Rt){return xt<=0||Rt.length===0&&Rt.ended?0:Rt.objectMode?1:xt!=xt?Rt.flowing&&Rt.length?Rt.buffer.head.data.length:Rt.length:(xt>Rt.highWaterMark&&(Rt.highWaterMark=Tt(xt)),xt<=Rt.length?xt:Rt.ended?Rt.length:(Rt.needReadable=!0,0))}function $t(xt,Rt){if(H("onEofChunk"),!Rt.ended){if(Rt.decoder){var Gt=Rt.decoder.end();Gt&&Gt.length&&(Rt.buffer.push(Gt),Rt.length+=Rt.objectMode?1:Gt.length)}Rt.ended=!0,Rt.sync?Bt(xt):(Rt.needReadable=!1,Rt.emittedReadable||(Rt.emittedReadable=!0,zt(xt)))}}function Bt(xt){var Rt=xt._readableState;H("emitReadable",Rt.needReadable,Rt.emittedReadable),Rt.needReadable=!1,Rt.emittedReadable||(H("emitReadable",Rt.flowing),Rt.emittedReadable=!0,w.nextTick(zt,xt))}function zt(xt){var Rt=xt._readableState;H("emitReadable_",Rt.destroyed,Rt.length,Rt.ended),Rt.destroyed||!Rt.length&&!Rt.ended||(xt.emit("readable"),Rt.emittedReadable=!1),Rt.needReadable=!Rt.flowing&&!Rt.ended&&Rt.length<=Rt.highWaterMark,Dt(xt)}function Ot(xt,Rt){Rt.readingMore||(Rt.readingMore=!0,w.nextTick(Nt,xt,Rt))}function Nt(xt,Rt){for(;!Rt.reading&&!Rt.ended&&(Rt.length<Rt.highWaterMark||Rt.flowing&&Rt.length===0);){var Gt=Rt.length;if(H("maybeReadMore read 0"),xt.read(0),Gt===Rt.length)break}Rt.readingMore=!1}function Pt(xt){return function(){var Rt=xt._readableState;H("pipeOnDrain",Rt.awaitDrain),Rt.awaitDrain&&Rt.awaitDrain--,Rt.awaitDrain===0&&F(xt,"data")&&(Rt.flowing=!0,Dt(xt))}}function Ut(xt){var Rt=xt._readableState;Rt.readableListening=xt.listenerCount("readable")>0,Rt.resumeScheduled&&!Rt.paused?Rt.flowing=!0:xt.listenerCount("data")>0&&xt.resume()}function Ft(xt){H("readable nexttick read 0"),xt.read(0)}function Zt(xt,Rt){Rt.resumeScheduled||(Rt.resumeScheduled=!0,w.nextTick(Ht,xt,Rt))}function Ht(xt,Rt){H("resume",Rt.reading),Rt.reading||xt.read(0),Rt.resumeScheduled=!1,xt.emit("resume"),Dt(xt),Rt.flowing&&!Rt.reading&&xt.read(0)}function Dt(xt){var Rt=xt._readableState;for(H("flow",Rt.flowing);Rt.flowing&&xt.read()!==null;);}function dt(xt,Rt){return Rt.length===0?null:(Rt.objectMode?Gt=Rt.buffer.shift():!xt||xt>=Rt.length?(Gt=Rt.decoder?Rt.buffer.join(""):Rt.buffer.length===1?Rt.buffer.first():Rt.buffer.concat(Rt.length),Rt.buffer.clear()):Gt=Rt.buffer.consume(xt,Rt.decoder),Gt);var Gt}function Lt(xt){var Rt=xt._readableState;H("endReadable",Rt.endEmitted),Rt.endEmitted||(Rt.ended=!0,w.nextTick(bt,Rt,xt))}function bt(xt,Rt){if(H("endReadableNT",xt.endEmitted,xt.length),!xt.endEmitted&&xt.length===0&&(xt.endEmitted=!0,Rt.readable=!1,Rt.emit("end"),xt.autoDestroy)){var Gt=Rt._writableState;(!Gt||Gt.autoDestroy&&Gt.finished)&&Rt.destroy()}}function wt(xt,Rt){for(var Gt=0,nt=xt.length;Gt<nt;Gt++)if(xt[Gt]===Rt)return Gt;return-1}At.prototype.read=function(xt){H("read",xt),xt=parseInt(xt,10);var Rt=this._readableState,Gt=xt;if(xt!==0&&(Rt.emittedReadable=!1),xt===0&&Rt.needReadable&&((Rt.highWaterMark!==0?Rt.length>=Rt.highWaterMark:Rt.length>0)||Rt.ended))return H("read: emitReadable",Rt.length,Rt.ended),Rt.length===0&&Rt.ended?Lt(this):Bt(this),null;if((xt=It(xt,Rt))===0&&Rt.ended)return Rt.length===0&&Lt(this),null;var nt,ht=Rt.needReadable;return H("need readable",ht),(Rt.length===0||Rt.length-xt<Rt.highWaterMark)&&H("length less than watermark",ht=!0),Rt.ended||Rt.reading?H("reading or ended",ht=!1):ht&&(H("do read"),Rt.reading=!0,Rt.sync=!0,Rt.length===0&&(Rt.needReadable=!0),this._read(Rt.highWaterMark),Rt.sync=!1,Rt.reading||(xt=It(Gt,Rt))),(nt=xt>0?dt(xt,Rt):null)===null?(Rt.needReadable=Rt.length<=Rt.highWaterMark,xt=0):(Rt.length-=xt,Rt.awaitDrain=0),Rt.length===0&&(Rt.ended||(Rt.needReadable=!0),Gt!==xt&&Rt.ended&&Lt(this)),nt!==null&&this.emit("data",nt),nt},At.prototype._read=function(xt){st(this,new J("_read()"))},At.prototype.pipe=function(xt,Rt){var Gt=this,nt=this._readableState;switch(nt.pipesCount){case 0:nt.pipes=xt;break;case 1:nt.pipes=[nt.pipes,xt];break;default:nt.pipes.push(xt)}nt.pipesCount+=1,H("pipe count=%d opts=%j",nt.pipesCount,Rt);var ht=Rt&&Rt.end===!1||xt===w.stdout||xt===w.stderr?fe:at;function ft(le,ue){H("onunpipe"),le===Gt&&ue&&ue.hasUnpiped===!1&&(ue.hasUnpiped=!0,Vt())}function at(){H("onend"),xt.end()}nt.endEmitted?w.nextTick(ht):Gt.once("end",ht),xt.on("unpipe",ft);var _t=Pt(Gt);xt.on("drain",_t);var St=!1;function Vt(){H("cleanup"),xt.removeListener("close",se),xt.removeListener("finish",ae),xt.removeListener("drain",_t),xt.removeListener("error",Jt),xt.removeListener("unpipe",ft),Gt.removeListener("end",at),Gt.removeListener("end",fe),Gt.removeListener("data",ee),St=!0,!nt.awaitDrain||xt._writableState&&!xt._writableState.needDrain||_t()}function ee(le){H("ondata");var ue=xt.write(le);H("dest.write",ue),ue===!1&&((nt.pipesCount===1&&nt.pipes===xt||nt.pipesCount>1&&wt(nt.pipes,xt)!==-1)&&!St&&(H("false write response, pause",nt.awaitDrain),nt.awaitDrain++),Gt.pause())}function Jt(le){H("onerror",le),fe(),xt.removeListener("error",Jt),F(xt,"error")===0&&st(xt,le)}function se(){xt.removeListener("finish",ae),fe()}function ae(){H("onfinish"),xt.removeListener("close",se),fe()}function fe(){H("unpipe"),Gt.unpipe(xt)}return Gt.on("data",ee),it(xt,"error",Jt),xt.once("close",se),xt.once("finish",ae),xt.emit("pipe",Gt),nt.flowing||(H("pipe resume"),Gt.resume()),xt},At.prototype.unpipe=function(xt){var Rt=this._readableState,Gt={hasUnpiped:!1};if(Rt.pipesCount===0)return this;if(Rt.pipesCount===1)return xt&&xt!==Rt.pipes||(xt||(xt=Rt.pipes),Rt.pipes=null,Rt.pipesCount=0,Rt.flowing=!1,xt&&xt.emit("unpipe",this,Gt)),this;if(!xt){var nt=Rt.pipes,ht=Rt.pipesCount;Rt.pipes=null,Rt.pipesCount=0,Rt.flowing=!1;for(var ft=0;ft<ht;ft++)nt[ft].emit("unpipe",this,{hasUnpiped:!1});return this}var at=wt(Rt.pipes,xt);return at===-1||(Rt.pipes.splice(at,1),Rt.pipesCount-=1,Rt.pipesCount===1&&(Rt.pipes=Rt.pipes[0]),xt.emit("unpipe",this,Gt)),this},At.prototype.on=function(xt,Rt){var Gt=D.prototype.on.call(this,xt,Rt),nt=this._readableState;return xt==="data"?(nt.readableListening=this.listenerCount("readable")>0,nt.flowing!==!1&&this.resume()):xt==="readable"&&(nt.endEmitted||nt.readableListening||(nt.readableListening=nt.needReadable=!0,nt.flowing=!1,nt.emittedReadable=!1,H("on readable",nt.length,nt.reading),nt.length?Bt(this):nt.reading||w.nextTick(Ft,this))),Gt},At.prototype.addListener=At.prototype.on,At.prototype.removeListener=function(xt,Rt){var Gt=D.prototype.removeListener.call(this,xt,Rt);return xt==="readable"&&w.nextTick(Ut,this),Gt},At.prototype.removeAllListeners=function(xt){var Rt=D.prototype.removeAllListeners.apply(this,arguments);return xt!=="readable"&&xt!==void 0||w.nextTick(Ut,this),Rt},At.prototype.resume=function(){var xt=this._readableState;return xt.flowing||(H("resume"),xt.flowing=!xt.readableListening,Zt(this,xt)),xt.paused=!1,this},At.prototype.pause=function(){return H("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(H("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},At.prototype.wrap=function(xt){var Rt=this,Gt=this._readableState,nt=!1;for(var ht in xt.on("end",function(){if(H("wrapped end"),Gt.decoder&&!Gt.ended){var at=Gt.decoder.end();at&&at.length&&Rt.push(at)}Rt.push(null)}),xt.on("data",function(at){H("wrapped data"),Gt.decoder&&(at=Gt.decoder.write(at)),Gt.objectMode&&at==null||(Gt.objectMode||at&&at.length)&&(Rt.push(at)||(nt=!0,xt.pause()))}),xt)this[ht]===void 0&&typeof xt[ht]=="function"&&(this[ht]=function(at){return function(){return xt[at].apply(xt,arguments)}}(ht));for(var ft=0;ft<ut.length;ft++)xt.on(ut[ft],this.emit.bind(this,ut[ft]));return this._read=function(at){H("wrapped _read",at),nt&&(nt=!1,xt.resume())},this},typeof Symbol=="function"&&(At.prototype[Symbol.asyncIterator]=function(){return Q===void 0&&(Q=d("./internal/streams/async_iterator")),Q(this)}),Object.defineProperty(At.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(At.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(At.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(xt){this._readableState&&(this._readableState.flowing=xt)}}),At._fromList=dt,Object.defineProperty(At.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),typeof Symbol=="function"&&(At.from=function(xt,Rt){return K===void 0&&(K=d("./internal/streams/from")),K(At,xt,Rt)})}).call(this)}).call(this,d("_process"),commonjsGlobal!==void 0?commonjsGlobal:typeof self<"u"?self:typeof window<"u"?window:{})},{"../errors":66,"./_stream_duplex":67,"./internal/streams/async_iterator":72,"./internal/streams/buffer_list":73,"./internal/streams/destroy":74,"./internal/streams/from":76,"./internal/streams/state":78,"./internal/streams/stream":79,_process:63,buffer:32,events:35,inherits:46,"string_decoder/":80,util:29}],70:[function(d,m,g){m.exports=$;var w=d("../errors").codes,I=w.ERR_METHOD_NOT_IMPLEMENTED,P=w.ERR_MULTIPLE_CALLBACK,F=w.ERR_TRANSFORM_ALREADY_TRANSFORMING,D=w.ERR_TRANSFORM_WITH_LENGTH_0,U=d("./_stream_duplex");function Z(W,V){var Q=this._transformState;Q.transforming=!1;var K=Q.writecb;if(K===null)return this.emit("error",new P);Q.writechunk=null,Q.writecb=null,V!=null&&this.push(V),K(W);var q=this._readableState;q.reading=!1,(q.needReadable||q.length<q.highWaterMark)&&this._read(q.highWaterMark)}function $(W){if(!(this instanceof $))return new $(W);U.call(this,W),this._transformState={afterTransform:Z.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,W&&(typeof W.transform=="function"&&(this._transform=W.transform),typeof W.flush=="function"&&(this._flush=W.flush)),this.on("prefinish",j)}function j(){var W=this;typeof this._flush!="function"||this._readableState.destroyed?H(this,null,null):this._flush(function(V,Q){H(W,V,Q)})}function H(W,V,Q){if(V)return W.emit("error",V);if(Q!=null&&W.push(Q),W._writableState.length)throw new D;if(W._transformState.transforming)throw new F;return W.push(null)}d("inherits")($,U),$.prototype.push=function(W,V){return this._transformState.needTransform=!1,U.prototype.push.call(this,W,V)},$.prototype._transform=function(W,V,Q){Q(new I("_transform()"))},$.prototype._write=function(W,V,Q){var K=this._transformState;if(K.writecb=Q,K.writechunk=W,K.writeencoding=V,!K.transforming){var q=this._readableState;(K.needTransform||q.needReadable||q.length<q.highWaterMark)&&this._read(q.highWaterMark)}},$.prototype._read=function(W){var V=this._transformState;V.writechunk===null||V.transforming?V.needTransform=!0:(V.transforming=!0,this._transform(V.writechunk,V.writeencoding,V.afterTransform))},$.prototype._destroy=function(W,V){U.prototype._destroy.call(this,W,function(Q){V(Q)})}},{"../errors":66,"./_stream_duplex":67,inherits:46}],71:[function(d,m,g){(function(w,I){(function(){function P(Dt){var dt=this;this.next=null,this.entry=null,this.finish=function(){Ht(dt,Dt)}}var F;m.exports=ct,ct.WritableState=it;var D={deprecate:d("util-deprecate")},U=d("./internal/streams/stream"),Z=d("buffer").Buffer,$=I.Uint8Array||function(){};function j(Dt){return Z.from(Dt)}function H(Dt){return Z.isBuffer(Dt)||Dt instanceof $}var W,V=d("./internal/streams/destroy"),Q=d("./internal/streams/state").getHighWaterMark,K=d("../errors").codes,q=K.ERR_INVALID_ARG_TYPE,et=K.ERR_METHOD_NOT_IMPLEMENTED,X=K.ERR_MULTIPLE_CALLBACK,tt=K.ERR_STREAM_CANNOT_PIPE,rt=K.ERR_STREAM_DESTROYED,ot=K.ERR_STREAM_NULL_VALUES,J=K.ERR_STREAM_WRITE_AFTER_END,lt=K.ERR_UNKNOWN_ENCODING,st=V.errorOrDestroy;function ut(){}function it(Dt,dt,Lt){F=F||d("./_stream_duplex"),Dt=Dt||{},typeof Lt!="boolean"&&(Lt=dt instanceof F),this.objectMode=!!Dt.objectMode,Lt&&(this.objectMode=this.objectMode||!!Dt.writableObjectMode),this.highWaterMark=Q(this,Dt,"writableHighWaterMark",Lt),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var bt=Dt.decodeStrings===!1;this.decodeStrings=!bt,this.defaultEncoding=Dt.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(wt){$t(dt,wt)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=Dt.emitClose!==!1,this.autoDestroy=!!Dt.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new P(this)}function ct(Dt){var dt=this instanceof(F=F||d("./_stream_duplex"));if(!dt&&!W.call(ct,this))return new ct(Dt);this._writableState=new it(Dt,this,dt),this.writable=!0,Dt&&(typeof Dt.write=="function"&&(this._write=Dt.write),typeof Dt.writev=="function"&&(this._writev=Dt.writev),typeof Dt.destroy=="function"&&(this._destroy=Dt.destroy),typeof Dt.final=="function"&&(this._final=Dt.final)),U.call(this)}function At(Dt,dt){var Lt=new J;st(Dt,Lt),w.nextTick(dt,Lt)}function Et(Dt,dt,Lt,bt){var wt;return Lt===null?wt=new ot:typeof Lt=="string"||dt.objectMode||(wt=new q("chunk",["string","Buffer"],Lt)),!wt||(st(Dt,wt),w.nextTick(bt,wt),!1)}function gt(Dt,dt,Lt){return Dt.objectMode||Dt.decodeStrings===!1||typeof dt!="string"||(dt=Z.from(dt,Lt)),dt}function pt(Dt,dt,Lt,bt,wt,xt){if(!Lt){var Rt=gt(dt,bt,wt);bt!==Rt&&(Lt=!0,wt="buffer",bt=Rt)}var Gt=dt.objectMode?1:bt.length;dt.length+=Gt;var nt=dt.length<dt.highWaterMark;if(nt||(dt.needDrain=!0),dt.writing||dt.corked){var ht=dt.lastBufferedRequest;dt.lastBufferedRequest={chunk:bt,encoding:wt,isBuf:Lt,callback:xt,next:null},ht?ht.next=dt.lastBufferedRequest:dt.bufferedRequest=dt.lastBufferedRequest,dt.bufferedRequestCount+=1}else vt(Dt,dt,!1,Gt,bt,wt,xt);return nt}function vt(Dt,dt,Lt,bt,wt,xt,Rt){dt.writelen=bt,dt.writecb=Rt,dt.writing=!0,dt.sync=!0,dt.destroyed?dt.onwrite(new rt("write")):Lt?Dt._writev(wt,dt.onwrite):Dt._write(wt,xt,dt.onwrite),dt.sync=!1}function Tt(Dt,dt,Lt,bt,wt){--dt.pendingcb,Lt?(w.nextTick(wt,bt),w.nextTick(Ft,Dt,dt),Dt._writableState.errorEmitted=!0,st(Dt,bt)):(wt(bt),Dt._writableState.errorEmitted=!0,st(Dt,bt),Ft(Dt,dt))}function It(Dt){Dt.writing=!1,Dt.writecb=null,Dt.length-=Dt.writelen,Dt.writelen=0}function $t(Dt,dt){var Lt=Dt._writableState,bt=Lt.sync,wt=Lt.writecb;if(typeof wt!="function")throw new X;if(It(Lt),dt)Tt(Dt,Lt,bt,dt,wt);else{var xt=Nt(Lt)||Dt.destroyed;xt||Lt.corked||Lt.bufferProcessing||!Lt.bufferedRequest||Ot(Dt,Lt),bt?w.nextTick(Bt,Dt,Lt,xt,wt):Bt(Dt,Lt,xt,wt)}}function Bt(Dt,dt,Lt,bt){Lt||zt(Dt,dt),dt.pendingcb--,bt(),Ft(Dt,dt)}function zt(Dt,dt){dt.length===0&&dt.needDrain&&(dt.needDrain=!1,Dt.emit("drain"))}function Ot(Dt,dt){dt.bufferProcessing=!0;var Lt=dt.bufferedRequest;if(Dt._writev&&Lt&&Lt.next){var bt=dt.bufferedRequestCount,wt=new Array(bt),xt=dt.corkedRequestsFree;xt.entry=Lt;for(var Rt=0,Gt=!0;Lt;)wt[Rt]=Lt,Lt.isBuf||(Gt=!1),Lt=Lt.next,Rt+=1;wt.allBuffers=Gt,vt(Dt,dt,!0,dt.length,wt,"",xt.finish),dt.pendingcb++,dt.lastBufferedRequest=null,xt.next?(dt.corkedRequestsFree=xt.next,xt.next=null):dt.corkedRequestsFree=new P(dt),dt.bufferedRequestCount=0}else{for(;Lt;){var nt=Lt.chunk,ht=Lt.encoding,ft=Lt.callback;if(vt(Dt,dt,!1,dt.objectMode?1:nt.length,nt,ht,ft),Lt=Lt.next,dt.bufferedRequestCount--,dt.writing)break}Lt===null&&(dt.lastBufferedRequest=null)}dt.bufferedRequest=Lt,dt.bufferProcessing=!1}function Nt(Dt){return Dt.ending&&Dt.length===0&&Dt.bufferedRequest===null&&!Dt.finished&&!Dt.writing}function Pt(Dt,dt){Dt._final(function(Lt){dt.pendingcb--,Lt&&st(Dt,Lt),dt.prefinished=!0,Dt.emit("prefinish"),Ft(Dt,dt)})}function Ut(Dt,dt){dt.prefinished||dt.finalCalled||(typeof Dt._final!="function"||dt.destroyed?(dt.prefinished=!0,Dt.emit("prefinish")):(dt.pendingcb++,dt.finalCalled=!0,w.nextTick(Pt,Dt,dt)))}function Ft(Dt,dt){var Lt=Nt(dt);if(Lt&&(Ut(Dt,dt),dt.pendingcb===0&&(dt.finished=!0,Dt.emit("finish"),dt.autoDestroy))){var bt=Dt._readableState;(!bt||bt.autoDestroy&&bt.endEmitted)&&Dt.destroy()}return Lt}function Zt(Dt,dt,Lt){dt.ending=!0,Ft(Dt,dt),Lt&&(dt.finished?w.nextTick(Lt):Dt.once("finish",Lt)),dt.ended=!0,Dt.writable=!1}function Ht(Dt,dt,Lt){var bt=Dt.entry;for(Dt.entry=null;bt;){var wt=bt.callback;dt.pendingcb--,wt(Lt),bt=bt.next}dt.corkedRequestsFree.next=Dt}d("inherits")(ct,U),it.prototype.getBuffer=function(){for(var Dt=this.bufferedRequest,dt=[];Dt;)dt.push(Dt),Dt=Dt.next;return dt},function(){try{Object.defineProperty(it.prototype,"buffer",{get:D.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}(),typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(W=Function.prototype[Symbol.hasInstance],Object.defineProperty(ct,Symbol.hasInstance,{value:function(Dt){return!!W.call(this,Dt)||this===ct&&Dt&&Dt._writableState instanceof it}})):W=function(Dt){return Dt instanceof this},ct.prototype.pipe=function(){st(this,new tt)},ct.prototype.write=function(Dt,dt,Lt){var bt=this._writableState,wt=!1,xt=!bt.objectMode&&H(Dt);return xt&&!Z.isBuffer(Dt)&&(Dt=j(Dt)),typeof dt=="function"&&(Lt=dt,dt=null),xt?dt="buffer":dt||(dt=bt.defaultEncoding),typeof Lt!="function"&&(Lt=ut),bt.ending?At(this,Lt):(xt||Et(this,bt,Dt,Lt))&&(bt.pendingcb++,wt=pt(this,bt,xt,Dt,dt,Lt)),wt},ct.prototype.cork=function(){this._writableState.corked++},ct.prototype.uncork=function(){var Dt=this._writableState;Dt.corked&&(Dt.corked--,Dt.writing||Dt.corked||Dt.bufferProcessing||!Dt.bufferedRequest||Ot(this,Dt))},ct.prototype.setDefaultEncoding=function(Dt){if(typeof Dt=="string"&&(Dt=Dt.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((Dt+"").toLowerCase())>-1))throw new lt(Dt);return this._writableState.defaultEncoding=Dt,this},Object.defineProperty(ct.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(ct.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),ct.prototype._write=function(Dt,dt,Lt){Lt(new et("_write()"))},ct.prototype._writev=null,ct.prototype.end=function(Dt,dt,Lt){var bt=this._writableState;return typeof Dt=="function"?(Lt=Dt,Dt=null,dt=null):typeof dt=="function"&&(Lt=dt,dt=null),Dt!=null&&this.write(Dt,dt),bt.corked&&(bt.corked=1,this.uncork()),bt.ending||Zt(this,bt,Lt),this},Object.defineProperty(ct.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(ct.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState!==void 0&&this._writableState.destroyed},set:function(Dt){this._writableState&&(this._writableState.destroyed=Dt)}}),ct.prototype.destroy=V.destroy,ct.prototype._undestroy=V.undestroy,ct.prototype._destroy=function(Dt,dt){dt(Dt)}}).call(this)}).call(this,d("_process"),commonjsGlobal!==void 0?commonjsGlobal:typeof self<"u"?self:typeof window<"u"?window:{})},{"../errors":66,"./_stream_duplex":67,"./internal/streams/destroy":74,"./internal/streams/state":78,"./internal/streams/stream":79,_process:63,buffer:32,inherits:46,"util-deprecate":81}],72:[function(d,m,g){(function(w){(function(){var I;function P(rt,ot,J){return ot in rt?Object.defineProperty(rt,ot,{value:J,enumerable:!0,configurable:!0,writable:!0}):rt[ot]=J,rt}var F=d("./end-of-stream"),D=Symbol("lastResolve"),U=Symbol("lastReject"),Z=Symbol("error"),$=Symbol("ended"),j=Symbol("lastPromise"),H=Symbol("handlePromise"),W=Symbol("stream");function V(rt,ot){return{value:rt,done:ot}}function Q(rt){var ot=rt[D];if(ot!==null){var J=rt[W].read();J!==null&&(rt[j]=null,rt[D]=null,rt[U]=null,ot(V(J,!1)))}}function K(rt){w.nextTick(Q,rt)}function q(rt,ot){return function(J,lt){rt.then(function(){ot[$]?J(V(void 0,!0)):ot[H](J,lt)},lt)}}var et=Object.getPrototypeOf(function(){}),X=Object.setPrototypeOf((I={get stream(){return this[W]},next:function(){var rt=this,ot=this[Z];if(ot!==null)return Promise.reject(ot);if(this[$])return Promise.resolve(V(void 0,!0));if(this[W].destroyed)return new Promise(function(ut,it){w.nextTick(function(){rt[Z]?it(rt[Z]):ut(V(void 0,!0))})});var J,lt=this[j];if(lt)J=new Promise(q(lt,this));else{var st=this[W].read();if(st!==null)return Promise.resolve(V(st,!1));J=new Promise(this[H])}return this[j]=J,J}},P(I,Symbol.asyncIterator,function(){return this}),P(I,"return",function(){var rt=this;return new Promise(function(ot,J){rt[W].destroy(null,function(lt){lt?J(lt):ot(V(void 0,!0))})})}),I),et),tt=function(rt){var ot,J=Object.create(X,(P(ot={},W,{value:rt,writable:!0}),P(ot,D,{value:null,writable:!0}),P(ot,U,{value:null,writable:!0}),P(ot,Z,{value:null,writable:!0}),P(ot,$,{value:rt._readableState.endEmitted,writable:!0}),P(ot,H,{value:function(lt,st){var ut=J[W].read();ut?(J[j]=null,J[D]=null,J[U]=null,lt(V(ut,!1))):(J[D]=lt,J[U]=st)},writable:!0}),ot));return J[j]=null,F(rt,function(lt){if(lt&&lt.code!=="ERR_STREAM_PREMATURE_CLOSE"){var st=J[U];return st!==null&&(J[j]=null,J[D]=null,J[U]=null,st(lt)),void(J[Z]=lt)}var ut=J[D];ut!==null&&(J[j]=null,J[D]=null,J[U]=null,ut(V(void 0,!0))),J[$]=!0}),rt.on("readable",K.bind(null,J)),J};m.exports=tt}).call(this)}).call(this,d("_process"))},{"./end-of-stream":75,_process:63}],73:[function(d,m,g){function w(W,V){var Q=Object.keys(W);if(Object.getOwnPropertySymbols){var K=Object.getOwnPropertySymbols(W);V&&(K=K.filter(function(q){return Object.getOwnPropertyDescriptor(W,q).enumerable})),Q.push.apply(Q,K)}return Q}function I(W){for(var V=1;V<arguments.length;V++){var Q=arguments[V]!=null?arguments[V]:{};V%2?w(Object(Q),!0).forEach(function(K){P(W,K,Q[K])}):Object.getOwnPropertyDescriptors?Object.defineProperties(W,Object.getOwnPropertyDescriptors(Q)):w(Object(Q)).forEach(function(K){Object.defineProperty(W,K,Object.getOwnPropertyDescriptor(Q,K))})}return W}function P(W,V,Q){return V in W?Object.defineProperty(W,V,{value:Q,enumerable:!0,configurable:!0,writable:!0}):W[V]=Q,W}function F(W,V){if(!(W instanceof V))throw new TypeError("Cannot call a class as a function")}function D(W,V){for(var Q=0;Q<V.length;Q++){var K=V[Q];K.enumerable=K.enumerable||!1,K.configurable=!0,"value"in K&&(K.writable=!0),Object.defineProperty(W,K.key,K)}}function U(W,V,Q){return V&&D(W.prototype,V),W}var Z=d("buffer").Buffer,$=d("util").inspect,j=$&&$.custom||"inspect";function H(W,V,Q){Z.prototype.copy.call(W,V,Q)}m.exports=function(){function W(){F(this,W),this.head=null,this.tail=null,this.length=0}return U(W,[{key:"push",value:function(V){var Q={data:V,next:null};this.length>0?this.tail.next=Q:this.head=Q,this.tail=Q,++this.length}},{key:"unshift",value:function(V){var Q={data:V,next:this.head};this.length===0&&(this.tail=Q),this.head=Q,++this.length}},{key:"shift",value:function(){if(this.length!==0){var V=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,V}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(V){if(this.length===0)return"";for(var Q=this.head,K=""+Q.data;Q=Q.next;)K+=V+Q.data;return K}},{key:"concat",value:function(V){if(this.length===0)return Z.alloc(0);for(var Q=Z.allocUnsafe(V>>>0),K=this.head,q=0;K;)H(K.data,Q,q),q+=K.data.length,K=K.next;return Q}},{key:"consume",value:function(V,Q){var K;return V<this.head.data.length?(K=this.head.data.slice(0,V),this.head.data=this.head.data.slice(V)):K=V===this.head.data.length?this.shift():Q?this._getString(V):this._getBuffer(V),K}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(V){var Q=this.head,K=1,q=Q.data;for(V-=q.length;Q=Q.next;){var et=Q.data,X=V>et.length?et.length:V;if(X===et.length?q+=et:q+=et.slice(0,V),(V-=X)==0){X===et.length?(++K,Q.next?this.head=Q.next:this.head=this.tail=null):(this.head=Q,Q.data=et.slice(X));break}++K}return this.length-=K,q}},{key:"_getBuffer",value:function(V){var Q=Z.allocUnsafe(V),K=this.head,q=1;for(K.data.copy(Q),V-=K.data.length;K=K.next;){var et=K.data,X=V>et.length?et.length:V;if(et.copy(Q,Q.length-V,0,X),(V-=X)==0){X===et.length?(++q,K.next?this.head=K.next:this.head=this.tail=null):(this.head=K,K.data=et.slice(X));break}++q}return this.length-=q,Q}},{key:j,value:function(V,Q){return $(this,I({},Q,{depth:0,customInspect:!1}))}}]),W}()},{buffer:32,util:29}],74:[function(d,m,g){(function(w){(function(){function I($,j){var H=this,W=this._readableState&&this._readableState.destroyed,V=this._writableState&&this._writableState.destroyed;return W||V?(j?j($):$&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,w.nextTick(U,this,$)):w.nextTick(U,this,$)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy($||null,function(Q){!j&&Q?H._writableState?H._writableState.errorEmitted?w.nextTick(F,H):(H._writableState.errorEmitted=!0,w.nextTick(P,H,Q)):w.nextTick(P,H,Q):j?(w.nextTick(F,H),j(Q)):w.nextTick(F,H)}),this)}function P($,j){U($,j),F($)}function F($){$._writableState&&!$._writableState.emitClose||$._readableState&&!$._readableState.emitClose||$.emit("close")}function D(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function U($,j){$.emit("error",j)}function Z($,j){var H=$._readableState,W=$._writableState;H&&H.autoDestroy||W&&W.autoDestroy?$.destroy(j):$.emit("error",j)}m.exports={destroy:I,undestroy:D,errorOrDestroy:Z}}).call(this)}).call(this,d("_process"))},{_process:63}],75:[function(d,m,g){var w=d("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function I(U){var Z=!1;return function(){if(!Z){Z=!0;for(var $=arguments.length,j=new Array($),H=0;H<$;H++)j[H]=arguments[H];U.apply(this,j)}}}function P(){}function F(U){return U.setHeader&&typeof U.abort=="function"}function D(U,Z,$){if(typeof Z=="function")return D(U,null,Z);Z||(Z={}),$=I($||P);var j=Z.readable||Z.readable!==!1&&U.readable,H=Z.writable||Z.writable!==!1&&U.writable,W=function(){U.writable||Q()},V=U._writableState&&U._writableState.finished,Q=function(){H=!1,V=!0,j||$.call(U)},K=U._readableState&&U._readableState.endEmitted,q=function(){j=!1,K=!0,H||$.call(U)},et=function(rt){$.call(U,rt)},X=function(){var rt;return j&&!K?(U._readableState&&U._readableState.ended||(rt=new w),$.call(U,rt)):H&&!V?(U._writableState&&U._writableState.ended||(rt=new w),$.call(U,rt)):void 0},tt=function(){U.req.on("finish",Q)};return F(U)?(U.on("complete",Q),U.on("abort",X),U.req?tt():U.on("request",tt)):H&&!U._writableState&&(U.on("end",W),U.on("close",W)),U.on("end",q),U.on("finish",Q),Z.error!==!1&&U.on("error",et),U.on("close",X),function(){U.removeListener("complete",Q),U.removeListener("abort",X),U.removeListener("request",tt),U.req&&U.req.removeListener("finish",Q),U.removeListener("end",W),U.removeListener("close",W),U.removeListener("finish",Q),U.removeListener("end",q),U.removeListener("error",et),U.removeListener("close",X)}}m.exports=D},{"../../../errors":66}],76:[function(d,m,g){m.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],77:[function(d,m,g){var w;function I(Q){var K=!1;return function(){K||(K=!0,Q.apply(void 0,arguments))}}var P=d("../../../errors").codes,F=P.ERR_MISSING_ARGS,D=P.ERR_STREAM_DESTROYED;function U(Q){if(Q)throw Q}function Z(Q){return Q.setHeader&&typeof Q.abort=="function"}function $(Q,K,q,et){et=I(et);var X=!1;Q.on("close",function(){X=!0}),w===void 0&&(w=d("./end-of-stream")),w(Q,{readable:K,writable:q},function(rt){if(rt)return et(rt);X=!0,et()});var tt=!1;return function(rt){if(!X&&!tt)return tt=!0,Z(Q)?Q.abort():typeof Q.destroy=="function"?Q.destroy():void et(rt||new D("pipe"))}}function j(Q){Q()}function H(Q,K){return Q.pipe(K)}function W(Q){return Q.length?typeof Q[Q.length-1]!="function"?U:Q.pop():U}function V(){for(var Q=arguments.length,K=new Array(Q),q=0;q<Q;q++)K[q]=arguments[q];var et,X=W(K);if(Array.isArray(K[0])&&(K=K[0]),K.length<2)throw new F("streams");var tt=K.map(function(rt,ot){var J=ot<K.length-1;return $(rt,J,ot>0,function(lt){et||(et=lt),lt&&tt.forEach(j),J||(tt.forEach(j),X(et))})});return K.reduce(H)}m.exports=V},{"../../../errors":66,"./end-of-stream":75}],78:[function(d,m,g){var w=d("../../../errors").codes.ERR_INVALID_OPT_VALUE;function I(F,D,U){return F.highWaterMark!=null?F.highWaterMark:D?F[U]:null}function P(F,D,U,Z){var $=I(D,Z,U);if($!=null){if(!isFinite($)||Math.floor($)!==$||$<0)throw new w(Z?U:"highWaterMark",$);return Math.floor($)}return F.objectMode?16:16384}m.exports={getHighWaterMark:P}},{"../../../errors":66}],79:[function(d,m,g){m.exports=d("events").EventEmitter},{events:35}],80:[function(d,m,g){var w=d("safe-buffer").Buffer,I=w.isEncoding||function(tt){switch((tt=""+tt)&&tt.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function P(tt){if(!tt)return"utf8";for(var rt;;)switch(tt){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return tt;default:if(rt)return;tt=(""+tt).toLowerCase(),rt=!0}}function F(tt){var rt=P(tt);if(typeof rt!="string"&&(w.isEncoding===I||!I(tt)))throw new Error("Unknown encoding: "+tt);return rt||tt}function D(tt){var rt;switch(this.encoding=F(tt),this.encoding){case"utf16le":this.text=V,this.end=Q,rt=4;break;case"utf8":this.fillLast=j,rt=4;break;case"base64":this.text=K,this.end=q,rt=3;break;default:return this.write=et,void(this.end=X)}this.lastNeed=0,this.lastTotal=0,this.lastChar=w.allocUnsafe(rt)}function U(tt){return tt<=127?0:tt>>5==6?2:tt>>4==14?3:tt>>3==30?4:tt>>6==2?-1:-2}function Z(tt,rt,ot){var J=rt.length-1;if(J<ot)return 0;var lt=U(rt[J]);return lt>=0?(lt>0&&(tt.lastNeed=lt-1),lt):--J<ot||lt===-2?0:(lt=U(rt[J]))>=0?(lt>0&&(tt.lastNeed=lt-2),lt):--J<ot||lt===-2?0:(lt=U(rt[J]))>=0?(lt>0&&(lt===2?lt=0:tt.lastNeed=lt-3),lt):0}function $(tt,rt,ot){if((192&rt[0])!=128)return tt.lastNeed=0,"�";if(tt.lastNeed>1&&rt.length>1){if((192&rt[1])!=128)return tt.lastNeed=1,"�";if(tt.lastNeed>2&&rt.length>2&&(192&rt[2])!=128)return tt.lastNeed=2,"�"}}function j(tt){var rt=this.lastTotal-this.lastNeed,ot=$(this,tt);return ot!==void 0?ot:this.lastNeed<=tt.length?(tt.copy(this.lastChar,rt,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(tt.copy(this.lastChar,rt,0,tt.length),void(this.lastNeed-=tt.length))}function H(tt,rt){var ot=Z(this,tt,rt);if(!this.lastNeed)return tt.toString("utf8",rt);this.lastTotal=ot;var J=tt.length-(ot-this.lastNeed);return tt.copy(this.lastChar,0,J),tt.toString("utf8",rt,J)}function W(tt){var rt=tt&&tt.length?this.write(tt):"";return this.lastNeed?rt+"�":rt}function V(tt,rt){if((tt.length-rt)%2==0){var ot=tt.toString("utf16le",rt);if(ot){var J=ot.charCodeAt(ot.length-1);if(J>=55296&&J<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=tt[tt.length-2],this.lastChar[1]=tt[tt.length-1],ot.slice(0,-1)}return ot}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=tt[tt.length-1],tt.toString("utf16le",rt,tt.length-1)}function Q(tt){var rt=tt&&tt.length?this.write(tt):"";if(this.lastNeed){var ot=this.lastTotal-this.lastNeed;return rt+this.lastChar.toString("utf16le",0,ot)}return rt}function K(tt,rt){var ot=(tt.length-rt)%3;return ot===0?tt.toString("base64",rt):(this.lastNeed=3-ot,this.lastTotal=3,ot===1?this.lastChar[0]=tt[tt.length-1]:(this.lastChar[0]=tt[tt.length-2],this.lastChar[1]=tt[tt.length-1]),tt.toString("base64",rt,tt.length-ot))}function q(tt){var rt=tt&&tt.length?this.write(tt):"";return this.lastNeed?rt+this.lastChar.toString("base64",0,3-this.lastNeed):rt}function et(tt){return tt.toString(this.encoding)}function X(tt){return tt&&tt.length?this.write(tt):""}g.StringDecoder=D,D.prototype.write=function(tt){if(tt.length===0)return"";var rt,ot;if(this.lastNeed){if((rt=this.fillLast(tt))===void 0)return"";ot=this.lastNeed,this.lastNeed=0}else ot=0;return ot<tt.length?rt?rt+this.text(tt,ot):this.text(tt,ot):rt||""},D.prototype.end=W,D.prototype.text=H,D.prototype.fillLast=function(tt){if(this.lastNeed<=tt.length)return tt.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);tt.copy(this.lastChar,this.lastTotal-this.lastNeed,0,tt.length),this.lastNeed-=tt.length}},{"safe-buffer":64}],81:[function(d,m,g){(function(w){(function(){function I(F,D){if(P("noDeprecation"))return F;var U=!1;function Z(){if(!U){if(P("throwDeprecation"))throw new Error(D);P("traceDeprecation")?console.trace(D):console.warn(D),U=!0}return F.apply(this,arguments)}return Z}function P(F){try{if(!w.localStorage)return!1}catch{return!1}var D=w.localStorage[F];return D!=null&&String(D).toLowerCase()==="true"}m.exports=I}).call(this)}).call(this,commonjsGlobal!==void 0?commonjsGlobal:typeof self<"u"?self:typeof window<"u"?window:{})},{}],82:[function(d,m,g){arguments[4][25][0].apply(g,arguments)},{dup:25}],83:[function(d,m,g){var w=d("is-arguments"),I=d("is-generator-function"),P=d("which-typed-array"),F=d("is-typed-array");function D(at){return at.call.bind(at)}var U=typeof BigInt<"u",Z=typeof Symbol<"u",$=D(Object.prototype.toString),j=D(Number.prototype.valueOf),H=D(String.prototype.valueOf),W=D(Boolean.prototype.valueOf);if(U)var V=D(BigInt.prototype.valueOf);if(Z)var Q=D(Symbol.prototype.valueOf);function K(at,_t){if(typeof at!="object")return!1;try{return _t(at),!0}catch{return!1}}function q(at){return typeof Promise<"u"&&at instanceof Promise||at!==null&&typeof at=="object"&&typeof at.then=="function"&&typeof at.catch=="function"}function et(at){return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?ArrayBuffer.isView(at):F(at)||Pt(at)}function X(at){return P(at)==="Uint8Array"}function tt(at){return P(at)==="Uint8ClampedArray"}function rt(at){return P(at)==="Uint16Array"}function ot(at){return P(at)==="Uint32Array"}function J(at){return P(at)==="Int8Array"}function lt(at){return P(at)==="Int16Array"}function st(at){return P(at)==="Int32Array"}function ut(at){return P(at)==="Float32Array"}function it(at){return P(at)==="Float64Array"}function ct(at){return P(at)==="BigInt64Array"}function At(at){return P(at)==="BigUint64Array"}function Et(at){return $(at)==="[object Map]"}function gt(at){return typeof Map<"u"&&(Et.working?Et(at):at instanceof Map)}function pt(at){return $(at)==="[object Set]"}function vt(at){return typeof Set<"u"&&(pt.working?pt(at):at instanceof Set)}function Tt(at){return $(at)==="[object WeakMap]"}function It(at){return typeof WeakMap<"u"&&(Tt.working?Tt(at):at instanceof WeakMap)}function $t(at){return $(at)==="[object WeakSet]"}function Bt(at){return $t(at)}function zt(at){return $(at)==="[object ArrayBuffer]"}function Ot(at){return typeof ArrayBuffer<"u"&&(zt.working?zt(at):at instanceof ArrayBuffer)}function Nt(at){return $(at)==="[object DataView]"}function Pt(at){return typeof DataView<"u"&&(Nt.working?Nt(at):at instanceof DataView)}g.isArgumentsObject=w,g.isGeneratorFunction=I,g.isTypedArray=F,g.isPromise=q,g.isArrayBufferView=et,g.isUint8Array=X,g.isUint8ClampedArray=tt,g.isUint16Array=rt,g.isUint32Array=ot,g.isInt8Array=J,g.isInt16Array=lt,g.isInt32Array=st,g.isFloat32Array=ut,g.isFloat64Array=it,g.isBigInt64Array=ct,g.isBigUint64Array=At,Et.working=typeof Map<"u"&&Et(new Map),g.isMap=gt,pt.working=typeof Set<"u"&&pt(new Set),g.isSet=vt,Tt.working=typeof WeakMap<"u"&&Tt(new WeakMap),g.isWeakMap=It,$t.working=typeof WeakSet<"u"&&$t(new WeakSet),g.isWeakSet=Bt,zt.working=typeof ArrayBuffer<"u"&&zt(new ArrayBuffer),g.isArrayBuffer=Ot,Nt.working=typeof ArrayBuffer<"u"&&typeof DataView<"u"&&Nt(new DataView(new ArrayBuffer(1),0,1)),g.isDataView=Pt;var Ut=typeof SharedArrayBuffer<"u"?SharedArrayBuffer:void 0;function Ft(at){return $(at)==="[object SharedArrayBuffer]"}function Zt(at){return Ut!==void 0&&(Ft.working===void 0&&(Ft.working=Ft(new Ut)),Ft.working?Ft(at):at instanceof Ut)}function Ht(at){return $(at)==="[object AsyncFunction]"}function Dt(at){return $(at)==="[object Map Iterator]"}function dt(at){return $(at)==="[object Set Iterator]"}function Lt(at){return $(at)==="[object Generator]"}function bt(at){return $(at)==="[object WebAssembly.Module]"}function wt(at){return K(at,j)}function xt(at){return K(at,H)}function Rt(at){return K(at,W)}function Gt(at){return U&&K(at,V)}function nt(at){return Z&&K(at,Q)}function ht(at){return wt(at)||xt(at)||Rt(at)||Gt(at)||nt(at)}function ft(at){return typeof Uint8Array<"u"&&(Ot(at)||Zt(at))}g.isSharedArrayBuffer=Zt,g.isAsyncFunction=Ht,g.isMapIterator=Dt,g.isSetIterator=dt,g.isGeneratorObject=Lt,g.isWebAssemblyCompiledModule=bt,g.isNumberObject=wt,g.isStringObject=xt,g.isBooleanObject=Rt,g.isBigIntObject=Gt,g.isSymbolObject=nt,g.isBoxedPrimitive=ht,g.isAnyArrayBuffer=ft,["isProxy","isExternal","isModuleNamespaceObject"].forEach(function(at){Object.defineProperty(g,at,{enumerable:!1,value:function(){throw new Error(at+" is not supported in userland")}})})},{"is-arguments":47,"is-generator-function":49,"is-typed-array":50,"which-typed-array":85}],84:[function(d,m,g){(function(w){(function(){var I=Object.getOwnPropertyDescriptors||function(Pt){for(var Ut=Object.keys(Pt),Ft={},Zt=0;Zt<Ut.length;Zt++)Ft[Ut[Zt]]=Object.getOwnPropertyDescriptor(Pt,Ut[Zt]);return Ft},P=/%[sdj%]/g;g.format=function(Pt){if(!lt(Pt)){for(var Ut=[],Ft=0;Ft<arguments.length;Ft++)Ut.push(Z(arguments[Ft]));return Ut.join(" ")}Ft=1;for(var Zt=arguments,Ht=Zt.length,Dt=String(Pt).replace(P,function(Lt){if(Lt==="%%")return"%";if(Ft>=Ht)return Lt;switch(Lt){case"%s":return String(Zt[Ft++]);case"%d":return Number(Zt[Ft++]);case"%j":try{return JSON.stringify(Zt[Ft++])}catch{return"[Circular]"}default:return Lt}}),dt=Zt[Ft];Ft<Ht;dt=Zt[++Ft])rt(dt)||!ct(dt)?Dt+=" "+dt:Dt+=" "+Z(dt);return Dt},g.deprecate=function(Pt,Ut){if(w!==void 0&&w.noDeprecation===!0)return Pt;if(w===void 0)return function(){return g.deprecate(Pt,Ut).apply(this,arguments)};var Ft=!1;function Zt(){if(!Ft){if(w.throwDeprecation)throw new Error(Ut);w.traceDeprecation?console.trace(Ut):console.error(Ut),Ft=!0}return Pt.apply(this,arguments)}return Zt};var F={},D=/^$/;if(w.env.NODE_DEBUG){var U=w.env.NODE_DEBUG;U=U.replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase(),D=new RegExp("^"+U+"$","i")}function Z(Pt,Ut){var Ft={seen:[],stylize:j};return arguments.length>=3&&(Ft.depth=arguments[2]),arguments.length>=4&&(Ft.colors=arguments[3]),tt(Ut)?Ft.showHidden=Ut:Ut&&g._extend(Ft,Ut),ut(Ft.showHidden)&&(Ft.showHidden=!1),ut(Ft.depth)&&(Ft.depth=2),ut(Ft.colors)&&(Ft.colors=!1),ut(Ft.customInspect)&&(Ft.customInspect=!0),Ft.colors&&(Ft.stylize=$),W(Ft,Pt,Ft.depth)}function $(Pt,Ut){var Ft=Z.styles[Ut];return Ft?"\x1B["+Z.colors[Ft][0]+"m"+Pt+"\x1B["+Z.colors[Ft][1]+"m":Pt}function j(Pt,Ut){return Pt}function H(Pt){var Ut={};return Pt.forEach(function(Ft,Zt){Ut[Ft]=!0}),Ut}function W(Pt,Ut,Ft){if(Pt.customInspect&&Ut&&gt(Ut.inspect)&&Ut.inspect!==g.inspect&&(!Ut.constructor||Ut.constructor.prototype!==Ut)){var Zt=Ut.inspect(Ft,Pt);return lt(Zt)||(Zt=W(Pt,Zt,Ft)),Zt}var Ht=V(Pt,Ut);if(Ht)return Ht;var Dt=Object.keys(Ut),dt=H(Dt);if(Pt.showHidden&&(Dt=Object.getOwnPropertyNames(Ut)),Et(Ut)&&(Dt.indexOf("message")>=0||Dt.indexOf("description")>=0))return Q(Ut);if(Dt.length===0){if(gt(Ut)){var Lt=Ut.name?": "+Ut.name:"";return Pt.stylize("[Function"+Lt+"]","special")}if(it(Ut))return Pt.stylize(RegExp.prototype.toString.call(Ut),"regexp");if(At(Ut))return Pt.stylize(Date.prototype.toString.call(Ut),"date");if(Et(Ut))return Q(Ut)}var bt,wt="",xt=!1,Rt=["{","}"];return X(Ut)&&(xt=!0,Rt=["[","]"]),gt(Ut)&&(wt=" [Function"+(Ut.name?": "+Ut.name:"")+"]"),it(Ut)&&(wt=" "+RegExp.prototype.toString.call(Ut)),At(Ut)&&(wt=" "+Date.prototype.toUTCString.call(Ut)),Et(Ut)&&(wt=" "+Q(Ut)),Dt.length!==0||xt&&Ut.length!=0?Ft<0?it(Ut)?Pt.stylize(RegExp.prototype.toString.call(Ut),"regexp"):Pt.stylize("[Object]","special"):(Pt.seen.push(Ut),bt=xt?K(Pt,Ut,Ft,dt,Dt):Dt.map(function(Gt){return q(Pt,Ut,Ft,dt,Gt,xt)}),Pt.seen.pop(),et(bt,wt,Rt)):Rt[0]+wt+Rt[1]}function V(Pt,Ut){if(ut(Ut))return Pt.stylize("undefined","undefined");if(lt(Ut)){var Ft="'"+JSON.stringify(Ut).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return Pt.stylize(Ft,"string")}return J(Ut)?Pt.stylize(""+Ut,"number"):tt(Ut)?Pt.stylize(""+Ut,"boolean"):rt(Ut)?Pt.stylize("null","null"):void 0}function Q(Pt){return"["+Error.prototype.toString.call(Pt)+"]"}function K(Pt,Ut,Ft,Zt,Ht){for(var Dt=[],dt=0,Lt=Ut.length;dt<Lt;++dt)Bt(Ut,String(dt))?Dt.push(q(Pt,Ut,Ft,Zt,String(dt),!0)):Dt.push("");return Ht.forEach(function(bt){bt.match(/^\d+$/)||Dt.push(q(Pt,Ut,Ft,Zt,bt,!0))}),Dt}function q(Pt,Ut,Ft,Zt,Ht,Dt){var dt,Lt,bt;if((bt=Object.getOwnPropertyDescriptor(Ut,Ht)||{value:Ut[Ht]}).get?Lt=bt.set?Pt.stylize("[Getter/Setter]","special"):Pt.stylize("[Getter]","special"):bt.set&&(Lt=Pt.stylize("[Setter]","special")),Bt(Zt,Ht)||(dt="["+Ht+"]"),Lt||(Pt.seen.indexOf(bt.value)<0?(Lt=rt(Ft)?W(Pt,bt.value,null):W(Pt,bt.value,Ft-1)).indexOf(`
`)>-1&&(Lt=Dt?Lt.split(`
`).map(function(wt){return"  "+wt}).join(`
`).slice(2):`
`+Lt.split(`
`).map(function(wt){return"   "+wt}).join(`
`)):Lt=Pt.stylize("[Circular]","special")),ut(dt)){if(Dt&&Ht.match(/^\d+$/))return Lt;(dt=JSON.stringify(""+Ht)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(dt=dt.slice(1,-1),dt=Pt.stylize(dt,"name")):(dt=dt.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),dt=Pt.stylize(dt,"string"))}return dt+": "+Lt}function et(Pt,Ut,Ft){return Pt.reduce(function(Zt,Ht){return Ht.indexOf(`
`),Zt+Ht.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?Ft[0]+(Ut===""?"":Ut+`
 `)+" "+Pt.join(`,
  `)+" "+Ft[1]:Ft[0]+Ut+" "+Pt.join(", ")+" "+Ft[1]}function X(Pt){return Array.isArray(Pt)}function tt(Pt){return typeof Pt=="boolean"}function rt(Pt){return Pt===null}function ot(Pt){return Pt==null}function J(Pt){return typeof Pt=="number"}function lt(Pt){return typeof Pt=="string"}function st(Pt){return typeof Pt=="symbol"}function ut(Pt){return Pt===void 0}function it(Pt){return ct(Pt)&&vt(Pt)==="[object RegExp]"}function ct(Pt){return typeof Pt=="object"&&Pt!==null}function At(Pt){return ct(Pt)&&vt(Pt)==="[object Date]"}function Et(Pt){return ct(Pt)&&(vt(Pt)==="[object Error]"||Pt instanceof Error)}function gt(Pt){return typeof Pt=="function"}function pt(Pt){return Pt===null||typeof Pt=="boolean"||typeof Pt=="number"||typeof Pt=="string"||typeof Pt=="symbol"||Pt===void 0}function vt(Pt){return Object.prototype.toString.call(Pt)}function Tt(Pt){return Pt<10?"0"+Pt.toString(10):Pt.toString(10)}g.debuglog=function(Pt){if(Pt=Pt.toUpperCase(),!F[Pt])if(D.test(Pt)){var Ut=w.pid;F[Pt]=function(){var Ft=g.format.apply(g,arguments);console.error("%s %d: %s",Pt,Ut,Ft)}}else F[Pt]=function(){};return F[Pt]},g.inspect=Z,Z.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},Z.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},g.types=d("./support/types"),g.isArray=X,g.isBoolean=tt,g.isNull=rt,g.isNullOrUndefined=ot,g.isNumber=J,g.isString=lt,g.isSymbol=st,g.isUndefined=ut,g.isRegExp=it,g.types.isRegExp=it,g.isObject=ct,g.isDate=At,g.types.isDate=At,g.isError=Et,g.types.isNativeError=Et,g.isFunction=gt,g.isPrimitive=pt,g.isBuffer=d("./support/isBuffer");var It=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function $t(){var Pt=new Date,Ut=[Tt(Pt.getHours()),Tt(Pt.getMinutes()),Tt(Pt.getSeconds())].join(":");return[Pt.getDate(),It[Pt.getMonth()],Ut].join(" ")}function Bt(Pt,Ut){return Object.prototype.hasOwnProperty.call(Pt,Ut)}g.log=function(){console.log("%s - %s",$t(),g.format.apply(g,arguments))},g.inherits=d("inherits"),g._extend=function(Pt,Ut){if(!Ut||!ct(Ut))return Pt;for(var Ft=Object.keys(Ut),Zt=Ft.length;Zt--;)Pt[Ft[Zt]]=Ut[Ft[Zt]];return Pt};var zt=typeof Symbol<"u"?Symbol("util.promisify.custom"):void 0;function Ot(Pt,Ut){if(!Pt){var Ft=new Error("Promise was rejected with a falsy value");Ft.reason=Pt,Pt=Ft}return Ut(Pt)}function Nt(Pt){if(typeof Pt!="function")throw new TypeError('The "original" argument must be of type Function');function Ut(){for(var Ft=[],Zt=0;Zt<arguments.length;Zt++)Ft.push(arguments[Zt]);var Ht=Ft.pop();if(typeof Ht!="function")throw new TypeError("The last argument must be of type Function");var Dt=this,dt=function(){return Ht.apply(Dt,arguments)};Pt.apply(this,Ft).then(function(Lt){w.nextTick(dt.bind(null,null,Lt))},function(Lt){w.nextTick(Ot.bind(null,Lt,dt))})}return Object.setPrototypeOf(Ut,Object.getPrototypeOf(Pt)),Object.defineProperties(Ut,I(Pt)),Ut}g.promisify=function(Pt){if(typeof Pt!="function")throw new TypeError('The "original" argument must be of type Function');if(zt&&Pt[zt]){var Ut;if(typeof(Ut=Pt[zt])!="function")throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(Ut,zt,{value:Ut,enumerable:!1,writable:!1,configurable:!0}),Ut}function Ut(){for(var Ft,Zt,Ht=new Promise(function(Lt,bt){Ft=Lt,Zt=bt}),Dt=[],dt=0;dt<arguments.length;dt++)Dt.push(arguments[dt]);Dt.push(function(Lt,bt){Lt?Zt(Lt):Ft(bt)});try{Pt.apply(this,Dt)}catch(Lt){Zt(Lt)}return Ht}return Object.setPrototypeOf(Ut,Object.getPrototypeOf(Pt)),zt&&Object.defineProperty(Ut,zt,{value:Ut,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(Ut,I(Pt))},g.promisify.custom=zt,g.callbackify=Nt}).call(this)}).call(this,d("_process"))},{"./support/isBuffer":82,"./support/types":83,_process:63,inherits:46}],85:[function(d,m,g){(function(w){(function(){var I=d("for-each"),P=d("available-typed-arrays"),F=d("call-bind/callBound"),D=d("gopd"),U=F("Object.prototype.toString"),Z=d("has-tostringtag/shams")(),$=typeof globalThis>"u"?w:globalThis,j=P(),H=F("String.prototype.slice"),W={},V=Object.getPrototypeOf;Z&&D&&V&&I(j,function(q){if(typeof $[q]=="function"){var et=new $[q];if(Symbol.toStringTag in et){var X=V(et),tt=D(X,Symbol.toStringTag);if(!tt){var rt=V(X);tt=D(rt,Symbol.toStringTag)}W[q]=tt.get}}});var Q=function(q){var et=!1;return I(W,function(X,tt){if(!et)try{var rt=X.call(q);rt===tt&&(et=rt)}catch{}}),et},K=d("is-typed-array");m.exports=function(q){return!!K(q)&&(Z&&Symbol.toStringTag in q?Q(q):H(U(q),8,-1))}}).call(this)}).call(this,commonjsGlobal!==void 0?commonjsGlobal:typeof self<"u"?self:typeof window<"u"?window:{})},{"available-typed-arrays":27,"call-bind/callBound":33,"for-each":36,gopd:40,"has-tostringtag/shams":43,"is-typed-array":50}]},{},[20])(20);var browserExports=browser$1.exports,PNGFilterType,PNGFilterType2,PNGColorType,PNGColorType2;function png(){return{mime:"image/png",hasAlpha:!0,encode:(d,{deflateLevel:m=9,deflateStrategy:g=3,filterType:w=PNGFilterType.AUTO,colorType:I,inputHasAlpha:P=!0,...F}={})=>{const D=new browserExports.PNG({width:d.width,height:d.height});return D.data=d.data,browserExports.PNG.sync.write(D,{...F,deflateLevel:m,deflateStrategy:g,filterType:w,colorType:I!==void 0?I:P?PNGColorType.COLOR_ALPHA:PNGColorType.COLOR,inputHasAlpha:P})},decode:(d,m)=>{const g=browserExports.PNG.sync.read(d,m);return{data:g.data,width:g.width,height:g.height}}}}PNGFilterType2=PNGFilterType||(PNGFilterType={}),PNGFilterType2[PNGFilterType2.AUTO=-1]="AUTO",PNGFilterType2[PNGFilterType2.NONE=0]="NONE",PNGFilterType2[PNGFilterType2.SUB=1]="SUB",PNGFilterType2[PNGFilterType2.UP=2]="UP",PNGFilterType2[PNGFilterType2.AVERAGE=3]="AVERAGE",PNGFilterType2[PNGFilterType2.PATH=4]="PATH",PNGColorType2=PNGColorType||(PNGColorType={}),PNGColorType2[PNGColorType2.GRAYSCALE=0]="GRAYSCALE",PNGColorType2[PNGColorType2.COLOR=2]="COLOR",PNGColorType2[PNGColorType2.GRAYSCALE_ALPHA=4]="GRAYSCALE_ALPHA",PNGColorType2[PNGColorType2.COLOR_ALPHA=6]="COLOR_ALPHA";var UTIF={exports:{}},common={},hasRequiredCommon;function requireCommon(){return hasRequiredCommon||(hasRequiredCommon=1,function(d){var m=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";function g(P,F){return Object.prototype.hasOwnProperty.call(P,F)}d.assign=function(P){for(var F=Array.prototype.slice.call(arguments,1);F.length;){var D=F.shift();if(D){if(typeof D!="object")throw new TypeError(D+"must be non-object");for(var U in D)g(D,U)&&(P[U]=D[U])}}return P},d.shrinkBuf=function(P,F){return P.length===F?P:P.subarray?P.subarray(0,F):(P.length=F,P)};var w={arraySet:function(P,F,D,U,Z){if(F.subarray&&P.subarray)P.set(F.subarray(D,D+U),Z);else for(var $=0;$<U;$++)P[Z+$]=F[D+$]},flattenChunks:function(P){var F,D,U,Z,$,j;for(U=0,F=0,D=P.length;F<D;F++)U+=P[F].length;for(j=new Uint8Array(U),Z=0,F=0,D=P.length;F<D;F++)$=P[F],j.set($,Z),Z+=$.length;return j}},I={arraySet:function(P,F,D,U,Z){for(var $=0;$<U;$++)P[Z+$]=F[D+$]},flattenChunks:function(P){return[].concat.apply([],P)}};d.setTyped=function(P){P?(d.Buf8=Uint8Array,d.Buf16=Uint16Array,d.Buf32=Int32Array,d.assign(d,w)):(d.Buf8=Array,d.Buf16=Array,d.Buf32=Array,d.assign(d,I))},d.setTyped(m)}(common)),common}var deflate$1={},deflate={},trees={},hasRequiredTrees,adler32_1,hasRequiredAdler32,crc32_1,hasRequiredCrc32,messages,hasRequiredMessages,hasRequiredDeflate$1;function requireTrees(){if(hasRequiredTrees)return trees;hasRequiredTrees=1;var d=requireCommon(),m=0,g=1;function w(bt){for(var wt=bt.length;--wt>=0;)bt[wt]=0}var I=0,P=29,F=256,D=F+1+P,U=30,Z=19,$=2*D+1,j=15,H=16,W=7,V=256,Q=16,K=17,q=18,et=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],X=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],tt=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],rt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ot=new Array(2*(D+2));w(ot);var J=new Array(2*U);w(J);var lt=new Array(512);w(lt);var st=new Array(256);w(st);var ut=new Array(P);w(ut);var it,ct,At,Et=new Array(U);function gt(bt,wt,xt,Rt,Gt){this.static_tree=bt,this.extra_bits=wt,this.extra_base=xt,this.elems=Rt,this.max_length=Gt,this.has_stree=bt&&bt.length}function pt(bt,wt){this.dyn_tree=bt,this.max_code=0,this.stat_desc=wt}function vt(bt){return bt<256?lt[bt]:lt[256+(bt>>>7)]}function Tt(bt,wt){bt.pending_buf[bt.pending++]=255&wt,bt.pending_buf[bt.pending++]=wt>>>8&255}function It(bt,wt,xt){bt.bi_valid>H-xt?(bt.bi_buf|=wt<<bt.bi_valid&65535,Tt(bt,bt.bi_buf),bt.bi_buf=wt>>H-bt.bi_valid,bt.bi_valid+=xt-H):(bt.bi_buf|=wt<<bt.bi_valid&65535,bt.bi_valid+=xt)}function $t(bt,wt,xt){It(bt,xt[2*wt],xt[2*wt+1])}function Bt(bt,wt){var xt=0;do xt|=1&bt,bt>>>=1,xt<<=1;while(--wt>0);return xt>>>1}function zt(bt,wt,xt){var Rt,Gt,nt=new Array(j+1),ht=0;for(Rt=1;Rt<=j;Rt++)nt[Rt]=ht=ht+xt[Rt-1]<<1;for(Gt=0;Gt<=wt;Gt++){var ft=bt[2*Gt+1];ft!==0&&(bt[2*Gt]=Bt(nt[ft]++,ft))}}function Ot(bt){var wt;for(wt=0;wt<D;wt++)bt.dyn_ltree[2*wt]=0;for(wt=0;wt<U;wt++)bt.dyn_dtree[2*wt]=0;for(wt=0;wt<Z;wt++)bt.bl_tree[2*wt]=0;bt.dyn_ltree[2*V]=1,bt.opt_len=bt.static_len=0,bt.last_lit=bt.matches=0}function Nt(bt){bt.bi_valid>8?Tt(bt,bt.bi_buf):bt.bi_valid>0&&(bt.pending_buf[bt.pending++]=bt.bi_buf),bt.bi_buf=0,bt.bi_valid=0}function Pt(bt,wt,xt,Rt){var Gt=2*wt,nt=2*xt;return bt[Gt]<bt[nt]||bt[Gt]===bt[nt]&&Rt[wt]<=Rt[xt]}function Ut(bt,wt,xt){for(var Rt=bt.heap[xt],Gt=xt<<1;Gt<=bt.heap_len&&(Gt<bt.heap_len&&Pt(wt,bt.heap[Gt+1],bt.heap[Gt],bt.depth)&&Gt++,!Pt(wt,Rt,bt.heap[Gt],bt.depth));)bt.heap[xt]=bt.heap[Gt],xt=Gt,Gt<<=1;bt.heap[xt]=Rt}function Ft(bt,wt,xt){var Rt,Gt,nt,ht,ft=0;if(bt.last_lit!==0)do Rt=bt.pending_buf[bt.d_buf+2*ft]<<8|bt.pending_buf[bt.d_buf+2*ft+1],Gt=bt.pending_buf[bt.l_buf+ft],ft++,Rt===0?$t(bt,Gt,wt):($t(bt,(nt=st[Gt])+F+1,wt),(ht=et[nt])!==0&&It(bt,Gt-=ut[nt],ht),$t(bt,nt=vt(--Rt),xt),(ht=X[nt])!==0&&It(bt,Rt-=Et[nt],ht));while(ft<bt.last_lit);$t(bt,V,wt)}function Zt(bt,wt){var xt,Rt,Gt,nt=wt.dyn_tree,ht=wt.stat_desc.static_tree,ft=wt.stat_desc.has_stree,at=wt.stat_desc.elems,_t=-1;for(bt.heap_len=0,bt.heap_max=$,xt=0;xt<at;xt++)nt[2*xt]!==0?(bt.heap[++bt.heap_len]=_t=xt,bt.depth[xt]=0):nt[2*xt+1]=0;for(;bt.heap_len<2;)nt[2*(Gt=bt.heap[++bt.heap_len]=_t<2?++_t:0)]=1,bt.depth[Gt]=0,bt.opt_len--,ft&&(bt.static_len-=ht[2*Gt+1]);for(wt.max_code=_t,xt=bt.heap_len>>1;xt>=1;xt--)Ut(bt,nt,xt);Gt=at;do xt=bt.heap[1],bt.heap[1]=bt.heap[bt.heap_len--],Ut(bt,nt,1),Rt=bt.heap[1],bt.heap[--bt.heap_max]=xt,bt.heap[--bt.heap_max]=Rt,nt[2*Gt]=nt[2*xt]+nt[2*Rt],bt.depth[Gt]=(bt.depth[xt]>=bt.depth[Rt]?bt.depth[xt]:bt.depth[Rt])+1,nt[2*xt+1]=nt[2*Rt+1]=Gt,bt.heap[1]=Gt++,Ut(bt,nt,1);while(bt.heap_len>=2);bt.heap[--bt.heap_max]=bt.heap[1],function(St,Vt){var ee,Jt,se,ae,fe,le,ue=Vt.dyn_tree,me=Vt.max_code,he=Vt.stat_desc.static_tree,Wt=Vt.stat_desc.has_stree,oe=Vt.stat_desc.extra_bits,kt=Vt.stat_desc.extra_base,Xt=Vt.stat_desc.max_length,Ct=0;for(ae=0;ae<=j;ae++)St.bl_count[ae]=0;for(ue[2*St.heap[St.heap_max]+1]=0,ee=St.heap_max+1;ee<$;ee++)(ae=ue[2*ue[2*(Jt=St.heap[ee])+1]+1]+1)>Xt&&(ae=Xt,Ct++),ue[2*Jt+1]=ae,Jt>me||(St.bl_count[ae]++,fe=0,Jt>=kt&&(fe=oe[Jt-kt]),le=ue[2*Jt],St.opt_len+=le*(ae+fe),Wt&&(St.static_len+=le*(he[2*Jt+1]+fe)));if(Ct!==0){do{for(ae=Xt-1;St.bl_count[ae]===0;)ae--;St.bl_count[ae]--,St.bl_count[ae+1]+=2,St.bl_count[Xt]--,Ct-=2}while(Ct>0);for(ae=Xt;ae!==0;ae--)for(Jt=St.bl_count[ae];Jt!==0;)(se=St.heap[--ee])>me||(ue[2*se+1]!==ae&&(St.opt_len+=(ae-ue[2*se+1])*ue[2*se],ue[2*se+1]=ae),Jt--)}}(bt,wt),zt(nt,_t,bt.bl_count)}function Ht(bt,wt,xt){var Rt,Gt,nt=-1,ht=wt[1],ft=0,at=7,_t=4;for(ht===0&&(at=138,_t=3),wt[2*(xt+1)+1]=65535,Rt=0;Rt<=xt;Rt++)Gt=ht,ht=wt[2*(Rt+1)+1],++ft<at&&Gt===ht||(ft<_t?bt.bl_tree[2*Gt]+=ft:Gt!==0?(Gt!==nt&&bt.bl_tree[2*Gt]++,bt.bl_tree[2*Q]++):ft<=10?bt.bl_tree[2*K]++:bt.bl_tree[2*q]++,ft=0,nt=Gt,ht===0?(at=138,_t=3):Gt===ht?(at=6,_t=3):(at=7,_t=4))}function Dt(bt,wt,xt){var Rt,Gt,nt=-1,ht=wt[1],ft=0,at=7,_t=4;for(ht===0&&(at=138,_t=3),Rt=0;Rt<=xt;Rt++)if(Gt=ht,ht=wt[2*(Rt+1)+1],!(++ft<at&&Gt===ht)){if(ft<_t)do $t(bt,Gt,bt.bl_tree);while(--ft!=0);else Gt!==0?(Gt!==nt&&($t(bt,Gt,bt.bl_tree),ft--),$t(bt,Q,bt.bl_tree),It(bt,ft-3,2)):ft<=10?($t(bt,K,bt.bl_tree),It(bt,ft-3,3)):($t(bt,q,bt.bl_tree),It(bt,ft-11,7));ft=0,nt=Gt,ht===0?(at=138,_t=3):Gt===ht?(at=6,_t=3):(at=7,_t=4)}}w(Et);var dt=!1;function Lt(bt,wt,xt,Rt){It(bt,(I<<1)+(Rt?1:0),3),function(Gt,nt,ht,ft){Nt(Gt),Tt(Gt,ht),Tt(Gt,~ht),d.arraySet(Gt.pending_buf,Gt.window,nt,ht,Gt.pending),Gt.pending+=ht}(bt,wt,xt)}return trees._tr_init=function(bt){dt||(function(){var wt,xt,Rt,Gt,nt,ht=new Array(j+1);for(Rt=0,Gt=0;Gt<P-1;Gt++)for(ut[Gt]=Rt,wt=0;wt<1<<et[Gt];wt++)st[Rt++]=Gt;for(st[Rt-1]=Gt,nt=0,Gt=0;Gt<16;Gt++)for(Et[Gt]=nt,wt=0;wt<1<<X[Gt];wt++)lt[nt++]=Gt;for(nt>>=7;Gt<U;Gt++)for(Et[Gt]=nt<<7,wt=0;wt<1<<X[Gt]-7;wt++)lt[256+nt++]=Gt;for(xt=0;xt<=j;xt++)ht[xt]=0;for(wt=0;wt<=143;)ot[2*wt+1]=8,wt++,ht[8]++;for(;wt<=255;)ot[2*wt+1]=9,wt++,ht[9]++;for(;wt<=279;)ot[2*wt+1]=7,wt++,ht[7]++;for(;wt<=287;)ot[2*wt+1]=8,wt++,ht[8]++;for(zt(ot,D+1,ht),wt=0;wt<U;wt++)J[2*wt+1]=5,J[2*wt]=Bt(wt,5);it=new gt(ot,et,F+1,D,j),ct=new gt(J,X,0,U,j),At=new gt(new Array(0),tt,0,Z,W)}(),dt=!0),bt.l_desc=new pt(bt.dyn_ltree,it),bt.d_desc=new pt(bt.dyn_dtree,ct),bt.bl_desc=new pt(bt.bl_tree,At),bt.bi_buf=0,bt.bi_valid=0,Ot(bt)},trees._tr_stored_block=Lt,trees._tr_flush_block=function(bt,wt,xt,Rt){var Gt,nt,ht=0;bt.level>0?(bt.strm.data_type===2&&(bt.strm.data_type=function(ft){var at,_t=4093624447;for(at=0;at<=31;at++,_t>>>=1)if(1&_t&&ft.dyn_ltree[2*at]!==0)return m;if(ft.dyn_ltree[18]!==0||ft.dyn_ltree[20]!==0||ft.dyn_ltree[26]!==0)return g;for(at=32;at<F;at++)if(ft.dyn_ltree[2*at]!==0)return g;return m}(bt)),Zt(bt,bt.l_desc),Zt(bt,bt.d_desc),ht=function(ft){var at;for(Ht(ft,ft.dyn_ltree,ft.l_desc.max_code),Ht(ft,ft.dyn_dtree,ft.d_desc.max_code),Zt(ft,ft.bl_desc),at=Z-1;at>=3&&ft.bl_tree[2*rt[at]+1]===0;at--);return ft.opt_len+=3*(at+1)+5+5+4,at}(bt),Gt=bt.opt_len+3+7>>>3,(nt=bt.static_len+3+7>>>3)<=Gt&&(Gt=nt)):Gt=nt=xt+5,xt+4<=Gt&&wt!==-1?Lt(bt,wt,xt,Rt):bt.strategy===4||nt===Gt?(It(bt,2+(Rt?1:0),3),Ft(bt,ot,J)):(It(bt,4+(Rt?1:0),3),function(ft,at,_t,St){var Vt;for(It(ft,at-257,5),It(ft,_t-1,5),It(ft,St-4,4),Vt=0;Vt<St;Vt++)It(ft,ft.bl_tree[2*rt[Vt]+1],3);Dt(ft,ft.dyn_ltree,at-1),Dt(ft,ft.dyn_dtree,_t-1)}(bt,bt.l_desc.max_code+1,bt.d_desc.max_code+1,ht+1),Ft(bt,bt.dyn_ltree,bt.dyn_dtree)),Ot(bt),Rt&&Nt(bt)},trees._tr_tally=function(bt,wt,xt){return bt.pending_buf[bt.d_buf+2*bt.last_lit]=wt>>>8&255,bt.pending_buf[bt.d_buf+2*bt.last_lit+1]=255&wt,bt.pending_buf[bt.l_buf+bt.last_lit]=255&xt,bt.last_lit++,wt===0?bt.dyn_ltree[2*xt]++:(bt.matches++,wt--,bt.dyn_ltree[2*(st[xt]+F+1)]++,bt.dyn_dtree[2*vt(wt)]++),bt.last_lit===bt.lit_bufsize-1},trees._tr_align=function(bt){It(bt,2,3),$t(bt,V,ot),function(wt){wt.bi_valid===16?(Tt(wt,wt.bi_buf),wt.bi_buf=0,wt.bi_valid=0):wt.bi_valid>=8&&(wt.pending_buf[wt.pending++]=255&wt.bi_buf,wt.bi_buf>>=8,wt.bi_valid-=8)}(bt)},trees}function requireAdler32(){return hasRequiredAdler32||(hasRequiredAdler32=1,adler32_1=function(d,m,g,w){for(var I=65535&d,P=d>>>16&65535,F=0;g!==0;){g-=F=g>2e3?2e3:g;do P=P+(I=I+m[w++]|0)|0;while(--F);I%=65521,P%=65521}return I|P<<16}),adler32_1}function requireCrc32(){if(hasRequiredCrc32)return crc32_1;hasRequiredCrc32=1;var d=function(){for(var m,g=[],w=0;w<256;w++){m=w;for(var I=0;I<8;I++)m=1&m?3988292384^m>>>1:m>>>1;g[w]=m}return g}();return crc32_1=function(m,g,w,I){var P=d,F=I+w;m^=-1;for(var D=I;D<F;D++)m=m>>>8^P[255&(m^g[D])];return~m},crc32_1}function requireMessages(){return hasRequiredMessages?messages:(hasRequiredMessages=1,messages={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"})}function requireDeflate$1(){if(hasRequiredDeflate$1)return deflate;hasRequiredDeflate$1=1;var d,m=requireCommon(),g=requireTrees(),w=requireAdler32(),I=requireCrc32(),P=requireMessages(),F=0,D=4,U=0,Z=-2,$=-1,j=4,H=2,W=8,V=9,Q=286,K=30,q=19,et=2*Q+1,X=15,tt=3,rt=258,ot=rt+tt+1,J=42,lt=103,st=113,ut=666,it=1,ct=2,At=3,Et=4;function gt(dt,Lt){return dt.msg=P[Lt],Lt}function pt(dt){return(dt<<1)-(dt>4?9:0)}function vt(dt){for(var Lt=dt.length;--Lt>=0;)dt[Lt]=0}function Tt(dt){var Lt=dt.state,bt=Lt.pending;bt>dt.avail_out&&(bt=dt.avail_out),bt!==0&&(m.arraySet(dt.output,Lt.pending_buf,Lt.pending_out,bt,dt.next_out),dt.next_out+=bt,Lt.pending_out+=bt,dt.total_out+=bt,dt.avail_out-=bt,Lt.pending-=bt,Lt.pending===0&&(Lt.pending_out=0))}function It(dt,Lt){g._tr_flush_block(dt,dt.block_start>=0?dt.block_start:-1,dt.strstart-dt.block_start,Lt),dt.block_start=dt.strstart,Tt(dt.strm)}function $t(dt,Lt){dt.pending_buf[dt.pending++]=Lt}function Bt(dt,Lt){dt.pending_buf[dt.pending++]=Lt>>>8&255,dt.pending_buf[dt.pending++]=255&Lt}function zt(dt,Lt){var bt,wt,xt=dt.max_chain_length,Rt=dt.strstart,Gt=dt.prev_length,nt=dt.nice_match,ht=dt.strstart>dt.w_size-ot?dt.strstart-(dt.w_size-ot):0,ft=dt.window,at=dt.w_mask,_t=dt.prev,St=dt.strstart+rt,Vt=ft[Rt+Gt-1],ee=ft[Rt+Gt];dt.prev_length>=dt.good_match&&(xt>>=2),nt>dt.lookahead&&(nt=dt.lookahead);do if(ft[(bt=Lt)+Gt]===ee&&ft[bt+Gt-1]===Vt&&ft[bt]===ft[Rt]&&ft[++bt]===ft[Rt+1]){Rt+=2,bt++;do;while(ft[++Rt]===ft[++bt]&&ft[++Rt]===ft[++bt]&&ft[++Rt]===ft[++bt]&&ft[++Rt]===ft[++bt]&&ft[++Rt]===ft[++bt]&&ft[++Rt]===ft[++bt]&&ft[++Rt]===ft[++bt]&&ft[++Rt]===ft[++bt]&&Rt<St);if(wt=rt-(St-Rt),Rt=St-rt,wt>Gt){if(dt.match_start=Lt,Gt=wt,wt>=nt)break;Vt=ft[Rt+Gt-1],ee=ft[Rt+Gt]}}while((Lt=_t[Lt&at])>ht&&--xt!=0);return Gt<=dt.lookahead?Gt:dt.lookahead}function Ot(dt){var Lt,bt,wt,xt,Rt,Gt,nt,ht,ft,at,_t=dt.w_size;do{if(xt=dt.window_size-dt.lookahead-dt.strstart,dt.strstart>=_t+(_t-ot)){m.arraySet(dt.window,dt.window,_t,_t,0),dt.match_start-=_t,dt.strstart-=_t,dt.block_start-=_t,Lt=bt=dt.hash_size;do wt=dt.head[--Lt],dt.head[Lt]=wt>=_t?wt-_t:0;while(--bt);Lt=bt=_t;do wt=dt.prev[--Lt],dt.prev[Lt]=wt>=_t?wt-_t:0;while(--bt);xt+=_t}if(dt.strm.avail_in===0)break;if(Gt=dt.strm,nt=dt.window,ht=dt.strstart+dt.lookahead,ft=xt,at=void 0,(at=Gt.avail_in)>ft&&(at=ft),bt=at===0?0:(Gt.avail_in-=at,m.arraySet(nt,Gt.input,Gt.next_in,at,ht),Gt.state.wrap===1?Gt.adler=w(Gt.adler,nt,at,ht):Gt.state.wrap===2&&(Gt.adler=I(Gt.adler,nt,at,ht)),Gt.next_in+=at,Gt.total_in+=at,at),dt.lookahead+=bt,dt.lookahead+dt.insert>=tt)for(Rt=dt.strstart-dt.insert,dt.ins_h=dt.window[Rt],dt.ins_h=(dt.ins_h<<dt.hash_shift^dt.window[Rt+1])&dt.hash_mask;dt.insert&&(dt.ins_h=(dt.ins_h<<dt.hash_shift^dt.window[Rt+tt-1])&dt.hash_mask,dt.prev[Rt&dt.w_mask]=dt.head[dt.ins_h],dt.head[dt.ins_h]=Rt,Rt++,dt.insert--,!(dt.lookahead+dt.insert<tt)););}while(dt.lookahead<ot&&dt.strm.avail_in!==0)}function Nt(dt,Lt){for(var bt,wt;;){if(dt.lookahead<ot){if(Ot(dt),dt.lookahead<ot&&Lt===F)return it;if(dt.lookahead===0)break}if(bt=0,dt.lookahead>=tt&&(dt.ins_h=(dt.ins_h<<dt.hash_shift^dt.window[dt.strstart+tt-1])&dt.hash_mask,bt=dt.prev[dt.strstart&dt.w_mask]=dt.head[dt.ins_h],dt.head[dt.ins_h]=dt.strstart),bt!==0&&dt.strstart-bt<=dt.w_size-ot&&(dt.match_length=zt(dt,bt)),dt.match_length>=tt)if(wt=g._tr_tally(dt,dt.strstart-dt.match_start,dt.match_length-tt),dt.lookahead-=dt.match_length,dt.match_length<=dt.max_lazy_match&&dt.lookahead>=tt){dt.match_length--;do dt.strstart++,dt.ins_h=(dt.ins_h<<dt.hash_shift^dt.window[dt.strstart+tt-1])&dt.hash_mask,bt=dt.prev[dt.strstart&dt.w_mask]=dt.head[dt.ins_h],dt.head[dt.ins_h]=dt.strstart;while(--dt.match_length!=0);dt.strstart++}else dt.strstart+=dt.match_length,dt.match_length=0,dt.ins_h=dt.window[dt.strstart],dt.ins_h=(dt.ins_h<<dt.hash_shift^dt.window[dt.strstart+1])&dt.hash_mask;else wt=g._tr_tally(dt,0,dt.window[dt.strstart]),dt.lookahead--,dt.strstart++;if(wt&&(It(dt,!1),dt.strm.avail_out===0))return it}return dt.insert=dt.strstart<tt-1?dt.strstart:tt-1,Lt===D?(It(dt,!0),dt.strm.avail_out===0?At:Et):dt.last_lit&&(It(dt,!1),dt.strm.avail_out===0)?it:ct}function Pt(dt,Lt){for(var bt,wt,xt;;){if(dt.lookahead<ot){if(Ot(dt),dt.lookahead<ot&&Lt===F)return it;if(dt.lookahead===0)break}if(bt=0,dt.lookahead>=tt&&(dt.ins_h=(dt.ins_h<<dt.hash_shift^dt.window[dt.strstart+tt-1])&dt.hash_mask,bt=dt.prev[dt.strstart&dt.w_mask]=dt.head[dt.ins_h],dt.head[dt.ins_h]=dt.strstart),dt.prev_length=dt.match_length,dt.prev_match=dt.match_start,dt.match_length=tt-1,bt!==0&&dt.prev_length<dt.max_lazy_match&&dt.strstart-bt<=dt.w_size-ot&&(dt.match_length=zt(dt,bt),dt.match_length<=5&&(dt.strategy===1||dt.match_length===tt&&dt.strstart-dt.match_start>4096)&&(dt.match_length=tt-1)),dt.prev_length>=tt&&dt.match_length<=dt.prev_length){xt=dt.strstart+dt.lookahead-tt,wt=g._tr_tally(dt,dt.strstart-1-dt.prev_match,dt.prev_length-tt),dt.lookahead-=dt.prev_length-1,dt.prev_length-=2;do++dt.strstart<=xt&&(dt.ins_h=(dt.ins_h<<dt.hash_shift^dt.window[dt.strstart+tt-1])&dt.hash_mask,bt=dt.prev[dt.strstart&dt.w_mask]=dt.head[dt.ins_h],dt.head[dt.ins_h]=dt.strstart);while(--dt.prev_length!=0);if(dt.match_available=0,dt.match_length=tt-1,dt.strstart++,wt&&(It(dt,!1),dt.strm.avail_out===0))return it}else if(dt.match_available){if((wt=g._tr_tally(dt,0,dt.window[dt.strstart-1]))&&It(dt,!1),dt.strstart++,dt.lookahead--,dt.strm.avail_out===0)return it}else dt.match_available=1,dt.strstart++,dt.lookahead--}return dt.match_available&&(wt=g._tr_tally(dt,0,dt.window[dt.strstart-1]),dt.match_available=0),dt.insert=dt.strstart<tt-1?dt.strstart:tt-1,Lt===D?(It(dt,!0),dt.strm.avail_out===0?At:Et):dt.last_lit&&(It(dt,!1),dt.strm.avail_out===0)?it:ct}function Ut(dt,Lt,bt,wt,xt){this.good_length=dt,this.max_lazy=Lt,this.nice_length=bt,this.max_chain=wt,this.func=xt}function Ft(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=W,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new m.Buf16(2*et),this.dyn_dtree=new m.Buf16(2*(2*K+1)),this.bl_tree=new m.Buf16(2*(2*q+1)),vt(this.dyn_ltree),vt(this.dyn_dtree),vt(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new m.Buf16(X+1),this.heap=new m.Buf16(2*Q+1),vt(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new m.Buf16(2*Q+1),vt(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Zt(dt){var Lt;return dt&&dt.state?(dt.total_in=dt.total_out=0,dt.data_type=H,(Lt=dt.state).pending=0,Lt.pending_out=0,Lt.wrap<0&&(Lt.wrap=-Lt.wrap),Lt.status=Lt.wrap?J:st,dt.adler=Lt.wrap===2?0:1,Lt.last_flush=F,g._tr_init(Lt),U):gt(dt,Z)}function Ht(dt){var Lt=Zt(dt);return Lt===U&&function(bt){bt.window_size=2*bt.w_size,vt(bt.head),bt.max_lazy_match=d[bt.level].max_lazy,bt.good_match=d[bt.level].good_length,bt.nice_match=d[bt.level].nice_length,bt.max_chain_length=d[bt.level].max_chain,bt.strstart=0,bt.block_start=0,bt.lookahead=0,bt.insert=0,bt.match_length=bt.prev_length=tt-1,bt.match_available=0,bt.ins_h=0}(dt.state),Lt}function Dt(dt,Lt,bt,wt,xt,Rt){if(!dt)return Z;var Gt=1;if(Lt===$&&(Lt=6),wt<0?(Gt=0,wt=-wt):wt>15&&(Gt=2,wt-=16),xt<1||xt>V||bt!==W||wt<8||wt>15||Lt<0||Lt>9||Rt<0||Rt>j)return gt(dt,Z);wt===8&&(wt=9);var nt=new Ft;return dt.state=nt,nt.strm=dt,nt.wrap=Gt,nt.gzhead=null,nt.w_bits=wt,nt.w_size=1<<nt.w_bits,nt.w_mask=nt.w_size-1,nt.hash_bits=xt+7,nt.hash_size=1<<nt.hash_bits,nt.hash_mask=nt.hash_size-1,nt.hash_shift=~~((nt.hash_bits+tt-1)/tt),nt.window=new m.Buf8(2*nt.w_size),nt.head=new m.Buf16(nt.hash_size),nt.prev=new m.Buf16(nt.w_size),nt.lit_bufsize=1<<xt+6,nt.pending_buf_size=4*nt.lit_bufsize,nt.pending_buf=new m.Buf8(nt.pending_buf_size),nt.d_buf=1*nt.lit_bufsize,nt.l_buf=3*nt.lit_bufsize,nt.level=Lt,nt.strategy=Rt,nt.method=bt,Ht(dt)}return d=[new Ut(0,0,0,0,function(dt,Lt){var bt=65535;for(bt>dt.pending_buf_size-5&&(bt=dt.pending_buf_size-5);;){if(dt.lookahead<=1){if(Ot(dt),dt.lookahead===0&&Lt===F)return it;if(dt.lookahead===0)break}dt.strstart+=dt.lookahead,dt.lookahead=0;var wt=dt.block_start+bt;if((dt.strstart===0||dt.strstart>=wt)&&(dt.lookahead=dt.strstart-wt,dt.strstart=wt,It(dt,!1),dt.strm.avail_out===0)||dt.strstart-dt.block_start>=dt.w_size-ot&&(It(dt,!1),dt.strm.avail_out===0))return it}return dt.insert=0,Lt===D?(It(dt,!0),dt.strm.avail_out===0?At:Et):(dt.strstart>dt.block_start&&(It(dt,!1),dt.strm.avail_out),it)}),new Ut(4,4,8,4,Nt),new Ut(4,5,16,8,Nt),new Ut(4,6,32,32,Nt),new Ut(4,4,16,16,Pt),new Ut(8,16,32,32,Pt),new Ut(8,16,128,128,Pt),new Ut(8,32,128,256,Pt),new Ut(32,128,258,1024,Pt),new Ut(32,258,258,4096,Pt)],deflate.deflateInit=function(dt,Lt){return Dt(dt,Lt,W,15,8,0)},deflate.deflateInit2=Dt,deflate.deflateReset=Ht,deflate.deflateResetKeep=Zt,deflate.deflateSetHeader=function(dt,Lt){return dt&&dt.state?dt.state.wrap!==2?Z:(dt.state.gzhead=Lt,U):Z},deflate.deflate=function(dt,Lt){var bt,wt,xt,Rt;if(!dt||!dt.state||Lt>5||Lt<0)return dt?gt(dt,Z):Z;if(wt=dt.state,!dt.output||!dt.input&&dt.avail_in!==0||wt.status===ut&&Lt!==D)return gt(dt,dt.avail_out===0?-5:Z);if(wt.strm=dt,bt=wt.last_flush,wt.last_flush=Lt,wt.status===J)if(wt.wrap===2)dt.adler=0,$t(wt,31),$t(wt,139),$t(wt,8),wt.gzhead?($t(wt,(wt.gzhead.text?1:0)+(wt.gzhead.hcrc?2:0)+(wt.gzhead.extra?4:0)+(wt.gzhead.name?8:0)+(wt.gzhead.comment?16:0)),$t(wt,255&wt.gzhead.time),$t(wt,wt.gzhead.time>>8&255),$t(wt,wt.gzhead.time>>16&255),$t(wt,wt.gzhead.time>>24&255),$t(wt,wt.level===9?2:wt.strategy>=2||wt.level<2?4:0),$t(wt,255&wt.gzhead.os),wt.gzhead.extra&&wt.gzhead.extra.length&&($t(wt,255&wt.gzhead.extra.length),$t(wt,wt.gzhead.extra.length>>8&255)),wt.gzhead.hcrc&&(dt.adler=I(dt.adler,wt.pending_buf,wt.pending,0)),wt.gzindex=0,wt.status=69):($t(wt,0),$t(wt,0),$t(wt,0),$t(wt,0),$t(wt,0),$t(wt,wt.level===9?2:wt.strategy>=2||wt.level<2?4:0),$t(wt,3),wt.status=st);else{var Gt=W+(wt.w_bits-8<<4)<<8;Gt|=(wt.strategy>=2||wt.level<2?0:wt.level<6?1:wt.level===6?2:3)<<6,wt.strstart!==0&&(Gt|=32),Gt+=31-Gt%31,wt.status=st,Bt(wt,Gt),wt.strstart!==0&&(Bt(wt,dt.adler>>>16),Bt(wt,65535&dt.adler)),dt.adler=1}if(wt.status===69)if(wt.gzhead.extra){for(xt=wt.pending;wt.gzindex<(65535&wt.gzhead.extra.length)&&(wt.pending!==wt.pending_buf_size||(wt.gzhead.hcrc&&wt.pending>xt&&(dt.adler=I(dt.adler,wt.pending_buf,wt.pending-xt,xt)),Tt(dt),xt=wt.pending,wt.pending!==wt.pending_buf_size));)$t(wt,255&wt.gzhead.extra[wt.gzindex]),wt.gzindex++;wt.gzhead.hcrc&&wt.pending>xt&&(dt.adler=I(dt.adler,wt.pending_buf,wt.pending-xt,xt)),wt.gzindex===wt.gzhead.extra.length&&(wt.gzindex=0,wt.status=73)}else wt.status=73;if(wt.status===73)if(wt.gzhead.name){xt=wt.pending;do{if(wt.pending===wt.pending_buf_size&&(wt.gzhead.hcrc&&wt.pending>xt&&(dt.adler=I(dt.adler,wt.pending_buf,wt.pending-xt,xt)),Tt(dt),xt=wt.pending,wt.pending===wt.pending_buf_size)){Rt=1;break}Rt=wt.gzindex<wt.gzhead.name.length?255&wt.gzhead.name.charCodeAt(wt.gzindex++):0,$t(wt,Rt)}while(Rt!==0);wt.gzhead.hcrc&&wt.pending>xt&&(dt.adler=I(dt.adler,wt.pending_buf,wt.pending-xt,xt)),Rt===0&&(wt.gzindex=0,wt.status=91)}else wt.status=91;if(wt.status===91)if(wt.gzhead.comment){xt=wt.pending;do{if(wt.pending===wt.pending_buf_size&&(wt.gzhead.hcrc&&wt.pending>xt&&(dt.adler=I(dt.adler,wt.pending_buf,wt.pending-xt,xt)),Tt(dt),xt=wt.pending,wt.pending===wt.pending_buf_size)){Rt=1;break}Rt=wt.gzindex<wt.gzhead.comment.length?255&wt.gzhead.comment.charCodeAt(wt.gzindex++):0,$t(wt,Rt)}while(Rt!==0);wt.gzhead.hcrc&&wt.pending>xt&&(dt.adler=I(dt.adler,wt.pending_buf,wt.pending-xt,xt)),Rt===0&&(wt.status=lt)}else wt.status=lt;if(wt.status===lt&&(wt.gzhead.hcrc?(wt.pending+2>wt.pending_buf_size&&Tt(dt),wt.pending+2<=wt.pending_buf_size&&($t(wt,255&dt.adler),$t(wt,dt.adler>>8&255),dt.adler=0,wt.status=st)):wt.status=st),wt.pending!==0){if(Tt(dt),dt.avail_out===0)return wt.last_flush=-1,U}else if(dt.avail_in===0&&pt(Lt)<=pt(bt)&&Lt!==D)return gt(dt,-5);if(wt.status===ut&&dt.avail_in!==0)return gt(dt,-5);if(dt.avail_in!==0||wt.lookahead!==0||Lt!==F&&wt.status!==ut){var nt=wt.strategy===2?function(ht,ft){for(var at;;){if(ht.lookahead===0&&(Ot(ht),ht.lookahead===0)){if(ft===F)return it;break}if(ht.match_length=0,at=g._tr_tally(ht,0,ht.window[ht.strstart]),ht.lookahead--,ht.strstart++,at&&(It(ht,!1),ht.strm.avail_out===0))return it}return ht.insert=0,ft===D?(It(ht,!0),ht.strm.avail_out===0?At:Et):ht.last_lit&&(It(ht,!1),ht.strm.avail_out===0)?it:ct}(wt,Lt):wt.strategy===3?function(ht,ft){for(var at,_t,St,Vt,ee=ht.window;;){if(ht.lookahead<=rt){if(Ot(ht),ht.lookahead<=rt&&ft===F)return it;if(ht.lookahead===0)break}if(ht.match_length=0,ht.lookahead>=tt&&ht.strstart>0&&(_t=ee[St=ht.strstart-1])===ee[++St]&&_t===ee[++St]&&_t===ee[++St]){Vt=ht.strstart+rt;do;while(_t===ee[++St]&&_t===ee[++St]&&_t===ee[++St]&&_t===ee[++St]&&_t===ee[++St]&&_t===ee[++St]&&_t===ee[++St]&&_t===ee[++St]&&St<Vt);ht.match_length=rt-(Vt-St),ht.match_length>ht.lookahead&&(ht.match_length=ht.lookahead)}if(ht.match_length>=tt?(at=g._tr_tally(ht,1,ht.match_length-tt),ht.lookahead-=ht.match_length,ht.strstart+=ht.match_length,ht.match_length=0):(at=g._tr_tally(ht,0,ht.window[ht.strstart]),ht.lookahead--,ht.strstart++),at&&(It(ht,!1),ht.strm.avail_out===0))return it}return ht.insert=0,ft===D?(It(ht,!0),ht.strm.avail_out===0?At:Et):ht.last_lit&&(It(ht,!1),ht.strm.avail_out===0)?it:ct}(wt,Lt):d[wt.level].func(wt,Lt);if(nt!==At&&nt!==Et||(wt.status=ut),nt===it||nt===At)return dt.avail_out===0&&(wt.last_flush=-1),U;if(nt===ct&&(Lt===1?g._tr_align(wt):Lt!==5&&(g._tr_stored_block(wt,0,0,!1),Lt===3&&(vt(wt.head),wt.lookahead===0&&(wt.strstart=0,wt.block_start=0,wt.insert=0))),Tt(dt),dt.avail_out===0))return wt.last_flush=-1,U}return Lt!==D?U:wt.wrap<=0?1:(wt.wrap===2?($t(wt,255&dt.adler),$t(wt,dt.adler>>8&255),$t(wt,dt.adler>>16&255),$t(wt,dt.adler>>24&255),$t(wt,255&dt.total_in),$t(wt,dt.total_in>>8&255),$t(wt,dt.total_in>>16&255),$t(wt,dt.total_in>>24&255)):(Bt(wt,dt.adler>>>16),Bt(wt,65535&dt.adler)),Tt(dt),wt.wrap>0&&(wt.wrap=-wt.wrap),wt.pending!==0?U:1)},deflate.deflateEnd=function(dt){var Lt;return dt&&dt.state?(Lt=dt.state.status)!==J&&Lt!==69&&Lt!==73&&Lt!==91&&Lt!==lt&&Lt!==st&&Lt!==ut?gt(dt,Z):(dt.state=null,Lt===st?gt(dt,-3):U):Z},deflate.deflateSetDictionary=function(dt,Lt){var bt,wt,xt,Rt,Gt,nt,ht,ft,at=Lt.length;if(!dt||!dt.state||(Rt=(bt=dt.state).wrap)===2||Rt===1&&bt.status!==J||bt.lookahead)return Z;for(Rt===1&&(dt.adler=w(dt.adler,Lt,at,0)),bt.wrap=0,at>=bt.w_size&&(Rt===0&&(vt(bt.head),bt.strstart=0,bt.block_start=0,bt.insert=0),ft=new m.Buf8(bt.w_size),m.arraySet(ft,Lt,at-bt.w_size,bt.w_size,0),Lt=ft,at=bt.w_size),Gt=dt.avail_in,nt=dt.next_in,ht=dt.input,dt.avail_in=at,dt.next_in=0,dt.input=Lt,Ot(bt);bt.lookahead>=tt;){wt=bt.strstart,xt=bt.lookahead-(tt-1);do bt.ins_h=(bt.ins_h<<bt.hash_shift^bt.window[wt+tt-1])&bt.hash_mask,bt.prev[wt&bt.w_mask]=bt.head[bt.ins_h],bt.head[bt.ins_h]=wt,wt++;while(--xt);bt.strstart=wt,bt.lookahead=tt-1,Ot(bt)}return bt.strstart+=bt.lookahead,bt.block_start=bt.strstart,bt.insert=bt.lookahead,bt.lookahead=0,bt.match_length=bt.prev_length=tt-1,bt.match_available=0,dt.next_in=nt,dt.input=ht,dt.avail_in=Gt,bt.wrap=Rt,U},deflate.deflateInfo="pako deflate (from Nodeca project)",deflate}var strings={},hasRequiredStrings,zstream,hasRequiredZstream,hasRequiredDeflate;function requireStrings(){if(hasRequiredStrings)return strings;hasRequiredStrings=1;var d=requireCommon(),m=!0,g=!0;try{String.fromCharCode.apply(null,[0])}catch{m=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{g=!1}for(var w=new d.Buf8(256),I=0;I<256;I++)w[I]=I>=252?6:I>=248?5:I>=240?4:I>=224?3:I>=192?2:1;function P(F,D){if(D<65534&&(F.subarray&&g||!F.subarray&&m))return String.fromCharCode.apply(null,d.shrinkBuf(F,D));for(var U="",Z=0;Z<D;Z++)U+=String.fromCharCode(F[Z]);return U}return w[254]=w[254]=1,strings.string2buf=function(F){var D,U,Z,$,j,H=F.length,W=0;for($=0;$<H;$++)(64512&(U=F.charCodeAt($)))==55296&&$+1<H&&(64512&(Z=F.charCodeAt($+1)))==56320&&(U=65536+(U-55296<<10)+(Z-56320),$++),W+=U<128?1:U<2048?2:U<65536?3:4;for(D=new d.Buf8(W),j=0,$=0;j<W;$++)(64512&(U=F.charCodeAt($)))==55296&&$+1<H&&(64512&(Z=F.charCodeAt($+1)))==56320&&(U=65536+(U-55296<<10)+(Z-56320),$++),U<128?D[j++]=U:U<2048?(D[j++]=192|U>>>6,D[j++]=128|63&U):U<65536?(D[j++]=224|U>>>12,D[j++]=128|U>>>6&63,D[j++]=128|63&U):(D[j++]=240|U>>>18,D[j++]=128|U>>>12&63,D[j++]=128|U>>>6&63,D[j++]=128|63&U);return D},strings.buf2binstring=function(F){return P(F,F.length)},strings.binstring2buf=function(F){for(var D=new d.Buf8(F.length),U=0,Z=D.length;U<Z;U++)D[U]=F.charCodeAt(U);return D},strings.buf2string=function(F,D){var U,Z,$,j,H=D||F.length,W=new Array(2*H);for(Z=0,U=0;U<H;)if(($=F[U++])<128)W[Z++]=$;else if((j=w[$])>4)W[Z++]=65533,U+=j-1;else{for($&=j===2?31:j===3?15:7;j>1&&U<H;)$=$<<6|63&F[U++],j--;j>1?W[Z++]=65533:$<65536?W[Z++]=$:($-=65536,W[Z++]=55296|$>>10&1023,W[Z++]=56320|1023&$)}return P(W,Z)},strings.utf8border=function(F,D){var U;for((D=D||F.length)>F.length&&(D=F.length),U=D-1;U>=0&&(192&F[U])==128;)U--;return U<0||U===0?D:U+w[F[U]]>D?U:D},strings}function requireZstream(){return hasRequiredZstream?zstream:(hasRequiredZstream=1,zstream=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0})}function requireDeflate(){if(hasRequiredDeflate)return deflate$1;hasRequiredDeflate=1;var d=requireDeflate$1(),m=requireCommon(),g=requireStrings(),w=requireMessages(),I=requireZstream(),P=Object.prototype.toString,F=0,D=-1,U=0,Z=8;function $(H){if(!(this instanceof $))return new $(H);this.options=m.assign({level:D,method:Z,chunkSize:16384,windowBits:15,memLevel:8,strategy:U,to:""},H||{});var W=this.options;W.raw&&W.windowBits>0?W.windowBits=-W.windowBits:W.gzip&&W.windowBits>0&&W.windowBits<16&&(W.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new I,this.strm.avail_out=0;var V=d.deflateInit2(this.strm,W.level,W.method,W.windowBits,W.memLevel,W.strategy);if(V!==F)throw new Error(w[V]);if(W.header&&d.deflateSetHeader(this.strm,W.header),W.dictionary){var Q;if(Q=typeof W.dictionary=="string"?g.string2buf(W.dictionary):P.call(W.dictionary)==="[object ArrayBuffer]"?new Uint8Array(W.dictionary):W.dictionary,(V=d.deflateSetDictionary(this.strm,Q))!==F)throw new Error(w[V]);this._dict_set=!0}}function j(H,W){var V=new $(W);if(V.push(H,!0),V.err)throw V.msg||w[V.err];return V.result}return $.prototype.push=function(H,W){var V,Q,K=this.strm,q=this.options.chunkSize;if(this.ended)return!1;Q=W===~~W?W:W===!0?4:0,typeof H=="string"?K.input=g.string2buf(H):P.call(H)==="[object ArrayBuffer]"?K.input=new Uint8Array(H):K.input=H,K.next_in=0,K.avail_in=K.input.length;do{if(K.avail_out===0&&(K.output=new m.Buf8(q),K.next_out=0,K.avail_out=q),(V=d.deflate(K,Q))!==1&&V!==F)return this.onEnd(V),this.ended=!0,!1;K.avail_out!==0&&(K.avail_in!==0||Q!==4&&Q!==2)||(this.options.to==="string"?this.onData(g.buf2binstring(m.shrinkBuf(K.output,K.next_out))):this.onData(m.shrinkBuf(K.output,K.next_out)))}while((K.avail_in>0||K.avail_out===0)&&V!==1);return Q===4?(V=d.deflateEnd(this.strm),this.onEnd(V),this.ended=!0,V===F):Q!==2||(this.onEnd(F),K.avail_out=0,!0)},$.prototype.onData=function(H){this.chunks.push(H)},$.prototype.onEnd=function(H){H===F&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=m.flattenChunks(this.chunks)),this.chunks=[],this.err=H,this.msg=this.strm.msg},deflate$1.Deflate=$,deflate$1.deflate=j,deflate$1.deflateRaw=function(H,W){return(W=W||{}).raw=!0,j(H,W)},deflate$1.gzip=function(H,W){return(W=W||{}).gzip=!0,j(H,W)},deflate$1}var inflate$1={},inflate={},inffast,hasRequiredInffast,inftrees,hasRequiredInftrees,hasRequiredInflate$1,constants,hasRequiredConstants,gzheader,hasRequiredGzheader,hasRequiredInflate,pako_1,hasRequiredPako;function requireInffast(){return hasRequiredInffast?inffast:(hasRequiredInffast=1,inffast=function(d,m){var g,w,I,P,F,D,U,Z,$,j,H,W,V,Q,K,q,et,X,tt,rt,ot,J,lt,st,ut;g=d.state,w=d.next_in,st=d.input,I=w+(d.avail_in-5),P=d.next_out,ut=d.output,F=P-(m-d.avail_out),D=P+(d.avail_out-257),U=g.dmax,Z=g.wsize,$=g.whave,j=g.wnext,H=g.window,W=g.hold,V=g.bits,Q=g.lencode,K=g.distcode,q=(1<<g.lenbits)-1,et=(1<<g.distbits)-1;t:do{V<15&&(W+=st[w++]<<V,V+=8,W+=st[w++]<<V,V+=8),X=Q[W&q];e:for(;;){if(W>>>=tt=X>>>24,V-=tt,(tt=X>>>16&255)===0)ut[P++]=65535&X;else{if(!(16&tt)){if(64&tt){if(32&tt){g.mode=12;break t}d.msg="invalid literal/length code",g.mode=30;break t}X=Q[(65535&X)+(W&(1<<tt)-1)];continue e}for(rt=65535&X,(tt&=15)&&(V<tt&&(W+=st[w++]<<V,V+=8),rt+=W&(1<<tt)-1,W>>>=tt,V-=tt),V<15&&(W+=st[w++]<<V,V+=8,W+=st[w++]<<V,V+=8),X=K[W&et];;){if(W>>>=tt=X>>>24,V-=tt,16&(tt=X>>>16&255)){if(ot=65535&X,V<(tt&=15)&&(W+=st[w++]<<V,(V+=8)<tt&&(W+=st[w++]<<V,V+=8)),(ot+=W&(1<<tt)-1)>U){d.msg="invalid distance too far back",g.mode=30;break t}if(W>>>=tt,V-=tt,ot>(tt=P-F)){if((tt=ot-tt)>$&&g.sane){d.msg="invalid distance too far back",g.mode=30;break t}if(J=0,lt=H,j===0){if(J+=Z-tt,tt<rt){rt-=tt;do ut[P++]=H[J++];while(--tt);J=P-ot,lt=ut}}else if(j<tt){if(J+=Z+j-tt,(tt-=j)<rt){rt-=tt;do ut[P++]=H[J++];while(--tt);if(J=0,j<rt){rt-=tt=j;do ut[P++]=H[J++];while(--tt);J=P-ot,lt=ut}}}else if(J+=j-tt,tt<rt){rt-=tt;do ut[P++]=H[J++];while(--tt);J=P-ot,lt=ut}for(;rt>2;)ut[P++]=lt[J++],ut[P++]=lt[J++],ut[P++]=lt[J++],rt-=3;rt&&(ut[P++]=lt[J++],rt>1&&(ut[P++]=lt[J++]))}else{J=P-ot;do ut[P++]=ut[J++],ut[P++]=ut[J++],ut[P++]=ut[J++],rt-=3;while(rt>2);rt&&(ut[P++]=ut[J++],rt>1&&(ut[P++]=ut[J++]))}break}if(64&tt){d.msg="invalid distance code",g.mode=30;break t}X=K[(65535&X)+(W&(1<<tt)-1)]}}break}}while(w<I&&P<D);w-=rt=V>>3,W&=(1<<(V-=rt<<3))-1,d.next_in=w,d.next_out=P,d.avail_in=w<I?I-w+5:5-(w-I),d.avail_out=P<D?D-P+257:257-(P-D),g.hold=W,g.bits=V},inffast)}function requireInftrees(){if(hasRequiredInftrees)return inftrees;hasRequiredInftrees=1;var d=requireCommon(),m=15,g=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],w=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],I=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],P=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];return inftrees=function(F,D,U,Z,$,j,H,W){var V,Q,K,q,et,X,tt,rt,ot,J=W.bits,lt=0,st=0,ut=0,it=0,ct=0,At=0,Et=0,gt=0,pt=0,vt=0,Tt=null,It=0,$t=new d.Buf16(16),Bt=new d.Buf16(16),zt=null,Ot=0;for(lt=0;lt<=m;lt++)$t[lt]=0;for(st=0;st<Z;st++)$t[D[U+st]]++;for(ct=J,it=m;it>=1&&$t[it]===0;it--);if(ct>it&&(ct=it),it===0)return $[j++]=20971520,$[j++]=20971520,W.bits=1,0;for(ut=1;ut<it&&$t[ut]===0;ut++);for(ct<ut&&(ct=ut),gt=1,lt=1;lt<=m;lt++)if(gt<<=1,(gt-=$t[lt])<0)return-1;if(gt>0&&(F===0||it!==1))return-1;for(Bt[1]=0,lt=1;lt<m;lt++)Bt[lt+1]=Bt[lt]+$t[lt];for(st=0;st<Z;st++)D[U+st]!==0&&(H[Bt[D[U+st]]++]=st);if(F===0?(Tt=zt=H,X=19):F===1?(Tt=g,It-=257,zt=w,Ot-=257,X=256):(Tt=I,zt=P,X=-1),vt=0,st=0,lt=ut,et=j,At=ct,Et=0,K=-1,q=(pt=1<<ct)-1,F===1&&pt>852||F===2&&pt>592)return 1;for(;;){tt=lt-Et,H[st]<X?(rt=0,ot=H[st]):H[st]>X?(rt=zt[Ot+H[st]],ot=Tt[It+H[st]]):(rt=96,ot=0),V=1<<lt-Et,ut=Q=1<<At;do $[et+(vt>>Et)+(Q-=V)]=tt<<24|rt<<16|ot;while(Q!==0);for(V=1<<lt-1;vt&V;)V>>=1;if(V!==0?(vt&=V-1,vt+=V):vt=0,st++,--$t[lt]==0){if(lt===it)break;lt=D[U+H[st]]}if(lt>ct&&(vt&q)!==K){for(Et===0&&(Et=ct),et+=ut,gt=1<<(At=lt-Et);At+Et<it&&!((gt-=$t[At+Et])<=0);)At++,gt<<=1;if(pt+=1<<At,F===1&&pt>852||F===2&&pt>592)return 1;$[K=vt&q]=ct<<24|At<<16|et-j}}return vt!==0&&($[et+vt]=lt-Et<<24|64<<16),W.bits=ct,0}}function requireInflate$1(){if(hasRequiredInflate$1)return inflate;hasRequiredInflate$1=1;var d=requireCommon(),m=requireAdler32(),g=requireCrc32(),w=requireInffast(),I=requireInftrees(),P=1,F=2,D=0,U=-2,Z=1,$=12,j=30,H=852,W=592;function V(st){return(st>>>24&255)+(st>>>8&65280)+((65280&st)<<8)+((255&st)<<24)}function Q(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new d.Buf16(320),this.work=new d.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function K(st){var ut;return st&&st.state?(ut=st.state,st.total_in=st.total_out=ut.total=0,st.msg="",ut.wrap&&(st.adler=1&ut.wrap),ut.mode=Z,ut.last=0,ut.havedict=0,ut.dmax=32768,ut.head=null,ut.hold=0,ut.bits=0,ut.lencode=ut.lendyn=new d.Buf32(H),ut.distcode=ut.distdyn=new d.Buf32(W),ut.sane=1,ut.back=-1,D):U}function q(st){var ut;return st&&st.state?((ut=st.state).wsize=0,ut.whave=0,ut.wnext=0,K(st)):U}function et(st,ut){var it,ct;return st&&st.state?(ct=st.state,ut<0?(it=0,ut=-ut):(it=1+(ut>>4),ut<48&&(ut&=15)),ut&&(ut<8||ut>15)?U:(ct.window!==null&&ct.wbits!==ut&&(ct.window=null),ct.wrap=it,ct.wbits=ut,q(st))):U}function X(st,ut){var it,ct;return st?(ct=new Q,st.state=ct,ct.window=null,(it=et(st,ut))!==D&&(st.state=null),it):U}var tt,rt,ot=!0;function J(st){if(ot){var ut;for(tt=new d.Buf32(512),rt=new d.Buf32(32),ut=0;ut<144;)st.lens[ut++]=8;for(;ut<256;)st.lens[ut++]=9;for(;ut<280;)st.lens[ut++]=7;for(;ut<288;)st.lens[ut++]=8;for(I(P,st.lens,0,288,tt,0,st.work,{bits:9}),ut=0;ut<32;)st.lens[ut++]=5;I(F,st.lens,0,32,rt,0,st.work,{bits:5}),ot=!1}st.lencode=tt,st.lenbits=9,st.distcode=rt,st.distbits=5}function lt(st,ut,it,ct){var At,Et=st.state;return Et.window===null&&(Et.wsize=1<<Et.wbits,Et.wnext=0,Et.whave=0,Et.window=new d.Buf8(Et.wsize)),ct>=Et.wsize?(d.arraySet(Et.window,ut,it-Et.wsize,Et.wsize,0),Et.wnext=0,Et.whave=Et.wsize):((At=Et.wsize-Et.wnext)>ct&&(At=ct),d.arraySet(Et.window,ut,it-ct,At,Et.wnext),(ct-=At)?(d.arraySet(Et.window,ut,it-ct,ct,0),Et.wnext=ct,Et.whave=Et.wsize):(Et.wnext+=At,Et.wnext===Et.wsize&&(Et.wnext=0),Et.whave<Et.wsize&&(Et.whave+=At))),0}return inflate.inflateReset=q,inflate.inflateReset2=et,inflate.inflateResetKeep=K,inflate.inflateInit=function(st){return X(st,15)},inflate.inflateInit2=X,inflate.inflate=function(st,ut){var it,ct,At,Et,gt,pt,vt,Tt,It,$t,Bt,zt,Ot,Nt,Pt,Ut,Ft,Zt,Ht,Dt,dt,Lt,bt,wt,xt=0,Rt=new d.Buf8(4),Gt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!st||!st.state||!st.output||!st.input&&st.avail_in!==0)return U;(it=st.state).mode===$&&(it.mode=13),gt=st.next_out,At=st.output,vt=st.avail_out,Et=st.next_in,ct=st.input,pt=st.avail_in,Tt=it.hold,It=it.bits,$t=pt,Bt=vt,Lt=D;t:for(;;)switch(it.mode){case Z:if(it.wrap===0){it.mode=13;break}for(;It<16;){if(pt===0)break t;pt--,Tt+=ct[Et++]<<It,It+=8}if(2&it.wrap&&Tt===35615){it.check=0,Rt[0]=255&Tt,Rt[1]=Tt>>>8&255,it.check=g(it.check,Rt,2,0),Tt=0,It=0,it.mode=2;break}if(it.flags=0,it.head&&(it.head.done=!1),!(1&it.wrap)||(((255&Tt)<<8)+(Tt>>8))%31){st.msg="incorrect header check",it.mode=j;break}if((15&Tt)!=8){st.msg="unknown compression method",it.mode=j;break}if(It-=4,dt=8+(15&(Tt>>>=4)),it.wbits===0)it.wbits=dt;else if(dt>it.wbits){st.msg="invalid window size",it.mode=j;break}it.dmax=1<<dt,st.adler=it.check=1,it.mode=512&Tt?10:$,Tt=0,It=0;break;case 2:for(;It<16;){if(pt===0)break t;pt--,Tt+=ct[Et++]<<It,It+=8}if(it.flags=Tt,(255&it.flags)!=8){st.msg="unknown compression method",it.mode=j;break}if(57344&it.flags){st.msg="unknown header flags set",it.mode=j;break}it.head&&(it.head.text=Tt>>8&1),512&it.flags&&(Rt[0]=255&Tt,Rt[1]=Tt>>>8&255,it.check=g(it.check,Rt,2,0)),Tt=0,It=0,it.mode=3;case 3:for(;It<32;){if(pt===0)break t;pt--,Tt+=ct[Et++]<<It,It+=8}it.head&&(it.head.time=Tt),512&it.flags&&(Rt[0]=255&Tt,Rt[1]=Tt>>>8&255,Rt[2]=Tt>>>16&255,Rt[3]=Tt>>>24&255,it.check=g(it.check,Rt,4,0)),Tt=0,It=0,it.mode=4;case 4:for(;It<16;){if(pt===0)break t;pt--,Tt+=ct[Et++]<<It,It+=8}it.head&&(it.head.xflags=255&Tt,it.head.os=Tt>>8),512&it.flags&&(Rt[0]=255&Tt,Rt[1]=Tt>>>8&255,it.check=g(it.check,Rt,2,0)),Tt=0,It=0,it.mode=5;case 5:if(1024&it.flags){for(;It<16;){if(pt===0)break t;pt--,Tt+=ct[Et++]<<It,It+=8}it.length=Tt,it.head&&(it.head.extra_len=Tt),512&it.flags&&(Rt[0]=255&Tt,Rt[1]=Tt>>>8&255,it.check=g(it.check,Rt,2,0)),Tt=0,It=0}else it.head&&(it.head.extra=null);it.mode=6;case 6:if(1024&it.flags&&((zt=it.length)>pt&&(zt=pt),zt&&(it.head&&(dt=it.head.extra_len-it.length,it.head.extra||(it.head.extra=new Array(it.head.extra_len)),d.arraySet(it.head.extra,ct,Et,zt,dt)),512&it.flags&&(it.check=g(it.check,ct,zt,Et)),pt-=zt,Et+=zt,it.length-=zt),it.length))break t;it.length=0,it.mode=7;case 7:if(2048&it.flags){if(pt===0)break t;zt=0;do dt=ct[Et+zt++],it.head&&dt&&it.length<65536&&(it.head.name+=String.fromCharCode(dt));while(dt&&zt<pt);if(512&it.flags&&(it.check=g(it.check,ct,zt,Et)),pt-=zt,Et+=zt,dt)break t}else it.head&&(it.head.name=null);it.length=0,it.mode=8;case 8:if(4096&it.flags){if(pt===0)break t;zt=0;do dt=ct[Et+zt++],it.head&&dt&&it.length<65536&&(it.head.comment+=String.fromCharCode(dt));while(dt&&zt<pt);if(512&it.flags&&(it.check=g(it.check,ct,zt,Et)),pt-=zt,Et+=zt,dt)break t}else it.head&&(it.head.comment=null);it.mode=9;case 9:if(512&it.flags){for(;It<16;){if(pt===0)break t;pt--,Tt+=ct[Et++]<<It,It+=8}if(Tt!==(65535&it.check)){st.msg="header crc mismatch",it.mode=j;break}Tt=0,It=0}it.head&&(it.head.hcrc=it.flags>>9&1,it.head.done=!0),st.adler=it.check=0,it.mode=$;break;case 10:for(;It<32;){if(pt===0)break t;pt--,Tt+=ct[Et++]<<It,It+=8}st.adler=it.check=V(Tt),Tt=0,It=0,it.mode=11;case 11:if(it.havedict===0)return st.next_out=gt,st.avail_out=vt,st.next_in=Et,st.avail_in=pt,it.hold=Tt,it.bits=It,2;st.adler=it.check=1,it.mode=$;case $:if(ut===5||ut===6)break t;case 13:if(it.last){Tt>>>=7&It,It-=7&It,it.mode=27;break}for(;It<3;){if(pt===0)break t;pt--,Tt+=ct[Et++]<<It,It+=8}switch(it.last=1&Tt,It-=1,3&(Tt>>>=1)){case 0:it.mode=14;break;case 1:if(J(it),it.mode=20,ut===6){Tt>>>=2,It-=2;break t}break;case 2:it.mode=17;break;case 3:st.msg="invalid block type",it.mode=j}Tt>>>=2,It-=2;break;case 14:for(Tt>>>=7&It,It-=7&It;It<32;){if(pt===0)break t;pt--,Tt+=ct[Et++]<<It,It+=8}if((65535&Tt)!=(Tt>>>16^65535)){st.msg="invalid stored block lengths",it.mode=j;break}if(it.length=65535&Tt,Tt=0,It=0,it.mode=15,ut===6)break t;case 15:it.mode=16;case 16:if(zt=it.length){if(zt>pt&&(zt=pt),zt>vt&&(zt=vt),zt===0)break t;d.arraySet(At,ct,Et,zt,gt),pt-=zt,Et+=zt,vt-=zt,gt+=zt,it.length-=zt;break}it.mode=$;break;case 17:for(;It<14;){if(pt===0)break t;pt--,Tt+=ct[Et++]<<It,It+=8}if(it.nlen=257+(31&Tt),Tt>>>=5,It-=5,it.ndist=1+(31&Tt),Tt>>>=5,It-=5,it.ncode=4+(15&Tt),Tt>>>=4,It-=4,it.nlen>286||it.ndist>30){st.msg="too many length or distance symbols",it.mode=j;break}it.have=0,it.mode=18;case 18:for(;it.have<it.ncode;){for(;It<3;){if(pt===0)break t;pt--,Tt+=ct[Et++]<<It,It+=8}it.lens[Gt[it.have++]]=7&Tt,Tt>>>=3,It-=3}for(;it.have<19;)it.lens[Gt[it.have++]]=0;if(it.lencode=it.lendyn,it.lenbits=7,bt={bits:it.lenbits},Lt=I(0,it.lens,0,19,it.lencode,0,it.work,bt),it.lenbits=bt.bits,Lt){st.msg="invalid code lengths set",it.mode=j;break}it.have=0,it.mode=19;case 19:for(;it.have<it.nlen+it.ndist;){for(;Ut=(xt=it.lencode[Tt&(1<<it.lenbits)-1])>>>16&255,Ft=65535&xt,!((Pt=xt>>>24)<=It);){if(pt===0)break t;pt--,Tt+=ct[Et++]<<It,It+=8}if(Ft<16)Tt>>>=Pt,It-=Pt,it.lens[it.have++]=Ft;else{if(Ft===16){for(wt=Pt+2;It<wt;){if(pt===0)break t;pt--,Tt+=ct[Et++]<<It,It+=8}if(Tt>>>=Pt,It-=Pt,it.have===0){st.msg="invalid bit length repeat",it.mode=j;break}dt=it.lens[it.have-1],zt=3+(3&Tt),Tt>>>=2,It-=2}else if(Ft===17){for(wt=Pt+3;It<wt;){if(pt===0)break t;pt--,Tt+=ct[Et++]<<It,It+=8}It-=Pt,dt=0,zt=3+(7&(Tt>>>=Pt)),Tt>>>=3,It-=3}else{for(wt=Pt+7;It<wt;){if(pt===0)break t;pt--,Tt+=ct[Et++]<<It,It+=8}It-=Pt,dt=0,zt=11+(127&(Tt>>>=Pt)),Tt>>>=7,It-=7}if(it.have+zt>it.nlen+it.ndist){st.msg="invalid bit length repeat",it.mode=j;break}for(;zt--;)it.lens[it.have++]=dt}}if(it.mode===j)break;if(it.lens[256]===0){st.msg="invalid code -- missing end-of-block",it.mode=j;break}if(it.lenbits=9,bt={bits:it.lenbits},Lt=I(P,it.lens,0,it.nlen,it.lencode,0,it.work,bt),it.lenbits=bt.bits,Lt){st.msg="invalid literal/lengths set",it.mode=j;break}if(it.distbits=6,it.distcode=it.distdyn,bt={bits:it.distbits},Lt=I(F,it.lens,it.nlen,it.ndist,it.distcode,0,it.work,bt),it.distbits=bt.bits,Lt){st.msg="invalid distances set",it.mode=j;break}if(it.mode=20,ut===6)break t;case 20:it.mode=21;case 21:if(pt>=6&&vt>=258){st.next_out=gt,st.avail_out=vt,st.next_in=Et,st.avail_in=pt,it.hold=Tt,it.bits=It,w(st,Bt),gt=st.next_out,At=st.output,vt=st.avail_out,Et=st.next_in,ct=st.input,pt=st.avail_in,Tt=it.hold,It=it.bits,it.mode===$&&(it.back=-1);break}for(it.back=0;Ut=(xt=it.lencode[Tt&(1<<it.lenbits)-1])>>>16&255,Ft=65535&xt,!((Pt=xt>>>24)<=It);){if(pt===0)break t;pt--,Tt+=ct[Et++]<<It,It+=8}if(Ut&&!(240&Ut)){for(Zt=Pt,Ht=Ut,Dt=Ft;Ut=(xt=it.lencode[Dt+((Tt&(1<<Zt+Ht)-1)>>Zt)])>>>16&255,Ft=65535&xt,!(Zt+(Pt=xt>>>24)<=It);){if(pt===0)break t;pt--,Tt+=ct[Et++]<<It,It+=8}Tt>>>=Zt,It-=Zt,it.back+=Zt}if(Tt>>>=Pt,It-=Pt,it.back+=Pt,it.length=Ft,Ut===0){it.mode=26;break}if(32&Ut){it.back=-1,it.mode=$;break}if(64&Ut){st.msg="invalid literal/length code",it.mode=j;break}it.extra=15&Ut,it.mode=22;case 22:if(it.extra){for(wt=it.extra;It<wt;){if(pt===0)break t;pt--,Tt+=ct[Et++]<<It,It+=8}it.length+=Tt&(1<<it.extra)-1,Tt>>>=it.extra,It-=it.extra,it.back+=it.extra}it.was=it.length,it.mode=23;case 23:for(;Ut=(xt=it.distcode[Tt&(1<<it.distbits)-1])>>>16&255,Ft=65535&xt,!((Pt=xt>>>24)<=It);){if(pt===0)break t;pt--,Tt+=ct[Et++]<<It,It+=8}if(!(240&Ut)){for(Zt=Pt,Ht=Ut,Dt=Ft;Ut=(xt=it.distcode[Dt+((Tt&(1<<Zt+Ht)-1)>>Zt)])>>>16&255,Ft=65535&xt,!(Zt+(Pt=xt>>>24)<=It);){if(pt===0)break t;pt--,Tt+=ct[Et++]<<It,It+=8}Tt>>>=Zt,It-=Zt,it.back+=Zt}if(Tt>>>=Pt,It-=Pt,it.back+=Pt,64&Ut){st.msg="invalid distance code",it.mode=j;break}it.offset=Ft,it.extra=15&Ut,it.mode=24;case 24:if(it.extra){for(wt=it.extra;It<wt;){if(pt===0)break t;pt--,Tt+=ct[Et++]<<It,It+=8}it.offset+=Tt&(1<<it.extra)-1,Tt>>>=it.extra,It-=it.extra,it.back+=it.extra}if(it.offset>it.dmax){st.msg="invalid distance too far back",it.mode=j;break}it.mode=25;case 25:if(vt===0)break t;if(zt=Bt-vt,it.offset>zt){if((zt=it.offset-zt)>it.whave&&it.sane){st.msg="invalid distance too far back",it.mode=j;break}zt>it.wnext?(zt-=it.wnext,Ot=it.wsize-zt):Ot=it.wnext-zt,zt>it.length&&(zt=it.length),Nt=it.window}else Nt=At,Ot=gt-it.offset,zt=it.length;zt>vt&&(zt=vt),vt-=zt,it.length-=zt;do At[gt++]=Nt[Ot++];while(--zt);it.length===0&&(it.mode=21);break;case 26:if(vt===0)break t;At[gt++]=it.length,vt--,it.mode=21;break;case 27:if(it.wrap){for(;It<32;){if(pt===0)break t;pt--,Tt|=ct[Et++]<<It,It+=8}if(Bt-=vt,st.total_out+=Bt,it.total+=Bt,Bt&&(st.adler=it.check=it.flags?g(it.check,At,Bt,gt-Bt):m(it.check,At,Bt,gt-Bt)),Bt=vt,(it.flags?Tt:V(Tt))!==it.check){st.msg="incorrect data check",it.mode=j;break}Tt=0,It=0}it.mode=28;case 28:if(it.wrap&&it.flags){for(;It<32;){if(pt===0)break t;pt--,Tt+=ct[Et++]<<It,It+=8}if(Tt!==(4294967295&it.total)){st.msg="incorrect length check",it.mode=j;break}Tt=0,It=0}it.mode=29;case 29:Lt=1;break t;case j:Lt=-3;break t;case 31:return-4;default:return U}return st.next_out=gt,st.avail_out=vt,st.next_in=Et,st.avail_in=pt,it.hold=Tt,it.bits=It,(it.wsize||Bt!==st.avail_out&&it.mode<j&&(it.mode<27||ut!==4))&&lt(st,st.output,st.next_out,Bt-st.avail_out),$t-=st.avail_in,Bt-=st.avail_out,st.total_in+=$t,st.total_out+=Bt,it.total+=Bt,it.wrap&&Bt&&(st.adler=it.check=it.flags?g(it.check,At,Bt,st.next_out-Bt):m(it.check,At,Bt,st.next_out-Bt)),st.data_type=it.bits+(it.last?64:0)+(it.mode===$?128:0)+(it.mode===20||it.mode===15?256:0),($t===0&&Bt===0||ut===4)&&Lt===D&&(Lt=-5),Lt},inflate.inflateEnd=function(st){if(!st||!st.state)return U;var ut=st.state;return ut.window&&(ut.window=null),st.state=null,D},inflate.inflateGetHeader=function(st,ut){var it;return st&&st.state&&2&(it=st.state).wrap?(it.head=ut,ut.done=!1,D):U},inflate.inflateSetDictionary=function(st,ut){var it,ct=ut.length;return st&&st.state?(it=st.state).wrap!==0&&it.mode!==11?U:it.mode===11&&m(1,ut,ct,0)!==it.check?-3:lt(st,ut,ct,ct)?(it.mode=31,-4):(it.havedict=1,D):U},inflate.inflateInfo="pako inflate (from Nodeca project)",inflate}function requireConstants(){return hasRequiredConstants?constants:(hasRequiredConstants=1,constants={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8})}function requireGzheader(){return hasRequiredGzheader?gzheader:(hasRequiredGzheader=1,gzheader=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1})}function requireInflate(){if(hasRequiredInflate)return inflate$1;hasRequiredInflate=1;var d=requireInflate$1(),m=requireCommon(),g=requireStrings(),w=requireConstants(),I=requireMessages(),P=requireZstream(),F=requireGzheader(),D=Object.prototype.toString;function U($){if(!(this instanceof U))return new U($);this.options=m.assign({chunkSize:16384,windowBits:0,to:""},$||{});var j=this.options;j.raw&&j.windowBits>=0&&j.windowBits<16&&(j.windowBits=-j.windowBits,j.windowBits===0&&(j.windowBits=-15)),!(j.windowBits>=0&&j.windowBits<16)||$&&$.windowBits||(j.windowBits+=32),j.windowBits>15&&j.windowBits<48&&(15&j.windowBits||(j.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new P,this.strm.avail_out=0;var H=d.inflateInit2(this.strm,j.windowBits);if(H!==w.Z_OK)throw new Error(I[H]);if(this.header=new F,d.inflateGetHeader(this.strm,this.header),j.dictionary&&(typeof j.dictionary=="string"?j.dictionary=g.string2buf(j.dictionary):D.call(j.dictionary)==="[object ArrayBuffer]"&&(j.dictionary=new Uint8Array(j.dictionary)),j.raw&&(H=d.inflateSetDictionary(this.strm,j.dictionary))!==w.Z_OK))throw new Error(I[H])}function Z($,j){var H=new U(j);if(H.push($,!0),H.err)throw H.msg||I[H.err];return H.result}return U.prototype.push=function($,j){var H,W,V,Q,K,q=this.strm,et=this.options.chunkSize,X=this.options.dictionary,tt=!1;if(this.ended)return!1;W=j===~~j?j:j===!0?w.Z_FINISH:w.Z_NO_FLUSH,typeof $=="string"?q.input=g.binstring2buf($):D.call($)==="[object ArrayBuffer]"?q.input=new Uint8Array($):q.input=$,q.next_in=0,q.avail_in=q.input.length;do{if(q.avail_out===0&&(q.output=new m.Buf8(et),q.next_out=0,q.avail_out=et),(H=d.inflate(q,w.Z_NO_FLUSH))===w.Z_NEED_DICT&&X&&(H=d.inflateSetDictionary(this.strm,X)),H===w.Z_BUF_ERROR&&tt===!0&&(H=w.Z_OK,tt=!1),H!==w.Z_STREAM_END&&H!==w.Z_OK)return this.onEnd(H),this.ended=!0,!1;q.next_out&&(q.avail_out!==0&&H!==w.Z_STREAM_END&&(q.avail_in!==0||W!==w.Z_FINISH&&W!==w.Z_SYNC_FLUSH)||(this.options.to==="string"?(V=g.utf8border(q.output,q.next_out),Q=q.next_out-V,K=g.buf2string(q.output,V),q.next_out=Q,q.avail_out=et-Q,Q&&m.arraySet(q.output,q.output,V,Q,0),this.onData(K)):this.onData(m.shrinkBuf(q.output,q.next_out)))),q.avail_in===0&&q.avail_out===0&&(tt=!0)}while((q.avail_in>0||q.avail_out===0)&&H!==w.Z_STREAM_END);return H===w.Z_STREAM_END&&(W=w.Z_FINISH),W===w.Z_FINISH?(H=d.inflateEnd(this.strm),this.onEnd(H),this.ended=!0,H===w.Z_OK):W!==w.Z_SYNC_FLUSH||(this.onEnd(w.Z_OK),q.avail_out=0,!0)},U.prototype.onData=function($){this.chunks.push($)},U.prototype.onEnd=function($){$===w.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=m.flattenChunks(this.chunks)),this.chunks=[],this.err=$,this.msg=this.strm.msg},inflate$1.Inflate=U,inflate$1.inflate=Z,inflate$1.inflateRaw=function($,j){return(j=j||{}).raw=!0,Z($,j)},inflate$1.ungzip=Z,inflate$1}function requirePako(){if(hasRequiredPako)return pako_1;hasRequiredPako=1;var d={};return(0,requireCommon().assign)(d,requireDeflate(),requireInflate(),requireConstants()),pako_1=d}(function(d){(function(){var m={};function g(){typeof process<"u"||console.log.apply(console,arguments)}d.exports=m,function(w,I){(function(){var P=function(){function U(Z){this.message="JPEG error: "+Z}return U.prototype=new Error,U.prototype.name="JpegError",U.constructor=U,U}(),F=function(){var U=new Uint8Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),Z=4017,$=799,j=3406,H=2276,W=1567,V=3784,Q=5793,K=2896;function q(lt){lt==null&&(lt={}),lt.w==null&&(lt.w=-1),this.V=lt.n,this.N=lt.w}function et(lt,st){for(var ut,it,ct,At=0,Et=[],gt=16;gt>0&&!lt[gt-1];)gt--;Et.push({children:[],index:0});var pt=Et[0];for(ut=0;ut<gt;ut++){for(it=0;it<lt[ut];it++){for((pt=Et.pop()).children[pt.index]=st[At];pt.index>0;)pt=Et.pop();for(pt.index++,Et.push(pt);Et.length<=ut;)Et.push(ct={children:[],index:0}),pt.children[pt.index]=ct.children,pt=ct;At++}ut+1<gt&&(Et.push(ct={children:[],index:0}),pt.children[pt.index]=ct.children,pt=ct)}return Et[0].children}function X(lt,st,ut){return 64*((lt.P+1)*st+ut)}function tt(lt,st,ut,it,ct,At,Et,gt,pt,vt){vt==null&&(vt=!1);var Tt,It,$t,Bt,zt,Ot,Nt,Pt,Ut,Ft,Zt,Ht=ut.m,Dt=ut.Z,dt=st,Lt=0,bt=0,wt=0,xt=0,Rt=0,Gt=0;function nt(){if(bt>0)return bt--,Lt>>bt&1;if((Lt=lt[st++])===255){var Jt=lt[st++];if(Jt){if(Jt===220&&vt){var se=D(lt,st+=2);if(st+=2,se>0&&se!==ut.s)throw new DNLMarkerError("Found DNL marker (0xFFDC) while parsing scan data",se)}else if(Jt===217){if(vt){var ae=8*Rt;if(ae>0&&ae<ut.s/10)throw new DNLMarkerError("Found EOI marker (0xFFD9) while parsing scan data, possibly caused by incorrect `scanLines` parameter",ae)}throw new EOIMarkerError("Found EOI marker (0xFFD9) while parsing scan data")}throw new P("unexpected marker")}}return bt=7,Lt>>>7}function ht(Jt){for(var se=Jt;;){switch(typeof(se=se[nt()])){case"number":return se;case"object":continue}throw new P("invalid huffman sequence")}}function ft(Jt){for(var se=0;Jt>0;)se=se<<1|nt(),Jt--;return se}function at(Jt){if(Jt===1)return nt()===1?1:-1;var se=ft(Jt);return se>=1<<Jt-1?se:se+(-1<<Jt)+1}function _t(Jt,se,ae,fe,le){var ue=ae%Ht;Rt=(ae/Ht|0)*Jt.A+fe;var me=ue*Jt.h+le;se(Jt,X(Jt,Rt,me))}function St(Jt,se,ae){Rt=ae/Jt.P|0;var fe=ae%Jt.P;se(Jt,X(Jt,Rt,fe))}var Vt=it.length;for(Nt=Dt?At===0?gt===0?function(Jt,se){var ae=ht(Jt.J),fe=ae===0?0:at(ae)<<pt;Jt.D[se]=Jt.Q+=fe}:function(Jt,se){Jt.D[se]|=nt()<<pt}:gt===0?function(Jt,se){if(wt>0)wt--;else for(var ae=At,fe=Et;ae<=fe;){var le=ht(Jt.i),ue=15&le,me=le>>4;if(ue!==0){var he=U[ae+=me];Jt.D[se+he]=at(ue)*(1<<pt),ae++}else{if(me<15){wt=ft(me)+(1<<me)-1;break}ae+=16}}}:function(Jt,se){for(var ae,fe,le=At,ue=Et,me=0;le<=ue;){var he=se+U[le],Wt=Jt.D[he]<0?-1:1;switch(xt){case 0:if(me=(fe=ht(Jt.i))>>4,(ae=15&fe)==0)me<15?(wt=ft(me)+(1<<me),xt=4):(me=16,xt=1);else{if(ae!==1)throw new P("invalid ACn encoding");Tt=at(ae),xt=me?2:3}continue;case 1:case 2:Jt.D[he]?Jt.D[he]+=Wt*(nt()<<pt):--me==0&&(xt=xt===2?3:0);break;case 3:Jt.D[he]?Jt.D[he]+=Wt*(nt()<<pt):(Jt.D[he]=Tt<<pt,xt=0);break;case 4:Jt.D[he]&&(Jt.D[he]+=Wt*(nt()<<pt))}le++}xt===4&&--wt==0&&(xt=0)}:function(Jt,se){var ae=ht(Jt.J),fe=ae===0?0:at(ae),le=1;for(Jt.D[se]=Jt.Q+=fe;le<64;){var ue=ht(Jt.i),me=15&ue,he=ue>>4;if(me!==0){var Wt=U[le+=he];Jt.D[se+Wt]=at(me),le++}else{if(he<15)break;le+=16}}},Ut=Vt===1?it[0].P*it[0].c:Ht*ut.R;Gt<=Ut;){var ee=ct?Math.min(Ut-Gt,ct):Ut;if(ee>0){for($t=0;$t<Vt;$t++)it[$t].Q=0;if(wt=0,Vt===1)for(It=it[0],Ot=0;Ot<ee;Ot++)St(It,Nt,Gt),Gt++;else for(Ot=0;Ot<ee;Ot++){for($t=0;$t<Vt;$t++)for(Ft=(It=it[$t]).h,Zt=It.A,Bt=0;Bt<Zt;Bt++)for(zt=0;zt<Ft;zt++)_t(It,Nt,Gt,Bt,zt);Gt++}}if(bt=0,!(Pt=J(lt,st))||(Pt.u&&(st=Pt.offset),!(Pt.M>=65488&&Pt.M<=65495)))break;st+=2}return st-dt}function rt(lt,st,ut){var it,ct,At,Et,gt,pt,vt,Tt,It,$t,Bt,zt,Ot,Nt,Pt,Ut,Ft,Zt=lt.$,Ht=lt.D;if(!Zt)throw new P("missing required Quantization Table.");for(var Dt=0;Dt<64;Dt+=8)It=Ht[st+Dt],$t=Ht[st+Dt+1],Bt=Ht[st+Dt+2],zt=Ht[st+Dt+3],Ot=Ht[st+Dt+4],Nt=Ht[st+Dt+5],Pt=Ht[st+Dt+6],Ut=Ht[st+Dt+7],It*=Zt[Dt],$t|Bt|zt|Ot|Nt|Pt|Ut?($t*=Zt[Dt+1],Bt*=Zt[Dt+2],zt*=Zt[Dt+3],Ot*=Zt[Dt+4],Nt*=Zt[Dt+5],Pt*=Zt[Dt+6],Ut*=Zt[Dt+7],ct=(it=(it=Q*It+128>>8)+(ct=Q*Ot+128>>8)+1>>1)-ct,Ft=(At=Bt)*V+(Et=Pt)*W+128>>8,At=At*W-Et*V+128>>8,vt=(gt=(gt=K*($t-Ut)+128>>8)+(vt=Nt<<4)+1>>1)-vt,pt=(Tt=(Tt=K*($t+Ut)+128>>8)+(pt=zt<<4)+1>>1)-pt,Et=(it=it+(Et=Ft)+1>>1)-Et,At=(ct=ct+At+1>>1)-At,Ft=gt*H+Tt*j+2048>>12,gt=gt*j-Tt*H+2048>>12,Tt=Ft,Ft=pt*$+vt*Z+2048>>12,pt=pt*Z-vt*$+2048>>12,vt=Ft,ut[Dt]=it+Tt,ut[Dt+7]=it-Tt,ut[Dt+1]=ct+vt,ut[Dt+6]=ct-vt,ut[Dt+2]=At+pt,ut[Dt+5]=At-pt,ut[Dt+3]=Et+gt,ut[Dt+4]=Et-gt):(Ft=Q*It+512>>10,ut[Dt]=Ft,ut[Dt+1]=Ft,ut[Dt+2]=Ft,ut[Dt+3]=Ft,ut[Dt+4]=Ft,ut[Dt+5]=Ft,ut[Dt+6]=Ft,ut[Dt+7]=Ft);for(var dt=0;dt<8;++dt)It=ut[dt],($t=ut[dt+8])|(Bt=ut[dt+16])|(zt=ut[dt+24])|(Ot=ut[dt+32])|(Nt=ut[dt+40])|(Pt=ut[dt+48])|(Ut=ut[dt+56])?(ct=(it=4112+((it=Q*It+2048>>12)+(ct=Q*Ot+2048>>12)+1>>1))-ct,Ft=(At=Bt)*V+(Et=Pt)*W+2048>>12,At=At*W-Et*V+2048>>12,Et=Ft,vt=(gt=(gt=K*($t-Ut)+2048>>12)+(vt=Nt)+1>>1)-vt,pt=(Tt=(Tt=K*($t+Ut)+2048>>12)+(pt=zt)+1>>1)-pt,Ft=gt*H+Tt*j+2048>>12,gt=gt*j-Tt*H+2048>>12,Tt=Ft,Ft=pt*$+vt*Z+2048>>12,pt=pt*Z-vt*$+2048>>12,(It=(it=it+Et+1>>1)+Tt)<16?It=0:It>=4080?It=255:It>>=4,($t=(ct=ct+At+1>>1)+(vt=Ft))<16?$t=0:$t>=4080?$t=255:$t>>=4,(Bt=(At=ct-At)+pt)<16?Bt=0:Bt>=4080?Bt=255:Bt>>=4,(zt=(Et=it-Et)+gt)<16?zt=0:zt>=4080?zt=255:zt>>=4,(Ot=Et-gt)<16?Ot=0:Ot>=4080?Ot=255:Ot>>=4,(Nt=At-pt)<16?Nt=0:Nt>=4080?Nt=255:Nt>>=4,(Pt=ct-vt)<16?Pt=0:Pt>=4080?Pt=255:Pt>>=4,(Ut=it-Tt)<16?Ut=0:Ut>=4080?Ut=255:Ut>>=4,Ht[st+dt]=It,Ht[st+dt+8]=$t,Ht[st+dt+16]=Bt,Ht[st+dt+24]=zt,Ht[st+dt+32]=Ot,Ht[st+dt+40]=Nt,Ht[st+dt+48]=Pt,Ht[st+dt+56]=Ut):(Ft=(Ft=Q*It+8192>>14)<-2040?0:Ft>=2024?255:Ft+2056>>4,Ht[st+dt]=Ft,Ht[st+dt+8]=Ft,Ht[st+dt+16]=Ft,Ht[st+dt+24]=Ft,Ht[st+dt+32]=Ft,Ht[st+dt+40]=Ft,Ht[st+dt+48]=Ft,Ht[st+dt+56]=Ft)}function ot(lt,st){for(var ut=st.P,it=st.c,ct=new Int16Array(64),At=0;At<it;At++)for(var Et=0;Et<ut;Et++)rt(st,X(st,At,Et),ct);return st.D}function J(lt,st,ut){ut==null&&(ut=st);var it=lt.length-1,ct=ut<st?ut:st;if(st>=it)return null;var At=D(lt,st);if(At>=65472&&At<=65534)return{u:null,M:At,offset:st};for(var Et=D(lt,ct);!(Et>=65472&&Et<=65534);){if(++ct>=it)return null;Et=D(lt,ct)}return{u:At.toString(16),M:Et,offset:ct}}return q.prototype={parse(lt,st){st==null&&(st={});var ut,it,ct=st.F,At=0,Et=null,gt=null,pt=0;function vt(){var kt=D(lt,At),Xt=(At+=2)+kt-2,Ct=J(lt,Xt,At);Ct&&Ct.u&&(Xt=Ct.offset);var re=lt.subarray(At,Xt);return At+=re.length,re}function Tt(kt){for(var Xt=Math.ceil(kt.o/8/kt.X),Ct=Math.ceil(kt.s/8/kt.B),re=0;re<kt.W.length;re++){St=kt.W[re];var te=Math.ceil(Math.ceil(kt.o/8)*St.h/kt.X),yt=Math.ceil(Math.ceil(kt.s/8)*St.A/kt.B),Mt=Xt*St.h,Yt=64*(Ct*St.A)*(Mt+1);St.D=new Int16Array(Yt),St.P=te,St.c=yt}kt.m=Xt,kt.R=Ct}var It=[],$t=[],Bt=[],zt=D(lt,At);if(At+=2,zt!==65496)throw new P("SOI not found");zt=D(lt,At),At+=2;t:for(;zt!==65497;){var Ot,Nt,Pt;switch(zt){case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var Ut=vt();zt===65504&&Ut[0]===74&&Ut[1]===70&&Ut[2]===73&&Ut[3]===70&&Ut[4]===0&&(Et={version:{d:Ut[5],T:Ut[6]},K:Ut[7],j:Ut[8]<<8|Ut[9],H:Ut[10]<<8|Ut[11],S:Ut[12],I:Ut[13],C:Ut.subarray(14,14+3*Ut[12]*Ut[13])}),zt===65518&&Ut[0]===65&&Ut[1]===100&&Ut[2]===111&&Ut[3]===98&&Ut[4]===101&&(gt={version:Ut[5]<<8|Ut[6],k:Ut[7]<<8|Ut[8],q:Ut[9]<<8|Ut[10],a:Ut[11]});break;case 65499:for(var Ft=D(lt,At)+(At+=2)-2;At<Ft;){var Zt=lt[At++],Ht=new Uint16Array(64);if(Zt>>4){if(Zt>>4!=1)throw new P("DQT - invalid table spec");for(Nt=0;Nt<64;Nt++)Ht[U[Nt]]=D(lt,At),At+=2}else for(Nt=0;Nt<64;Nt++)Ht[U[Nt]]=lt[At++];It[15&Zt]=Ht}break;case 65472:case 65473:case 65474:if(ut)throw new P("Only single frame JPEGs supported");At+=2,(ut={}).G=zt===65473,ut.Z=zt===65474,ut.precision=lt[At++];var Dt,dt=D(lt,At),Lt=0,bt=0;At+=2,ut.s=ct||dt,ut.o=D(lt,At),At+=2,ut.W=[],ut._={};var wt=lt[At++];for(Ot=0;Ot<wt;Ot++){Dt=lt[At];var xt=lt[At+1]>>4,Rt=15&lt[At+1];Lt<xt&&(Lt=xt),bt<Rt&&(bt=Rt);var Gt=lt[At+2];Pt=ut.W.push({h:xt,A:Rt,L:Gt,$:null}),ut._[Dt]=Pt-1,At+=3}ut.X=Lt,ut.B=bt,Tt(ut);break;case 65476:var nt=D(lt,At);for(At+=2,Ot=2;Ot<nt;){var ht=lt[At++],ft=new Uint8Array(16),at=0;for(Nt=0;Nt<16;Nt++,At++)at+=ft[Nt]=lt[At];var _t=new Uint8Array(at);for(Nt=0;Nt<at;Nt++,At++)_t[Nt]=lt[At];Ot+=17+at,(ht>>4?$t:Bt)[15&ht]=et(ft,_t)}break;case 65501:it=D(lt,At+=2),At+=2;break;case 65498:var St,Vt=++pt==1&&!ct;At+=2;var ee=lt[At++],Jt=[];for(Ot=0;Ot<ee;Ot++){var se=lt[At++],ae=ut._[se];(St=ut.W[ae]).index=se;var fe=lt[At++];St.J=Bt[fe>>4],St.i=$t[15&fe],Jt.push(St)}var le=lt[At++],ue=lt[At++],me=lt[At++];try{var he=tt(lt,At,ut,Jt,it,le,ue,me>>4,15&me,Vt);At+=he}catch(kt){if(kt instanceof DNLMarkerError)return this.parse(lt,{F:kt.s});if(kt instanceof EOIMarkerError)break t;throw kt}break;case 65500:At+=4;break;case 65535:lt[At]!==255&&At--;break;default:var Wt=J(lt,At-2,At-3);if(Wt&&Wt.u){At=Wt.offset;break}if(At>=lt.length-1)break t;throw new P("JpegImage.parse - unknown marker: "+zt.toString(16))}zt=D(lt,At),At+=2}for(this.width=ut.o,this.height=ut.s,this.g=Et,this.b=gt,this.W=[],Ot=0;Ot<ut.W.length;Ot++){var oe=It[(St=ut.W[Ot]).L];oe&&(St.$=oe),this.W.push({index:St.index,e:ot(0,St),l:St.h/ut.X,t:St.A/ut.B,P:St.P,c:St.c})}this.p=this.W.length},Y(lt,st,ut){ut==null&&(ut=!1);var it,ct,At,Et,gt,pt,vt,Tt,It,$t,Bt,zt,Ot=this.width/lt,Nt=this.height/st,Pt=0,Ut=this.W.length,Ft=lt*st*Ut,Zt=new Uint8ClampedArray(Ft),Ht=new Uint32Array(lt),Dt=4294967288;for(vt=0;vt<Ut;vt++){if(ct=(it=this.W[vt]).l*Ot,At=it.t*Nt,Pt=vt,Bt=it.e,Et=it.P+1<<3,ct!==zt){for(gt=0;gt<lt;gt++)Tt=0|gt*ct,Ht[gt]=(Tt&Dt)<<3|7&Tt;zt=ct}for(pt=0;pt<st;pt++)for($t=Et*((Tt=0|pt*At)&Dt)|(7&Tt)<<3,gt=0;gt<lt;gt++)Zt[Pt]=Bt[$t+Ht[gt]],Pt+=Ut}var dt=this.V;if(ut||Ut!==4||dt||(dt=new Int32Array([-256,255,-256,255,-256,255,-256,255])),dt)for(vt=0;vt<Ft;)for(Tt=0,It=0;Tt<Ut;Tt++,vt++,It+=2)Zt[vt]=(Zt[vt]*dt[It]>>8)+dt[It+1];return Zt},get f(){return this.b?!!this.b.a:this.p===3?this.N!==0&&(this.W[0].index!==82||this.W[1].index!==71||this.W[2].index!==66):this.N===1},z:function(lt){for(var st,ut,it,ct=0,At=lt.length;ct<At;ct+=3)st=lt[ct],ut=lt[ct+1],it=lt[ct+2],lt[ct]=st-179.456+1.402*it,lt[ct+1]=st+135.459-.344*ut-.714*it,lt[ct+2]=st-226.816+1.772*ut;return lt},O:function(lt){for(var st,ut,it,ct,At=0,Et=0,gt=lt.length;Et<gt;Et+=4)st=lt[Et],ut=lt[Et+1],it=lt[Et+2],ct=lt[Et+3],lt[At++]=ut*(-660635669420364e-19*ut+.000437130475926232*it-54080610064599e-18*st+.00048449797120281*ct-.154362151871126)-122.67195406894+it*(-.000957964378445773*it+.000817076911346625*st-.00477271405408747*ct+1.53380253221734)+st*(.000961250184130688*st-.00266257332283933*ct+.48357088451265)+ct*(-.000336197177618394*ct+.484791561490776),lt[At++]=107.268039397724+ut*(219927104525741e-19*ut-.000640992018297945*it+.000659397001245577*st+.000426105652938837*ct-.176491792462875)+it*(-.000778269941513683*it+.00130872261408275*st+.000770482631801132*ct-.151051492775562)+st*(.00126935368114843*st-.00265090189010898*ct+.25802910206845)+ct*(-.000318913117588328*ct-.213742400323665),lt[At++]=ut*(-.000570115196973677*ut-263409051004589e-19*it+.0020741088115012*st-.00288260236853442*ct+.814272968359295)-20.810012546947+it*(-153496057440975e-19*it-.000132689043961446*st+.000560833691242812*ct-.195152027534049)+st*(.00174418132927582*st-.00255243321439347*ct+.116935020465145)+ct*(-.000343531996510555*ct+.24165260232407);return lt.subarray(0,At)},r:function(lt){for(var st,ut,it,ct=0,At=lt.length;ct<At;ct+=4)st=lt[ct],ut=lt[ct+1],it=lt[ct+2],lt[ct]=434.456-st-1.402*it,lt[ct+1]=119.541-st+.344*ut+.714*it,lt[ct+2]=481.816-st-1.772*ut;return lt},U:function(lt){for(var st,ut,it,ct,At=0,Et=0,gt=lt.length;Et<gt;Et+=4)st=lt[Et],ut=lt[Et+1],it=lt[Et+2],ct=lt[Et+3],lt[At++]=255+st*(-6747147073602441e-20*st+.0008379262121013727*ut+.0002894718188643294*it+.003264231057537806*ct-1.1185611867203937)+ut*(26374107616089405e-21*ut-8626949158638572e-20*it-.0002748769067499491*ct-.02155688794978967)+it*(-3878099212869363e-20*it-.0003267808279485286*ct+.0686742238595345)-ct*(.0003361971776183937*ct+.7430659151342254),lt[At++]=255+st*(.00013596372813588848*st+.000924537132573585*ut+.00010567359618683593*it+.0004791864687436512*ct-.3109689587515875)+ut*(-.00023545346108370344*ut+.0002702845253534714*it+.0020200308977307156*ct-.7488052167015494)+it*(6834815998235662e-20*it+.00015168452363460973*ct-.09751927774728933)-ct*(.0003189131175883281*ct+.7364883807733168),lt[At++]=255+st*(13598650411385307e-21*st+.00012423956175490851*ut+.0004751985097583589*it-36729317476630422e-22*ct-.05562186980264034)+ut*(.00016141380598724676*ut+.0009692239130725186*it+.0007782692450036253*ct-.44015232367526463)+it*(5068882914068769e-22*it+.0017778369011375071*ct-.7591454649749609)-ct*(.0003435319965105553*ct+.7063770186160144);return lt.subarray(0,At)},getData:function(lt){var st=lt.width,ut=lt.height,it=lt.forceRGB,ct=lt.isSourcePDF;if(this.p>4)throw new P("Unsupported color mode");var At=this.Y(st,ut,ct);if(this.p===1&&it){for(var Et=At.length,gt=new Uint8ClampedArray(3*Et),pt=0,vt=0;vt<Et;vt++){var Tt=At[vt];gt[pt++]=Tt,gt[pt++]=Tt,gt[pt++]=Tt}return gt}if(this.p===3&&this.f)return this.z(At);if(this.p===4){if(this.f)return it?this.O(At):this.r(At);if(it)return this.U(At)}return At}},q}();function D(U,Z){return U[Z]<<8|U[Z+1]}w.JpegDecoder=F})(),w.encodeImage=function(P,F,D,U){var Z={t256:[F],t257:[D],t258:[8,8,8,8],t259:[1],t262:[2],t273:[1e3],t277:[4],t278:[D],t279:[F*D*4],t282:[[72,1]],t283:[[72,1]],t284:[1],t286:[[0,1]],t287:[[0,1]],t296:[1],t305:["Photopea (UTIF.js)"],t338:[1]};if(U)for(var $ in U)Z[$]=U[$];var j=new Uint8Array(w.encode([Z])),H=new Uint8Array(P),W=new Uint8Array(1e3+F*D*4);for($=0;$<j.length;$++)W[$]=j[$];for($=0;$<H.length;$++)W[1e3+$]=H[$];return W.buffer},w.encode=function(P){var F=new Uint8Array(2e4),D=4,U=w._binBE;F[0]=F[1]=77,U.writeUshort(F,2,42);var Z=8;U.writeUint(F,D,Z),D+=4;for(var $=0;$<P.length;$++){var j=w._writeIFD(U,w._types.basic,F,Z,P[$]);Z=j[1],$<P.length-1&&(3&Z&&(Z+=4-(3&Z)),U.writeUint(F,j[0],Z))}return F.slice(0,Z).buffer},w.decode=function(P,F){F==null&&(F={parseMN:!0,debug:!1});var D=new Uint8Array(P),U=0,Z=w._binBE.readASCII(D,U,2);U+=2;var $=Z=="II"?w._binLE:w._binBE;$.readUshort(D,U),U+=2;var j=$.readUint(D,U);U+=4;for(var H=[];;){var W=$.readUshort(D,j),V=$.readUshort(D,j+4);if(W!=0&&(V<1||13<V)){g("error in TIFF");break}if(w._readIFD($,D,j,H,0,F),(j=$.readUint(D,j+2+12*W))==0)break}return H},w.decodeImage=function(P,F,D){if(!F.data){var U=new Uint8Array(P),Z=w._binBE.readASCII(U,0,2);if(F.t256!=null){F.isLE=Z=="II",F.width=F.t256[0],F.height=F.t257[0];var $=F.t259?F.t259[0]:1,j=F.t266?F.t266[0]:1;F.t284&&F.t284[0]==2&&g("PlanarConfiguration 2 should not be used!"),$==7&&F.t258&&F.t258.length>3&&(F.t258=F.t258.slice(0,3));var H=F.t277?F.t277[0]:1,W=(F.t258?F.t258[0]:1)*H;$==1&&F.t279!=null&&F.t278&&F.t262[0]==32803&&(W=Math.round(8*F.t279[0]/(F.width*F.t278[0]))),F.t50885&&F.t50885[0]==4&&(W=3*F.t258[0]);var V=8*Math.ceil(F.width*W/8),Q=F.t273;(Q==null||F.t322)&&(Q=F.t324);var K=F.t279;$==1&&Q.length==1&&(K=[F.height*(V>>>3)]),(K==null||F.t322)&&(K=F.t325);var q=new Uint8Array(F.height*(V>>>3)),et=0;if(F.t322!=null){var X=F.t322[0],tt=F.t323[0],rt=Math.floor((F.width+X-1)/X),ot=Math.floor((F.height+tt-1)/tt),J=new Uint8Array(0|Math.ceil(X*tt*W/8));console.log("====",rt,ot);for(var lt=0;lt<ot;lt++)for(var st=0;st<rt;st++){var ut=lt*rt+st;J.fill(0),w.decode._decompress(F,D,U,Q[ut],K[ut],$,J,0,j,X,tt),$==6?q=J:w._copyTile(J,0|Math.ceil(X*W/8),tt,q,0|Math.ceil(F.width*W/8),F.height,0|Math.ceil(st*X*W/8),lt*tt)}et=8*q.length}else{if(Q==null)return;var it=F.t278?F.t278[0]:F.height;for(it=Math.min(it,F.height),ut=0;ut<Q.length;ut++)w.decode._decompress(F,D,U,Q[ut],K[ut],$,q,0|Math.ceil(et/8),j,F.width,it),et+=V*it;et=Math.min(et,8*q.length)}F.data=new Uint8Array(q.buffer,0,0|Math.ceil(et/8))}}},w.decode._decompress=function(P,F,D,U,Z,$,j,H,W,V,Q){if(P.t271&&P.t271[0]=="Panasonic"&&P.t45&&P.t45[0]==6&&($=34316),$==1)for(var K=0;K<Z;K++)j[H+K]=D[U+K];else if($==2)w.decode._decodeG2(D,U,Z,j,H,V,W);else if($==3)w.decode._decodeG3(D,U,Z,j,H,V,W,!!P.t292&&!(1&~P.t292[0]));else if($==4)w.decode._decodeG4(D,U,Z,j,H,V,W);else if($==5)w.decode._decodeLZW(D,U,Z,j,H,8);else if($==6)w.decode._decodeOldJPEG(P,D,U,Z,j,H);else if($==7||$==34892)w.decode._decodeNewJPEG(P,D,U,Z,j,H);else if($==8||$==32946){var q=new Uint8Array(D.buffer,U+2,Z-6),et=I.inflateRaw(q);H+et.length<=j.length&&j.set(et,H)}else $==9?w.decode._decodeVC5(D,U,Z,j,H,P.t33422):$==32767?w.decode._decodeARW(P,D,U,Z,j,H):$==32773?w.decode._decodePackBits(D,U,Z,j,H):$==32809?w.decode._decodeThunder(D,U,Z,j,H):$==34316?w.decode._decodePanasonic(P,D,U,Z,j,H):$==34713?w.decode._decodeNikon(P,F,D,U,Z,j,H):$==34676?w.decode._decodeLogLuv32(P,D,U,Z,j,H):g("Unknown compression",$);var X=P.t258?Math.min(32,P.t258[0]):1,tt=P.t277?P.t277[0]:1,rt=X*tt>>>3,ot=Math.ceil(X*tt*V/8);if(X==16&&!P.isLE&&P.t33422==null)for(var J=0;J<Q;J++)for(var lt=H+J*ot,st=1;st<ot;st+=2){var ut=j[lt+st];j[lt+st]=j[lt+st-1],j[lt+st-1]=ut}if(P.t317&&P.t317[0]==2)for(J=0;J<Q;J++){var it=H+J*ot;if(X==16)for(K=rt;K<ot;K+=2){var ct=(j[it+K+1]<<8|j[it+K])+(j[it+K-rt+1]<<8|j[it+K-rt]);j[it+K]=255&ct,j[it+K+1]=ct>>>8&255}else if(tt==3)for(K=3;K<ot;K+=3)j[it+K]=j[it+K]+j[it+K-3]&255,j[it+K+1]=j[it+K+1]+j[it+K-2]&255,j[it+K+2]=j[it+K+2]+j[it+K-1]&255;else for(K=rt;K<ot;K++)j[it+K]=j[it+K]+j[it+K-rt]&255}},w.decode._decodePanasonic=function(P,F,D,U,Z,$){var j,H,W,V,Q,K,q,et,X=F.buffer,tt=P.t2[0],rt=P.t3[0],ot=P.t10[0],J=P.t45[0],lt=0,st=0,ut=0,it=0,ct=J==6?new Uint32Array(18):new Uint8Array(16),At=[0,0],Et=[0,0],gt=0,pt=new Uint8Array(16384),vt=new Uint16Array(Z.buffer);function Tt(Gt){if(ut==0){var nt=new Uint8Array(X,D+st+8184,8200),ht=new Uint8Array(X,D+st,8184);pt.set(nt),pt.set(ht,nt.length),st+=16384}if(J!=5)return(pt[it=(ut=ut-Gt&131071)>>3^16368]|pt[it+1]<<8)>>(7&ut)&~(-1<<Gt);for(j=0;j<16;j++)ct[j]=pt[ut++],ut&=16383}function It(Gt){return pt[ut+15-Gt]}function $t(){At[0]=0,At[1]=0,Et[0]=0,Et[1]=0}if(J==7)throw J;if(J==6){var Bt=ot==12,zt=Bt?function(){ct[0]=It(0)<<4|It(1)>>4,ct[1]=4095&((15&It(1))<<8|It(2)),ct[2]=It(3)>>6&3,ct[3]=(63&It(3))<<2|It(4)>>6,ct[4]=(63&It(4))<<2|It(5)>>6,ct[5]=(63&It(5))<<2|It(6)>>6,ct[6]=It(6)>>4&3,ct[7]=(15&It(6))<<4|It(7)>>4,ct[8]=(15&It(7))<<4|It(8)>>4,ct[9]=(15&It(8))<<4|It(9)>>4,ct[10]=It(9)>>2&3,ct[11]=(3&It(9))<<6|It(10)>>2,ct[12]=(3&It(10))<<6|It(11)>>2,ct[13]=(3&It(11))<<6|It(12)>>2,ct[14]=3&It(12),ct[15]=It(13),ct[16]=It(14),ct[17]=It(15),ut+=16,it=0}:function(){ct[0]=It(0)<<6|It(1)>>2,ct[1]=16383&((3&It(1))<<12|It(2)<<4|It(3)>>4),ct[2]=It(3)>>2&3,ct[3]=(3&It(3))<<8|It(4),ct[4]=It(5)<<2|It(6)>>6,ct[5]=(63&It(6))<<4|It(7)>>4,ct[6]=It(7)>>2&3,ct[7]=(3&It(7))<<8|It(8),ct[8]=It(9)<<2&1020|It(10)>>6,ct[9]=1023&(It(10)<<4|It(11)>>4),ct[10]=It(11)>>2&3,ct[11]=(3&It(11))<<8|It(12),ct[12]=1023&(It(13)<<2&1020|It(14)>>6),ct[13]=1023&(It(14)<<4|It(15)>>4),ut+=16,it=0},Ot=Bt?14:11,Nt=Bt?128:512,Pt=Bt?2048:8192,Ut=Bt?16383:65535,Ft=Bt?4095:16383,Zt=tt/Ot,Ht=16*Zt,Dt=Bt?18:14;for(K=0;K<rt-15;K+=16){var dt=Math.min(16,rt-K),Lt=Ht*dt;for(pt=new Uint8Array(X,D+lt,Lt),ut=0,lt+=Lt,et=0,q=0;et<dt;et++,q=0){gt=(K+et)*tt;for(var bt=0;bt<Zt;bt++)for(zt(),$t(),W=0,Q=0,j=0;j<Ot;j++){if(V=1&j,j%3==2){var wt=it<Dt?ct[it++]:0;wt==3&&(wt=4),Q=Nt<<wt,W=1<<wt}var xt=it<Dt?ct[it++]:0;At[V]?(xt*=W,Q<Pt&&Et[V]>Q&&(xt+=Et[V]-Q),Et[V]=xt):(At[V]=xt,xt?Et[V]=xt:xt=Et[V]),vt[gt+q++]=xt-15<=Ut?xt-15&Ut:xt+2147483633>>31&Ft}}}}else if(J==5){var Rt=ot==12?10:9;for(K=0;K<rt;K++)for(q=0;q<tt;q+=Rt)Tt(0),ot==12?(vt[gt++]=((15&ct[1])<<8)+ct[0],vt[gt++]=16*ct[2]+(ct[1]>>4),vt[gt++]=((15&ct[4])<<8)+ct[3],vt[gt++]=16*ct[5]+(ct[4]>>4),vt[gt++]=((15&ct[7])<<8)+ct[6],vt[gt++]=16*ct[8]+(ct[7]>>4),vt[gt++]=((15&ct[10])<<8)+ct[9],vt[gt++]=16*ct[11]+(ct[10]>>4),vt[gt++]=((15&ct[13])<<8)+ct[12],vt[gt++]=16*ct[14]+(ct[13]>>4)):ot==14&&(vt[gt++]=ct[0]+((63&ct[1])<<8),vt[gt++]=(ct[1]>>6)+4*ct[2]+((15&ct[3])<<10),vt[gt++]=(ct[3]>>4)+16*ct[4]+((3&ct[5])<<12),vt[gt++]=((252&ct[5])>>2)+(ct[6]<<6),vt[gt++]=ct[7]+((63&ct[8])<<8),vt[gt++]=(ct[8]>>6)+4*ct[9]+((15&ct[10])<<10),vt[gt++]=(ct[10]>>4)+16*ct[11]+((3&ct[12])<<12),vt[gt++]=((252&ct[12])>>2)+(ct[13]<<6),vt[gt++]=ct[14]+((63&ct[15])<<8))}else{if(J!=4)throw J;for(K=0;K<rt;K++)for(q=0;q<tt;q++)V=1&(j=q%14),j==0&&$t(),j%3==2&&(W=4>>3-Tt(2)),Et[V]?(H=Tt(8))!=0&&(At[V]-=128<<W,(At[V]<0||W==4)&&(At[V]&=~(-1<<W)),At[V]+=H<<W):(Et[V]=Tt(8),(Et[V]||j>11)&&(At[V]=Et[V]<<4|Tt(4))),vt[gt++]=At[1&q]}},w.decode._decodeVC5=function(){var P,F,D,U=[1,0,1,0,2,2,1,1,3,7,1,2,5,25,1,3,6,48,1,4,6,54,1,5,7,111,1,8,7,99,1,6,7,105,12,0,7,107,1,7,8,209,20,0,8,212,1,9,8,220,1,10,9,393,1,11,9,394,32,0,9,416,1,12,9,427,1,13,10,887,1,18,10,784,1,14,10,790,1,15,10,835,60,0,10,852,1,16,10,885,1,17,11,1571,1,19,11,1668,1,20,11,1669,100,0,11,1707,1,21,11,1772,1,22,12,3547,1,29,12,3164,1,24,12,3166,1,25,12,3140,1,23,12,3413,1,26,12,3537,1,27,12,3539,1,28,13,7093,1,35,13,6283,1,30,13,6331,1,31,13,6335,180,0,13,6824,1,32,13,7072,1,33,13,7077,320,0,13,7076,1,34,14,12565,1,36,14,12661,1,37,14,12669,1,38,14,13651,1,39,14,14184,1,40,15,28295,1,46,15,28371,1,47,15,25320,1,42,15,25336,1,43,15,25128,1,41,15,27300,1,44,15,28293,1,45,16,50259,1,48,16,50643,1,49,16,50675,1,50,16,56740,1,53,16,56584,1,51,16,56588,1,52,17,113483,1,61,17,113482,1,60,17,101285,1,55,17,101349,1,56,17,109205,1,57,17,109207,1,58,17,100516,1,54,17,113171,1,59,18,202568,1,62,18,202696,1,63,18,218408,1,64,18,218412,1,65,18,226340,1,66,18,226356,1,67,18,226358,1,68,19,402068,1,69,19,405138,1,70,19,405394,1,71,19,436818,1,72,19,436826,1,73,19,452714,1,75,19,452718,1,76,19,452682,1,74,20,804138,1,77,20,810279,1,78,20,810790,1,79,20,873638,1,80,20,873654,1,81,20,905366,1,82,20,905430,1,83,20,905438,1,84,21,1608278,1,85,21,1620557,1,86,21,1621582,1,87,21,1621583,1,88,21,1747310,1,89,21,1810734,1,90,21,1810735,1,91,21,1810863,1,92,21,1810879,1,93,22,3621725,1,99,22,3621757,1,100,22,3241112,1,94,22,3494556,1,95,22,3494557,1,96,22,3494622,1,97,22,3494623,1,98,23,6482227,1,102,23,6433117,1,101,23,6989117,1,103,23,6989119,1,105,23,6989118,1,104,23,7243449,1,106,23,7243512,1,107,24,13978233,1,111,24,12964453,1,109,24,12866232,1,108,24,14486897,1,113,24,13978232,1,110,24,14486896,1,112,24,14487026,1,114,24,14487027,1,115,25,25732598,1,225,25,25732597,1,189,25,25732596,1,188,25,25732595,1,203,25,25732594,1,202,25,25732593,1,197,25,25732592,1,207,25,25732591,1,169,25,25732590,1,223,25,25732589,1,159,25,25732522,1,235,25,25732579,1,152,25,25732575,1,192,25,25732489,1,179,25,25732573,1,201,25,25732472,1,172,25,25732576,1,149,25,25732488,1,178,25,25732566,1,120,25,25732571,1,219,25,25732577,1,150,25,25732487,1,127,25,25732506,1,211,25,25732548,1,125,25,25732588,1,158,25,25732486,1,247,25,25732467,1,238,25,25732508,1,163,25,25732552,1,228,25,25732603,1,183,25,25732513,1,217,25,25732587,1,168,25,25732520,1,122,25,25732484,1,128,25,25732562,1,249,25,25732505,1,187,25,25732504,1,186,25,25732483,1,136,25,25928905,1,181,25,25732560,1,255,25,25732500,1,230,25,25732482,1,135,25,25732555,1,233,25,25732568,1,222,25,25732583,1,145,25,25732481,1,134,25,25732586,1,167,25,25732521,1,248,25,25732518,1,209,25,25732480,1,243,25,25732512,1,216,25,25732509,1,164,25,25732547,1,140,25,25732479,1,157,25,25732544,1,239,25,25732574,1,191,25,25732564,1,251,25,25732478,1,156,25,25732546,1,139,25,25732498,1,242,25,25732557,1,133,25,25732477,1,162,25,25732515,1,213,25,25732584,1,165,25,25732514,1,212,25,25732476,1,227,25,25732494,1,198,25,25732531,1,236,25,25732530,1,234,25,25732529,1,117,25,25732528,1,215,25,25732527,1,124,25,25732526,1,123,25,25732525,1,254,25,25732524,1,253,25,25732523,1,148,25,25732570,1,218,25,25732580,1,146,25,25732581,1,147,25,25732569,1,224,25,25732533,1,143,25,25732540,1,184,25,25732541,1,185,25,25732585,1,166,25,25732556,1,132,25,25732485,1,129,25,25732563,1,250,25,25732578,1,151,25,25732501,1,119,25,25732502,1,193,25,25732536,1,176,25,25732496,1,245,25,25732553,1,229,25,25732516,1,206,25,25732582,1,144,25,25732517,1,208,25,25732558,1,137,25,25732543,1,241,25,25732466,1,237,25,25732507,1,190,25,25732542,1,240,25,25732551,1,131,25,25732554,1,232,25,25732565,1,252,25,25732475,1,171,25,25732493,1,205,25,25732492,1,204,25,25732491,1,118,25,25732490,1,214,25,25928904,1,180,25,25732549,1,126,25,25732602,1,182,25,25732539,1,175,25,25732545,1,141,25,25732559,1,138,25,25732537,1,177,25,25732534,1,153,25,25732503,1,194,25,25732606,1,160,25,25732567,1,121,25,25732538,1,174,25,25732497,1,246,25,25732550,1,130,25,25732572,1,200,25,25732474,1,170,25,25732511,1,221,25,25732601,1,196,25,25732532,1,142,25,25732519,1,210,25,25732495,1,199,25,25732605,1,155,25,25732535,1,154,25,25732499,1,244,25,25732510,1,220,25,25732600,1,195,25,25732607,1,161,25,25732604,1,231,25,25732473,1,173,25,25732599,1,226,26,51465122,1,116,26,51465123,0,1],Z=[3,3,3,3,2,2,2,1,1,1];function $(et){var X=et[1],tt=et[0][X>>>3]>>>7-(7&X)&1;return et[1]++,tt}function j(et,X){if(P==null){P={};for(var tt=0;tt<U.length;tt+=4)P[U[tt+1]]=U.slice(tt,tt+4)}for(var rt=$(et),ot=P[rt];ot==null;)rt=rt<<1|$(et),ot=P[rt];var J=ot[3];J!=0&&(J=$(et)==0?J:-J),X[0]=ot[2],X[1]=J}function H(et,X){for(var tt=0;tt<X;tt++)1&~et||et++,et>>>=1;return et}function W(et,X){return et>>X}function V(et,X,tt,rt,ot,J){X[tt]=W(W(11*et[ot]-4*et[ot+J]+et[ot+J+J]+4,3)+et[rt],1),X[tt+J]=W(W(5*et[ot]+4*et[ot+J]-et[ot+J+J]+4,3)-et[rt],1)}function Q(et,X,tt,rt,ot,J){var lt=et[ot-J]-et[ot+J],st=et[ot],ut=et[rt];X[tt]=W(W(lt+4,3)+st+ut,1),X[tt+J]=W(W(4-lt,3)+st-ut,1)}function K(et,X,tt,rt,ot,J){X[tt]=W(W(5*et[ot]+4*et[ot-J]-et[ot-J-J]+4,3)+et[rt],1),X[tt+J]=W(W(11*et[ot]-4*et[ot-J]+et[ot-J-J]+4,3)-et[rt],1)}function q(et){return et=D[et=et<0?0:et>4095?4095:et]>>>2}return function(et,X,tt,rt,ot,J){rt=new Uint16Array(rt.buffer);var lt,st,ut,it,ct,At,Et,gt,pt=Date.now(),vt=w._binBE,Tt=X+tt;X+=4;for(var It=J[0]==1;X<Tt;){var $t=vt.readShort(et,X),Bt=vt.readUshort(et,X+2);if(X+=4,$t==12)Zt=Bt;else if($t==20)lt=Bt;else if($t==21)st=Bt;else if($t==48)ut=Bt;else if($t==53)it=Bt;else if($t!=35){if($t==62)ct=Bt;else if($t!=101){if($t==109)At=Bt;else if($t!=84){if($t!=106){if($t!=107){if($t!=108){if($t!=102){if($t==104)ae=Bt;else if($t!=105){var zt=$t<0?-$t:$t,Ot=65280&zt,Nt=0;if(24576&zt&&(8192&zt?(Nt=65535&Bt,Nt+=(255&zt)<<16):Nt=65535&Bt),24576&~zt){if(zt==16388)X+=4*Nt;else if(Ot!=8192&&Ot!=8448&&Ot!=9216)throw zt.toString(16)}else{if(Et==null){Et=[];for(var Pt=0;Pt<4;Pt++)Et[Pt]=new Int16Array((lt>>>1)*(st>>>1));for(gt=new Int16Array((lt>>>1)*(st>>>1)),F=new Int16Array(1024),Pt=0;Pt<1024;Pt++){var Ut=Pt-512,Ft=Math.abs(Ut),Zt=Math.floor(768*Ft*Ft*Ft/16581375)+Ft;F[Pt]=Math.sign(Ut)*Zt}for(D=new Uint16Array(4096),Pt=0;Pt<4096;Pt++){var Ht=Pt,Dt=65535*(Math.pow(113,Ht/4095)-1)/112;D[Pt]=Math.min(Dt,65535)}}var dt=Et[ct],Lt=H(lt,1+Z[ut]),bt=H(st,1+Z[ut]);if(ut==0)for(var wt=0;wt<bt;wt++)for(var xt=0;xt<Lt;xt++){var Rt=X+2*(wt*Lt+xt);dt[wt*(lt>>>1)+xt]=et[Rt]<<8|et[Rt+1]}else{var Gt=[et,8*X],nt=[],ht=0,ft=Lt*bt,at=[0,0],_t=0;for(Bt=0;ht<ft;)for(j(Gt,at),_t=at[0],Bt=at[1];_t>0;)nt[ht++]=Bt,_t--;var St=(ut-1)%3,Vt=St!=1?Lt:0,ee=St!=0?bt:0;for(wt=0;wt<bt;wt++){var Jt=(wt+ee)*(lt>>>1)+Vt,se=wt*Lt;for(xt=0;xt<Lt;xt++)dt[Jt+xt]=F[nt[se+xt]+512]*it}if(St==2){var ae=lt>>>1,fe=2*Lt,le=2*bt;for(wt=0;wt<bt;wt++)for(xt=0;xt<fe;xt++){Pt=2*wt*ae+xt;var ue=bt*ae+(he=wt*ae+xt);wt==0?V(dt,gt,Pt,ue,he,ae):wt==bt-1?K(dt,gt,Pt,ue,he,ae):Q(dt,gt,Pt,ue,he,ae)}var me=dt;for(dt=gt,gt=me,wt=0;wt<le;wt++)for(xt=0;xt<Lt;xt++){var he;Pt=wt*ae+2*xt,ue=Lt+(he=wt*ae+xt),xt==0?V(dt,gt,Pt,ue,he,1):xt==Lt-1?K(dt,gt,Pt,ue,he,1):Q(dt,gt,Pt,ue,he,1)}me=dt,dt=gt,gt=me;for(var Wt=[],oe=2-~~((ut-1)/3),kt=0;kt<3;kt++)Wt[kt]=At>>14-2*kt&3;var Xt=Wt[oe];if(Xt!=0)for(wt=0;wt<le;wt++)for(xt=0;xt<fe;xt++)dt[Pt=wt*ae+xt]=dt[Pt]<<Xt}}if(ut==9&&ct==3){var Ct=Et[0],re=Et[1],te=Et[2],yt=Et[3];for(wt=0;wt<st;wt+=2)for(xt=0;xt<lt;xt+=2){var Mt=wt*lt+xt,Yt=Ct[Rt=(wt>>>1)*(lt>>>1)+(xt>>>1)],Qt=re[Rt]-2048,mt=te[Rt]-2048,qt=yt[Rt]-2048,ie=(Qt<<1)+Yt,jt=(mt<<1)+Yt,Kt=Yt+qt,ne=Yt-qt;It?(rt[Mt]=q(Kt),rt[Mt+1]=q(jt),rt[Mt+lt]=q(ie),rt[Mt+lt+1]=q(ne)):(rt[Mt]=q(ie),rt[Mt+1]=q(Kt),rt[Mt+lt]=q(ne),rt[Mt+lt+1]=q(jt))}}X+=4*Nt}}}}}}}}}}console.log(Date.now()-pt)}}(),w.decode._decodeLogLuv32=function(P,F,D,U,Z,$){for(var j=P.width,H=4*j,W=0,V=new Uint8Array(H);W<U;){for(var Q=0;Q<H;){var K=F[D+W];if(W++,K<128){for(var q=0;q<K;q++)V[Q+q]=F[D+W+q];Q+=K,W+=K}else{for(K-=126,q=0;q<K;q++)V[Q+q]=F[D+W];Q+=K,W++}}for(var et=0;et<j;et++)Z[$+0]=V[et],Z[$+1]=V[et+j],Z[$+2]=V[et+2*j],Z[$+4]=V[et+3*j],$+=6}},w.decode._ljpeg_diff=function(P,F,D){var U,Z,$=w.decode._getbithuff;return U=$(P,F,D[0],D),(Z=$(P,F,U,0))&1<<U-1||(Z-=(1<<U)-1),Z},w.decode._decodeARW=function(P,F,D,U,Z,$){var j=P.t256[0],H=P.t257[0],W=P.t258[0],V=P.isLE?w._binLE:w._binBE;if(j*H==U||j*H*1.5==U)if(j*H*1.5!=U){var Q,K,q,et,X,tt,rt,ot,J=new Uint16Array(16),lt=new Uint8Array(j+1);for(pt=0;pt<H;pt++){for(var st=0;st<j;st++)lt[st]=F[D++];for(ot=0,gt=0;gt<j-30;ot+=16){for(K=2047&(Q=V.readUint(lt,ot)),q=2047&Q>>>11,et=15&Q>>>22,X=15&Q>>>26,tt=0;tt<4&&128<<tt<=K-q;tt++);for(rt=30,ut=0;ut<16;ut++)ut==et?J[ut]=K:ut==X?J[ut]=q:(J[ut]=((V.readUshort(lt,ot+(rt>>3))>>>(7&rt)&127)<<tt)+q,J[ut]>2047&&(J[ut]=2047),rt+=7);for(ut=0;ut<16;ut++,gt+=2)Nt=J[ut]<<1,w.decode._putsF(Z,(pt*j+gt)*W,Nt<<16-W);gt-=1&gt?1:31}}}else for(var ut=0;ut<U;ut+=3){var it=F[D+ut+0],ct=F[D+ut+1],At=F[D+ut+2];Z[$+ut]=ct<<4|it>>>4,Z[$+ut+1]=it<<4|At>>>4,Z[$+ut+2]=At<<4|ct>>>4}else{H+=8;var Et,gt,pt,vt=[D,0,0,0],Tt=new Uint16Array(32770),It=[3857,3856,3599,3342,3085,2828,2571,2314,2057,1800,1543,1286,1029,772,771,768,514,513],$t=0,Bt=w.decode._ljpeg_diff;for(Tt[0]=15,Et=ut=0;ut<18;ut++)for(var zt=32768>>>(It[ut]>>>8),Ot=0;Ot<zt;Ot++)Tt[++Et]=It[ut];for(gt=j;gt--;)for(pt=0;pt<H+1;pt+=2)if(pt==H&&(pt=1),$t+=Bt(F,vt,Tt),pt<H){var Nt=4095&$t;w.decode._putsF(Z,(pt*j+gt)*W,Nt<<16-W)}}},w.decode._decodeNikon=function(P,F,D,U,Z,$,j){var H=[[0,0,1,5,1,1,1,1,1,1,2,0,0,0,0,0,0,5,4,3,6,2,7,1,0,8,9,11,10,12],[0,0,1,5,1,1,1,1,1,1,2,0,0,0,0,0,0,57,90,56,39,22,5,4,3,2,1,0,11,12,12],[0,0,1,4,2,3,1,2,0,0,0,0,0,0,0,0,0,5,4,6,3,7,2,8,1,9,0,10,11,12],[0,0,1,4,3,1,1,1,1,1,2,0,0,0,0,0,0,5,6,4,7,8,3,9,2,1,0,10,11,12,13,14],[0,0,1,5,1,1,1,1,1,1,1,2,0,0,0,0,0,8,92,75,58,41,7,6,5,4,3,2,1,0,13,14],[0,0,1,4,2,2,3,1,2,0,0,0,0,0,0,0,0,7,6,8,5,9,4,10,3,11,12,2,0,1,13,14]],W=P.t256[0],V=P.t257[0],Q=P.t258[0],K=0,q=0,et=w.decode._make_decoder,X=w.decode._getbithuff,tt=F[0].exifIFD.makerNote,rt=tt.t150?tt.t150:tt.t140,ot=0,J=rt[ot++],lt=rt[ot++];J!=73&&lt!=88||(ot+=2110),J==70&&(K=2),Q==14&&(K+=3);for(var st=[[0,0],[0,0]],ut=P.isLE?w._binLE:w._binBE,it=0;it<2;it++)for(var ct=0;ct<2;ct++)st[it][ct]=ut.readShort(rt,ot),ot+=2;var At,Et,gt,pt,vt,Tt=1<<Q&32767,It=0,$t=ut.readShort(rt,ot);ot+=2,$t>1&&(It=Math.floor(Tt/($t-1))),J==68&&lt==32&&It>0&&(q=ut.readShort(rt,562));var Bt=[0,0],zt=et(H[K]),Ot=[U,0,0,0];for(At=0;At<V;At++)for(q&&At==q&&(zt=et(H[K+1])),Et=0;Et<W;Et++){it=X(D,Ot,zt[0],zt),(vt=1+(X(D,Ot,(gt=15&it)-(pt=it>>>4),0)<<1)<<pt>>>1)&1<<gt-1||(vt-=(1<<gt)-(pt==0?1:0)),Et<2?Bt[Et]=st[1&At][Et]+=vt:Bt[1&Et]+=vt;var Nt=Math.min(Math.max(Bt[1&Et],0),(1<<Q)-1),Pt=(At*W+Et)*Q;w.decode._putsF($,Pt,Nt<<16-Q)}},w.decode._putsF=function(P,F,D){D<<=8-(7&F);var U=F>>>3;P[U]|=D>>>16,P[U+1]|=D>>>8,P[U+2]|=D},w.decode._getbithuff=function(P,F,D,U){var Z;w.decode._get_byte;var $=F[0],j=F[1],H=F[2],W=F[3];if(D==0||H<0)return 0;for(;!W&&H<D&&(Z=P[$++])!=-1&&!(W=0);)j=(j<<8)+Z,H+=8;if(Z=j<<32-H>>>32-D,U?(H-=U[Z+1]>>>8,Z=255&U[Z+1]):H-=D,H<0)throw"e";return F[0]=$,F[1]=j,F[2]=H,F[3]=W,Z},w.decode._make_decoder=function(P){var F,D,U,Z,$,j=[];for(F=16;F!=0&&!P[F];F--);var H=17;for(j[0]=F,U=D=1;D<=F;D++)for(Z=0;Z<P[D];Z++,++H)for($=0;$<1<<F-D;$++)U<=1<<F&&(j[U++]=D<<8|P[H]);return j},w.decode._decodeNewJPEG=function(P,F,D,U,Z,$){U=Math.min(U,F.length-D);var j=P.t347,H=j?j.length:0,W=new Uint8Array(H+U);if(j){for(var V=0,Q=0;Q<H-1&&(j[Q]!=255||j[Q+1]!=217);Q++)W[V++]=j[Q];var K=F[D],q=F[D+1];for(K==255&&q==216||(W[V++]=K,W[V++]=q),Q=2;Q<U;Q++)W[V++]=F[D+Q]}else for(Q=0;Q<U;Q++)W[Q]=F[D+Q];if(P.t262[0]==32803||P.t259[0]==7&&P.t262[0]==34892){var et=P.t258[0],X=w.LosslessJpegDecode(W),tt=X.length;if(et==16)if(P.isLE)for(Q=0;Q<tt;Q++)Z[$+(Q<<1)]=255&X[Q],Z[$+(Q<<1)+1]=X[Q]>>>8;else for(Q=0;Q<tt;Q++)Z[$+(Q<<1)]=X[Q]>>>8,Z[$+(Q<<1)+1]=255&X[Q];else if(et==14||et==12||et==10){var rt=16-et;for(Q=0;Q<tt;Q++)w.decode._putsF(Z,Q*et,X[Q]<<rt)}else{if(et!=8)throw new Error("unsupported bit depth "+et);for(Q=0;Q<tt;Q++)Z[$+Q]=X[Q]}}else{var ot=new w.JpegDecoder;ot.parse(W);var J=ot.getData({width:ot.width,height:ot.height,forceRGB:!0,isSourcePDF:!1});for(Q=0;Q<J.length;Q++)Z[$+Q]=J[Q]}P.t262[0]==6&&(P.t262[0]=2)},w.decode._decodeOldJPEGInit=function(P,F,D,U){var Z,$,j,H,W,V=216,Q=0,K=0,q=!1,et=P.t513,X=et?et[0]:0,tt=P.t514,rt=tt?tt[0]:0,ot=P.t324||P.t273||et,J=P.t530,lt=0,st=0,ut=P.t277?P.t277[0]:1,it=P.t515;if(ot&&(K=ot[0],q=ot.length>1),!q){if(F[D]==255&&F[D+1]==V)return{jpegOffset:D};if(et!=null&&(F[D+X]==255&&F[D+X+1]==V?Q=D+X:g("JPEGInterchangeFormat does not point to SOI"),tt==null?g("JPEGInterchangeFormatLength field is missing"):(X>=K||X+rt<=K)&&g("JPEGInterchangeFormatLength field value is invalid"),Q!=null))return{jpegOffset:Q}}if(J!=null&&(lt=J[0],st=J[1]),et!=null&&tt!=null)if(rt>=2&&X+rt<=K){for(Z=F[D+X+rt-2]==255&&F[D+X+rt-1]==V?new Uint8Array(rt-2):new Uint8Array(rt),j=0;j<Z.length;j++)Z[j]=F[D+X+j];g("Incorrect JPEG interchange format: using JPEGInterchangeFormat offset to derive tables")}else g("JPEGInterchangeFormat+JPEGInterchangeFormatLength > offset to first strip or tile");if(Z==null){var ct=0,At=[];At[ct++]=255,At[ct++]=V;var Et=P.t519;if(Et==null)throw new Error("JPEGQTables tag is missing");for(j=0;j<Et.length;j++)for(At[ct++]=255,At[ct++]=219,At[ct++]=0,At[ct++]=67,At[ct++]=j,H=0;H<64;H++)At[ct++]=F[D+Et[j]+H];for(W=0;W<2;W++){var gt=P[W==0?"t520":"t521"];if(gt==null)throw new Error((W==0?"JPEGDCTables":"JPEGACTables")+" tag is missing");for(j=0;j<gt.length;j++){At[ct++]=255,At[ct++]=196;var pt=19;for(H=0;H<16;H++)pt+=F[D+gt[j]+H];for(At[ct++]=pt>>>8,At[ct++]=255&pt,At[ct++]=j|W<<4,H=0;H<16;H++)At[ct++]=F[D+gt[j]+H];for(H=0;H<pt;H++)At[ct++]=F[D+gt[j]+16+H]}}if(At[ct++]=255,At[ct++]=192,At[ct++]=0,At[ct++]=8+3*ut,At[ct++]=8,At[ct++]=P.height>>>8&255,At[ct++]=255&P.height,At[ct++]=P.width>>>8&255,At[ct++]=255&P.width,At[ct++]=ut,ut==1)At[ct++]=1,At[ct++]=17,At[ct++]=0;else for(j=0;j<3;j++)At[ct++]=j+1,At[ct++]=j!=0?17:(15&lt)<<4|15&st,At[ct++]=j;it!=null&&it[0]!=0&&(At[ct++]=255,At[ct++]=221,At[ct++]=0,At[ct++]=4,At[ct++]=it[0]>>>8&255,At[ct++]=255&it[0]),Z=new Uint8Array(At)}var vt=-1;for(j=0;j<Z.length-1;){if(Z[j]==255&&Z[j+1]==192){vt=j;break}j++}if(vt==-1){var Tt=new Uint8Array(Z.length+10+3*ut);Tt.set(Z);var It=Z.length;if(vt=Z.length,(Z=Tt)[It++]=255,Z[It++]=192,Z[It++]=0,Z[It++]=8+3*ut,Z[It++]=8,Z[It++]=P.height>>>8&255,Z[It++]=255&P.height,Z[It++]=P.width>>>8&255,Z[It++]=255&P.width,Z[It++]=ut,ut==1)Z[It++]=1,Z[It++]=17,Z[It++]=0;else for(j=0;j<3;j++)Z[It++]=j+1,Z[It++]=j!=0?17:(15&lt)<<4|15&st,Z[It++]=j}if(F[K]==255&&F[K+1]==218){var $t=F[K+2]<<8|F[K+3];for(($=new Uint8Array($t+2))[0]=F[K],$[1]=F[K+1],$[2]=F[K+2],$[3]=F[K+3],j=0;j<$t-2;j++)$[j+4]=F[K+j+4]}else{var Bt=0;if(($=new Uint8Array(8+2*ut))[Bt++]=255,$[Bt++]=218,$[Bt++]=0,$[Bt++]=6+2*ut,$[Bt++]=ut,ut==1)$[Bt++]=1,$[Bt++]=0;else for(j=0;j<3;j++)$[Bt++]=j+1,$[Bt++]=j<<4|j;$[Bt++]=0,$[Bt++]=63,$[Bt++]=0}return{jpegOffset:D,tables:Z,sosMarker:$,sofPosition:vt}},w.decode._decodeOldJPEG=function(P,F,D,U,Z,$){var j,H,W,V,Q=w.decode._decodeOldJPEGInit(P,F,D,U);if(Q.jpegOffset!=null)for(j=D+U-Q.jpegOffset,W=new Uint8Array(j),et=0;et<j;et++)W[et]=F[Q.jpegOffset+et];else{for(H=Q.tables.length,(W=new Uint8Array(H+Q.sosMarker.length+U+2)).set(Q.tables),V=H,W[Q.sofPosition+5]=P.height>>>8&255,W[Q.sofPosition+6]=255&P.height,W[Q.sofPosition+7]=P.width>>>8&255,W[Q.sofPosition+8]=255&P.width,F[D]==255&&F[D+1]==SOS||(W.set(Q.sosMarker,V),V+=sosMarker.length),et=0;et<U;et++)W[V++]=F[D+et];W[V++]=255,W[V++]=EOI}var K=new w.JpegDecoder;K.parse(W);for(var q=K.getData({width:K.width,height:K.height,forceRGB:!0,isSourcePDF:!1}),et=0;et<q.length;et++)Z[$+et]=q[et];P.t262&&P.t262[0]==6&&(P.t262[0]=2)},w.decode._decodePackBits=function(P,F,D,U,Z){for(var $=new Int8Array(P.buffer),j=new Int8Array(U.buffer),H=F+D;F<H;){var W=$[F];if(F++,W>=0&&W<128)for(var V=0;V<W+1;V++)j[Z]=$[F],Z++,F++;if(W>=-127&&W<0){for(V=0;V<1-W;V++)j[Z]=$[F],Z++;F++}}return Z},w.decode._decodeThunder=function(P,F,D,U,Z){for(var $=[0,1,0,-1],j=[0,1,2,3,0,-3,-2,-1],H=F+D,W=2*Z,V=0;F<H;){var Q=P[F],K=Q>>>6,q=63&Q;if(F++,K==3&&(V=15&q,U[W>>>1]|=V<<4*(1-W&1),W++),K==0)for(var et=0;et<q;et++)U[W>>>1]|=V<<4*(1-W&1),W++;if(K==2)for(et=0;et<2;et++)(X=q>>>3*(1-et)&7)!=4&&(V+=j[X],U[W>>>1]|=V<<4*(1-W&1),W++);if(K==1)for(et=0;et<3;et++){var X;(X=q>>>2*(2-et)&3)!=2&&(V+=$[X],U[W>>>1]|=V<<4*(1-W&1),W++)}}},w.decode._dmap={1:0,"011":1,"000011":2,"0000011":3,"010":-1,"000010":-2,"0000010":-3},w.decode._lens=function(){var P=function(W,V,Q,K){for(var q=0;q<V.length;q++)W[V[q]]=Q+q*K},F="00110101,000111,0111,1000,1011,1100,1110,1111,10011,10100,00111,01000,001000,000011,110100,110101,101010,101011,0100111,0001100,0001000,0010111,0000011,0000100,0101000,0101011,0010011,0100100,0011000,00000010,00000011,00011010,00011011,00010010,00010011,00010100,00010101,00010110,00010111,00101000,00101001,00101010,00101011,00101100,00101101,00000100,00000101,00001010,00001011,01010010,01010011,01010100,01010101,00100100,00100101,01011000,01011001,01011010,01011011,01001010,01001011,00110010,00110011,00110100",D="0000110111,010,11,10,011,0011,0010,00011,000101,000100,0000100,0000101,0000111,00000100,00000111,000011000,0000010111,0000011000,0000001000,00001100111,00001101000,00001101100,00000110111,00000101000,00000010111,00000011000,000011001010,000011001011,000011001100,000011001101,000001101000,000001101001,000001101010,000001101011,000011010010,000011010011,000011010100,000011010101,000011010110,000011010111,000001101100,000001101101,000011011010,000011011011,000001010100,000001010101,000001010110,000001010111,000001100100,000001100101,000001010010,000001010011,000000100100,000000110111,000000111000,000000100111,000000101000,000001011000,000001011001,000000101011,000000101100,000001011010,000001100110,000001100111",U="11011,10010,010111,0110111,00110110,00110111,01100100,01100101,01101000,01100111,011001100,011001101,011010010,011010011,011010100,011010101,011010110,011010111,011011000,011011001,011011010,011011011,010011000,010011001,010011010,011000,010011011",Z="0000001111,000011001000,000011001001,000001011011,000000110011,000000110100,000000110101,0000001101100,0000001101101,0000001001010,0000001001011,0000001001100,0000001001101,0000001110010,0000001110011,0000001110100,0000001110101,0000001110110,0000001110111,0000001010010,0000001010011,0000001010100,0000001010101,0000001011010,0000001011011,0000001100100,0000001100101",$="00000001000,00000001100,00000001101,000000010010,000000010011,000000010100,000000010101,000000010110,000000010111,000000011100,000000011101,000000011110,000000011111";F=F.split(","),D=D.split(","),U=U.split(","),Z=Z.split(","),$=$.split(",");var j={},H={};return P(j,F,0,1),P(j,U,64,64),P(j,$,1792,64),P(H,D,0,1),P(H,Z,64,64),P(H,$,1792,64),[j,H]}(),w.decode._decodeG4=function(P,F,D,U,Z,$,j){for(var H=w.decode,W=F<<3,V=0,Q="",K=[],q=[],et=0;et<$;et++)q.push(0);q=H._makeDiff(q);for(var X=0,tt=0,rt=0,ot=0,J=0,lt=0,st="",ut=0,it=8*Math.ceil($/8);W>>>3<F+D;){rt=H._findDiff(q,X+(X==0?0:1),1-J),ot=H._findDiff(q,rt,J);var ct=0;if(j==1&&(ct=P[W>>>3]>>>7-(7&W)&1),j==2&&(ct=P[W>>>3]>>>(7&W)&1),W++,Q+=ct,st=="H"){if(H._lens[J][Q]!=null){var At=H._lens[J][Q];Q="",V+=At,At<64&&(H._addNtimes(K,V,J),X+=V,J=1-J,V=0,--ut==0&&(st=""))}}else Q=="0001"&&(Q="",H._addNtimes(K,ot-X,J),X=ot),Q=="001"&&(Q="",st="H",ut=2),H._dmap[Q]!=null&&(tt=rt+H._dmap[Q],H._addNtimes(K,tt-X,J),X=tt,Q="",J=1-J);K.length==$&&st==""&&(H._writeBits(K,U,8*Z+lt*it),J=0,lt++,X=0,q=H._makeDiff(K),K=[])}},w.decode._findDiff=function(P,F,D){for(var U=0;U<P.length;U+=2)if(P[U]>=F&&P[U+1]==D)return P[U]},w.decode._makeDiff=function(P){var F=[];P[0]==1&&F.push(0,1);for(var D=1;D<P.length;D++)P[D-1]!=P[D]&&F.push(D,P[D]);return F.push(P.length,0,P.length,1),F},w.decode._decodeG2=function(P,F,D,U,Z,$,j){for(var H=w.decode,W=F<<3,V=0,Q="",K=[],q=0,et=0,X=8*Math.ceil($/8);W>>>3<F+D;){var tt=0;j==1&&(tt=P[W>>>3]>>>7-(7&W)&1),j==2&&(tt=P[W>>>3]>>>(7&W)&1),W++,Q+=tt,(V=H._lens[q][Q])!=null&&(H._addNtimes(K,V,q),Q="",V<64&&(q=1-q),K.length==$&&(H._writeBits(K,U,8*Z+et*X),K=[],et++,q=0,7&W&&(W+=8-(7&W)),V>=64&&(W+=8)))}},w.decode._decodeG3=function(P,F,D,U,Z,$,j,H){for(var W=w.decode,V=F<<3,Q=0,K="",q=[],et=[],X=0;X<$;X++)q.push(0);for(var tt=0,rt=0,ot=0,J=0,lt=0,st=-1,ut="",it=0,ct=!0,At=8*Math.ceil($/8);V>>>3<F+D;){ot=W._findDiff(et,tt+(tt==0?0:1),1-lt),J=W._findDiff(et,ot,lt);var Et=0;if(j==1&&(Et=P[V>>>3]>>>7-(7&V)&1),j==2&&(Et=P[V>>>3]>>>(7&V)&1),V++,K+=Et,ct){if(W._lens[lt][K]!=null){var gt=W._lens[lt][K];K="",Q+=gt,gt<64&&(W._addNtimes(q,Q,lt),lt=1-lt,Q=0)}}else ut=="H"?W._lens[lt][K]!=null&&(gt=W._lens[lt][K],K="",Q+=gt,gt<64&&(W._addNtimes(q,Q,lt),tt+=Q,lt=1-lt,Q=0,--it==0&&(ut=""))):(K=="0001"&&(K="",W._addNtimes(q,J-tt,lt),tt=J),K=="001"&&(K="",ut="H",it=2),W._dmap[K]!=null&&(rt=ot+W._dmap[K],W._addNtimes(q,rt-tt,lt),tt=rt,K="",lt=1-lt));K.endsWith("000000000001")&&(st>=0&&W._writeBits(q,U,8*Z+st*At),H&&(j==1&&(ct=(P[V>>>3]>>>7-(7&V)&1)==1),j==2&&(ct=(P[V>>>3]>>>(7&V)&1)==1),V++),K="",lt=0,st++,tt=0,et=W._makeDiff(q),q=[])}q.length==$&&W._writeBits(q,U,8*Z+st*At)},w.decode._addNtimes=function(P,F,D){for(var U=0;U<F;U++)P.push(D)},w.decode._writeBits=function(P,F,D){for(var U=0;U<P.length;U++)F[D+U>>>3]|=P[U]<<7-(D+U&7)},w.decode._decodeLZW=w.decode._decodeLZW=function(){var P,F,D,U,Z=0,$=0,j=0,H=0,W=function(){var X=P>>>3,tt=(F[X]<<16|F[X+1]<<8|F[X+2])>>>24-(7&P)-$&(1<<$)-1;return P+=$,tt},V=new Uint32Array(16384),Q=0,K=function(X){$=X+1,Z=H+1},q=function(X){for(var tt=X<<2,rt=V[tt+2],ot=U+rt-1;tt!=65535;)D[ot--]=V[tt],tt=V[tt+1];U+=rt},et=function(X,tt){var rt=Z<<2,ot=X<<2;V[rt]=V[3+(tt<<2)],V[rt+1]=ot,V[rt+2]=V[ot+2]+1,V[rt+3]=V[ot+3],++Z+1==1<<$&&$!=12&&$++};return function(X,tt,rt,ot,J,lt){P=tt<<3,F=X,D=ot,U=J;var st=tt+rt<<3,ut=0,it=0;for(function(ct){if(ct!=Q){Q=ct,H=1+(j=1<<ct);for(var At=0;At<H+1;At++)V[4*At]=V[4*At+3]=At,V[4*At+1]=65535,V[4*At+2]=1}}(lt),K(lt);P<st&&(ut=W())!=H;){if(ut==j){if(K(lt),(ut=W())==H)break;q(ut)}else ut<Z?(q(ut),et(it,ut)):(et(it,it),q(Z-1));it=ut}return U}}(),w.tags={},w._types=function(){var P=new Array(250);return P.fill(0),{basic:{main:P=P.concat([0,0,0,0,4,3,3,3,3,3,0,0,3,0,0,0,3,0,0,2,2,2,2,4,3,0,0,3,4,4,3,3,5,5,3,2,5,5,0,0,0,0,4,4,0,0,3,3,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,2,2,3,5,5,3,0,3,3,4,4,4,3,4,0,0,0,0,0,0,0,0,0,3,3,0,0,0,0,0,0,0,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,3,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),rest:{33432:2,33434:5,33437:5,34665:4,34850:3,34853:4,34855:3,34864:3,34866:4,36864:7,36867:2,36868:2,37121:7,37377:10,37378:5,37380:10,37381:5,37383:3,37384:3,37385:3,37386:5,37510:7,37520:2,37521:2,37522:2,40960:7,40961:3,40962:4,40963:4,40965:4,41486:5,41487:5,41488:3,41985:3,41986:3,41987:3,41988:5,41989:3,41990:3,41993:3,41994:3,41995:7,41996:3,42032:2,42033:2,42034:5,42036:2,42037:2,59932:7}},gps:{main:[1,2,5,2,5,1,5,5,0,9],rest:{18:2,29:2}}}}(),w._readIFD=function(P,F,D,U,Z,$){var j=P.readUshort(F,D);D+=2;var H={};$.debug&&g("   ".repeat(Z),U.length-1,">>>----------------");for(var W=0;W<j;W++){var V=P.readUshort(F,D);D+=2;var Q=P.readUshort(F,D);D+=2;var K=P.readUint(F,D);D+=4;var q=P.readUint(F,D);D+=4;var et=[];if(Q==1||Q==7){var X=K<5?D-4:q;X+K>F.buffer.byteLength&&(K=F.buffer.byteLength-X),et=new Uint8Array(F.buffer,X,K)}if(Q==2){var tt=K<5?D-4:q,rt=F[tt],ot=Math.max(0,Math.min(K-1,F.length-tt));rt<128||ot==0?et.push(P.readASCII(F,tt,ot)):et=new Uint8Array(F.buffer,tt,ot)}if(Q==3)for(var J=0;J<K;J++)et.push(P.readUshort(F,(K<3?D-4:q)+2*J));if(Q==4||Q==13)for(J=0;J<K;J++)et.push(P.readUint(F,(K<2?D-4:q)+4*J));if(Q==5||Q==10){var lt=Q==5?P.readUint:P.readInt;for(J=0;J<K;J++)et.push([lt(F,q+8*J),lt(F,q+8*J+4)])}if(Q==8)for(J=0;J<K;J++)et.push(P.readShort(F,(K<3?D-4:q)+2*J));if(Q==9)for(J=0;J<K;J++)et.push(P.readInt(F,(K<2?D-4:q)+4*J));if(Q==11)for(J=0;J<K;J++)et.push(P.readFloat(F,q+4*J));if(Q==12)for(J=0;J<K;J++)et.push(P.readDouble(F,q+8*J));if(K==0||et.length!=0){if($.debug&&g("   ".repeat(Z),V,Q,w.tags[V],et),H["t"+V]=et,!(V==330&&H.t272&&H.t272[0]=="DSLR-A100")){if(V==330||V==34665||V==34853||V==50740&&P.readUshort(F,P.readUint(et,0))<300||V==61440){var st=V==50740?[P.readUint(et,0)]:et,ut=[];for(J=0;J<st.length;J++)w._readIFD(P,F,st[J],ut,Z+1,$);V==330&&(H.subIFD=ut),V==34665&&(H.exifIFD=ut[0]),V==34853&&(H.gpsiIFD=ut[0]),V==50740&&(H.dngPrvt=ut[0]),V==61440&&(H.fujiIFD=ut[0])}}if(V==37500&&$.parseMN){var it=et;if(P.readASCII(it,0,5)=="Nikon")H.makerNote=w.decode(it.slice(10).buffer)[0];else if(P.readASCII(it,0,5)=="OLYMP"||P.readASCII(it,0,9)=="OM SYSTEM"){var ct=[8208,8224,8240,8256,8272],At=[];w._readIFD(P,it,it[1]==77?16:it[5]==85?12:8,At,Z+1,$);var Et=H.makerNote=At.pop();for(J=0;J<ct.length;J++){var gt="t"+ct[J];Et[gt]!=null&&(w._readIFD(P,it,Et[gt][0],At,Z+1,$),Et[gt]=At.pop())}Et.t12288&&(w._readIFD(P,Et.t12288,0,At,Z+1,$),Et.t12288=At.pop())}else P.readUshort(F,q)<300&&P.readUshort(F,q+4)<=12&&(At=[],w._readIFD(P,F,q,At,Z+1,$),H.makerNote=At[0])}}else if(g(V,"unknown TIFF tag type: ",Q,"num:",K),W==0)return}return U.push(H),$.debug&&g("   ".repeat(Z),"<<<---------------"),D},w._writeIFD=function(P,F,D,U,Z){var $=Object.keys(Z),j=$.length;Z.exifIFD&&j--,Z.gpsiIFD&&j--,P.writeUshort(D,U,j);for(var H=(U+=2)+12*j+4,W=0;W<$.length;W++){var V=$[W];if(V!="t34665"&&V!="t34853"){V=="exifIFD"&&(V="t34665"),V=="gpsiIFD"&&(V="t34853");var Q=parseInt(V.slice(1)),K=F.main[Q];if(K==null&&(K=F.rest[Q]),K==null||K==0)throw new Error("unknown type of tag: "+Q);var q=Z[V];Q==34665&&(q=[H],H=w._writeIFD(P,F,D,H,Z.exifIFD)[1]),Q==34853&&(q=[H],H=w._writeIFD(P,w._types.gps,D,H,Z.gpsiIFD)[1]),K==2&&(q=q[0]+"\0");var et=q.length;P.writeUshort(D,U,Q),U+=2,P.writeUshort(D,U,K),U+=2,P.writeUint(D,U,et);var X=[-1,1,1,2,4,8,0,1,0,4,8,0,8][K]*et,tt=U+=4;if(X>4&&(P.writeUint(D,U,H),tt=H),K==1||K==7)for(var rt=0;rt<et;rt++)D[tt+rt]=q[rt];else if(K==2)P.writeASCII(D,tt,q);else if(K==3)for(rt=0;rt<et;rt++)P.writeUshort(D,tt+2*rt,q[rt]);else if(K==4)for(rt=0;rt<et;rt++)P.writeUint(D,tt+4*rt,q[rt]);else if(K==5||K==10){var ot=K==5?P.writeUint:P.writeInt;for(rt=0;rt<et;rt++){var J=q[rt],lt=J[0],st=J[1];if(lt==null)throw"e";ot(D,tt+8*rt,lt),ot(D,tt+8*rt+4,st)}}else if(K==9)for(rt=0;rt<et;rt++)P.writeInt(D,tt+4*rt,q[rt]);else{if(K!=12)throw K;for(rt=0;rt<et;rt++)P.writeDouble(D,tt+8*rt,q[rt])}X>4&&(H+=X+=1&X),U+=4}}return[U,H]},w.toRGBA8=function(P,F){function D(Vt){return Vt<.0031308?12.92*Vt:1.055*Math.pow(Vt,1/2.4)-.055}var U=P.width,Z=P.height,$=U*Z,j=P.data,H=new Uint8Array(4*$),W=P.t262?P.t262[0]:2,V=P.t258?Math.min(32,P.t258[0]):1;P.t262==null&&V==1&&(W=0);var Q=P.t277?P.t277[0]:P.t258?P.t258.length:[1,1,3,1,1,4,3][W],K=P.t339?P.t339[0]:null;if(W==1&&V==32&&K!=3)throw"e";var q=Math.ceil(Q*V*U/8);if(W==0){F=1/256;for(var et=0;et<Z;et++){var X=et*q,tt=et*U;if(V==1)for(var rt=0;rt<U;rt++){var ot=tt+rt<<2,J=j[X+(rt>>3)]>>7-(7&rt)&1;H[ot]=H[ot+1]=H[ot+2]=255*(1-J),H[ot+3]=255}if(V==4)for(rt=0;rt<U;rt++)ot=tt+rt<<2,J=j[X+(rt>>1)]>>4-4*(1&rt)&15,H[ot]=H[ot+1]=H[ot+2]=17*(15-J),H[ot+3]=255;if(V==8)for(rt=0;rt<U;rt++)ot=tt+rt<<2,J=j[X+rt],H[ot]=H[ot+1]=H[ot+2]=255-J,H[ot+3]=255;if(V==16)for(rt=0;rt<U;rt++)ot=tt+rt<<2,J=j[(st=X+2*rt)+1]<<8|j[st],H[ot]=H[ot+1]=H[ot+2]=Math.min(255,255-~~(J*F)),H[ot+3]=255}}else if(W==1){F==null&&(F=1/256);var lt=3&j.length?null:new Float32Array(j.buffer);for(et=0;et<Z;et++){if(X=et*q,tt=et*U,V==1)for(rt=0;rt<U;rt++)ot=tt+rt<<2,J=j[X+(rt>>3)]>>7-(7&rt)&1,H[ot]=H[ot+1]=H[ot+2]=255*J,H[ot+3]=255;if(V==2)for(rt=0;rt<U;rt++)ot=tt+rt<<2,J=j[X+(rt>>2)]>>6-2*(3&rt)&3,H[ot]=H[ot+1]=H[ot+2]=85*J,H[ot+3]=255;if(V==8)for(rt=0;rt<U;rt++)ot=tt+rt<<2,J=j[X+rt*Q],H[ot]=H[ot+1]=H[ot+2]=J,H[ot+3]=255;if(V==16)for(rt=0;rt<U;rt++)ot=tt+rt<<2,J=j[(st=X+2*rt)+1]<<8|j[st],H[ot]=H[ot+1]=H[ot+2]=Math.min(255,~~(J*F)),H[ot+3]=255;if(V==32)for(rt=0;rt<U;rt++){var st;ot=tt+rt<<2,J=lt[st=(X>>>2)+rt],H[ot]=H[ot+1]=H[ot+2]=~~(.5+255*J),H[ot+3]=255}}}else if(W==2)if(V==8){if(Q==1)for(rt=0;rt<$;rt++)H[4*rt]=H[4*rt+1]=H[4*rt+2]=j[rt],H[4*rt+3]=255;if(Q==3)for(rt=0;rt<$;rt++){var ut=3*rt;H[ot=rt<<2]=j[ut],H[ot+1]=j[ut+1],H[ot+2]=j[ut+2],H[ot+3]=255}if(Q>=4)for(rt=0;rt<$;rt++)ut=rt*Q,H[ot=rt<<2]=j[ut],H[ot+1]=j[ut+1],H[ot+2]=j[ut+2],H[ot+3]=j[ut+3]}else if(V==16){if(Q==4)for(rt=0;rt<$;rt++)ut=8*rt+1,H[ot=rt<<2]=j[ut],H[ot+1]=j[ut+2],H[ot+2]=j[ut+4],H[ot+3]=j[ut+6];if(Q==3)for(rt=0;rt<$;rt++)ut=6*rt+1,H[ot=rt<<2]=j[ut],H[ot+1]=j[ut+2],H[ot+2]=j[ut+4],H[ot+3]=255}else{if(V!=32)throw V;var it=new Float32Array(j.buffer),ct=0;for(rt=0;rt<it.length;rt++)ct=Math.min(ct,it[rt]);if(ct<0)for(rt=0;rt<j.length;rt+=4){var At=j[rt];j[rt]=j[rt+3],j[rt+3]=At,At=j[rt+1],j[rt+1]=j[rt+2],j[rt+2]=At}var Et=[];for(rt=0;rt<65536;rt++)Et.push(D(rt/65535));for(rt=0;rt<it.length;rt++){var gt=Math.max(0,Math.min(1,it[rt]));it[rt]=Et[~~(.5+65535*gt)]}if(Q==3)for(rt=0;rt<$;rt++)ut=3*rt,H[ot=rt<<2]=~~(.5+255*it[ut]),H[ot+1]=~~(.5+255*it[ut+1]),H[ot+2]=~~(.5+255*it[ut+2]),H[ot+3]=255;else{if(Q!=4)throw Q;for(rt=0;rt<$;rt++)ut=4*rt,H[ot=rt<<2]=~~(.5+255*it[ut]),H[ot+1]=~~(.5+255*it[ut+1]),H[ot+2]=~~(.5+255*it[ut+2]),H[ot+3]=~~(.5+255*it[ut+3])}}else if(W==3){var pt=P.t320,vt=1<<V,Tt=V==8&&Q>1&&P.t338&&P.t338[0]!=0;for(et=0;et<Z;et++)for(var It=0;It<U;It++){ot=(rt=et*U+It)<<2;var $t=0,Bt=et*q;if(V==1)$t=j[Bt+(It>>>3)]>>>7-(7&It)&1;else if(V==2)$t=j[Bt+(It>>>2)]>>>6-2*(3&It)&3;else if(V==4)$t=j[Bt+(It>>>1)]>>>4-4*(1&It)&15;else{if(V!=8)throw V;$t=j[Bt+It*Q]}H[ot]=pt[$t]>>8,H[ot+1]=pt[vt+$t]>>8,H[ot+2]=pt[vt+vt+$t]>>8,H[ot+3]=Tt?j[Bt+It*Q+1]:255}}else if(W==5){var zt=Q>4?1:0;for(rt=0;rt<$;rt++){ot=rt<<2;var Ot=rt*Q;if(window.UDOC){var Nt=j[Ot],Pt=j[Ot+1],Ut=j[Ot+2],Ft=j[Ot+3],Zt=UDOC.C.cmykToRgb([Nt*(1/255),Pt*(1/255),Ut*(1/255),Ft*(1/255)]);H[ot]=~~(.5+255*Zt[0]),H[ot+1]=~~(.5+255*Zt[1]),H[ot+2]=~~(.5+255*Zt[2])}else Nt=255-j[Ot],Pt=255-j[Ot+1],Ut=255-j[Ot+2],Ft=(255-j[Ot+3])*(1/255),H[ot]=~~(Nt*Ft+.5),H[ot+1]=~~(Pt*Ft+.5),H[ot+2]=~~(Ut*Ft+.5);H[ot+3]=255*(1-zt)+j[Ot+4]*zt}}else if(W==6&&P.t278){var Ht=P.t278[0];for(et=0;et<Z;et+=Ht){rt=et*U;for(var Dt=Ht*U,dt=0;dt<Dt;dt++){ot=4*(rt+dt),Ut=j[(Ot=3*rt+4*(dt>>>1))+(1&dt)];var Lt=j[Ot+2]-128,bt=j[Ot+3]-128,wt=Ut+((bt>>2)+(bt>>3)+(bt>>5)),xt=Ut-((Lt>>2)+(Lt>>4)+(Lt>>5))-((bt>>1)+(bt>>3)+(bt>>4)+(bt>>5)),Rt=Ut+(Lt+(Lt>>1)+(Lt>>2)+(Lt>>6));H[ot]=Math.max(0,Math.min(255,wt)),H[ot+1]=Math.max(0,Math.min(255,xt)),H[ot+2]=Math.max(0,Math.min(255,Rt)),H[ot+3]=255}}}else if(W==32845)for(et=0;et<Z;et++)for(It=0;It<U;It++){ot=4*(et*U+It);var Gt=j[(Ot=6*(et*U+It))+1]<<8|j[Ot],nt=(Gt=Math.pow(2,(Gt+.5)/256-64),(j[Ot+3]+.5)/410),ht=(j[Ot+5]+.5)/410,ft=9*nt/(6*nt-16*ht+12),at=4*ht/(6*nt-16*ht+12),_t=ft*Gt/at,St=(1-ft-at)*Gt/at;wt=2.69*_t-1.276*(Ut=Gt)-.414*St,xt=-1.022*_t+1.978*Ut+.044*St,Rt=.061*_t-.224*Ut+1.163*St,H[ot]=255*D(Math.min(wt,1)),H[ot+1]=255*D(Math.min(xt,1)),H[ot+2]=255*D(Math.min(Rt,1)),H[ot+3]=255}else g("Unknown Photometric interpretation: "+W);return H},w.replaceIMG=function(P){P==null&&(P=document.getElementsByTagName("img"));for(var F=["tif","tiff","dng","cr2","nef"],D=0;D<P.length;D++){var U=P[D],Z=U.getAttribute("src");if(Z!=null){var $=Z.split(".").pop().toLowerCase();if(F.indexOf($)!=-1){var j=new XMLHttpRequest;w._xhrs.push(j),w._imgs.push(U),j.open("GET",Z),j.responseType="arraybuffer",j.onload=w._imgLoaded,j.send()}}}},w._xhrs=[],w._imgs=[],w._imgLoaded=function(P){var F=w._xhrs.indexOf(P.target),D=w._imgs[F];w._xhrs.splice(F,1),w._imgs.splice(F,1),D.setAttribute("src",w.bufferToURI(P.target.response))},w.bufferToURI=function(P){var F=w.decode(P),D=F,U=0,Z=D[0];F[0].subIFD&&(D=D.concat(F[0].subIFD));for(var $=0;$<D.length;$++){var j=D[$];if(!(j.t258==null||j.t258.length<3)){var H=j.t256*j.t257;H>U&&(U=H,Z=j)}}w.decodeImage(P,Z,F);var W=w.toRGBA8(Z),V=Z.width,Q=Z.height,K=document.createElement("canvas");K.width=V,K.height=Q;var q=K.getContext("2d"),et=new ImageData(new Uint8ClampedArray(W.buffer),V,Q);return q.putImageData(et,0,0),K.toDataURL()},w._binBE={nextZero:function(P,F){for(;P[F]!=0;)F++;return F},readUshort:function(P,F){return P[F]<<8|P[F+1]},readShort:function(P,F){var D=w._binBE.ui8;return D[0]=P[F+1],D[1]=P[F+0],w._binBE.i16[0]},readInt:function(P,F){var D=w._binBE.ui8;return D[0]=P[F+3],D[1]=P[F+2],D[2]=P[F+1],D[3]=P[F+0],w._binBE.i32[0]},readUint:function(P,F){var D=w._binBE.ui8;return D[0]=P[F+3],D[1]=P[F+2],D[2]=P[F+1],D[3]=P[F+0],w._binBE.ui32[0]},readASCII:function(P,F,D){for(var U="",Z=0;Z<D;Z++)U+=String.fromCharCode(P[F+Z]);return U},readFloat:function(P,F){for(var D=w._binBE.ui8,U=0;U<4;U++)D[U]=P[F+3-U];return w._binBE.fl32[0]},readDouble:function(P,F){for(var D=w._binBE.ui8,U=0;U<8;U++)D[U]=P[F+7-U];return w._binBE.fl64[0]},writeUshort:function(P,F,D){P[F]=D>>8&255,P[F+1]=255&D},writeInt:function(P,F,D){var U=w._binBE.ui8;w._binBE.i32[0]=D,P[F+3]=U[0],P[F+2]=U[1],P[F+1]=U[2],P[F+0]=U[3]},writeUint:function(P,F,D){P[F]=D>>24&255,P[F+1]=D>>16&255,P[F+2]=D>>8&255,P[F+3]=255&D},writeASCII:function(P,F,D){for(var U=0;U<D.length;U++)P[F+U]=D.charCodeAt(U)},writeDouble:function(P,F,D){w._binBE.fl64[0]=D;for(var U=0;U<8;U++)P[F+U]=w._binBE.ui8[7-U]}},w._binBE.ui8=new Uint8Array(8),w._binBE.i16=new Int16Array(w._binBE.ui8.buffer),w._binBE.i32=new Int32Array(w._binBE.ui8.buffer),w._binBE.ui32=new Uint32Array(w._binBE.ui8.buffer),w._binBE.fl32=new Float32Array(w._binBE.ui8.buffer),w._binBE.fl64=new Float64Array(w._binBE.ui8.buffer),w._binLE={nextZero:w._binBE.nextZero,readUshort:function(P,F){return P[F+1]<<8|P[F]},readShort:function(P,F){var D=w._binBE.ui8;return D[0]=P[F+0],D[1]=P[F+1],w._binBE.i16[0]},readInt:function(P,F){var D=w._binBE.ui8;return D[0]=P[F+0],D[1]=P[F+1],D[2]=P[F+2],D[3]=P[F+3],w._binBE.i32[0]},readUint:function(P,F){var D=w._binBE.ui8;return D[0]=P[F+0],D[1]=P[F+1],D[2]=P[F+2],D[3]=P[F+3],w._binBE.ui32[0]},readASCII:w._binBE.readASCII,readFloat:function(P,F){for(var D=w._binBE.ui8,U=0;U<4;U++)D[U]=P[F+U];return w._binBE.fl32[0]},readDouble:function(P,F){for(var D=w._binBE.ui8,U=0;U<8;U++)D[U]=P[F+U];return w._binBE.fl64[0]},writeUshort:function(P,F,D){P[F]=255&D,P[F+1]=D>>8&255},writeInt:function(P,F,D){var U=w._binBE.ui8;w._binBE.i32[0]=D,P[F+0]=U[0],P[F+1]=U[1],P[F+2]=U[2],P[F+3]=U[3]},writeUint:function(P,F,D){P[F]=D>>>0&255,P[F+1]=D>>>8&255,P[F+2]=D>>>16&255,P[F+3]=D>>>24&255},writeASCII:w._binBE.writeASCII},w._copyTile=function(P,F,D,U,Z,$,j,H){for(var W=Math.min(F,Z-j),V=Math.min(D,$-H),Q=0;Q<V;Q++)for(var K=(H+Q)*Z+j,q=Q*F,et=0;et<W;et++)U[K+et]=P[q+et]},w.LosslessJpegDecode=function(){var P,F;function D(){return P[F++]}function U(){return P[F++]<<8|P[F++]}function Z(X){for(var tt=D(),rt=[0,0,0,255],ot=[],J=0;J<16;J++)ot[J]=D();for(J=0;J<16;J++)for(var lt=0;lt<ot[J];lt++)rt[$(rt,0,J+1,1)+3]=D();var st=new Uint8Array(256);for(X[tt]=[new Uint8Array(rt),st],J=0;J<256;J++){for(var ut=8,it=J,ct=0;rt[ct+3]==255&&ut!=0;)ct=rt[ct+(it>>--ut&1)];st[J]=ct}}function $(X,tt,rt,ot){if(X[tt+3]!=255)return 0;if(rt==0)return tt;for(var J=0;J<2;J++){X[tt+J]==0&&(X[tt+J]=X.length,X.push(0,0,ot,255));var lt=$(X,X[tt+J],rt-1,ot+1);if(lt!=0)return lt}return 0}function j(X){for(var tt=X.b,rt=X.f;tt<25&&X.a<X.d;){var ot=X.data[X.a++];ot!=255||X.c||X.a++,rt=rt<<8|ot,tt+=8}if(tt<0)throw"e";X.b=tt,X.f=rt}function H(X,tt){return tt.b<X&&j(tt),tt.f>>(tt.b-=X)&65535>>16-X}function W(X,tt){var rt=X[0],ot=0,J=255;tt.b<16&&j(tt);var lt=tt.f>>tt.b-8&255;for(J=rt[(ot=X[1][lt])+3],tt.b-=rt[ot+2];J==255;)J=rt[(ot=rt[ot+(tt.f>>--tt.b&1)])+3];return J}function V(X,tt){return X<32768>>16-tt&&(X+=1-(1<<tt)),X}function Q(X,tt){var rt=W(X,tt);return rt==0?0:rt==16?-32768:V(H(rt,tt),rt)}function K(X,tt,rt,ot,J,lt){for(var st=0,ut=0;ut<lt;ut++){for(var it=ut*tt,ct=0;ct<tt;ct+=J){st++;for(var At=0;At<J;At++)X[it+ct+At]=Q(ot[At],rt)}if(rt.e!=0&&st%rt.e==0&&ut!=0){for(var Et=rt.a,gt=rt.data;gt[Et]!=255||!(208<=gt[Et+1]&&gt[Et+1]<=215);)Et--;rt.a=Et+2,rt.f=0,rt.b=0}}}function q(X,tt){return V(H(X,tt),X)}function et(X,tt,rt,ot,J,lt,st,ut){for(var it=rt*st,ct=J;ct<lt;ct++)X[ct]+=1<<ut-1;for(var At=st;At<it;At+=st)for(ct=J;ct<lt;ct++)X[At+ct]+=X[At+ct-st];for(var Et=1;Et<ot;Et++){var gt=Et*it;for(ct=J;ct<lt;ct++)X[gt+ct]+=X[gt+ct-it];for(At=st;At<it;At+=st)for(ct=J;ct<lt;ct++){var pt=gt+At+ct,vt=pt-it,Tt=X[pt-st],It=0;if(tt==0)It=0;else if(tt==1)It=Tt;else if(tt==2)It=X[vt];else if(tt==3)It=X[vt-st];else if(tt==4)It=Tt+(X[vt]-X[vt-st]);else if(tt==5)It=Tt+(X[vt]-X[vt-st]>>>1);else if(tt==6)It=X[vt]+(Tt-X[vt-st]>>>1);else{if(tt!=7)throw tt;It=Tt+X[vt]>>>1}X[pt]+=It}}}return function(X){if(P=X,F=0,U()!=65496)throw"e";for(var tt=[],rt=0,ot=0,J=0,lt=[],st=[],ut=[],it=0,ct=0,At=0;;){var Et=U();if(Et!=65535){var gt=U();if(Et==65475){ot=D(),ct=U(),At=U(),it=D();for(var pt=0;pt<it;pt++){var vt=D(),Tt=D();if(D()!=0)throw"e";tt[vt]=[pt,Tt>>4,15&Tt]}}else if(Et==65476)for(var It=F+gt-2;F<It;)Z(st);else{if(Et==65498){for(F++,pt=0;pt<it;pt++){var $t=tt[D()];ut[$t[0]]=st[D()>>>4],lt[$t[0]]=$t.slice(1)}rt=D(),F+=2;break}Et==65501?J=U():F+=gt-2}}else F--}var Bt=new(ot>8?Uint16Array:Uint8Array)(ct*At*it),zt={b:0,f:0,c:rt==8,a:F,data:P,d:P.length,e:J};if(zt.c)(function(_t,St,Vt,ee,Jt){for(var se=P.length-F,ae=0;ae<se;ae+=4){var fe=P[F+ae];P[F+ae]=P[F+ae+3],P[F+ae+3]=fe,fe=P[F+ae+1],P[F+ae+1]=P[F+ae+2],P[F+ae+2]=fe}for(var le=0;le<Jt;le++)for(var ue=32768,me=32768,he=0;he<St;he+=2){var Wt=W(ee,Vt),oe=W(ee,Vt);Wt!=0&&(ue+=q(Wt,Vt)),oe!=0&&(me+=q(oe,Vt)),_t[le*St+he]=65535&ue,_t[le*St+he+1]=65535&me}})(Bt,At*it,zt,ut[0],ct);else{var Ot=[],Nt=0,Pt=0;for(pt=0;pt<it;pt++){var Ut=lt[pt];(Rt=Ut[0])>Nt&&(Nt=Rt),(xt=Ut[1])>Pt&&(Pt=xt),Ot.push(Rt*xt)}if(Nt!=1||Pt!=1){if(it!=3||Ot[1]!=1||Ot[2]!=1||Nt!=2||Pt!=1&&Pt!=2)throw"e";var Ft=[],Zt=0;for(pt=0;pt<it;pt++){for(var Ht=0;Ht<Ot[pt];Ht++)Ft.push(ut[pt]);Zt+=Ot[pt]}var Dt=At/Nt,dt=ct/Pt,Lt=Dt*dt;K(Bt,Dt*Zt,zt,Ft,Zt,dt),et(Bt,rt,Dt,dt,Zt-2,Zt,Zt,ot);var bt=new Uint16Array(Lt*Ot[0]);if(Nt==2&&Pt==2){for(pt=0;pt<Lt;pt++)bt[4*pt]=Bt[6*pt],bt[4*pt+1]=Bt[6*pt+1],bt[4*pt+2]=Bt[6*pt+2],bt[4*pt+3]=Bt[6*pt+3];for(et(bt,rt,4*Dt,dt,0,1,1,ot),pt=0;pt<Lt;pt++)Bt[6*pt]=bt[4*pt],Bt[6*pt+1]=bt[4*pt+1],Bt[6*pt+2]=bt[4*pt+2],Bt[6*pt+3]=bt[4*pt+3]}if(Nt==2&&Pt==1){for(pt=0;pt<Lt;pt++)bt[2*pt]=Bt[4*pt],bt[2*pt+1]=Bt[4*pt+1];for(et(bt,rt,2*Dt,dt,0,1,1,ot),pt=0;pt<Lt;pt++)Bt[4*pt]=bt[2*pt],Bt[4*pt+1]=bt[2*pt+1]}for(var wt=Bt.slice(0),xt=0;xt<ct;xt++)if(Pt==2)for(var Rt=0;Rt<At;Rt++){var Gt=((xt>>>1)*Dt+(Rt>>>1))*Zt,nt=2*(1&xt)+(1&Rt);Bt[ht=(xt*At+Rt)*it]=wt[Gt+nt],Bt[ht+1]=wt[Gt+4],Bt[ht+2]=wt[Gt+5]}else for(Rt=0;Rt<At;Rt++){var ht;Gt=(xt*Dt+(Rt>>>1))*Zt,nt=1&Rt,Bt[ht=(xt*At+Rt)*it]=wt[Gt+nt],Bt[ht+1]=wt[Gt+2],Bt[ht+2]=wt[Gt+3]}}else if(K(Bt,At*it,zt,ut,it,ct),J==0)et(Bt,rt,At,ct,0,it,it,ot);else{var ft=Math.floor(J/At);for(xt=0;xt<ct;xt+=ft){var at=Bt.slice(xt*At*it,(xt+ft)*At*it);et(at,rt,At,ft,0,it,it,ot),Bt.set(at,xt*At*it)}}}return Bt}}(),function(){var P=2,F=4,D=5,U=6,Z=7,$=12,j=13,H=14,W=15,V=17;function Q(lt){var st={c:new Int8Array(2<<lt.u)};return function(ut,it,ct){var At=[it,3*it+18,5*it+67,7*it+276,ct];ut.o=it,ut.w=(At[4]+2*it)/(2*it+1)+1|0,ut.v=Math.ceil(Math.log2(ut.w)),ut.t=9,function(Et,gt){for(var pt=-gt[4],vt=0;pt<=gt[4];vt++,pt++)Et[vt]=pt<=-276?-4:pt<=-67?-3:pt<=-18?-2:pt<-0?-1:pt<=gt[0]?0:pt<gt[1]?1:pt<gt[2]?2:pt<gt[3]?3:4}(ut.c,At)}(st,0,lt.g),st}function K(lt){for(var st=[[],[],[]],ut=Math.max(2,lt.w+32>>>6),it=0;it<3;it++)for(var ct=0;ct<41;ct++)st[it][ct]=[ut,1];return st}function q(lt,st){var ut=0,it=8-lt.a;if(lt.j,lt.a,st){if(st>=it)do ut<<=it,st-=it,ut|=lt[lt.j]&(1<<it)-1,lt.j++,it=8;while(st>=8);st&&(ut<<=st,it-=st,ut|=lt[lt.j]>>>it&(1<<st)-1),lt.a=8-it}return ut}function et(lt,st,ut,it,ct,At,Et,gt){gt==null&&(gt=0);var pt,vt,Tt,It,$t,Bt,zt=At+1,Ot=zt%2,Nt=0,Pt=it[ct],Ut=it[ct-1],Ft=it[ct-2][zt],Zt=Ut[zt-1],Ht=Ut[zt],Dt=Ut[zt+1],dt=Pt[zt-1],Lt=Pt[zt+1],bt=Math.abs;if(Ot&&(Tt=bt(Dt-Ht),It=bt(Ft-Ht),$t=bt(Zt-Ht)),Ot){if(Bt=(Bt=Tt>$t&&It<Tt?Ft+Zt:Tt<$t&&It<$t?Ft+Dt:Dt+Zt)+2*Ht>>>2,gt)return void(Pt[zt]=Bt);pt=st.t*st.c[lt.g+Ht-Ft]+st.c[lt.g+Zt-Ht]}else Bt=Ht>Zt&&Ht>Dt||Ht<Zt&&Ht<Dt?Lt+dt+2*Ht>>>2:dt+Lt>>>1,pt=st.t*st.c[lt.g+Ht-Zt]+st.c[lt.g+Zt-dt];vt=bt(pt);var wt=function(Rt){for(var Gt=-1,nt=0;!nt;Gt++)nt=Rt[Rt.j]>>>7-Rt.a&1,Rt.a++,Rt.a&=7,Rt.a||Rt.j++;return Gt}(ut);if(wt<lt.n-st.v-1){var xt=function(Rt,Gt){var nt=0;if(Gt<Rt)for(;nt<=14&&Gt<<++nt<Rt;);return nt}(Et[vt][0],Et[vt][1]);Nt=q(ut,xt)+(wt<<xt)}else Nt=q(ut,st.v)+1;Nt=1&Nt?-1-(Nt>>>1):Nt>>>1,Et[vt][0]+=bt(Nt),Et[vt][1]==lt.f&&(Et[vt][0]>>>=1,Et[vt][1]>>>=1),Et[vt][1]++,Bt=pt<0?Bt-Nt:Bt+Nt,lt.i&&(Bt<0?Bt+=st.w:Bt>lt.g&&(Bt-=st.w)),Pt[zt]=Bt>=0?Math.min(Bt,lt.g):0}function X(lt,st,ut){for(var it=lt[0].length,ct=st;ct<=ut;ct++)lt[ct][0]=lt[ct-1][1],lt[ct][it-1]=lt[ct-1][it-2]}function tt(lt){X(lt,Z,$),X(lt,P,F),X(lt,W,V)}function rt(lt,st,ut,it,ct,At,Et,gt,pt,vt,Tt,It,$t){for(var Bt=0,zt=1,Ot=ct<j&&ct>F;zt<lt.m;)Bt<lt.m&&(et(lt,st,ut,it,ct,Bt,Et[pt],lt.h&&(Ot&&vt||!Ot&&(Tt||(Bt&It)==$t))),et(lt,st,ut,it,At,Bt,Et[pt],lt.h&&(!Ot&&vt||Ot&&(Tt||(Bt&It)==$t))),Bt+=2),Bt>8&&(et(lt,st,ut,it,ct,zt,gt[pt]),et(lt,st,ut,it,At,zt,gt[pt]),zt+=2);tt(it)}function ot(lt,st,ut,it,ct,At){rt(lt,st,ut,it,P,Z,ct,At,0,0,1,0,8),rt(lt,st,ut,it,8,W,ct,At,1,0,1,0,8),rt(lt,st,ut,it,3,9,ct,At,2,1,0,3,0),rt(lt,st,ut,it,10,16,ct,At,0,0,0,3,2),rt(lt,st,ut,it,F,11,ct,At,1,0,0,3,2),rt(lt,st,ut,it,$,V,ct,At,2,1,0,3,0)}function J(lt,st,ut,it,ct,At){var Et=At.length,gt=lt.l;ct+1==lt.s&&(gt=lt.e-ct*lt.l);for(var pt=6*lt.e*it+ct*lt.l,vt=0;vt<6;vt++){for(var Tt=0;Tt<gt;Tt++){var It,$t=At[vt%Et][Tt%Et];It=$t==0?P+(vt>>>1):$t==2?W+(vt>>>1):Z+vt;var Bt=lt.h?(2*Tt/3&2147483646|Tt%3&1)+(Tt%3>>>1):Tt>>>1;st[pt+Tt]=ut[It][Bt+1]}pt+=lt.e}}w._decompressRAF=function(lt,st){var ut=function(zt){var Ot=w._binBE.readUshort,Nt={b:Ot(zt,0),i:zt[2],C:zt[3],u:zt[4],q:Ot(zt,5),k:Ot(zt,7),e:Ot(zt,9),l:Ot(zt,11),s:zt[13],d:Ot(zt,14)};if(Nt.b!=18771||Nt.i>1||Nt.q<6||Nt.q%6||Nt.e<768||Nt.e%24||Nt.l!=768||Nt.k<Nt.l||Nt.k%Nt.l||Nt.k-Nt.e>=Nt.l||Nt.s>16||Nt.s!=Nt.k/Nt.l||Nt.s!=Math.ceil(Nt.e/Nt.l)||Nt.d!=Nt.q/6||Nt.u!=12&&Nt.u!=14&&Nt.u!=16||Nt.C!=16&&Nt.C!=0)throw"Invalid data";if(Nt.i==0)throw"Not implemented. We need this file!";return Nt.h=Nt.C==16,Nt.m=0|(Nt.h?2*Nt.l/3:Nt.l>>>1),Nt.A=Nt.m+2,Nt.f=64,Nt.g=(1<<Nt.u)-1,Nt.n=4*Nt.u,Nt}(lt),it=function(zt,Ot){var Nt=new Array(Ot.s),Pt=4*Ot.s,Ut=16+Pt;12&Pt&&(Ut+=16-(12&Pt));for(var Ft=0,Zt=16;Ft<Ot.s;Zt+=4){var Ht=w._binBE.readUint(zt,Zt);Nt[Ft]=zt.slice(Ut,Ut+Ht),Nt[Ft].j=0,Nt[Ft].a=0,Ut+=Ht,Ft++}if(Ut!=zt.length)throw"Invalid data";return Nt}(lt,ut),ct=Q(ut),At=new Int16Array(ut.e*ut.q);st==null&&(st=ut.h?[[1,1,0,1,1,2],[1,1,2,1,1,0],[2,0,1,0,2,1],[1,1,2,1,1,0],[1,1,0,1,1,2],[0,2,1,2,0,1]]:[[0,1],[3,2]]);for(var Et=[[0,3],[1,F],[D,11],[U,$],[j,16],[H,V]],gt=[],pt=0;pt<18;pt++)gt[pt]=new Uint16Array(ut.A);for(var vt=0;vt<ut.s;vt++){var Tt=K(ct),It=K(ct);for(pt=0;pt<18;pt++)for(var $t=0;$t<ut.A;$t++)gt[pt][$t]=0;for(var Bt=0;Bt<ut.d;Bt++){for(ot(ut,ct,it[vt],gt,Tt,It),pt=0;pt<6;pt++)for($t=0;$t<ut.A;$t++)gt[Et[pt][0]][$t]=gt[Et[pt][1]][$t];for(J(ut,At,gt,Bt,vt,st),pt=P;pt<18;pt++)if([D,U,j,H].indexOf(pt)==-1)for($t=0;$t<ut.A;$t++)gt[pt][$t]=0;tt(gt)}}return At}}()}(m,typeof commonjsRequire=="function"?requirePako():self.pako)})()})(UTIF);var UTIFExports=UTIF.exports,utif=getDefaultExportFromCjs(UTIFExports),util$1,objectUtil;function getDimensionValue(d){return typeof d=="number"?d:d instanceof Uint8Array?d[0]:typeof d[0]=="string"?parseInt(d[0]):d[0]}function tiff(){return{mime:"image/tiff",encode:d=>{const m=utif.encodeImage(d.data,d.width,d.height);return Buffer$2.from(m)},decode:d=>{const m=utif.decode(d),g=m[0];if(!g)throw new Error("No page found in TIFF");if(!g.t256)throw new Error("No image width found in TIFF");if(!g.t257)throw new Error("No image height found in TIFF");m.forEach(I=>{utif.decodeImage(d,I)});const w=utif.toRGBA8(g);return{data:Buffer$2.from(w),width:getDimensionValue(g.t256),height:getDimensionValue(g.t257)}}}}(function(d){d.assertEqual=m=>m,d.assertIs=function(m){},d.assertNever=function(m){throw new Error},d.arrayToEnum=m=>{const g={};for(const w of m)g[w]=w;return g},d.getValidEnumValues=m=>{const g=d.objectKeys(m).filter(I=>typeof m[m[I]]!="number"),w={};for(const I of g)w[I]=m[I];return d.objectValues(w)},d.objectValues=m=>d.objectKeys(m).map(function(g){return m[g]}),d.objectKeys=typeof Object.keys=="function"?m=>Object.keys(m):m=>{const g=[];for(const w in m)Object.prototype.hasOwnProperty.call(m,w)&&g.push(w);return g},d.find=(m,g)=>{for(const w of m)if(g(w))return w},d.isInteger=typeof Number.isInteger=="function"?m=>Number.isInteger(m):m=>typeof m=="number"&&isFinite(m)&&Math.floor(m)===m,d.joinValues=function(m,g=" | "){return m.map(w=>typeof w=="string"?`'${w}'`:w).join(g)},d.jsonStringifyReplacer=(m,g)=>typeof g=="bigint"?g.toString():g})(util$1||(util$1={})),function(d){d.mergeShapes=(m,g)=>({...m,...g})}(objectUtil||(objectUtil={}));const ZodParsedType=util$1.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),getParsedType=d=>{switch(typeof d){case"undefined":return ZodParsedType.undefined;case"string":return ZodParsedType.string;case"number":return isNaN(d)?ZodParsedType.nan:ZodParsedType.number;case"boolean":return ZodParsedType.boolean;case"function":return ZodParsedType.function;case"bigint":return ZodParsedType.bigint;case"symbol":return ZodParsedType.symbol;case"object":return Array.isArray(d)?ZodParsedType.array:d===null?ZodParsedType.null:d.then&&typeof d.then=="function"&&d.catch&&typeof d.catch=="function"?ZodParsedType.promise:typeof Map<"u"&&d instanceof Map?ZodParsedType.map:typeof Set<"u"&&d instanceof Set?ZodParsedType.set:typeof Date<"u"&&d instanceof Date?ZodParsedType.date:ZodParsedType.object;default:return ZodParsedType.unknown}},ZodIssueCode=util$1.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),quotelessJson=d=>JSON.stringify(d,null,2).replace(/"([^"]+)":/g,"$1:");class ZodError extends Error{constructor(m){super(),this.issues=[],this.addIssue=w=>{this.issues=[...this.issues,w]},this.addIssues=(w=[])=>{this.issues=[...this.issues,...w]};const g=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,g):this.__proto__=g,this.name="ZodError",this.issues=m}get errors(){return this.issues}format(m){const g=m||function(P){return P.message},w={_errors:[]},I=P=>{for(const F of P.issues)if(F.code==="invalid_union")F.unionErrors.map(I);else if(F.code==="invalid_return_type")I(F.returnTypeError);else if(F.code==="invalid_arguments")I(F.argumentsError);else if(F.path.length===0)w._errors.push(g(F));else{let D=w,U=0;for(;U<F.path.length;){const Z=F.path[U];U===F.path.length-1?(D[Z]=D[Z]||{_errors:[]},D[Z]._errors.push(g(F))):D[Z]=D[Z]||{_errors:[]},D=D[Z],U++}}};return I(this),w}static assert(m){if(!(m instanceof ZodError))throw new Error(`Not a ZodError: ${m}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,util$1.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(m=g=>g.message){const g={},w=[];for(const I of this.issues)I.path.length>0?(g[I.path[0]]=g[I.path[0]]||[],g[I.path[0]].push(m(I))):w.push(m(I));return{formErrors:w,fieldErrors:g}}get formErrors(){return this.flatten()}}ZodError.create=d=>new ZodError(d);const errorMap=(d,m)=>{let g;switch(d.code){case ZodIssueCode.invalid_type:g=d.received===ZodParsedType.undefined?"Required":`Expected ${d.expected}, received ${d.received}`;break;case ZodIssueCode.invalid_literal:g=`Invalid literal value, expected ${JSON.stringify(d.expected,util$1.jsonStringifyReplacer)}`;break;case ZodIssueCode.unrecognized_keys:g=`Unrecognized key(s) in object: ${util$1.joinValues(d.keys,", ")}`;break;case ZodIssueCode.invalid_union:g="Invalid input";break;case ZodIssueCode.invalid_union_discriminator:g=`Invalid discriminator value. Expected ${util$1.joinValues(d.options)}`;break;case ZodIssueCode.invalid_enum_value:g=`Invalid enum value. Expected ${util$1.joinValues(d.options)}, received '${d.received}'`;break;case ZodIssueCode.invalid_arguments:g="Invalid function arguments";break;case ZodIssueCode.invalid_return_type:g="Invalid function return type";break;case ZodIssueCode.invalid_date:g="Invalid date";break;case ZodIssueCode.invalid_string:typeof d.validation=="object"?"includes"in d.validation?(g=`Invalid input: must include "${d.validation.includes}"`,typeof d.validation.position=="number"&&(g=`${g} at one or more positions greater than or equal to ${d.validation.position}`)):"startsWith"in d.validation?g=`Invalid input: must start with "${d.validation.startsWith}"`:"endsWith"in d.validation?g=`Invalid input: must end with "${d.validation.endsWith}"`:util$1.assertNever(d.validation):g=d.validation!=="regex"?`Invalid ${d.validation}`:"Invalid";break;case ZodIssueCode.too_small:g=d.type==="array"?`Array must contain ${d.exact?"exactly":d.inclusive?"at least":"more than"} ${d.minimum} element(s)`:d.type==="string"?`String must contain ${d.exact?"exactly":d.inclusive?"at least":"over"} ${d.minimum} character(s)`:d.type==="number"?`Number must be ${d.exact?"exactly equal to ":d.inclusive?"greater than or equal to ":"greater than "}${d.minimum}`:d.type==="date"?`Date must be ${d.exact?"exactly equal to ":d.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(d.minimum))}`:"Invalid input";break;case ZodIssueCode.too_big:g=d.type==="array"?`Array must contain ${d.exact?"exactly":d.inclusive?"at most":"less than"} ${d.maximum} element(s)`:d.type==="string"?`String must contain ${d.exact?"exactly":d.inclusive?"at most":"under"} ${d.maximum} character(s)`:d.type==="number"?`Number must be ${d.exact?"exactly":d.inclusive?"less than or equal to":"less than"} ${d.maximum}`:d.type==="bigint"?`BigInt must be ${d.exact?"exactly":d.inclusive?"less than or equal to":"less than"} ${d.maximum}`:d.type==="date"?`Date must be ${d.exact?"exactly":d.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(d.maximum))}`:"Invalid input";break;case ZodIssueCode.custom:g="Invalid input";break;case ZodIssueCode.invalid_intersection_types:g="Intersection results could not be merged";break;case ZodIssueCode.not_multiple_of:g=`Number must be a multiple of ${d.multipleOf}`;break;case ZodIssueCode.not_finite:g="Number must be finite";break;default:g=m.defaultError,util$1.assertNever(d)}return{message:g}};let overrideErrorMap=errorMap;function setErrorMap(d){overrideErrorMap=d}function getErrorMap(){return overrideErrorMap}const makeIssue=d=>{const{data:m,path:g,errorMaps:w,issueData:I}=d,P=[...g,...I.path||[]],F={...I,path:P};if(I.message!==void 0)return{...I,path:P,message:I.message};let D="";const U=w.filter(Z=>!!Z).slice().reverse();for(const Z of U)D=Z(F,{data:m,defaultError:D}).message;return{...I,path:P,message:D}},EMPTY_PATH=[];function addIssueToContext(d,m){const g=getErrorMap(),w=makeIssue({issueData:m,data:d.data,path:d.path,errorMaps:[d.common.contextualErrorMap,d.schemaErrorMap,g,g===errorMap?void 0:errorMap].filter(I=>!!I)});d.common.issues.push(w)}class ParseStatus{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(m,g){const w=[];for(const I of g){if(I.status==="aborted")return INVALID;I.status==="dirty"&&m.dirty(),w.push(I.value)}return{status:m.value,value:w}}static async mergeObjectAsync(m,g){const w=[];for(const I of g){const P=await I.key,F=await I.value;w.push({key:P,value:F})}return ParseStatus.mergeObjectSync(m,w)}static mergeObjectSync(m,g){const w={};for(const I of g){const{key:P,value:F}=I;if(P.status==="aborted"||F.status==="aborted")return INVALID;P.status==="dirty"&&m.dirty(),F.status==="dirty"&&m.dirty(),P.value==="__proto__"||F.value===void 0&&!I.alwaysSet||(w[P.value]=F.value)}return{status:m.value,value:w}}}const INVALID=Object.freeze({status:"aborted"}),DIRTY=d=>({status:"dirty",value:d}),OK=d=>({status:"valid",value:d}),isAborted=d=>d.status==="aborted",isDirty=d=>d.status==="dirty",isValid=d=>d.status==="valid",isAsync=d=>typeof Promise<"u"&&d instanceof Promise;function __classPrivateFieldGet(d,m,g,w){if(typeof m=="function"?d!==m||!0:!m.has(d))throw new TypeError("Cannot read private member from an object whose class did not declare it");return m.get(d)}function __classPrivateFieldSet(d,m,g,w,I){if(typeof m=="function"?d!==m||!0:!m.has(d))throw new TypeError("Cannot write private member to an object whose class did not declare it");return m.set(d,g),g}var errorUtil,_ZodEnum_cache,_ZodNativeEnum_cache;typeof SuppressedError=="function"&&SuppressedError,function(d){d.errToObj=m=>typeof m=="string"?{message:m}:m||{},d.toString=m=>typeof m=="string"?m:m?.message}(errorUtil||(errorUtil={}));class ParseInputLazyPath{constructor(m,g,w,I){this._cachedPath=[],this.parent=m,this.data=g,this._path=w,this._key=I}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const handleResult=(d,m)=>{if(isValid(m))return{success:!0,data:m.value};if(!d.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const g=new ZodError(d.common.issues);return this._error=g,this._error}}};function processCreateParams(d){if(!d)return{};const{errorMap:m,invalid_type_error:g,required_error:w,description:I}=d;if(m&&(g||w))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return m?{errorMap:m,description:I}:{errorMap:(P,F)=>{var D,U;const{message:Z}=d;return P.code==="invalid_enum_value"?{message:Z??F.defaultError}:F.data===void 0?{message:(D=Z??w)!==null&&D!==void 0?D:F.defaultError}:P.code!=="invalid_type"?{message:F.defaultError}:{message:(U=Z??g)!==null&&U!==void 0?U:F.defaultError}},description:I}}class ZodType{constructor(m){this.spa=this.safeParseAsync,this._def=m,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(m){return getParsedType(m.data)}_getOrReturnCtx(m,g){return g||{common:m.parent.common,data:m.data,parsedType:getParsedType(m.data),schemaErrorMap:this._def.errorMap,path:m.path,parent:m.parent}}_processInputParams(m){return{status:new ParseStatus,ctx:{common:m.parent.common,data:m.data,parsedType:getParsedType(m.data),schemaErrorMap:this._def.errorMap,path:m.path,parent:m.parent}}}_parseSync(m){const g=this._parse(m);if(isAsync(g))throw new Error("Synchronous parse encountered promise.");return g}_parseAsync(m){const g=this._parse(m);return Promise.resolve(g)}parse(m,g){const w=this.safeParse(m,g);if(w.success)return w.data;throw w.error}safeParse(m,g){var w;const I={common:{issues:[],async:(w=g?.async)!==null&&w!==void 0&&w,contextualErrorMap:g?.errorMap},path:g?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:m,parsedType:getParsedType(m)},P=this._parseSync({data:m,path:I.path,parent:I});return handleResult(I,P)}async parseAsync(m,g){const w=await this.safeParseAsync(m,g);if(w.success)return w.data;throw w.error}async safeParseAsync(m,g){const w={common:{issues:[],contextualErrorMap:g?.errorMap,async:!0},path:g?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:m,parsedType:getParsedType(m)},I=this._parse({data:m,path:w.path,parent:w}),P=await(isAsync(I)?I:Promise.resolve(I));return handleResult(w,P)}refine(m,g){const w=I=>typeof g=="string"||g===void 0?{message:g}:typeof g=="function"?g(I):g;return this._refinement((I,P)=>{const F=m(I),D=()=>P.addIssue({code:ZodIssueCode.custom,...w(I)});return typeof Promise<"u"&&F instanceof Promise?F.then(U=>!!U||(D(),!1)):!!F||(D(),!1)})}refinement(m,g){return this._refinement((w,I)=>!!m(w)||(I.addIssue(typeof g=="function"?g(w,I):g),!1))}_refinement(m){return new ZodEffects({schema:this,typeName:ZodFirstPartyTypeKind.ZodEffects,effect:{type:"refinement",refinement:m}})}superRefine(m){return this._refinement(m)}optional(){return ZodOptional.create(this,this._def)}nullable(){return ZodNullable.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return ZodArray.create(this,this._def)}promise(){return ZodPromise.create(this,this._def)}or(m){return ZodUnion.create([this,m],this._def)}and(m){return ZodIntersection.create(this,m,this._def)}transform(m){return new ZodEffects({...processCreateParams(this._def),schema:this,typeName:ZodFirstPartyTypeKind.ZodEffects,effect:{type:"transform",transform:m}})}default(m){const g=typeof m=="function"?m:()=>m;return new ZodDefault({...processCreateParams(this._def),innerType:this,defaultValue:g,typeName:ZodFirstPartyTypeKind.ZodDefault})}brand(){return new ZodBranded({typeName:ZodFirstPartyTypeKind.ZodBranded,type:this,...processCreateParams(this._def)})}catch(m){const g=typeof m=="function"?m:()=>m;return new ZodCatch({...processCreateParams(this._def),innerType:this,catchValue:g,typeName:ZodFirstPartyTypeKind.ZodCatch})}describe(m){return new this.constructor({...this._def,description:m})}pipe(m){return ZodPipeline.create(this,m)}readonly(){return ZodReadonly.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const cuidRegex=/^c[^\s-]{8,}$/i,cuid2Regex=/^[0-9a-z]+$/,ulidRegex=/^[0-9A-HJKMNP-TV-Z]{26}$/,uuidRegex=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,nanoidRegex=/^[a-z0-9_-]{21}$/i,durationRegex=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,emailRegex=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,_emojiRegex="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let emojiRegex;const ipv4Regex=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv6Regex=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,base64Regex=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,dateRegexSource="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",dateRegex=new RegExp(`^${dateRegexSource}$`);function timeRegexSource(d){let m="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return d.precision?m=`${m}\\.\\d{${d.precision}}`:d.precision==null&&(m=`${m}(\\.\\d+)?`),m}function timeRegex(d){return new RegExp(`^${timeRegexSource(d)}$`)}function datetimeRegex(d){let m=`${dateRegexSource}T${timeRegexSource(d)}`;const g=[];return g.push(d.local?"Z?":"Z"),d.offset&&g.push("([+-]\\d{2}:?\\d{2})"),m=`${m}(${g.join("|")})`,new RegExp(`^${m}$`)}function isValidIP(d,m){return!(m!=="v4"&&m||!ipv4Regex.test(d))||!(m!=="v6"&&m||!ipv6Regex.test(d))}class ZodString extends ZodType{_parse(m){if(this._def.coerce&&(m.data=String(m.data)),this._getType(m)!==ZodParsedType.string){const I=this._getOrReturnCtx(m);return addIssueToContext(I,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.string,received:I.parsedType}),INVALID}const g=new ParseStatus;let w;for(const I of this._def.checks)if(I.kind==="min")m.data.length<I.value&&(w=this._getOrReturnCtx(m,w),addIssueToContext(w,{code:ZodIssueCode.too_small,minimum:I.value,type:"string",inclusive:!0,exact:!1,message:I.message}),g.dirty());else if(I.kind==="max")m.data.length>I.value&&(w=this._getOrReturnCtx(m,w),addIssueToContext(w,{code:ZodIssueCode.too_big,maximum:I.value,type:"string",inclusive:!0,exact:!1,message:I.message}),g.dirty());else if(I.kind==="length"){const P=m.data.length>I.value,F=m.data.length<I.value;(P||F)&&(w=this._getOrReturnCtx(m,w),P?addIssueToContext(w,{code:ZodIssueCode.too_big,maximum:I.value,type:"string",inclusive:!0,exact:!0,message:I.message}):F&&addIssueToContext(w,{code:ZodIssueCode.too_small,minimum:I.value,type:"string",inclusive:!0,exact:!0,message:I.message}),g.dirty())}else if(I.kind==="email")emailRegex.test(m.data)||(w=this._getOrReturnCtx(m,w),addIssueToContext(w,{validation:"email",code:ZodIssueCode.invalid_string,message:I.message}),g.dirty());else if(I.kind==="emoji")emojiRegex||(emojiRegex=new RegExp(_emojiRegex,"u")),emojiRegex.test(m.data)||(w=this._getOrReturnCtx(m,w),addIssueToContext(w,{validation:"emoji",code:ZodIssueCode.invalid_string,message:I.message}),g.dirty());else if(I.kind==="uuid")uuidRegex.test(m.data)||(w=this._getOrReturnCtx(m,w),addIssueToContext(w,{validation:"uuid",code:ZodIssueCode.invalid_string,message:I.message}),g.dirty());else if(I.kind==="nanoid")nanoidRegex.test(m.data)||(w=this._getOrReturnCtx(m,w),addIssueToContext(w,{validation:"nanoid",code:ZodIssueCode.invalid_string,message:I.message}),g.dirty());else if(I.kind==="cuid")cuidRegex.test(m.data)||(w=this._getOrReturnCtx(m,w),addIssueToContext(w,{validation:"cuid",code:ZodIssueCode.invalid_string,message:I.message}),g.dirty());else if(I.kind==="cuid2")cuid2Regex.test(m.data)||(w=this._getOrReturnCtx(m,w),addIssueToContext(w,{validation:"cuid2",code:ZodIssueCode.invalid_string,message:I.message}),g.dirty());else if(I.kind==="ulid")ulidRegex.test(m.data)||(w=this._getOrReturnCtx(m,w),addIssueToContext(w,{validation:"ulid",code:ZodIssueCode.invalid_string,message:I.message}),g.dirty());else if(I.kind==="url")try{new URL(m.data)}catch{w=this._getOrReturnCtx(m,w),addIssueToContext(w,{validation:"url",code:ZodIssueCode.invalid_string,message:I.message}),g.dirty()}else I.kind==="regex"?(I.regex.lastIndex=0,I.regex.test(m.data)||(w=this._getOrReturnCtx(m,w),addIssueToContext(w,{validation:"regex",code:ZodIssueCode.invalid_string,message:I.message}),g.dirty())):I.kind==="trim"?m.data=m.data.trim():I.kind==="includes"?m.data.includes(I.value,I.position)||(w=this._getOrReturnCtx(m,w),addIssueToContext(w,{code:ZodIssueCode.invalid_string,validation:{includes:I.value,position:I.position},message:I.message}),g.dirty()):I.kind==="toLowerCase"?m.data=m.data.toLowerCase():I.kind==="toUpperCase"?m.data=m.data.toUpperCase():I.kind==="startsWith"?m.data.startsWith(I.value)||(w=this._getOrReturnCtx(m,w),addIssueToContext(w,{code:ZodIssueCode.invalid_string,validation:{startsWith:I.value},message:I.message}),g.dirty()):I.kind==="endsWith"?m.data.endsWith(I.value)||(w=this._getOrReturnCtx(m,w),addIssueToContext(w,{code:ZodIssueCode.invalid_string,validation:{endsWith:I.value},message:I.message}),g.dirty()):I.kind==="datetime"?datetimeRegex(I).test(m.data)||(w=this._getOrReturnCtx(m,w),addIssueToContext(w,{code:ZodIssueCode.invalid_string,validation:"datetime",message:I.message}),g.dirty()):I.kind==="date"?dateRegex.test(m.data)||(w=this._getOrReturnCtx(m,w),addIssueToContext(w,{code:ZodIssueCode.invalid_string,validation:"date",message:I.message}),g.dirty()):I.kind==="time"?timeRegex(I).test(m.data)||(w=this._getOrReturnCtx(m,w),addIssueToContext(w,{code:ZodIssueCode.invalid_string,validation:"time",message:I.message}),g.dirty()):I.kind==="duration"?durationRegex.test(m.data)||(w=this._getOrReturnCtx(m,w),addIssueToContext(w,{validation:"duration",code:ZodIssueCode.invalid_string,message:I.message}),g.dirty()):I.kind==="ip"?isValidIP(m.data,I.version)||(w=this._getOrReturnCtx(m,w),addIssueToContext(w,{validation:"ip",code:ZodIssueCode.invalid_string,message:I.message}),g.dirty()):I.kind==="base64"?base64Regex.test(m.data)||(w=this._getOrReturnCtx(m,w),addIssueToContext(w,{validation:"base64",code:ZodIssueCode.invalid_string,message:I.message}),g.dirty()):util$1.assertNever(I);return{status:g.value,value:m.data}}_regex(m,g,w){return this.refinement(I=>m.test(I),{validation:g,code:ZodIssueCode.invalid_string,...errorUtil.errToObj(w)})}_addCheck(m){return new ZodString({...this._def,checks:[...this._def.checks,m]})}email(m){return this._addCheck({kind:"email",...errorUtil.errToObj(m)})}url(m){return this._addCheck({kind:"url",...errorUtil.errToObj(m)})}emoji(m){return this._addCheck({kind:"emoji",...errorUtil.errToObj(m)})}uuid(m){return this._addCheck({kind:"uuid",...errorUtil.errToObj(m)})}nanoid(m){return this._addCheck({kind:"nanoid",...errorUtil.errToObj(m)})}cuid(m){return this._addCheck({kind:"cuid",...errorUtil.errToObj(m)})}cuid2(m){return this._addCheck({kind:"cuid2",...errorUtil.errToObj(m)})}ulid(m){return this._addCheck({kind:"ulid",...errorUtil.errToObj(m)})}base64(m){return this._addCheck({kind:"base64",...errorUtil.errToObj(m)})}ip(m){return this._addCheck({kind:"ip",...errorUtil.errToObj(m)})}datetime(m){var g,w;return typeof m=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:m}):this._addCheck({kind:"datetime",precision:m?.precision===void 0?null:m?.precision,offset:(g=m?.offset)!==null&&g!==void 0&&g,local:(w=m?.local)!==null&&w!==void 0&&w,...errorUtil.errToObj(m?.message)})}date(m){return this._addCheck({kind:"date",message:m})}time(m){return typeof m=="string"?this._addCheck({kind:"time",precision:null,message:m}):this._addCheck({kind:"time",precision:m?.precision===void 0?null:m?.precision,...errorUtil.errToObj(m?.message)})}duration(m){return this._addCheck({kind:"duration",...errorUtil.errToObj(m)})}regex(m,g){return this._addCheck({kind:"regex",regex:m,...errorUtil.errToObj(g)})}includes(m,g){return this._addCheck({kind:"includes",value:m,position:g?.position,...errorUtil.errToObj(g?.message)})}startsWith(m,g){return this._addCheck({kind:"startsWith",value:m,...errorUtil.errToObj(g)})}endsWith(m,g){return this._addCheck({kind:"endsWith",value:m,...errorUtil.errToObj(g)})}min(m,g){return this._addCheck({kind:"min",value:m,...errorUtil.errToObj(g)})}max(m,g){return this._addCheck({kind:"max",value:m,...errorUtil.errToObj(g)})}length(m,g){return this._addCheck({kind:"length",value:m,...errorUtil.errToObj(g)})}nonempty(m){return this.min(1,errorUtil.errToObj(m))}trim(){return new ZodString({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new ZodString({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new ZodString({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(m=>m.kind==="datetime")}get isDate(){return!!this._def.checks.find(m=>m.kind==="date")}get isTime(){return!!this._def.checks.find(m=>m.kind==="time")}get isDuration(){return!!this._def.checks.find(m=>m.kind==="duration")}get isEmail(){return!!this._def.checks.find(m=>m.kind==="email")}get isURL(){return!!this._def.checks.find(m=>m.kind==="url")}get isEmoji(){return!!this._def.checks.find(m=>m.kind==="emoji")}get isUUID(){return!!this._def.checks.find(m=>m.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(m=>m.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(m=>m.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(m=>m.kind==="cuid2")}get isULID(){return!!this._def.checks.find(m=>m.kind==="ulid")}get isIP(){return!!this._def.checks.find(m=>m.kind==="ip")}get isBase64(){return!!this._def.checks.find(m=>m.kind==="base64")}get minLength(){let m=null;for(const g of this._def.checks)g.kind==="min"&&(m===null||g.value>m)&&(m=g.value);return m}get maxLength(){let m=null;for(const g of this._def.checks)g.kind==="max"&&(m===null||g.value<m)&&(m=g.value);return m}}function floatSafeRemainder(d,m){const g=(d.toString().split(".")[1]||"").length,w=(m.toString().split(".")[1]||"").length,I=g>w?g:w;return parseInt(d.toFixed(I).replace(".",""))%parseInt(m.toFixed(I).replace(".",""))/Math.pow(10,I)}ZodString.create=d=>{var m;return new ZodString({checks:[],typeName:ZodFirstPartyTypeKind.ZodString,coerce:(m=d?.coerce)!==null&&m!==void 0&&m,...processCreateParams(d)})};class ZodNumber extends ZodType{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(m){if(this._def.coerce&&(m.data=Number(m.data)),this._getType(m)!==ZodParsedType.number){const I=this._getOrReturnCtx(m);return addIssueToContext(I,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.number,received:I.parsedType}),INVALID}let g;const w=new ParseStatus;for(const I of this._def.checks)I.kind==="int"?util$1.isInteger(m.data)||(g=this._getOrReturnCtx(m,g),addIssueToContext(g,{code:ZodIssueCode.invalid_type,expected:"integer",received:"float",message:I.message}),w.dirty()):I.kind==="min"?(I.inclusive?m.data<I.value:m.data<=I.value)&&(g=this._getOrReturnCtx(m,g),addIssueToContext(g,{code:ZodIssueCode.too_small,minimum:I.value,type:"number",inclusive:I.inclusive,exact:!1,message:I.message}),w.dirty()):I.kind==="max"?(I.inclusive?m.data>I.value:m.data>=I.value)&&(g=this._getOrReturnCtx(m,g),addIssueToContext(g,{code:ZodIssueCode.too_big,maximum:I.value,type:"number",inclusive:I.inclusive,exact:!1,message:I.message}),w.dirty()):I.kind==="multipleOf"?floatSafeRemainder(m.data,I.value)!==0&&(g=this._getOrReturnCtx(m,g),addIssueToContext(g,{code:ZodIssueCode.not_multiple_of,multipleOf:I.value,message:I.message}),w.dirty()):I.kind==="finite"?Number.isFinite(m.data)||(g=this._getOrReturnCtx(m,g),addIssueToContext(g,{code:ZodIssueCode.not_finite,message:I.message}),w.dirty()):util$1.assertNever(I);return{status:w.value,value:m.data}}gte(m,g){return this.setLimit("min",m,!0,errorUtil.toString(g))}gt(m,g){return this.setLimit("min",m,!1,errorUtil.toString(g))}lte(m,g){return this.setLimit("max",m,!0,errorUtil.toString(g))}lt(m,g){return this.setLimit("max",m,!1,errorUtil.toString(g))}setLimit(m,g,w,I){return new ZodNumber({...this._def,checks:[...this._def.checks,{kind:m,value:g,inclusive:w,message:errorUtil.toString(I)}]})}_addCheck(m){return new ZodNumber({...this._def,checks:[...this._def.checks,m]})}int(m){return this._addCheck({kind:"int",message:errorUtil.toString(m)})}positive(m){return this._addCheck({kind:"min",value:0,inclusive:!1,message:errorUtil.toString(m)})}negative(m){return this._addCheck({kind:"max",value:0,inclusive:!1,message:errorUtil.toString(m)})}nonpositive(m){return this._addCheck({kind:"max",value:0,inclusive:!0,message:errorUtil.toString(m)})}nonnegative(m){return this._addCheck({kind:"min",value:0,inclusive:!0,message:errorUtil.toString(m)})}multipleOf(m,g){return this._addCheck({kind:"multipleOf",value:m,message:errorUtil.toString(g)})}finite(m){return this._addCheck({kind:"finite",message:errorUtil.toString(m)})}safe(m){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:errorUtil.toString(m)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:errorUtil.toString(m)})}get minValue(){let m=null;for(const g of this._def.checks)g.kind==="min"&&(m===null||g.value>m)&&(m=g.value);return m}get maxValue(){let m=null;for(const g of this._def.checks)g.kind==="max"&&(m===null||g.value<m)&&(m=g.value);return m}get isInt(){return!!this._def.checks.find(m=>m.kind==="int"||m.kind==="multipleOf"&&util$1.isInteger(m.value))}get isFinite(){let m=null,g=null;for(const w of this._def.checks){if(w.kind==="finite"||w.kind==="int"||w.kind==="multipleOf")return!0;w.kind==="min"?(g===null||w.value>g)&&(g=w.value):w.kind==="max"&&(m===null||w.value<m)&&(m=w.value)}return Number.isFinite(g)&&Number.isFinite(m)}}ZodNumber.create=d=>new ZodNumber({checks:[],typeName:ZodFirstPartyTypeKind.ZodNumber,coerce:d?.coerce||!1,...processCreateParams(d)});class ZodBigInt extends ZodType{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(m){if(this._def.coerce&&(m.data=BigInt(m.data)),this._getType(m)!==ZodParsedType.bigint){const I=this._getOrReturnCtx(m);return addIssueToContext(I,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.bigint,received:I.parsedType}),INVALID}let g;const w=new ParseStatus;for(const I of this._def.checks)I.kind==="min"?(I.inclusive?m.data<I.value:m.data<=I.value)&&(g=this._getOrReturnCtx(m,g),addIssueToContext(g,{code:ZodIssueCode.too_small,type:"bigint",minimum:I.value,inclusive:I.inclusive,message:I.message}),w.dirty()):I.kind==="max"?(I.inclusive?m.data>I.value:m.data>=I.value)&&(g=this._getOrReturnCtx(m,g),addIssueToContext(g,{code:ZodIssueCode.too_big,type:"bigint",maximum:I.value,inclusive:I.inclusive,message:I.message}),w.dirty()):I.kind==="multipleOf"?m.data%I.value!==BigInt(0)&&(g=this._getOrReturnCtx(m,g),addIssueToContext(g,{code:ZodIssueCode.not_multiple_of,multipleOf:I.value,message:I.message}),w.dirty()):util$1.assertNever(I);return{status:w.value,value:m.data}}gte(m,g){return this.setLimit("min",m,!0,errorUtil.toString(g))}gt(m,g){return this.setLimit("min",m,!1,errorUtil.toString(g))}lte(m,g){return this.setLimit("max",m,!0,errorUtil.toString(g))}lt(m,g){return this.setLimit("max",m,!1,errorUtil.toString(g))}setLimit(m,g,w,I){return new ZodBigInt({...this._def,checks:[...this._def.checks,{kind:m,value:g,inclusive:w,message:errorUtil.toString(I)}]})}_addCheck(m){return new ZodBigInt({...this._def,checks:[...this._def.checks,m]})}positive(m){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:errorUtil.toString(m)})}negative(m){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:errorUtil.toString(m)})}nonpositive(m){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:errorUtil.toString(m)})}nonnegative(m){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:errorUtil.toString(m)})}multipleOf(m,g){return this._addCheck({kind:"multipleOf",value:m,message:errorUtil.toString(g)})}get minValue(){let m=null;for(const g of this._def.checks)g.kind==="min"&&(m===null||g.value>m)&&(m=g.value);return m}get maxValue(){let m=null;for(const g of this._def.checks)g.kind==="max"&&(m===null||g.value<m)&&(m=g.value);return m}}ZodBigInt.create=d=>{var m;return new ZodBigInt({checks:[],typeName:ZodFirstPartyTypeKind.ZodBigInt,coerce:(m=d?.coerce)!==null&&m!==void 0&&m,...processCreateParams(d)})};class ZodBoolean extends ZodType{_parse(m){if(this._def.coerce&&(m.data=!!m.data),this._getType(m)!==ZodParsedType.boolean){const g=this._getOrReturnCtx(m);return addIssueToContext(g,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.boolean,received:g.parsedType}),INVALID}return OK(m.data)}}ZodBoolean.create=d=>new ZodBoolean({typeName:ZodFirstPartyTypeKind.ZodBoolean,coerce:d?.coerce||!1,...processCreateParams(d)});class ZodDate extends ZodType{_parse(m){if(this._def.coerce&&(m.data=new Date(m.data)),this._getType(m)!==ZodParsedType.date){const I=this._getOrReturnCtx(m);return addIssueToContext(I,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.date,received:I.parsedType}),INVALID}if(isNaN(m.data.getTime()))return addIssueToContext(this._getOrReturnCtx(m),{code:ZodIssueCode.invalid_date}),INVALID;const g=new ParseStatus;let w;for(const I of this._def.checks)I.kind==="min"?m.data.getTime()<I.value&&(w=this._getOrReturnCtx(m,w),addIssueToContext(w,{code:ZodIssueCode.too_small,message:I.message,inclusive:!0,exact:!1,minimum:I.value,type:"date"}),g.dirty()):I.kind==="max"?m.data.getTime()>I.value&&(w=this._getOrReturnCtx(m,w),addIssueToContext(w,{code:ZodIssueCode.too_big,message:I.message,inclusive:!0,exact:!1,maximum:I.value,type:"date"}),g.dirty()):util$1.assertNever(I);return{status:g.value,value:new Date(m.data.getTime())}}_addCheck(m){return new ZodDate({...this._def,checks:[...this._def.checks,m]})}min(m,g){return this._addCheck({kind:"min",value:m.getTime(),message:errorUtil.toString(g)})}max(m,g){return this._addCheck({kind:"max",value:m.getTime(),message:errorUtil.toString(g)})}get minDate(){let m=null;for(const g of this._def.checks)g.kind==="min"&&(m===null||g.value>m)&&(m=g.value);return m!=null?new Date(m):null}get maxDate(){let m=null;for(const g of this._def.checks)g.kind==="max"&&(m===null||g.value<m)&&(m=g.value);return m!=null?new Date(m):null}}ZodDate.create=d=>new ZodDate({checks:[],coerce:d?.coerce||!1,typeName:ZodFirstPartyTypeKind.ZodDate,...processCreateParams(d)});class ZodSymbol extends ZodType{_parse(m){if(this._getType(m)!==ZodParsedType.symbol){const g=this._getOrReturnCtx(m);return addIssueToContext(g,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.symbol,received:g.parsedType}),INVALID}return OK(m.data)}}ZodSymbol.create=d=>new ZodSymbol({typeName:ZodFirstPartyTypeKind.ZodSymbol,...processCreateParams(d)});class ZodUndefined extends ZodType{_parse(m){if(this._getType(m)!==ZodParsedType.undefined){const g=this._getOrReturnCtx(m);return addIssueToContext(g,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.undefined,received:g.parsedType}),INVALID}return OK(m.data)}}ZodUndefined.create=d=>new ZodUndefined({typeName:ZodFirstPartyTypeKind.ZodUndefined,...processCreateParams(d)});class ZodNull extends ZodType{_parse(m){if(this._getType(m)!==ZodParsedType.null){const g=this._getOrReturnCtx(m);return addIssueToContext(g,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.null,received:g.parsedType}),INVALID}return OK(m.data)}}ZodNull.create=d=>new ZodNull({typeName:ZodFirstPartyTypeKind.ZodNull,...processCreateParams(d)});class ZodAny extends ZodType{constructor(){super(...arguments),this._any=!0}_parse(m){return OK(m.data)}}ZodAny.create=d=>new ZodAny({typeName:ZodFirstPartyTypeKind.ZodAny,...processCreateParams(d)});class ZodUnknown extends ZodType{constructor(){super(...arguments),this._unknown=!0}_parse(m){return OK(m.data)}}ZodUnknown.create=d=>new ZodUnknown({typeName:ZodFirstPartyTypeKind.ZodUnknown,...processCreateParams(d)});class ZodNever extends ZodType{_parse(m){const g=this._getOrReturnCtx(m);return addIssueToContext(g,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.never,received:g.parsedType}),INVALID}}ZodNever.create=d=>new ZodNever({typeName:ZodFirstPartyTypeKind.ZodNever,...processCreateParams(d)});class ZodVoid extends ZodType{_parse(m){if(this._getType(m)!==ZodParsedType.undefined){const g=this._getOrReturnCtx(m);return addIssueToContext(g,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.void,received:g.parsedType}),INVALID}return OK(m.data)}}ZodVoid.create=d=>new ZodVoid({typeName:ZodFirstPartyTypeKind.ZodVoid,...processCreateParams(d)});class ZodArray extends ZodType{_parse(m){const{ctx:g,status:w}=this._processInputParams(m),I=this._def;if(g.parsedType!==ZodParsedType.array)return addIssueToContext(g,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.array,received:g.parsedType}),INVALID;if(I.exactLength!==null){const F=g.data.length>I.exactLength.value,D=g.data.length<I.exactLength.value;(F||D)&&(addIssueToContext(g,{code:F?ZodIssueCode.too_big:ZodIssueCode.too_small,minimum:D?I.exactLength.value:void 0,maximum:F?I.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:I.exactLength.message}),w.dirty())}if(I.minLength!==null&&g.data.length<I.minLength.value&&(addIssueToContext(g,{code:ZodIssueCode.too_small,minimum:I.minLength.value,type:"array",inclusive:!0,exact:!1,message:I.minLength.message}),w.dirty()),I.maxLength!==null&&g.data.length>I.maxLength.value&&(addIssueToContext(g,{code:ZodIssueCode.too_big,maximum:I.maxLength.value,type:"array",inclusive:!0,exact:!1,message:I.maxLength.message}),w.dirty()),g.common.async)return Promise.all([...g.data].map((F,D)=>I.type._parseAsync(new ParseInputLazyPath(g,F,g.path,D)))).then(F=>ParseStatus.mergeArray(w,F));const P=[...g.data].map((F,D)=>I.type._parseSync(new ParseInputLazyPath(g,F,g.path,D)));return ParseStatus.mergeArray(w,P)}get element(){return this._def.type}min(m,g){return new ZodArray({...this._def,minLength:{value:m,message:errorUtil.toString(g)}})}max(m,g){return new ZodArray({...this._def,maxLength:{value:m,message:errorUtil.toString(g)}})}length(m,g){return new ZodArray({...this._def,exactLength:{value:m,message:errorUtil.toString(g)}})}nonempty(m){return this.min(1,m)}}function deepPartialify(d){if(d instanceof ZodObject){const m={};for(const g in d.shape){const w=d.shape[g];m[g]=ZodOptional.create(deepPartialify(w))}return new ZodObject({...d._def,shape:()=>m})}return d instanceof ZodArray?new ZodArray({...d._def,type:deepPartialify(d.element)}):d instanceof ZodOptional?ZodOptional.create(deepPartialify(d.unwrap())):d instanceof ZodNullable?ZodNullable.create(deepPartialify(d.unwrap())):d instanceof ZodTuple?ZodTuple.create(d.items.map(m=>deepPartialify(m))):d}ZodArray.create=(d,m)=>new ZodArray({type:d,minLength:null,maxLength:null,exactLength:null,typeName:ZodFirstPartyTypeKind.ZodArray,...processCreateParams(m)});class ZodObject extends ZodType{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const m=this._def.shape(),g=util$1.objectKeys(m);return this._cached={shape:m,keys:g}}_parse(m){if(this._getType(m)!==ZodParsedType.object){const U=this._getOrReturnCtx(m);return addIssueToContext(U,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.object,received:U.parsedType}),INVALID}const{status:g,ctx:w}=this._processInputParams(m),{shape:I,keys:P}=this._getCached(),F=[];if(!(this._def.catchall instanceof ZodNever&&this._def.unknownKeys==="strip"))for(const U in w.data)P.includes(U)||F.push(U);const D=[];for(const U of P){const Z=I[U],$=w.data[U];D.push({key:{status:"valid",value:U},value:Z._parse(new ParseInputLazyPath(w,$,w.path,U)),alwaysSet:U in w.data})}if(this._def.catchall instanceof ZodNever){const U=this._def.unknownKeys;if(U==="passthrough")for(const Z of F)D.push({key:{status:"valid",value:Z},value:{status:"valid",value:w.data[Z]}});else if(U==="strict")F.length>0&&(addIssueToContext(w,{code:ZodIssueCode.unrecognized_keys,keys:F}),g.dirty());else if(U!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const U=this._def.catchall;for(const Z of F){const $=w.data[Z];D.push({key:{status:"valid",value:Z},value:U._parse(new ParseInputLazyPath(w,$,w.path,Z)),alwaysSet:Z in w.data})}}return w.common.async?Promise.resolve().then(async()=>{const U=[];for(const Z of D){const $=await Z.key,j=await Z.value;U.push({key:$,value:j,alwaysSet:Z.alwaysSet})}return U}).then(U=>ParseStatus.mergeObjectSync(g,U)):ParseStatus.mergeObjectSync(g,D)}get shape(){return this._def.shape()}strict(m){return errorUtil.errToObj,new ZodObject({...this._def,unknownKeys:"strict",...m!==void 0?{errorMap:(g,w)=>{var I,P,F,D;const U=(F=(P=(I=this._def).errorMap)===null||P===void 0?void 0:P.call(I,g,w).message)!==null&&F!==void 0?F:w.defaultError;return g.code==="unrecognized_keys"?{message:(D=errorUtil.errToObj(m).message)!==null&&D!==void 0?D:U}:{message:U}}}:{}})}strip(){return new ZodObject({...this._def,unknownKeys:"strip"})}passthrough(){return new ZodObject({...this._def,unknownKeys:"passthrough"})}extend(m){return new ZodObject({...this._def,shape:()=>({...this._def.shape(),...m})})}merge(m){return new ZodObject({unknownKeys:m._def.unknownKeys,catchall:m._def.catchall,shape:()=>({...this._def.shape(),...m._def.shape()}),typeName:ZodFirstPartyTypeKind.ZodObject})}setKey(m,g){return this.augment({[m]:g})}catchall(m){return new ZodObject({...this._def,catchall:m})}pick(m){const g={};return util$1.objectKeys(m).forEach(w=>{m[w]&&this.shape[w]&&(g[w]=this.shape[w])}),new ZodObject({...this._def,shape:()=>g})}omit(m){const g={};return util$1.objectKeys(this.shape).forEach(w=>{m[w]||(g[w]=this.shape[w])}),new ZodObject({...this._def,shape:()=>g})}deepPartial(){return deepPartialify(this)}partial(m){const g={};return util$1.objectKeys(this.shape).forEach(w=>{const I=this.shape[w];m&&!m[w]?g[w]=I:g[w]=I.optional()}),new ZodObject({...this._def,shape:()=>g})}required(m){const g={};return util$1.objectKeys(this.shape).forEach(w=>{if(m&&!m[w])g[w]=this.shape[w];else{let I=this.shape[w];for(;I instanceof ZodOptional;)I=I._def.innerType;g[w]=I}}),new ZodObject({...this._def,shape:()=>g})}keyof(){return createZodEnum(util$1.objectKeys(this.shape))}}ZodObject.create=(d,m)=>new ZodObject({shape:()=>d,unknownKeys:"strip",catchall:ZodNever.create(),typeName:ZodFirstPartyTypeKind.ZodObject,...processCreateParams(m)}),ZodObject.strictCreate=(d,m)=>new ZodObject({shape:()=>d,unknownKeys:"strict",catchall:ZodNever.create(),typeName:ZodFirstPartyTypeKind.ZodObject,...processCreateParams(m)}),ZodObject.lazycreate=(d,m)=>new ZodObject({shape:d,unknownKeys:"strip",catchall:ZodNever.create(),typeName:ZodFirstPartyTypeKind.ZodObject,...processCreateParams(m)});class ZodUnion extends ZodType{_parse(m){const{ctx:g}=this._processInputParams(m),w=this._def.options;if(g.common.async)return Promise.all(w.map(async I=>{const P={...g,common:{...g.common,issues:[]},parent:null};return{result:await I._parseAsync({data:g.data,path:g.path,parent:P}),ctx:P}})).then(function(I){for(const F of I)if(F.result.status==="valid")return F.result;for(const F of I)if(F.result.status==="dirty")return g.common.issues.push(...F.ctx.common.issues),F.result;const P=I.map(F=>new ZodError(F.ctx.common.issues));return addIssueToContext(g,{code:ZodIssueCode.invalid_union,unionErrors:P}),INVALID});{let I;const P=[];for(const D of w){const U={...g,common:{...g.common,issues:[]},parent:null},Z=D._parseSync({data:g.data,path:g.path,parent:U});if(Z.status==="valid")return Z;Z.status!=="dirty"||I||(I={result:Z,ctx:U}),U.common.issues.length&&P.push(U.common.issues)}if(I)return g.common.issues.push(...I.ctx.common.issues),I.result;const F=P.map(D=>new ZodError(D));return addIssueToContext(g,{code:ZodIssueCode.invalid_union,unionErrors:F}),INVALID}}get options(){return this._def.options}}ZodUnion.create=(d,m)=>new ZodUnion({options:d,typeName:ZodFirstPartyTypeKind.ZodUnion,...processCreateParams(m)});const getDiscriminator=d=>d instanceof ZodLazy?getDiscriminator(d.schema):d instanceof ZodEffects?getDiscriminator(d.innerType()):d instanceof ZodLiteral?[d.value]:d instanceof ZodEnum?d.options:d instanceof ZodNativeEnum?util$1.objectValues(d.enum):d instanceof ZodDefault?getDiscriminator(d._def.innerType):d instanceof ZodUndefined?[void 0]:d instanceof ZodNull?[null]:d instanceof ZodOptional?[void 0,...getDiscriminator(d.unwrap())]:d instanceof ZodNullable?[null,...getDiscriminator(d.unwrap())]:d instanceof ZodBranded||d instanceof ZodReadonly?getDiscriminator(d.unwrap()):d instanceof ZodCatch?getDiscriminator(d._def.innerType):[];class ZodDiscriminatedUnion extends ZodType{_parse(m){const{ctx:g}=this._processInputParams(m);if(g.parsedType!==ZodParsedType.object)return addIssueToContext(g,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.object,received:g.parsedType}),INVALID;const w=this.discriminator,I=g.data[w],P=this.optionsMap.get(I);return P?g.common.async?P._parseAsync({data:g.data,path:g.path,parent:g}):P._parseSync({data:g.data,path:g.path,parent:g}):(addIssueToContext(g,{code:ZodIssueCode.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[w]}),INVALID)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(m,g,w){const I=new Map;for(const P of g){const F=getDiscriminator(P.shape[m]);if(!F.length)throw new Error(`A discriminator value for key \`${m}\` could not be extracted from all schema options`);for(const D of F){if(I.has(D))throw new Error(`Discriminator property ${String(m)} has duplicate value ${String(D)}`);I.set(D,P)}}return new ZodDiscriminatedUnion({typeName:ZodFirstPartyTypeKind.ZodDiscriminatedUnion,discriminator:m,options:g,optionsMap:I,...processCreateParams(w)})}}function mergeValues(d,m){const g=getParsedType(d),w=getParsedType(m);if(d===m)return{valid:!0,data:d};if(g===ZodParsedType.object&&w===ZodParsedType.object){const I=util$1.objectKeys(m),P=util$1.objectKeys(d).filter(D=>I.indexOf(D)!==-1),F={...d,...m};for(const D of P){const U=mergeValues(d[D],m[D]);if(!U.valid)return{valid:!1};F[D]=U.data}return{valid:!0,data:F}}if(g===ZodParsedType.array&&w===ZodParsedType.array){if(d.length!==m.length)return{valid:!1};const I=[];for(let P=0;P<d.length;P++){const F=mergeValues(d[P],m[P]);if(!F.valid)return{valid:!1};I.push(F.data)}return{valid:!0,data:I}}return g===ZodParsedType.date&&w===ZodParsedType.date&&+d==+m?{valid:!0,data:d}:{valid:!1}}class ZodIntersection extends ZodType{_parse(m){const{status:g,ctx:w}=this._processInputParams(m),I=(P,F)=>{if(isAborted(P)||isAborted(F))return INVALID;const D=mergeValues(P.value,F.value);return D.valid?((isDirty(P)||isDirty(F))&&g.dirty(),{status:g.value,value:D.data}):(addIssueToContext(w,{code:ZodIssueCode.invalid_intersection_types}),INVALID)};return w.common.async?Promise.all([this._def.left._parseAsync({data:w.data,path:w.path,parent:w}),this._def.right._parseAsync({data:w.data,path:w.path,parent:w})]).then(([P,F])=>I(P,F)):I(this._def.left._parseSync({data:w.data,path:w.path,parent:w}),this._def.right._parseSync({data:w.data,path:w.path,parent:w}))}}ZodIntersection.create=(d,m,g)=>new ZodIntersection({left:d,right:m,typeName:ZodFirstPartyTypeKind.ZodIntersection,...processCreateParams(g)});class ZodTuple extends ZodType{_parse(m){const{status:g,ctx:w}=this._processInputParams(m);if(w.parsedType!==ZodParsedType.array)return addIssueToContext(w,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.array,received:w.parsedType}),INVALID;if(w.data.length<this._def.items.length)return addIssueToContext(w,{code:ZodIssueCode.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),INVALID;!this._def.rest&&w.data.length>this._def.items.length&&(addIssueToContext(w,{code:ZodIssueCode.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),g.dirty());const I=[...w.data].map((P,F)=>{const D=this._def.items[F]||this._def.rest;return D?D._parse(new ParseInputLazyPath(w,P,w.path,F)):null}).filter(P=>!!P);return w.common.async?Promise.all(I).then(P=>ParseStatus.mergeArray(g,P)):ParseStatus.mergeArray(g,I)}get items(){return this._def.items}rest(m){return new ZodTuple({...this._def,rest:m})}}ZodTuple.create=(d,m)=>{if(!Array.isArray(d))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new ZodTuple({items:d,typeName:ZodFirstPartyTypeKind.ZodTuple,rest:null,...processCreateParams(m)})};class ZodRecord extends ZodType{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(m){const{status:g,ctx:w}=this._processInputParams(m);if(w.parsedType!==ZodParsedType.object)return addIssueToContext(w,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.object,received:w.parsedType}),INVALID;const I=[],P=this._def.keyType,F=this._def.valueType;for(const D in w.data)I.push({key:P._parse(new ParseInputLazyPath(w,D,w.path,D)),value:F._parse(new ParseInputLazyPath(w,w.data[D],w.path,D)),alwaysSet:D in w.data});return w.common.async?ParseStatus.mergeObjectAsync(g,I):ParseStatus.mergeObjectSync(g,I)}get element(){return this._def.valueType}static create(m,g,w){return new ZodRecord(g instanceof ZodType?{keyType:m,valueType:g,typeName:ZodFirstPartyTypeKind.ZodRecord,...processCreateParams(w)}:{keyType:ZodString.create(),valueType:m,typeName:ZodFirstPartyTypeKind.ZodRecord,...processCreateParams(g)})}}class ZodMap extends ZodType{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(m){const{status:g,ctx:w}=this._processInputParams(m);if(w.parsedType!==ZodParsedType.map)return addIssueToContext(w,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.map,received:w.parsedType}),INVALID;const I=this._def.keyType,P=this._def.valueType,F=[...w.data.entries()].map(([D,U],Z)=>({key:I._parse(new ParseInputLazyPath(w,D,w.path,[Z,"key"])),value:P._parse(new ParseInputLazyPath(w,U,w.path,[Z,"value"]))}));if(w.common.async){const D=new Map;return Promise.resolve().then(async()=>{for(const U of F){const Z=await U.key,$=await U.value;if(Z.status==="aborted"||$.status==="aborted")return INVALID;Z.status!=="dirty"&&$.status!=="dirty"||g.dirty(),D.set(Z.value,$.value)}return{status:g.value,value:D}})}{const D=new Map;for(const U of F){const Z=U.key,$=U.value;if(Z.status==="aborted"||$.status==="aborted")return INVALID;Z.status!=="dirty"&&$.status!=="dirty"||g.dirty(),D.set(Z.value,$.value)}return{status:g.value,value:D}}}}ZodMap.create=(d,m,g)=>new ZodMap({valueType:m,keyType:d,typeName:ZodFirstPartyTypeKind.ZodMap,...processCreateParams(g)});class ZodSet extends ZodType{_parse(m){const{status:g,ctx:w}=this._processInputParams(m);if(w.parsedType!==ZodParsedType.set)return addIssueToContext(w,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.set,received:w.parsedType}),INVALID;const I=this._def;I.minSize!==null&&w.data.size<I.minSize.value&&(addIssueToContext(w,{code:ZodIssueCode.too_small,minimum:I.minSize.value,type:"set",inclusive:!0,exact:!1,message:I.minSize.message}),g.dirty()),I.maxSize!==null&&w.data.size>I.maxSize.value&&(addIssueToContext(w,{code:ZodIssueCode.too_big,maximum:I.maxSize.value,type:"set",inclusive:!0,exact:!1,message:I.maxSize.message}),g.dirty());const P=this._def.valueType;function F(U){const Z=new Set;for(const $ of U){if($.status==="aborted")return INVALID;$.status==="dirty"&&g.dirty(),Z.add($.value)}return{status:g.value,value:Z}}const D=[...w.data.values()].map((U,Z)=>P._parse(new ParseInputLazyPath(w,U,w.path,Z)));return w.common.async?Promise.all(D).then(U=>F(U)):F(D)}min(m,g){return new ZodSet({...this._def,minSize:{value:m,message:errorUtil.toString(g)}})}max(m,g){return new ZodSet({...this._def,maxSize:{value:m,message:errorUtil.toString(g)}})}size(m,g){return this.min(m,g).max(m,g)}nonempty(m){return this.min(1,m)}}ZodSet.create=(d,m)=>new ZodSet({valueType:d,minSize:null,maxSize:null,typeName:ZodFirstPartyTypeKind.ZodSet,...processCreateParams(m)});class ZodFunction extends ZodType{constructor(){super(...arguments),this.validate=this.implement}_parse(m){const{ctx:g}=this._processInputParams(m);if(g.parsedType!==ZodParsedType.function)return addIssueToContext(g,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.function,received:g.parsedType}),INVALID;function w(D,U){return makeIssue({data:D,path:g.path,errorMaps:[g.common.contextualErrorMap,g.schemaErrorMap,getErrorMap(),errorMap].filter(Z=>!!Z),issueData:{code:ZodIssueCode.invalid_arguments,argumentsError:U}})}function I(D,U){return makeIssue({data:D,path:g.path,errorMaps:[g.common.contextualErrorMap,g.schemaErrorMap,getErrorMap(),errorMap].filter(Z=>!!Z),issueData:{code:ZodIssueCode.invalid_return_type,returnTypeError:U}})}const P={errorMap:g.common.contextualErrorMap},F=g.data;if(this._def.returns instanceof ZodPromise){const D=this;return OK(async function(...U){const Z=new ZodError([]),$=await D._def.args.parseAsync(U,P).catch(W=>{throw Z.addIssue(w(U,W)),Z}),j=await Reflect.apply(F,this,$);return await D._def.returns._def.type.parseAsync(j,P).catch(W=>{throw Z.addIssue(I(j,W)),Z})})}{const D=this;return OK(function(...U){const Z=D._def.args.safeParse(U,P);if(!Z.success)throw new ZodError([w(U,Z.error)]);const $=Reflect.apply(F,this,Z.data),j=D._def.returns.safeParse($,P);if(!j.success)throw new ZodError([I($,j.error)]);return j.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...m){return new ZodFunction({...this._def,args:ZodTuple.create(m).rest(ZodUnknown.create())})}returns(m){return new ZodFunction({...this._def,returns:m})}implement(m){return this.parse(m)}strictImplement(m){return this.parse(m)}static create(m,g,w){return new ZodFunction({args:m||ZodTuple.create([]).rest(ZodUnknown.create()),returns:g||ZodUnknown.create(),typeName:ZodFirstPartyTypeKind.ZodFunction,...processCreateParams(w)})}}class ZodLazy extends ZodType{get schema(){return this._def.getter()}_parse(m){const{ctx:g}=this._processInputParams(m);return this._def.getter()._parse({data:g.data,path:g.path,parent:g})}}ZodLazy.create=(d,m)=>new ZodLazy({getter:d,typeName:ZodFirstPartyTypeKind.ZodLazy,...processCreateParams(m)});class ZodLiteral extends ZodType{_parse(m){if(m.data!==this._def.value){const g=this._getOrReturnCtx(m);return addIssueToContext(g,{received:g.data,code:ZodIssueCode.invalid_literal,expected:this._def.value}),INVALID}return{status:"valid",value:m.data}}get value(){return this._def.value}}function createZodEnum(d,m){return new ZodEnum({values:d,typeName:ZodFirstPartyTypeKind.ZodEnum,...processCreateParams(m)})}ZodLiteral.create=(d,m)=>new ZodLiteral({value:d,typeName:ZodFirstPartyTypeKind.ZodLiteral,...processCreateParams(m)});class ZodEnum extends ZodType{constructor(){super(...arguments),_ZodEnum_cache.set(this,void 0)}_parse(m){if(typeof m.data!="string"){const g=this._getOrReturnCtx(m),w=this._def.values;return addIssueToContext(g,{expected:util$1.joinValues(w),received:g.parsedType,code:ZodIssueCode.invalid_type}),INVALID}if(__classPrivateFieldGet(this,_ZodEnum_cache)||__classPrivateFieldSet(this,_ZodEnum_cache,new Set(this._def.values)),!__classPrivateFieldGet(this,_ZodEnum_cache).has(m.data)){const g=this._getOrReturnCtx(m),w=this._def.values;return addIssueToContext(g,{received:g.data,code:ZodIssueCode.invalid_enum_value,options:w}),INVALID}return OK(m.data)}get options(){return this._def.values}get enum(){const m={};for(const g of this._def.values)m[g]=g;return m}get Values(){const m={};for(const g of this._def.values)m[g]=g;return m}get Enum(){const m={};for(const g of this._def.values)m[g]=g;return m}extract(m,g=this._def){return ZodEnum.create(m,{...this._def,...g})}exclude(m,g=this._def){return ZodEnum.create(this.options.filter(w=>!m.includes(w)),{...this._def,...g})}}_ZodEnum_cache=new WeakMap,ZodEnum.create=createZodEnum;class ZodNativeEnum extends ZodType{constructor(){super(...arguments),_ZodNativeEnum_cache.set(this,void 0)}_parse(m){const g=util$1.getValidEnumValues(this._def.values),w=this._getOrReturnCtx(m);if(w.parsedType!==ZodParsedType.string&&w.parsedType!==ZodParsedType.number){const I=util$1.objectValues(g);return addIssueToContext(w,{expected:util$1.joinValues(I),received:w.parsedType,code:ZodIssueCode.invalid_type}),INVALID}if(__classPrivateFieldGet(this,_ZodNativeEnum_cache)||__classPrivateFieldSet(this,_ZodNativeEnum_cache,new Set(util$1.getValidEnumValues(this._def.values))),!__classPrivateFieldGet(this,_ZodNativeEnum_cache).has(m.data)){const I=util$1.objectValues(g);return addIssueToContext(w,{received:w.data,code:ZodIssueCode.invalid_enum_value,options:I}),INVALID}return OK(m.data)}get enum(){return this._def.values}}_ZodNativeEnum_cache=new WeakMap,ZodNativeEnum.create=(d,m)=>new ZodNativeEnum({values:d,typeName:ZodFirstPartyTypeKind.ZodNativeEnum,...processCreateParams(m)});class ZodPromise extends ZodType{unwrap(){return this._def.type}_parse(m){const{ctx:g}=this._processInputParams(m);if(g.parsedType!==ZodParsedType.promise&&g.common.async===!1)return addIssueToContext(g,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.promise,received:g.parsedType}),INVALID;const w=g.parsedType===ZodParsedType.promise?g.data:Promise.resolve(g.data);return OK(w.then(I=>this._def.type.parseAsync(I,{path:g.path,errorMap:g.common.contextualErrorMap})))}}ZodPromise.create=(d,m)=>new ZodPromise({type:d,typeName:ZodFirstPartyTypeKind.ZodPromise,...processCreateParams(m)});class ZodEffects extends ZodType{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===ZodFirstPartyTypeKind.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(m){const{status:g,ctx:w}=this._processInputParams(m),I=this._def.effect||null,P={addIssue:F=>{addIssueToContext(w,F),F.fatal?g.abort():g.dirty()},get path(){return w.path}};if(P.addIssue=P.addIssue.bind(P),I.type==="preprocess"){const F=I.transform(w.data,P);if(w.common.async)return Promise.resolve(F).then(async D=>{if(g.value==="aborted")return INVALID;const U=await this._def.schema._parseAsync({data:D,path:w.path,parent:w});return U.status==="aborted"?INVALID:U.status==="dirty"||g.value==="dirty"?DIRTY(U.value):U});{if(g.value==="aborted")return INVALID;const D=this._def.schema._parseSync({data:F,path:w.path,parent:w});return D.status==="aborted"?INVALID:D.status==="dirty"||g.value==="dirty"?DIRTY(D.value):D}}if(I.type==="refinement"){const F=D=>{const U=I.refinement(D,P);if(w.common.async)return Promise.resolve(U);if(U instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return D};if(w.common.async===!1){const D=this._def.schema._parseSync({data:w.data,path:w.path,parent:w});return D.status==="aborted"?INVALID:(D.status==="dirty"&&g.dirty(),F(D.value),{status:g.value,value:D.value})}return this._def.schema._parseAsync({data:w.data,path:w.path,parent:w}).then(D=>D.status==="aborted"?INVALID:(D.status==="dirty"&&g.dirty(),F(D.value).then(()=>({status:g.value,value:D.value}))))}if(I.type==="transform"){if(w.common.async===!1){const F=this._def.schema._parseSync({data:w.data,path:w.path,parent:w});if(!isValid(F))return F;const D=I.transform(F.value,P);if(D instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:g.value,value:D}}return this._def.schema._parseAsync({data:w.data,path:w.path,parent:w}).then(F=>isValid(F)?Promise.resolve(I.transform(F.value,P)).then(D=>({status:g.value,value:D})):F)}util$1.assertNever(I)}}ZodEffects.create=(d,m,g)=>new ZodEffects({schema:d,typeName:ZodFirstPartyTypeKind.ZodEffects,effect:m,...processCreateParams(g)}),ZodEffects.createWithPreprocess=(d,m,g)=>new ZodEffects({schema:m,effect:{type:"preprocess",transform:d},typeName:ZodFirstPartyTypeKind.ZodEffects,...processCreateParams(g)});class ZodOptional extends ZodType{_parse(m){return this._getType(m)===ZodParsedType.undefined?OK(void 0):this._def.innerType._parse(m)}unwrap(){return this._def.innerType}}ZodOptional.create=(d,m)=>new ZodOptional({innerType:d,typeName:ZodFirstPartyTypeKind.ZodOptional,...processCreateParams(m)});class ZodNullable extends ZodType{_parse(m){return this._getType(m)===ZodParsedType.null?OK(null):this._def.innerType._parse(m)}unwrap(){return this._def.innerType}}ZodNullable.create=(d,m)=>new ZodNullable({innerType:d,typeName:ZodFirstPartyTypeKind.ZodNullable,...processCreateParams(m)});class ZodDefault extends ZodType{_parse(m){const{ctx:g}=this._processInputParams(m);let w=g.data;return g.parsedType===ZodParsedType.undefined&&(w=this._def.defaultValue()),this._def.innerType._parse({data:w,path:g.path,parent:g})}removeDefault(){return this._def.innerType}}ZodDefault.create=(d,m)=>new ZodDefault({innerType:d,typeName:ZodFirstPartyTypeKind.ZodDefault,defaultValue:typeof m.default=="function"?m.default:()=>m.default,...processCreateParams(m)});class ZodCatch extends ZodType{_parse(m){const{ctx:g}=this._processInputParams(m),w={...g,common:{...g.common,issues:[]}},I=this._def.innerType._parse({data:w.data,path:w.path,parent:{...w}});return isAsync(I)?I.then(P=>({status:"valid",value:P.status==="valid"?P.value:this._def.catchValue({get error(){return new ZodError(w.common.issues)},input:w.data})})):{status:"valid",value:I.status==="valid"?I.value:this._def.catchValue({get error(){return new ZodError(w.common.issues)},input:w.data})}}removeCatch(){return this._def.innerType}}ZodCatch.create=(d,m)=>new ZodCatch({innerType:d,typeName:ZodFirstPartyTypeKind.ZodCatch,catchValue:typeof m.catch=="function"?m.catch:()=>m.catch,...processCreateParams(m)});class ZodNaN extends ZodType{_parse(m){if(this._getType(m)!==ZodParsedType.nan){const g=this._getOrReturnCtx(m);return addIssueToContext(g,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.nan,received:g.parsedType}),INVALID}return{status:"valid",value:m.data}}}ZodNaN.create=d=>new ZodNaN({typeName:ZodFirstPartyTypeKind.ZodNaN,...processCreateParams(d)});const BRAND=Symbol("zod_brand");class ZodBranded extends ZodType{_parse(m){const{ctx:g}=this._processInputParams(m),w=g.data;return this._def.type._parse({data:w,path:g.path,parent:g})}unwrap(){return this._def.type}}class ZodPipeline extends ZodType{_parse(m){const{status:g,ctx:w}=this._processInputParams(m);if(w.common.async)return(async()=>{const I=await this._def.in._parseAsync({data:w.data,path:w.path,parent:w});return I.status==="aborted"?INVALID:I.status==="dirty"?(g.dirty(),DIRTY(I.value)):this._def.out._parseAsync({data:I.value,path:w.path,parent:w})})();{const I=this._def.in._parseSync({data:w.data,path:w.path,parent:w});return I.status==="aborted"?INVALID:I.status==="dirty"?(g.dirty(),{status:"dirty",value:I.value}):this._def.out._parseSync({data:I.value,path:w.path,parent:w})}}static create(m,g){return new ZodPipeline({in:m,out:g,typeName:ZodFirstPartyTypeKind.ZodPipeline})}}class ZodReadonly extends ZodType{_parse(m){const g=this._def.innerType._parse(m),w=I=>(isValid(I)&&(I.value=Object.freeze(I.value)),I);return isAsync(g)?g.then(I=>w(I)):w(g)}unwrap(){return this._def.innerType}}function custom(d,m={},g){return d?ZodAny.create().superRefine((w,I)=>{var P,F;if(!d(w)){const D=typeof m=="function"?m(w):typeof m=="string"?{message:m}:m,U=(F=(P=D.fatal)!==null&&P!==void 0?P:g)===null||F===void 0||F,Z=typeof D=="string"?{message:D}:D;I.addIssue({code:"custom",...Z,fatal:U})}}):ZodAny.create()}ZodReadonly.create=(d,m)=>new ZodReadonly({innerType:d,typeName:ZodFirstPartyTypeKind.ZodReadonly,...processCreateParams(m)});const late={object:ZodObject.lazycreate};var ZodFirstPartyTypeKind;(function(d){d.ZodString="ZodString",d.ZodNumber="ZodNumber",d.ZodNaN="ZodNaN",d.ZodBigInt="ZodBigInt",d.ZodBoolean="ZodBoolean",d.ZodDate="ZodDate",d.ZodSymbol="ZodSymbol",d.ZodUndefined="ZodUndefined",d.ZodNull="ZodNull",d.ZodAny="ZodAny",d.ZodUnknown="ZodUnknown",d.ZodNever="ZodNever",d.ZodVoid="ZodVoid",d.ZodArray="ZodArray",d.ZodObject="ZodObject",d.ZodUnion="ZodUnion",d.ZodDiscriminatedUnion="ZodDiscriminatedUnion",d.ZodIntersection="ZodIntersection",d.ZodTuple="ZodTuple",d.ZodRecord="ZodRecord",d.ZodMap="ZodMap",d.ZodSet="ZodSet",d.ZodFunction="ZodFunction",d.ZodLazy="ZodLazy",d.ZodLiteral="ZodLiteral",d.ZodEnum="ZodEnum",d.ZodEffects="ZodEffects",d.ZodNativeEnum="ZodNativeEnum",d.ZodOptional="ZodOptional",d.ZodNullable="ZodNullable",d.ZodDefault="ZodDefault",d.ZodCatch="ZodCatch",d.ZodPromise="ZodPromise",d.ZodBranded="ZodBranded",d.ZodPipeline="ZodPipeline",d.ZodReadonly="ZodReadonly"})(ZodFirstPartyTypeKind||(ZodFirstPartyTypeKind={}));const instanceOfType=(d,m={message:`Input not instance of ${d.name}`})=>custom(g=>g instanceof d,m),stringType=ZodString.create,numberType=ZodNumber.create,nanType=ZodNaN.create,bigIntType=ZodBigInt.create,booleanType=ZodBoolean.create,dateType=ZodDate.create,symbolType=ZodSymbol.create,undefinedType=ZodUndefined.create,nullType=ZodNull.create,anyType=ZodAny.create,unknownType=ZodUnknown.create,neverType=ZodNever.create,voidType=ZodVoid.create,arrayType=ZodArray.create,objectType=ZodObject.create,strictObjectType=ZodObject.strictCreate,unionType=ZodUnion.create,discriminatedUnionType=ZodDiscriminatedUnion.create,intersectionType=ZodIntersection.create,tupleType=ZodTuple.create,recordType=ZodRecord.create,mapType=ZodMap.create,setType=ZodSet.create,functionType=ZodFunction.create,lazyType=ZodLazy.create,literalType=ZodLiteral.create,enumType=ZodEnum.create,nativeEnumType=ZodNativeEnum.create,promiseType=ZodPromise.create,effectsType=ZodEffects.create,optionalType=ZodOptional.create,nullableType=ZodNullable.create,preprocessType=ZodEffects.createWithPreprocess,pipelineType=ZodPipeline.create,ostring=()=>stringType().optional(),onumber=()=>numberType().optional(),oboolean=()=>booleanType().optional(),coerce={string:d=>ZodString.create({...d,coerce:!0}),number:d=>ZodNumber.create({...d,coerce:!0}),boolean:d=>ZodBoolean.create({...d,coerce:!0}),bigint:d=>ZodBigInt.create({...d,coerce:!0}),date:d=>ZodDate.create({...d,coerce:!0})},NEVER=INVALID;var z=Object.freeze({__proto__:null,defaultErrorMap:errorMap,setErrorMap,getErrorMap,makeIssue,EMPTY_PATH,addIssueToContext,ParseStatus,INVALID,DIRTY,OK,isAborted,isDirty,isValid,isAsync,get util(){return util$1},get objectUtil(){return objectUtil},ZodParsedType,getParsedType,ZodType,datetimeRegex,ZodString,ZodNumber,ZodBigInt,ZodBoolean,ZodDate,ZodSymbol,ZodUndefined,ZodNull,ZodAny,ZodUnknown,ZodNever,ZodVoid,ZodArray,ZodObject,ZodUnion,ZodDiscriminatedUnion,ZodIntersection,ZodTuple,ZodRecord,ZodMap,ZodSet,ZodFunction,ZodLazy,ZodLiteral,ZodEnum,ZodNativeEnum,ZodPromise,ZodEffects,ZodTransformer:ZodEffects,ZodOptional,ZodNullable,ZodDefault,ZodCatch,ZodNaN,BRAND,ZodBranded,ZodPipeline,ZodReadonly,custom,Schema:ZodType,ZodSchema:ZodType,late,get ZodFirstPartyTypeKind(){return ZodFirstPartyTypeKind},coerce,any:anyType,array:arrayType,bigint:bigIntType,boolean:booleanType,date:dateType,discriminatedUnion:discriminatedUnionType,effect:effectsType,enum:enumType,function:functionType,instanceof:instanceOfType,intersection:intersectionType,lazy:lazyType,literal:literalType,map:mapType,nan:nanType,nativeEnum:nativeEnumType,never:neverType,null:nullType,nullable:nullableType,number:numberType,object:objectType,oboolean,onumber,optional:optionalType,ostring,pipeline:pipelineType,preprocess:preprocessType,promise:promiseType,record:recordType,set:setType,strictObject:strictObjectType,string:stringType,symbol:symbolType,transformer:effectsType,tuple:tupleType,undefined:undefinedType,union:unionType,unknown:unknownType,void:voidType,NEVER,ZodIssueCode,quotelessJson,ZodError}),Edge,Edge2;Edge2=Edge||(Edge={}),Edge2[Edge2.EXTEND=1]="EXTEND",Edge2[Edge2.WRAP=2]="WRAP",Edge2[Edge2.CROP=3]="CROP";const JimpClassSchema=z.object({bitmap:z.object({data:z.union([z.instanceof(Buffer$2),z.instanceof(Uint8Array)]),width:z.number(),height:z.number()})}),BlitOptionsSchemaComplex=z.object({src:JimpClassSchema,x:z.number().optional(),y:z.number().optional(),srcX:z.number().optional(),srcY:z.number().optional(),srcW:z.number().optional(),srcH:z.number().optional()}),BlitOptionsSchema=z.union([JimpClassSchema,BlitOptionsSchemaComplex]),methods$h={blit(d,m){const g=BlitOptionsSchema.parse(m);let{src:w,x:I=0,y:P=0,srcX:F=0,srcY:D=0,srcW:U=w.bitmap.width,srcH:Z=w.bitmap.height}="bitmap"in g?{src:g}:g;if(!("bitmap"in w))throw new Error("The source must be a Jimp image");if(typeof I!="number"||typeof P!="number")throw new Error("x and y must be numbers");I=Math.round(I),P=Math.round(P),F=Math.round(F),D=Math.round(D),U=Math.round(U),Z=Math.round(Z);const $=d.bitmap.width,j=d.bitmap.height;return scan(w,F,D,U,Z,function(H,W,V){const Q=I+H-F,K=P+W-D;if(Q>=0&&K>=0&&$-Q>0&&j-K>0){const q=d.getPixelIndex(Q,K),et={r:w.bitmap.data[V]||0,g:w.bitmap.data[V+1]||0,b:w.bitmap.data[V+2]||0,a:w.bitmap.data[V+3]||0},X={r:d.bitmap.data[q]||0,g:d.bitmap.data[q+1]||0,b:d.bitmap.data[q+2]||0,a:d.bitmap.data[q+3]||0};d.bitmap.data[q]=(et.a*(et.r-X.r)-X.r+255>>8)+X.r,d.bitmap.data[q+1]=(et.a*(et.g-X.g)-X.g+255>>8)+X.g,d.bitmap.data[q+2]=(et.a*(et.b-X.b)-X.b+255>>8)+X.b,d.bitmap.data[q+3]=limit255(X.a+et.a)}}),d}},mulTable=[1,57,41,21,203,34,97,73,227,91,149,62,105,45,39,137,241,107,3,173,39,71,65,238,219,101,187,87,81,151,141,133,249,117,221,209,197,187,177,169,5,153,73,139,133,127,243,233,223,107,103,99,191,23,177,171,165,159,77,149,9,139,135,131,253,245,119,231,224,109,211,103,25,195,189,23,45,175,171,83,81,79,155,151,147,9,141,137,67,131,129,251,123,30,235,115,113,221,217,53,13,51,50,49,193,189,185,91,179,175,43,169,83,163,5,79,155,19,75,147,145,143,35,69,17,67,33,65,255,251,247,243,239,59,29,229,113,111,219,27,213,105,207,51,201,199,49,193,191,47,93,183,181,179,11,87,43,85,167,165,163,161,159,157,155,77,19,75,37,73,145,143,141,35,138,137,135,67,33,131,129,255,63,250,247,61,121,239,237,117,29,229,227,225,111,55,109,216,213,211,209,207,205,203,201,199,197,195,193,48,190,47,93,185,183,181,179,178,176,175,173,171,85,21,167,165,41,163,161,5,79,157,78,154,153,19,75,149,74,147,73,144,143,71,141,140,139,137,17,135,134,133,66,131,65,129,1],shgTable=[0,9,10,10,14,12,14,14,16,15,16,15,16,15,15,17,18,17,12,18,16,17,17,19,19,18,19,18,18,19,19,19,20,19,20,20,20,20,20,20,15,20,19,20,20,20,21,21,21,20,20,20,21,18,21,21,21,21,20,21,17,21,21,21,22,22,21,22,22,21,22,21,19,22,22,19,20,22,22,21,21,21,22,22,22,18,22,22,21,22,22,23,22,20,23,22,22,23,23,21,19,21,21,21,23,23,23,22,23,23,21,23,22,23,18,22,23,20,22,23,23,23,21,22,20,22,21,22,24,24,24,24,24,22,21,24,23,23,24,21,24,23,24,22,24,24,22,24,24,22,23,24,24,24,20,23,22,23,24,24,24,24,24,24,24,23,21,23,22,23,24,24,24,22,24,24,24,23,22,24,24,25,23,25,25,23,24,25,25,24,22,25,25,25,24,23,24,25,25,25,25,25,25,25,25,25,25,25,25,23,25,23,24,25,25,25,25,25,25,25,25,25,24,22,25,25,23,25,25,20,24,25,24,25,25,22,24,25,24,25,24,25,25,24,25,25,25,25,22,25,25,25,24,25,24,25,18],methods$g={blur(d,m){if(typeof m!="number")throw new Error("r must be a number");if(m<1)throw new Error("r must be greater than 0");let g,w,I,P,F,D,U,Z,$,j,H,W,V;const Q=d.bitmap.width-1,K=d.bitmap.height-1,q=m+1,et=mulTable[m],X=shgTable[m],tt=[],rt=[],ot=[],J=[],lt=[],st=[];let ut=2;for(;ut-- >0;){for(W=0,V=0,D=0;D<d.bitmap.height;D++){for(g=d.bitmap.data[V]*q,w=d.bitmap.data[V+1]*q,I=d.bitmap.data[V+2]*q,P=d.bitmap.data[V+3]*q,U=1;U<=m;U++)Z=V+((U>Q?Q:U)<<2),g+=d.bitmap.data[Z++],w+=d.bitmap.data[Z++],I+=d.bitmap.data[Z++],P+=d.bitmap.data[Z];for(F=0;F<d.bitmap.width;F++)tt[W]=g,rt[W]=w,ot[W]=I,J[W]=P,D===0&&(lt[F]=((Z=F+q)<Q?Z:Q)<<2,st[F]=(Z=F-m)>0?Z<<2:0),$=V+lt[F],j=V+st[F],g+=d.bitmap.data[$++]-d.bitmap.data[j++],w+=d.bitmap.data[$++]-d.bitmap.data[j++],I+=d.bitmap.data[$++]-d.bitmap.data[j++],P+=d.bitmap.data[$]-d.bitmap.data[j++],W++;V+=d.bitmap.width<<2}for(F=0;F<d.bitmap.width;F++){for(H=F,g=tt[H]*q,w=rt[H]*q,I=ot[H]*q,P=J[H]*q,U=1;U<=m;U++)H+=U>K?0:d.bitmap.width,g+=tt[H],w+=rt[H],I+=ot[H],P+=J[H];for(W=F<<2,D=0;D<d.bitmap.height;D++)d.bitmap.data[W]=limit255(g*et>>>X),d.bitmap.data[W+1]=limit255(w*et>>>X),d.bitmap.data[W+2]=limit255(I*et>>>X),d.bitmap.data[W+3]=limit255(P*et>>>X),F===0&&(lt[D]=((Z=D+q)<K?Z:K)*d.bitmap.width,st[D]=(Z=D-m)>0?Z*d.bitmap.width:0),$=F+lt[D],j=F+st[D],g+=tt[$]-tt[j],w+=rt[$]-rt[j],I+=ot[$]-ot[j],P+=J[$]-J[j],W+=d.bitmap.width<<2}}return d},gaussian(d,m){if(typeof m!="number")throw new Error("r must be a number");if(m<1)throw new Error("r must be greater than 0");const g=Math.ceil(2.57*m),w=2*g+1,I=m*m*2,P=I*Math.PI,F=[];for(let D=0;D<w;D++){const U=[];for(let Z=0;Z<w;Z++){const $=(Z-g)**2+(D-g)**2;U[Z]=Math.exp(-$/I)/P}F.push(U)}for(let D=0;D<d.bitmap.height;D++)for(let U=0;U<d.bitmap.width;U++){let Z=0,$=0,j=0,H=0,W=0;for(let V=0;V<w;V++){for(let K=0;K<w;K++){const q=Math.min(d.bitmap.width-1,Math.max(0,K+U-g)),et=Math.min(d.bitmap.height-1,Math.max(0,V+D-g)),X=F[V][K],tt=et*d.bitmap.width+q<<2;Z+=d.bitmap.data[tt]*X,$+=d.bitmap.data[tt+1]*X,j+=d.bitmap.data[tt+2]*X,H+=d.bitmap.data[tt+3]*X,W+=X}const Q=D*d.bitmap.width+U<<2;d.bitmap.data[Q]=Math.round(Z/W),d.bitmap.data[Q+1]=Math.round($/W),d.bitmap.data[Q+2]=Math.round(j/W),d.bitmap.data[Q+3]=Math.round(H/W)}}return d}},CircleOptionsSchema=z.object({x:z.number().optional(),y:z.number().optional(),radius:z.number().min(0).optional()}),methods$f={circle(d,m={}){const g=CircleOptionsSchema.parse(m),w=g.radius||(d.bitmap.width>d.bitmap.height?d.bitmap.height:d.bitmap.width)/2,I=typeof g.x=="number"?g.x:d.bitmap.width/2,P=typeof g.y=="number"?g.y:d.bitmap.height/2;return d.scan((F,D,U)=>{const Z=Math.sqrt(Math.pow(F-I,2)+Math.pow(D-P,2));w-Z<=0?d.bitmap.data[U+3]=0:w-Z<1&&(d.bitmap.data[U+3]=255*(w-Z))}),d}},ConvolutionMatrixSchema=z.array(z.number()).min(1).array(),ConvolutionComplexOptionsSchema=z.object({kernel:ConvolutionMatrixSchema,edgeHandling:z.nativeEnum(Edge).optional()}),ConvolutionOptionsSchema=z.union([ConvolutionMatrixSchema,ConvolutionComplexOptionsSchema]),ConvoluteComplexOptionsSchema=z.object({kernel:ConvolutionMatrixSchema,x:z.number().optional(),y:z.number().optional(),w:z.number().optional(),h:z.number().optional()}),ConvoluteOptionsSchema=z.union([ConvolutionMatrixSchema,ConvoluteComplexOptionsSchema]),PixelateSize=z.number().min(1).max(1/0),PixelateComplexOptionsSchema=z.object({size:PixelateSize,x:z.number().optional(),y:z.number().optional(),w:z.number().optional(),h:z.number().optional()}),PixelateOptionsSchema=z.union([PixelateSize,PixelateComplexOptionsSchema]);function applyKernel(d,m,g,w){const I=[0,0,0,0],P=(m.length-1)/2;for(let F=0;F<m.length;F+=1)for(let D=0;D<m[F].length;D+=1){const U=d.getPixelIndex(g+F-P,w+D-P);I[0]+=d.bitmap.data[U]*m[F][D],I[1]+=d.bitmap.data[U+1]*m[F][D],I[2]+=d.bitmap.data[U+2]*m[F][D],I[3]+=d.bitmap.data[U+3]*m[F][D]}return I}function mix(d,m,g=50){return{r:(m.r-d.r)*(g/100)+d.r,g:(m.g-d.g)*(g/100)+d.g,b:(m.b-d.b)*(g/100)+d.b}}const HueActionSchema=z.object({apply:z.literal("hue"),params:z.tuple([z.number().min(-360).max(360)])}),SpinActionSchema=z.object({apply:z.literal("spin"),params:z.tuple([z.number().min(-360).max(360)])}),LightenActionSchema=z.object({apply:z.literal("lighten"),params:z.tuple([z.number().min(0).max(100)]).optional()}),RGBColorSchema=z.object({r:z.number().min(0).max(255),g:z.number().min(0).max(255),b:z.number().min(0).max(255)}),MixActionSchema=z.object({apply:z.literal("mix"),params:z.union([z.tuple([RGBColorSchema]),z.tuple([RGBColorSchema,z.number().min(0).max(100)])])}),TintActionSchema=z.object({apply:z.literal("tint"),params:z.tuple([z.number().min(0).max(100)]).optional()}),ShadeActionSchema=z.object({apply:z.literal("shade"),params:z.tuple([z.number().min(0).max(100)]).optional()}),XorActionSchema=z.object({apply:z.literal("xor"),params:z.tuple([RGBColorSchema])}),RedActionSchema=z.object({apply:z.literal("red"),params:z.tuple([z.number().min(-255).max(255)])}),GreenActionSchema=z.object({apply:z.literal("green"),params:z.tuple([z.number().min(-255).max(255)])}),BlueActionSchema=z.object({apply:z.literal("blue"),params:z.tuple([z.number().min(-255).max(255)])}),BrightenActionSchema=z.object({apply:z.literal("brighten"),params:z.tuple([z.number().min(0).max(100)]).optional()}),DarkenActionSchema=z.object({apply:z.literal("darken"),params:z.tuple([z.number().min(0).max(100)]).optional()}),DesaturateActionSchema=z.object({apply:z.literal("desaturate"),params:z.tuple([z.number().min(0).max(100)]).optional()}),SaturateActionSchema=z.object({apply:z.literal("saturate"),params:z.tuple([z.number().min(0).max(100)]).optional()}),GrayscaleActionSchema=z.object({apply:z.literal("greyscale"),params:z.tuple([]).optional()}),ColorActionNameSchema=z.union([HueActionSchema,SpinActionSchema,LightenActionSchema,MixActionSchema,TintActionSchema,ShadeActionSchema,XorActionSchema,RedActionSchema,GreenActionSchema,BlueActionSchema,BrightenActionSchema,DarkenActionSchema,DesaturateActionSchema,SaturateActionSchema,GrayscaleActionSchema]);function histogram(d){const m={r:new Array(256).fill(0),g:new Array(256).fill(0),b:new Array(256).fill(0)};return d.scan((g,w,I)=>{m.r[d.bitmap.data[I+0]]++,m.g[d.bitmap.data[I+1]]++,m.b[d.bitmap.data[I+2]]++}),m}const normalizeValue=function(d,m,g){return 255*(d-m)/(g-m)},getBounds=function(d){return[d.findIndex(m=>m>0),255-d.slice().reverse().findIndex(m=>m>0)]},methods$e={normalize(d){const m=histogram(d),g={r:getBounds(m.r),g:getBounds(m.g),b:getBounds(m.b)};return d.scan((w,I,P)=>{const F=d.bitmap.data[P+0],D=d.bitmap.data[P+1],U=d.bitmap.data[P+2];d.bitmap.data[P+0]=normalizeValue(F,g.r[0],g.r[1]),d.bitmap.data[P+1]=normalizeValue(D,g.g[0],g.g[1]),d.bitmap.data[P+2]=normalizeValue(U,g.b[0],g.b[1])}),d},invert:d=>(d.scan((m,g,w)=>{d.bitmap.data[w]=255-d.bitmap.data[w],d.bitmap.data[w+1]=255-d.bitmap.data[w+1],d.bitmap.data[w+2]=255-d.bitmap.data[w+2]}),d),brightness(d,m){if(typeof m!="number")throw new Error("val must be numbers");return d.scan((g,w,I)=>{d.bitmap.data[I]=limit255(d.bitmap.data[I]*m),d.bitmap.data[I+1]=limit255(d.bitmap.data[I+1]*m),d.bitmap.data[I+2]=limit255(d.bitmap.data[I+2]*m)}),d},contrast(d,m){if(typeof m!="number")throw new Error("val must be numbers");if(m<-1||m>1)throw new Error("val must be a number between -1 and +1");const g=(m+1)/(1-m);function w(I){return(I=Math.floor(g*(I-127)+127))<0?0:I>255?255:I}return d.scan((I,P,F)=>{d.bitmap.data[F]=w(d.bitmap.data[F]),d.bitmap.data[F+1]=w(d.bitmap.data[F+1]),d.bitmap.data[F+2]=w(d.bitmap.data[F+2])}),d},posterize(d,m){if(typeof m!="number")throw new Error("n must be numbers");return m<2&&(m=2),d.scan((g,w,I)=>{const P=d.bitmap.data[I],F=d.bitmap.data[I+1],D=d.bitmap.data[I+2];d.bitmap.data[I]=Math.floor(P/255*(m-1))/(m-1)*255,d.bitmap.data[I+1]=Math.floor(F/255*(m-1))/(m-1)*255,d.bitmap.data[I+2]=Math.floor(D/255*(m-1))/(m-1)*255}),d},greyscale:d=>(d.scan((m,g,w)=>{const I=.2126*d.bitmap.data[w]+.7152*d.bitmap.data[w+1]+.0722*d.bitmap.data[w+2];d.bitmap.data[w]=I,d.bitmap.data[w+1]=I,d.bitmap.data[w+2]=I}),d),opacity(d,m){if(typeof m!="number")throw new Error("f must be a number");if(m<0||m>1)throw new Error("f must be a number from 0 to 1");return d.scan((g,w,I)=>{const P=d.bitmap.data[I+3]*m;d.bitmap.data[I+3]=P}),d},sepia:d=>(d.scan((m,g,w)=>{let I=d.bitmap.data[w],P=d.bitmap.data[w+1],F=d.bitmap.data[w+2];I=.393*I+.769*P+.189*F,P=.349*I+.686*P+.168*F,F=.272*I+.534*P+.131*F,d.bitmap.data[w]=I<255?I:255,d.bitmap.data[w+1]=P<255?P:255,d.bitmap.data[w+2]=F<255?F:255}),d),fade(d,m){if(typeof m!="number")throw new Error("f must be a number");if(m<0||m>1)throw new Error("f must be a number from 0 to 1");return this.opacity(d,1-m)},convolution(d,m){const g=ConvolutionOptionsSchema.parse(m),{kernel:w,edgeHandling:I=Edge.EXTEND}="kernel"in g?g:{kernel:g,edgeHandling:void 0};if(!w[0])throw new Error("kernel must be a matrix");const P=Buffer$2.from(d.bitmap.data),F=w.length,D=w[0].length,U=Math.floor(F/2),Z=Math.floor(D/2),$=-U,j=-Z;let H,W,V,Q,K,q,et,X,tt,rt;return d.scan((ot,J,lt)=>{Q=0,V=0,W=0;for(let st=$;st<=U;st++)for(let ut=j;ut<=Z;ut++)X=ot+ut,tt=J+st,H=w[st+U][ut+Z],rt=d.getPixelIndex(X,tt,I),rt===-1?(et=0,q=0,K=0):(K=d.bitmap.data[rt+0],q=d.bitmap.data[rt+1],et=d.bitmap.data[rt+2]),W+=H*K,V+=H*q,Q+=H*et;W<0&&(W=0),V<0&&(V=0),Q<0&&(Q=0),W>255&&(W=255),V>255&&(V=255),Q>255&&(Q=255),P[lt+0]=W,P[lt+1]=V,P[lt+2]=Q}),d.bitmap.data=P,d},opaque:d=>(d.scan((m,g,w)=>{d.bitmap.data[w+3]=255}),d),pixelate(d,m){const g=PixelateOptionsSchema.parse(m),{size:w,x:I=0,y:P=0,w:F=d.bitmap.width-I,h:D=d.bitmap.height-P}=typeof g=="number"?{size:g}:g,U=[[1/16,2/16,1/16],[2/16,.25,2/16],[1/16,2/16,1/16]],Z=clone(d);return scan(Z,I,P,F,D,($,j,H)=>{$=w*Math.floor($/w),j=w*Math.floor(j/w);const W=applyKernel(Z,U,$,j);d.bitmap.data[H]=W[0],d.bitmap.data[H+1]=W[1],d.bitmap.data[H+2]=W[2],d.bitmap.data[H+3]=W[3]}),d},convolute(d,m){const g=ConvoluteOptionsSchema.parse(m),{kernel:w,x:I=0,y:P=0,w:F=d.bitmap.width-I,h:D=d.bitmap.height-P}="kernel"in g?g:{kernel:g},U=clone(d);return scan(U,I,P,F,D,(Z,$,j)=>{const H=applyKernel(U,w,Z,$);d.bitmap.data[j]=limit255(H[0]),d.bitmap.data[j+1]=limit255(H[1]),d.bitmap.data[j+2]=limit255(H[2]),d.bitmap.data[j+3]=limit255(H[3])}),d},color(d,m){if(!m||!Array.isArray(m))throw new Error("actions must be an array");return m.forEach(g=>ColorActionNameSchema.parse(g)),m=m.map(g=>(g.apply!=="xor"&&g.apply!=="mix"||(g.params[0]=tinycolor(g.params[0]).toRgb()),g)),d.scan((g,w,I)=>{let P={r:d.bitmap.data[I],g:d.bitmap.data[I+1],b:d.bitmap.data[I+2]};const F=(D,U)=>limit255(P[D]+U);m.forEach(D=>{if(D.apply==="mix")P=mix(P,D.params[0],D.params[1]);else if(D.apply==="tint")P=mix(P,{r:255,g:255,b:255},D.params?.[0]);else if(D.apply==="shade")P=mix(P,{r:0,g:0,b:0},D.params?.[0]);else if(D.apply==="xor")P={r:P.r^D.params[0].r,g:P.g^D.params[0].g,b:P.b^D.params[0].b};else if(D.apply==="red")P.r=F("r",D.params[0]);else if(D.apply==="green")P.g=F("g",D.params[0]);else if(D.apply==="blue")P.b=F("b",D.params[0]);else{D.apply==="hue"&&(D.apply="spin");const U=tinycolor(P),Z=U[D.apply].bind(U);if(!Z)throw new Error("action "+D.apply+" not supported");P=Z(...D.params||[]).toRgb()}}),d.bitmap.data[I]=P.r,d.bitmap.data[I+1]=P.g,d.bitmap.data[I+2]=P.b}),d}};var lib$1={},ieee754={read:function(d,m,g,w,I){var P,F,D=8*I-w-1,U=(1<<D)-1,Z=U>>1,$=-7,j=g?I-1:0,H=g?-1:1,W=d[m+j];for(j+=H,P=W&(1<<-$)-1,W>>=-$,$+=D;$>0;P=256*P+d[m+j],j+=H,$-=8);for(F=P&(1<<-$)-1,P>>=-$,$+=w;$>0;F=256*F+d[m+j],j+=H,$-=8);if(P===0)P=1-Z;else{if(P===U)return F?NaN:1/0*(W?-1:1);F+=Math.pow(2,w),P-=Z}return(W?-1:1)*F*Math.pow(2,P-w)},write:function(d,m,g,w,I,P){var F,D,U,Z=8*P-I-1,$=(1<<Z)-1,j=$>>1,H=I===23?Math.pow(2,-24)-Math.pow(2,-77):0,W=w?0:P-1,V=w?1:-1,Q=m<0||m===0&&1/m<0?1:0;for(m=Math.abs(m),isNaN(m)||m===1/0?(D=isNaN(m)?1:0,F=$):(F=Math.floor(Math.log(m)/Math.LN2),m*(U=Math.pow(2,-F))<1&&(F--,U*=2),(m+=F+j>=1?H/U:H*Math.pow(2,1-j))*U>=2&&(F++,U/=2),F+j>=$?(D=0,F=$):F+j>=1?(D=(m*U-1)*Math.pow(2,I),F+=j):(D=m*Math.pow(2,j-1)*Math.pow(2,I),F=0));I>=8;d[g+W]=255&D,W+=V,D/=256,I-=8);for(F=F<<I|D,Z+=I;Z>0;d[g+W]=255&F,W+=V,F/=256,Z-=8);d[g+W-V]|=128*Q}};(function(d){Object.defineProperty(d,"__esModule",{value:!0}),d.AnsiStringType=d.StringType=d.BufferType=d.Uint8ArrayType=d.IgnoreType=d.Float80_LE=d.Float80_BE=d.Float64_LE=d.Float64_BE=d.Float32_LE=d.Float32_BE=d.Float16_LE=d.Float16_BE=d.INT64_BE=d.UINT64_BE=d.INT64_LE=d.UINT64_LE=d.INT32_LE=d.INT32_BE=d.INT24_BE=d.INT24_LE=d.INT16_LE=d.INT16_BE=d.INT8=d.UINT32_BE=d.UINT32_LE=d.UINT24_BE=d.UINT24_LE=d.UINT16_BE=d.UINT16_LE=d.UINT8=void 0;const m=ieee754;function g(I){return new DataView(I.buffer,I.byteOffset)}d.UINT8={len:1,get:(I,P)=>g(I).getUint8(P),put:(I,P,F)=>(g(I).setUint8(P,F),P+1)},d.UINT16_LE={len:2,get:(I,P)=>g(I).getUint16(P,!0),put:(I,P,F)=>(g(I).setUint16(P,F,!0),P+2)},d.UINT16_BE={len:2,get:(I,P)=>g(I).getUint16(P),put:(I,P,F)=>(g(I).setUint16(P,F),P+2)},d.UINT24_LE={len:3,get(I,P){const F=g(I);return F.getUint8(P)+(F.getUint16(P+1,!0)<<8)},put(I,P,F){const D=g(I);return D.setUint8(P,255&F),D.setUint16(P+1,F>>8,!0),P+3}},d.UINT24_BE={len:3,get(I,P){const F=g(I);return(F.getUint16(P)<<8)+F.getUint8(P+2)},put(I,P,F){const D=g(I);return D.setUint16(P,F>>8),D.setUint8(P+2,255&F),P+3}},d.UINT32_LE={len:4,get:(I,P)=>g(I).getUint32(P,!0),put:(I,P,F)=>(g(I).setUint32(P,F,!0),P+4)},d.UINT32_BE={len:4,get:(I,P)=>g(I).getUint32(P),put:(I,P,F)=>(g(I).setUint32(P,F),P+4)},d.INT8={len:1,get:(I,P)=>g(I).getInt8(P),put:(I,P,F)=>(g(I).setInt8(P,F),P+1)},d.INT16_BE={len:2,get:(I,P)=>g(I).getInt16(P),put:(I,P,F)=>(g(I).setInt16(P,F),P+2)},d.INT16_LE={len:2,get:(I,P)=>g(I).getInt16(P,!0),put:(I,P,F)=>(g(I).setInt16(P,F,!0),P+2)},d.INT24_LE={len:3,get(I,P){const F=d.UINT24_LE.get(I,P);return F>8388607?F-16777216:F},put(I,P,F){const D=g(I);return D.setUint8(P,255&F),D.setUint16(P+1,F>>8,!0),P+3}},d.INT24_BE={len:3,get(I,P){const F=d.UINT24_BE.get(I,P);return F>8388607?F-16777216:F},put(I,P,F){const D=g(I);return D.setUint16(P,F>>8),D.setUint8(P+2,255&F),P+3}},d.INT32_BE={len:4,get:(I,P)=>g(I).getInt32(P),put:(I,P,F)=>(g(I).setInt32(P,F),P+4)},d.INT32_LE={len:4,get:(I,P)=>g(I).getInt32(P,!0),put:(I,P,F)=>(g(I).setInt32(P,F,!0),P+4)},d.UINT64_LE={len:8,get:(I,P)=>g(I).getBigUint64(P,!0),put:(I,P,F)=>(g(I).setBigUint64(P,F,!0),P+8)},d.INT64_LE={len:8,get:(I,P)=>g(I).getBigInt64(P,!0),put:(I,P,F)=>(g(I).setBigInt64(P,F,!0),P+8)},d.UINT64_BE={len:8,get:(I,P)=>g(I).getBigUint64(P),put:(I,P,F)=>(g(I).setBigUint64(P,F),P+8)},d.INT64_BE={len:8,get:(I,P)=>g(I).getBigInt64(P),put:(I,P,F)=>(g(I).setBigInt64(P,F),P+8)},d.Float16_BE={len:2,get(I,P){return m.read(I,P,!1,10,this.len)},put(I,P,F){return m.write(I,F,P,!1,10,this.len),P+this.len}},d.Float16_LE={len:2,get(I,P){return m.read(I,P,!0,10,this.len)},put(I,P,F){return m.write(I,F,P,!0,10,this.len),P+this.len}},d.Float32_BE={len:4,get:(I,P)=>g(I).getFloat32(P),put:(I,P,F)=>(g(I).setFloat32(P,F),P+4)},d.Float32_LE={len:4,get:(I,P)=>g(I).getFloat32(P,!0),put:(I,P,F)=>(g(I).setFloat32(P,F,!0),P+4)},d.Float64_BE={len:8,get:(I,P)=>g(I).getFloat64(P),put:(I,P,F)=>(g(I).setFloat64(P,F),P+8)},d.Float64_LE={len:8,get:(I,P)=>g(I).getFloat64(P,!0),put:(I,P,F)=>(g(I).setFloat64(P,F,!0),P+8)},d.Float80_BE={len:10,get(I,P){return m.read(I,P,!1,63,this.len)},put(I,P,F){return m.write(I,F,P,!1,63,this.len),P+this.len}},d.Float80_LE={len:10,get(I,P){return m.read(I,P,!0,63,this.len)},put(I,P,F){return m.write(I,F,P,!0,63,this.len),P+this.len}},d.IgnoreType=class{constructor(I){this.len=I}get(I,P){}},d.Uint8ArrayType=class{constructor(I){this.len=I}get(I,P){return I.subarray(P,P+this.len)}},d.BufferType=class{constructor(I){this.len=I}get(I,P){return Buffer$2.from(I.subarray(P,P+this.len))}},d.StringType=class{constructor(I,P){this.len=I,this.encoding=P}get(I,P){return Buffer$2.from(I).toString(this.encoding,P,P+this.len)}};class w{constructor(P){this.len=P}static decode(P,F,D){let U="";for(let Z=F;Z<D;++Z)U+=w.codePointToString(w.singleByteDecoder(P[Z]));return U}static inRange(P,F,D){return F<=P&&P<=D}static codePointToString(P){return P<=65535?String.fromCharCode(P):(P-=65536,String.fromCharCode(55296+(P>>10),56320+(1023&P)))}static singleByteDecoder(P){if(w.inRange(P,0,127))return P;const F=w.windows1252[P-128];if(F===null)throw Error("invaliding encoding");return F}get(P,F=0){return w.decode(P,F,F+this.len)}}d.AnsiStringType=w,w.windows1252=[8364,129,8218,402,8222,8230,8224,8225,710,8240,352,8249,338,141,381,143,144,8216,8217,8220,8221,8226,8211,8212,732,8482,353,8250,339,157,382,376,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255]})(lib$1);var core$1={},ReadStreamTokenizer$1={},AbstractTokenizer$1={},lib={},EndOfFileStream={};(function(d){Object.defineProperty(d,"__esModule",{value:!0}),d.EndOfStreamError=d.defaultMessages=void 0,d.defaultMessages="End-Of-Stream";class m extends Error{constructor(){super(d.defaultMessages)}}d.EndOfStreamError=m})(EndOfFileStream);var StreamReader={},Deferred$1={};Object.defineProperty(Deferred$1,"__esModule",{value:!0}),Deferred$1.Deferred=void 0;class Deferred{constructor(){this.resolve=()=>null,this.reject=()=>null,this.promise=new Promise((m,g)=>{this.reject=g,this.resolve=m})}}Deferred$1.Deferred=Deferred,function(d){Object.defineProperty(d,"__esModule",{value:!0}),d.StreamReader=d.EndOfStreamError=void 0;const m=EndOfFileStream,g=Deferred$1;var w=EndOfFileStream;Object.defineProperty(d,"EndOfStreamError",{enumerable:!0,get:function(){return w.EndOfStreamError}}),d.StreamReader=class{constructor(I){if(this.s=I,this.deferred=null,this.endOfStream=!1,this.peekQueue=[],!I.read||!I.once)throw new Error("Expected an instance of stream.Readable");this.s.once("end",()=>this.reject(new m.EndOfStreamError)),this.s.once("error",P=>this.reject(P)),this.s.once("close",()=>this.reject(new Error("Stream closed")))}async peek(I,P,F){const D=await this.read(I,P,F);return this.peekQueue.push(I.subarray(P,P+D)),D}async read(I,P,F){if(F===0)return 0;if(this.peekQueue.length===0&&this.endOfStream)throw new m.EndOfStreamError;let D=F,U=0;for(;this.peekQueue.length>0&&D>0;){const Z=this.peekQueue.pop();if(!Z)throw new Error("peekData should be defined");const $=Math.min(Z.length,D);I.set(Z.subarray(0,$),P+U),U+=$,D-=$,$<Z.length&&this.peekQueue.push(Z.subarray($))}for(;D>0&&!this.endOfStream;){const Z=Math.min(D,1048576),$=await this.readFromStream(I,P+U,Z);if(U+=$,$<Z)break;D-=$}return U}async readFromStream(I,P,F){const D=this.s.read(F);if(D)return I.set(D,P),D.length;{const U={buffer:I,offset:P,length:F,deferred:new g.Deferred};return this.deferred=U.deferred,this.s.once("readable",()=>{this.readDeferred(U)}),U.deferred.promise}}readDeferred(I){const P=this.s.read(I.length);P?(I.buffer.set(P,I.offset),I.deferred.resolve(P.length),this.deferred=null):this.s.once("readable",()=>{this.readDeferred(I)})}reject(I){this.endOfStream=!0,this.deferred&&(this.deferred.reject(I),this.deferred=null)}}}(StreamReader),function(d){Object.defineProperty(d,"__esModule",{value:!0}),d.StreamReader=d.EndOfStreamError=void 0;var m=EndOfFileStream;Object.defineProperty(d,"EndOfStreamError",{enumerable:!0,get:function(){return m.EndOfStreamError}});var g=StreamReader;Object.defineProperty(d,"StreamReader",{enumerable:!0,get:function(){return g.StreamReader}})}(lib),Object.defineProperty(AbstractTokenizer$1,"__esModule",{value:!0}),AbstractTokenizer$1.AbstractTokenizer=void 0;const peek_readable_1$2=lib;class AbstractTokenizer{constructor(m){this.position=0,this.numBuffer=new Uint8Array(8),this.fileInfo=m||{}}async readToken(m,g=this.position){const w=Buffer$2.alloc(m.len);if(await this.readBuffer(w,{position:g})<m.len)throw new peek_readable_1$2.EndOfStreamError;return m.get(w,0)}async peekToken(m,g=this.position){const w=Buffer$2.alloc(m.len);if(await this.peekBuffer(w,{position:g})<m.len)throw new peek_readable_1$2.EndOfStreamError;return m.get(w,0)}async readNumber(m){if(await this.readBuffer(this.numBuffer,{length:m.len})<m.len)throw new peek_readable_1$2.EndOfStreamError;return m.get(this.numBuffer,0)}async peekNumber(m){if(await this.peekBuffer(this.numBuffer,{length:m.len})<m.len)throw new peek_readable_1$2.EndOfStreamError;return m.get(this.numBuffer,0)}async ignore(m){if(this.fileInfo.size!==void 0){const g=this.fileInfo.size-this.position;if(m>g)return this.position+=g,g}return this.position+=m,m}async close(){}normalizeOptions(m,g){if(g&&g.position!==void 0&&g.position<this.position)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");return g?{mayBeLess:g.mayBeLess===!0,offset:g.offset?g.offset:0,length:g.length?g.length:m.length-(g.offset?g.offset:0),position:g.position?g.position:this.position}:{mayBeLess:!1,offset:0,length:m.length,position:this.position}}}AbstractTokenizer$1.AbstractTokenizer=AbstractTokenizer,Object.defineProperty(ReadStreamTokenizer$1,"__esModule",{value:!0}),ReadStreamTokenizer$1.ReadStreamTokenizer=void 0;const AbstractTokenizer_1$1=AbstractTokenizer$1,peek_readable_1$1=lib,maxBufferSize=256e3;class ReadStreamTokenizer extends AbstractTokenizer_1$1.AbstractTokenizer{constructor(m,g){super(g),this.streamReader=new peek_readable_1$1.StreamReader(m)}async getFileInfo(){return this.fileInfo}async readBuffer(m,g){const w=this.normalizeOptions(m,g),I=w.position-this.position;if(I>0)return await this.ignore(I),this.readBuffer(m,g);if(I<0)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");if(w.length===0)return 0;const P=await this.streamReader.read(m,w.offset,w.length);if(this.position+=P,(!g||!g.mayBeLess)&&P<w.length)throw new peek_readable_1$1.EndOfStreamError;return P}async peekBuffer(m,g){const w=this.normalizeOptions(m,g);let I=0;if(w.position){const P=w.position-this.position;if(P>0){const F=new Uint8Array(w.length+P);return I=await this.peekBuffer(F,{mayBeLess:w.mayBeLess}),m.set(F.subarray(P),w.offset),I-P}if(P<0)throw new Error("Cannot peek from a negative offset in a stream")}if(w.length>0){try{I=await this.streamReader.peek(m,w.offset,w.length)}catch(P){if(g&&g.mayBeLess&&P instanceof peek_readable_1$1.EndOfStreamError)return 0;throw P}if(!w.mayBeLess&&I<w.length)throw new peek_readable_1$1.EndOfStreamError}return I}async ignore(m){const g=Math.min(maxBufferSize,m),w=new Uint8Array(g);let I=0;for(;I<m;){const P=m-I,F=await this.readBuffer(w,{length:Math.min(g,P)});if(F<0)return F;I+=F}return I}}ReadStreamTokenizer$1.ReadStreamTokenizer=ReadStreamTokenizer;var BufferTokenizer$1={};Object.defineProperty(BufferTokenizer$1,"__esModule",{value:!0}),BufferTokenizer$1.BufferTokenizer=void 0;const peek_readable_1=lib,AbstractTokenizer_1=AbstractTokenizer$1;class BufferTokenizer extends AbstractTokenizer_1.AbstractTokenizer{constructor(m,g){super(g),this.uint8Array=m,this.fileInfo.size=this.fileInfo.size?this.fileInfo.size:m.length}async readBuffer(m,g){if(g&&g.position){if(g.position<this.position)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");this.position=g.position}const w=await this.peekBuffer(m,g);return this.position+=w,w}async peekBuffer(m,g){const w=this.normalizeOptions(m,g),I=Math.min(this.uint8Array.length-w.position,w.length);if(!w.mayBeLess&&I<w.length)throw new peek_readable_1.EndOfStreamError;return m.set(this.uint8Array.subarray(w.position,w.position+I),w.offset),I}async close(){}}BufferTokenizer$1.BufferTokenizer=BufferTokenizer,function(d){Object.defineProperty(d,"__esModule",{value:!0}),d.fromBuffer=d.fromStream=d.EndOfStreamError=void 0;const m=ReadStreamTokenizer$1,g=BufferTokenizer$1;var w=lib;Object.defineProperty(d,"EndOfStreamError",{enumerable:!0,get:function(){return w.EndOfStreamError}}),d.fromStream=function(I,P){return P=P||{},new m.ReadStreamTokenizer(I,P)},d.fromBuffer=function(I,P){return new g.BufferTokenizer(I,P)}}(core$1);var util={stringToBytes:d=>[...d].map(m=>m.charCodeAt(0)),tarHeaderChecksumMatches:(d,m=0)=>{const g=parseInt(d.toString("utf8",148,154).replace(/\0.*$/,"").trim(),8);if(isNaN(g))return!1;let w=256;for(let I=m;I<m+148;I++)w+=d[I];for(let I=m+156;I<m+512;I++)w+=d[I];return g===w},uint32SyncSafeToken:{get:(d,m)=>127&d[m+3]|d[m+2]<<7|d[m+1]<<14|d[m]<<21,len:4}},supported$1={extensions:["jpg","png","apng","gif","webp","flif","xcf","cr2","cr3","orf","arw","dng","nef","rw2","raf","tif","bmp","icns","jxr","psd","indd","zip","tar","rar","gz","bz2","7z","dmg","mp4","mid","mkv","webm","mov","avi","mpg","mp2","mp3","m4a","oga","ogg","ogv","opus","flac","wav","spx","amr","pdf","epub","exe","swf","rtf","wasm","woff","woff2","eot","ttf","otf","ico","flv","ps","xz","sqlite","nes","crx","xpi","cab","deb","ar","rpm","Z","lz","cfb","mxf","mts","blend","bpg","docx","pptx","xlsx","3gp","3g2","jp2","jpm","jpx","mj2","aif","qcp","odt","ods","odp","xml","mobi","heic","cur","ktx","ape","wv","dcm","ics","glb","pcap","dsf","lnk","alias","voc","ac3","m4v","m4p","m4b","f4v","f4p","f4b","f4a","mie","asf","ogm","ogx","mpc","arrow","shp","aac","mp1","it","s3m","xm","ai","skp","avif","eps","lzh","pgp","asar","stl","chm","3mf","zst","jxl","vcf"],mimeTypes:["image/jpeg","image/png","image/gif","image/webp","image/flif","image/x-xcf","image/x-canon-cr2","image/x-canon-cr3","image/tiff","image/bmp","image/vnd.ms-photo","image/vnd.adobe.photoshop","application/x-indesign","application/epub+zip","application/x-xpinstall","application/vnd.oasis.opendocument.text","application/vnd.oasis.opendocument.spreadsheet","application/vnd.oasis.opendocument.presentation","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/zip","application/x-tar","application/x-rar-compressed","application/gzip","application/x-bzip2","application/x-7z-compressed","application/x-apple-diskimage","application/x-apache-arrow","video/mp4","audio/midi","video/x-matroska","video/webm","video/quicktime","video/vnd.avi","audio/vnd.wave","audio/qcelp","audio/x-ms-asf","video/x-ms-asf","application/vnd.ms-asf","video/mpeg","video/3gpp","audio/mpeg","audio/mp4","audio/opus","video/ogg","audio/ogg","application/ogg","audio/x-flac","audio/ape","audio/wavpack","audio/amr","application/pdf","application/x-msdownload","application/x-shockwave-flash","application/rtf","application/wasm","font/woff","font/woff2","application/vnd.ms-fontobject","font/ttf","font/otf","image/x-icon","video/x-flv","application/postscript","application/eps","application/x-xz","application/x-sqlite3","application/x-nintendo-nes-rom","application/x-google-chrome-extension","application/vnd.ms-cab-compressed","application/x-deb","application/x-unix-archive","application/x-rpm","application/x-compress","application/x-lzip","application/x-cfb","application/x-mie","application/mxf","video/mp2t","application/x-blender","image/bpg","image/jp2","image/jpx","image/jpm","image/mj2","audio/aiff","application/xml","application/x-mobipocket-ebook","image/heif","image/heif-sequence","image/heic","image/heic-sequence","image/icns","image/ktx","application/dicom","audio/x-musepack","text/calendar","text/vcard","model/gltf-binary","application/vnd.tcpdump.pcap","audio/x-dsf","application/x.ms.shortcut","application/x.apple.alias","audio/x-voc","audio/vnd.dolby.dd-raw","audio/x-m4a","image/apng","image/x-olympus-orf","image/x-sony-arw","image/x-adobe-dng","image/x-nikon-nef","image/x-panasonic-rw2","image/x-fujifilm-raf","video/x-m4v","video/3gpp2","application/x-esri-shape","audio/aac","audio/x-it","audio/x-s3m","audio/x-xm","video/MP1S","video/MP2P","application/vnd.sketchup.skp","image/avif","application/x-lzh-compressed","application/pgp-encrypted","application/x-asar","model/stl","application/vnd.ms-htmlhelp","model/3mf","image/jxl","application/zstd"]};const Token=lib$1,strtok3=core$1,{stringToBytes,tarHeaderChecksumMatches,uint32SyncSafeToken}=util,supported=supported$1,minimumBytes=4100;async function fromStream(d){const m=await strtok3.fromStream(d);try{return await fromTokenizer(m)}finally{await m.close()}}async function fromBuffer(d){if(!(d instanceof Uint8Array||d instanceof ArrayBuffer||Buffer$2.isBuffer(d)))throw new TypeError(`Expected the \`input\` argument to be of type \`Uint8Array\` or \`Buffer\` or \`ArrayBuffer\`, got \`${typeof d}\``);const m=d instanceof Buffer$2?d:Buffer$2.from(d);if(m&&m.length>1)return fromTokenizer(strtok3.fromBuffer(m))}function _check(d,m,g){g={offset:0,...g};for(const[w,I]of m.entries())if(g.mask){if(I!==(g.mask[w]&d[w+g.offset]))return!1}else if(I!==d[w+g.offset])return!1;return!0}async function fromTokenizer(d){try{return _fromTokenizer(d)}catch(m){if(!(m instanceof strtok3.EndOfStreamError))throw m}}async function _fromTokenizer(d){let m=Buffer$2.alloc(minimumBytes);const g=(I,P)=>_check(m,I,P),w=(I,P)=>g(stringToBytes(I),P);if(d.fileInfo.size||(d.fileInfo.size=Number.MAX_SAFE_INTEGER),await d.peekBuffer(m,{length:12,mayBeLess:!0}),g([66,77]))return{ext:"bmp",mime:"image/bmp"};if(g([11,119]))return{ext:"ac3",mime:"audio/vnd.dolby.dd-raw"};if(g([120,1]))return{ext:"dmg",mime:"application/x-apple-diskimage"};if(g([77,90]))return{ext:"exe",mime:"application/x-msdownload"};if(g([37,33]))return await d.peekBuffer(m,{length:24,mayBeLess:!0}),w("PS-Adobe-",{offset:2})&&w(" EPSF-",{offset:14})?{ext:"eps",mime:"application/eps"}:{ext:"ps",mime:"application/postscript"};if(g([31,160])||g([31,157]))return{ext:"Z",mime:"application/x-compress"};if(g([255,216,255]))return{ext:"jpg",mime:"image/jpeg"};if(g([73,73,188]))return{ext:"jxr",mime:"image/vnd.ms-photo"};if(g([31,139,8]))return{ext:"gz",mime:"application/gzip"};if(g([66,90,104]))return{ext:"bz2",mime:"application/x-bzip2"};if(w("ID3")){await d.ignore(6);const I=await d.readToken(uint32SyncSafeToken);return d.position+I>d.fileInfo.size?{ext:"mp3",mime:"audio/mpeg"}:(await d.ignore(I),fromTokenizer(d))}if(w("MP+"))return{ext:"mpc",mime:"audio/x-musepack"};if((m[0]===67||m[0]===70)&&g([87,83],{offset:1}))return{ext:"swf",mime:"application/x-shockwave-flash"};if(g([71,73,70]))return{ext:"gif",mime:"image/gif"};if(w("FLIF"))return{ext:"flif",mime:"image/flif"};if(w("8BPS"))return{ext:"psd",mime:"image/vnd.adobe.photoshop"};if(w("WEBP",{offset:8}))return{ext:"webp",mime:"image/webp"};if(w("MPCK"))return{ext:"mpc",mime:"audio/x-musepack"};if(w("FORM"))return{ext:"aif",mime:"audio/aiff"};if(w("icns",{offset:0}))return{ext:"icns",mime:"image/icns"};if(g([80,75,3,4])){try{for(;d.position+30<d.fileInfo.size;){await d.readBuffer(m,{length:30});const I={compressedSize:m.readUInt32LE(18),uncompressedSize:m.readUInt32LE(22),filenameLength:m.readUInt16LE(26),extraFieldLength:m.readUInt16LE(28)};if(I.filename=await d.readToken(new Token.StringType(I.filenameLength,"utf-8")),await d.ignore(I.extraFieldLength),I.filename==="META-INF/mozilla.rsa")return{ext:"xpi",mime:"application/x-xpinstall"};if(I.filename.endsWith(".rels")||I.filename.endsWith(".xml"))switch(I.filename.split("/")[0]){case"_rels":default:break;case"word":return{ext:"docx",mime:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"};case"ppt":return{ext:"pptx",mime:"application/vnd.openxmlformats-officedocument.presentationml.presentation"};case"xl":return{ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}}if(I.filename.startsWith("xl/"))return{ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"};if(I.filename.startsWith("3D/")&&I.filename.endsWith(".model"))return{ext:"3mf",mime:"model/3mf"};if(I.filename==="mimetype"&&I.compressedSize===I.uncompressedSize)switch(await d.readToken(new Token.StringType(I.compressedSize,"utf-8"))){case"application/epub+zip":return{ext:"epub",mime:"application/epub+zip"};case"application/vnd.oasis.opendocument.text":return{ext:"odt",mime:"application/vnd.oasis.opendocument.text"};case"application/vnd.oasis.opendocument.spreadsheet":return{ext:"ods",mime:"application/vnd.oasis.opendocument.spreadsheet"};case"application/vnd.oasis.opendocument.presentation":return{ext:"odp",mime:"application/vnd.oasis.opendocument.presentation"}}if(I.compressedSize===0){let P=-1;for(;P<0&&d.position<d.fileInfo.size;)await d.peekBuffer(m,{mayBeLess:!0}),P=m.indexOf("504B0304",0,"hex"),await d.ignore(P>=0?P:m.length)}else await d.ignore(I.compressedSize)}}catch(I){if(!(I instanceof strtok3.EndOfStreamError))throw I}return{ext:"zip",mime:"application/zip"}}if(w("OggS")){await d.ignore(28);const I=Buffer$2.alloc(8);return await d.readBuffer(I),_check(I,[79,112,117,115,72,101,97,100])?{ext:"opus",mime:"audio/opus"}:_check(I,[128,116,104,101,111,114,97])?{ext:"ogv",mime:"video/ogg"}:_check(I,[1,118,105,100,101,111,0])?{ext:"ogm",mime:"video/ogg"}:_check(I,[127,70,76,65,67])?{ext:"oga",mime:"audio/ogg"}:_check(I,[83,112,101,101,120,32,32])?{ext:"spx",mime:"audio/ogg"}:_check(I,[1,118,111,114,98,105,115])?{ext:"ogg",mime:"audio/ogg"}:{ext:"ogx",mime:"application/ogg"}}if(g([80,75])&&(m[2]===3||m[2]===5||m[2]===7)&&(m[3]===4||m[3]===6||m[3]===8))return{ext:"zip",mime:"application/zip"};if(w("ftyp",{offset:4})&&96&m[8]){const I=m.toString("binary",8,12).replace("\0"," ").trim();switch(I){case"avif":return{ext:"avif",mime:"image/avif"};case"mif1":return{ext:"heic",mime:"image/heif"};case"msf1":return{ext:"heic",mime:"image/heif-sequence"};case"heic":case"heix":return{ext:"heic",mime:"image/heic"};case"hevc":case"hevx":return{ext:"heic",mime:"image/heic-sequence"};case"qt":return{ext:"mov",mime:"video/quicktime"};case"M4V":case"M4VH":case"M4VP":return{ext:"m4v",mime:"video/x-m4v"};case"M4P":return{ext:"m4p",mime:"video/mp4"};case"M4B":return{ext:"m4b",mime:"audio/mp4"};case"M4A":return{ext:"m4a",mime:"audio/x-m4a"};case"F4V":return{ext:"f4v",mime:"video/mp4"};case"F4P":return{ext:"f4p",mime:"video/mp4"};case"F4A":return{ext:"f4a",mime:"audio/mp4"};case"F4B":return{ext:"f4b",mime:"audio/mp4"};case"crx":return{ext:"cr3",mime:"image/x-canon-cr3"};default:return I.startsWith("3g")?I.startsWith("3g2")?{ext:"3g2",mime:"video/3gpp2"}:{ext:"3gp",mime:"video/3gpp"}:{ext:"mp4",mime:"video/mp4"}}}if(w("MThd"))return{ext:"mid",mime:"audio/midi"};if(w("wOFF")&&(g([0,1,0,0],{offset:4})||w("OTTO",{offset:4})))return{ext:"woff",mime:"font/woff"};if(w("wOF2")&&(g([0,1,0,0],{offset:4})||w("OTTO",{offset:4})))return{ext:"woff2",mime:"font/woff2"};if(g([212,195,178,161])||g([161,178,195,212]))return{ext:"pcap",mime:"application/vnd.tcpdump.pcap"};if(w("DSD "))return{ext:"dsf",mime:"audio/x-dsf"};if(w("LZIP"))return{ext:"lz",mime:"application/x-lzip"};if(w("fLaC"))return{ext:"flac",mime:"audio/x-flac"};if(g([66,80,71,251]))return{ext:"bpg",mime:"image/bpg"};if(w("wvpk"))return{ext:"wv",mime:"audio/wavpack"};if(w("%PDF")){await d.ignore(1350);const I=10485760,P=Buffer$2.alloc(Math.min(I,d.fileInfo.size));return await d.readBuffer(P,{mayBeLess:!0}),P.includes(Buffer$2.from("AIPrivateData"))?{ext:"ai",mime:"application/postscript"}:{ext:"pdf",mime:"application/pdf"}}if(g([0,97,115,109]))return{ext:"wasm",mime:"application/wasm"};if(g([73,73,42,0]))return w("CR",{offset:8})?{ext:"cr2",mime:"image/x-canon-cr2"}:g([28,0,254,0],{offset:8})||g([31,0,11,0],{offset:8})?{ext:"nef",mime:"image/x-nikon-nef"}:g([8,0,0,0],{offset:4})&&(g([45,0,254,0],{offset:8})||g([39,0,254,0],{offset:8}))?{ext:"dng",mime:"image/x-adobe-dng"}:(m=Buffer$2.alloc(24),await d.peekBuffer(m),(g([16,251,134,1],{offset:4})||g([8,0,0,0],{offset:4}))&&g([0,254,0,4,0,1,0,0,0,1,0,0,0,3,1],{offset:9})?{ext:"arw",mime:"image/x-sony-arw"}:{ext:"tif",mime:"image/tiff"});if(g([77,77,0,42]))return{ext:"tif",mime:"image/tiff"};if(w("MAC "))return{ext:"ape",mime:"audio/ape"};if(g([26,69,223,163])){async function I(){const U=await d.peekNumber(Token.UINT8);let Z=128,$=0;for(;!(U&Z)&&Z!==0;)++$,Z>>=1;const j=Buffer$2.alloc($+1);return await d.readBuffer(j),j}async function P(){const U=await I(),Z=await I();Z[0]^=128>>Z.length-1;const $=Math.min(6,Z.length);return{id:U.readUIntBE(0,U.length),len:Z.readUIntBE(Z.length-$,$)}}async function F(U,Z){for(;Z>0;){const $=await P();if($.id===17026)return d.readToken(new Token.StringType($.len,"utf-8"));await d.ignore($.len),--Z}}const D=await P();switch(await F(0,D.len)){case"webm":return{ext:"webm",mime:"video/webm"};case"matroska":return{ext:"mkv",mime:"video/x-matroska"};default:return}}if(g([82,73,70,70])){if(g([65,86,73],{offset:8}))return{ext:"avi",mime:"video/vnd.avi"};if(g([87,65,86,69],{offset:8}))return{ext:"wav",mime:"audio/vnd.wave"};if(g([81,76,67,77],{offset:8}))return{ext:"qcp",mime:"audio/qcelp"}}if(w("SQLi"))return{ext:"sqlite",mime:"application/x-sqlite3"};if(g([78,69,83,26]))return{ext:"nes",mime:"application/x-nintendo-nes-rom"};if(w("Cr24"))return{ext:"crx",mime:"application/x-google-chrome-extension"};if(w("MSCF")||w("ISc("))return{ext:"cab",mime:"application/vnd.ms-cab-compressed"};if(g([237,171,238,219]))return{ext:"rpm",mime:"application/x-rpm"};if(g([197,208,211,198]))return{ext:"eps",mime:"application/eps"};if(g([40,181,47,253]))return{ext:"zst",mime:"application/zstd"};if(g([79,84,84,79,0]))return{ext:"otf",mime:"font/otf"};if(w("#!AMR"))return{ext:"amr",mime:"audio/amr"};if(w("{\\rtf"))return{ext:"rtf",mime:"application/rtf"};if(g([70,76,86,1]))return{ext:"flv",mime:"video/x-flv"};if(w("IMPM"))return{ext:"it",mime:"audio/x-it"};if(w("-lh0-",{offset:2})||w("-lh1-",{offset:2})||w("-lh2-",{offset:2})||w("-lh3-",{offset:2})||w("-lh4-",{offset:2})||w("-lh5-",{offset:2})||w("-lh6-",{offset:2})||w("-lh7-",{offset:2})||w("-lzs-",{offset:2})||w("-lz4-",{offset:2})||w("-lz5-",{offset:2})||w("-lhd-",{offset:2}))return{ext:"lzh",mime:"application/x-lzh-compressed"};if(g([0,0,1,186])){if(g([33],{offset:4,mask:[241]}))return{ext:"mpg",mime:"video/MP1S"};if(g([68],{offset:4,mask:[196]}))return{ext:"mpg",mime:"video/MP2P"}}if(w("ITSF"))return{ext:"chm",mime:"application/vnd.ms-htmlhelp"};if(g([253,55,122,88,90,0]))return{ext:"xz",mime:"application/x-xz"};if(w("<?xml "))return{ext:"xml",mime:"application/xml"};if(g([55,122,188,175,39,28]))return{ext:"7z",mime:"application/x-7z-compressed"};if(g([82,97,114,33,26,7])&&(m[6]===0||m[6]===1))return{ext:"rar",mime:"application/x-rar-compressed"};if(w("solid "))return{ext:"stl",mime:"model/stl"};if(w("BLENDER"))return{ext:"blend",mime:"application/x-blender"};if(w("!<arch>"))return await d.ignore(8),await d.readToken(new Token.StringType(13,"ascii"))==="debian-binary"?{ext:"deb",mime:"application/x-deb"}:{ext:"ar",mime:"application/x-unix-archive"};if(g([137,80,78,71,13,10,26,10])){async function I(){return{length:await d.readToken(Token.INT32_BE),type:await d.readToken(new Token.StringType(4,"binary"))}}await d.ignore(8);do{const P=await I();if(P.length<0)return;switch(P.type){case"IDAT":return{ext:"png",mime:"image/png"};case"acTL":return{ext:"apng",mime:"image/apng"};default:await d.ignore(P.length+4)}}while(d.position+8<d.fileInfo.size);return{ext:"png",mime:"image/png"}}if(g([65,82,82,79,87,49,0,0]))return{ext:"arrow",mime:"application/x-apache-arrow"};if(g([103,108,84,70,2,0,0,0]))return{ext:"glb",mime:"model/gltf-binary"};if(g([102,114,101,101],{offset:4})||g([109,100,97,116],{offset:4})||g([109,111,111,118],{offset:4})||g([119,105,100,101],{offset:4}))return{ext:"mov",mime:"video/quicktime"};if(g([73,73,82,79,8,0,0,0,24]))return{ext:"orf",mime:"image/x-olympus-orf"};if(w("gimp xcf "))return{ext:"xcf",mime:"image/x-xcf"};if(g([73,73,85,0,24,0,0,0,136,231,116,216]))return{ext:"rw2",mime:"image/x-panasonic-rw2"};if(g([48,38,178,117,142,102,207,17,166,217])){async function I(){const P=Buffer$2.alloc(16);return await d.readBuffer(P),{id:P,size:Number(await d.readToken(Token.UINT64_LE))}}for(await d.ignore(30);d.position+24<d.fileInfo.size;){const P=await I();let F=P.size-24;if(_check(P.id,[145,7,220,183,183,169,207,17,142,230,0,192,12,32,83,101])){const D=Buffer$2.alloc(16);if(F-=await d.readBuffer(D),_check(D,[64,158,105,248,77,91,207,17,168,253,0,128,95,92,68,43]))return{ext:"asf",mime:"audio/x-ms-asf"};if(_check(D,[192,239,25,188,77,91,207,17,168,253,0,128,95,92,68,43]))return{ext:"asf",mime:"video/x-ms-asf"};break}await d.ignore(F)}return{ext:"asf",mime:"application/vnd.ms-asf"}}if(g([171,75,84,88,32,49,49,187,13,10,26,10]))return{ext:"ktx",mime:"image/ktx"};if((g([126,16,4])||g([126,24,4]))&&g([48,77,73,69],{offset:4}))return{ext:"mie",mime:"application/x-mie"};if(g([39,10,0,0,0,0,0,0,0,0,0,0],{offset:2}))return{ext:"shp",mime:"application/x-esri-shape"};if(g([0,0,0,12,106,80,32,32,13,10,135,10]))switch(await d.ignore(20),await d.readToken(new Token.StringType(4,"ascii"))){case"jp2 ":return{ext:"jp2",mime:"image/jp2"};case"jpx ":return{ext:"jpx",mime:"image/jpx"};case"jpm ":return{ext:"jpm",mime:"image/jpm"};case"mjp2":return{ext:"mj2",mime:"image/mj2"};default:return}if(g([255,10])||g([0,0,0,12,74,88,76,32,13,10,135,10]))return{ext:"jxl",mime:"image/jxl"};if(g([0,0,1,186])||g([0,0,1,179]))return{ext:"mpg",mime:"video/mpeg"};if(g([0,1,0,0,0]))return{ext:"ttf",mime:"font/ttf"};if(g([0,0,1,0]))return{ext:"ico",mime:"image/x-icon"};if(g([0,0,2,0]))return{ext:"cur",mime:"image/x-icon"};if(g([208,207,17,224,161,177,26,225]))return{ext:"cfb",mime:"application/x-cfb"};if(await d.peekBuffer(m,{length:Math.min(256,d.fileInfo.size),mayBeLess:!0}),w("BEGIN:")){if(w("VCARD",{offset:6}))return{ext:"vcf",mime:"text/vcard"};if(w("VCALENDAR",{offset:6}))return{ext:"ics",mime:"text/calendar"}}if(w("FUJIFILMCCD-RAW"))return{ext:"raf",mime:"image/x-fujifilm-raf"};if(w("Extended Module:"))return{ext:"xm",mime:"audio/x-xm"};if(w("Creative Voice File"))return{ext:"voc",mime:"audio/x-voc"};if(g([4,0,0,0])&&m.length>=16){const I=m.readUInt32LE(12);if(I>12&&m.length>=I+16)try{const P=m.slice(16,I+16).toString();if(JSON.parse(P).files)return{ext:"asar",mime:"application/x-asar"}}catch{}}if(g([6,14,43,52,2,5,1,1,13,1,2,1,1,2]))return{ext:"mxf",mime:"application/mxf"};if(w("SCRM",{offset:44}))return{ext:"s3m",mime:"audio/x-s3m"};if(g([71],{offset:4})&&(g([71],{offset:192})||g([71],{offset:196})))return{ext:"mts",mime:"video/mp2t"};if(g([66,79,79,75,77,79,66,73],{offset:60}))return{ext:"mobi",mime:"application/x-mobipocket-ebook"};if(g([68,73,67,77],{offset:128}))return{ext:"dcm",mime:"application/dicom"};if(g([76,0,0,0,1,20,2,0,0,0,0,0,192,0,0,0,0,0,0,70]))return{ext:"lnk",mime:"application/x.ms.shortcut"};if(g([98,111,111,107,0,0,0,0,109,97,114,107,0,0,0,0]))return{ext:"alias",mime:"application/x.apple.alias"};if(g([76,80],{offset:34})&&(g([0,0,1],{offset:8})||g([1,0,2],{offset:8})||g([2,0,2],{offset:8})))return{ext:"eot",mime:"application/vnd.ms-fontobject"};if(g([6,6,237,245,216,29,70,229,189,49,239,231,254,116,183,29]))return{ext:"indd",mime:"application/x-indesign"};if(await d.peekBuffer(m,{length:Math.min(512,d.fileInfo.size),mayBeLess:!0}),tarHeaderChecksumMatches(m))return{ext:"tar",mime:"application/x-tar"};if(g([255,254,255,14,83,0,107,0,101,0,116,0,99,0,104,0,85,0,112,0,32,0,77,0,111,0,100,0,101,0,108,0]))return{ext:"skp",mime:"application/vnd.sketchup.skp"};if(w("-----BEGIN PGP MESSAGE-----"))return{ext:"pgp",mime:"application/pgp-encrypted"};if(m.length>=2&&g([255,224],{offset:0,mask:[255,224]})){if(g([16],{offset:1,mask:[22]}))return g([8],{offset:1,mask:[8]}),{ext:"aac",mime:"audio/aac"};if(g([2],{offset:1,mask:[6]}))return{ext:"mp3",mime:"audio/mpeg"};if(g([4],{offset:1,mask:[6]}))return{ext:"mp2",mime:"audio/mpeg"};if(g([6],{offset:1,mask:[6]}))return{ext:"mp1",mime:"audio/mpeg"}}}const stream=readableStream=>new Promise((resolve,reject)=>{const stream=eval("require")("stream");readableStream.on("error",reject),readableStream.once("readable",async()=>{const d=new stream.PassThrough;let m;m=stream.pipeline?stream.pipeline(readableStream,d,()=>{}):readableStream.pipe(d);const g=readableStream.read(minimumBytes)||readableStream.read()||Buffer$2.alloc(0);try{const w=await fromBuffer(g);d.fileType=w}catch(w){reject(w)}resolve(m)})}),fileType={fromStream,fromTokenizer,fromBuffer,stream};Object.defineProperty(fileType,"extensions",{get:()=>new Set(supported.extensions)}),Object.defineProperty(fileType,"mimeTypes",{get:()=>new Set(supported.mimeTypes)});var core=fileType,fileType$1=getDefaultExportFromCjs(core);function to(d,m){return d.then(function(g){return[null,g]}).catch(function(g){return[g,void 0]})}const writeFile=async()=>{throw new Error("Not supported")};function Mime$1(){this._types=Object.create(null),this._extensions=Object.create(null);for(let d=0;d<arguments.length;d++)this.define(arguments[d]);this.define=this.define.bind(this),this.getType=this.getType.bind(this),this.getExtension=this.getExtension.bind(this)}Mime$1.prototype.define=function(d,m){for(let g in d){let w=d[g].map(function(I){return I.toLowerCase()});g=g.toLowerCase();for(let I=0;I<w.length;I++){const P=w[I];if(P[0]!=="*"){if(!m&&P in this._types)throw new Error('Attempt to change mapping for "'+P+'" extension from "'+this._types[P]+'" to "'+g+'". Pass `force=true` to allow this, otherwise remove "'+P+'" from the list of extensions for "'+g+'".');this._types[P]=g}}if(m||!this._extensions[g]){const I=w[0];this._extensions[g]=I[0]!=="*"?I:I.substr(1)}}},Mime$1.prototype.getType=function(d){let m=(d=String(d)).replace(/^.*[/\\]/,"").toLowerCase(),g=m.replace(/^.*\./,"").toLowerCase(),w=m.length<d.length;return(g.length<m.length-1||!w)&&this._types[g]||null},Mime$1.prototype.getExtension=function(d){return(d=/^\s*([^;\s]*)/.test(d)&&RegExp.$1)&&this._extensions[d.toLowerCase()]||null};var Mime_1=Mime$1,standard={"application/andrew-inset":["ez"],"application/applixware":["aw"],"application/atom+xml":["atom"],"application/atomcat+xml":["atomcat"],"application/atomdeleted+xml":["atomdeleted"],"application/atomsvc+xml":["atomsvc"],"application/atsc-dwd+xml":["dwd"],"application/atsc-held+xml":["held"],"application/atsc-rsat+xml":["rsat"],"application/bdoc":["bdoc"],"application/calendar+xml":["xcs"],"application/ccxml+xml":["ccxml"],"application/cdfx+xml":["cdfx"],"application/cdmi-capability":["cdmia"],"application/cdmi-container":["cdmic"],"application/cdmi-domain":["cdmid"],"application/cdmi-object":["cdmio"],"application/cdmi-queue":["cdmiq"],"application/cu-seeme":["cu"],"application/dash+xml":["mpd"],"application/davmount+xml":["davmount"],"application/docbook+xml":["dbk"],"application/dssc+der":["dssc"],"application/dssc+xml":["xdssc"],"application/ecmascript":["es","ecma"],"application/emma+xml":["emma"],"application/emotionml+xml":["emotionml"],"application/epub+zip":["epub"],"application/exi":["exi"],"application/express":["exp"],"application/fdt+xml":["fdt"],"application/font-tdpfr":["pfr"],"application/geo+json":["geojson"],"application/gml+xml":["gml"],"application/gpx+xml":["gpx"],"application/gxf":["gxf"],"application/gzip":["gz"],"application/hjson":["hjson"],"application/hyperstudio":["stk"],"application/inkml+xml":["ink","inkml"],"application/ipfix":["ipfix"],"application/its+xml":["its"],"application/java-archive":["jar","war","ear"],"application/java-serialized-object":["ser"],"application/java-vm":["class"],"application/javascript":["js","mjs"],"application/json":["json","map"],"application/json5":["json5"],"application/jsonml+json":["jsonml"],"application/ld+json":["jsonld"],"application/lgr+xml":["lgr"],"application/lost+xml":["lostxml"],"application/mac-binhex40":["hqx"],"application/mac-compactpro":["cpt"],"application/mads+xml":["mads"],"application/manifest+json":["webmanifest"],"application/marc":["mrc"],"application/marcxml+xml":["mrcx"],"application/mathematica":["ma","nb","mb"],"application/mathml+xml":["mathml"],"application/mbox":["mbox"],"application/mediaservercontrol+xml":["mscml"],"application/metalink+xml":["metalink"],"application/metalink4+xml":["meta4"],"application/mets+xml":["mets"],"application/mmt-aei+xml":["maei"],"application/mmt-usd+xml":["musd"],"application/mods+xml":["mods"],"application/mp21":["m21","mp21"],"application/mp4":["mp4s","m4p"],"application/msword":["doc","dot"],"application/mxf":["mxf"],"application/n-quads":["nq"],"application/n-triples":["nt"],"application/node":["cjs"],"application/octet-stream":["bin","dms","lrf","mar","so","dist","distz","pkg","bpk","dump","elc","deploy","exe","dll","deb","dmg","iso","img","msi","msp","msm","buffer"],"application/oda":["oda"],"application/oebps-package+xml":["opf"],"application/ogg":["ogx"],"application/omdoc+xml":["omdoc"],"application/onenote":["onetoc","onetoc2","onetmp","onepkg"],"application/oxps":["oxps"],"application/p2p-overlay+xml":["relo"],"application/patch-ops-error+xml":["xer"],"application/pdf":["pdf"],"application/pgp-encrypted":["pgp"],"application/pgp-signature":["asc","sig"],"application/pics-rules":["prf"],"application/pkcs10":["p10"],"application/pkcs7-mime":["p7m","p7c"],"application/pkcs7-signature":["p7s"],"application/pkcs8":["p8"],"application/pkix-attr-cert":["ac"],"application/pkix-cert":["cer"],"application/pkix-crl":["crl"],"application/pkix-pkipath":["pkipath"],"application/pkixcmp":["pki"],"application/pls+xml":["pls"],"application/postscript":["ai","eps","ps"],"application/provenance+xml":["provx"],"application/pskc+xml":["pskcxml"],"application/raml+yaml":["raml"],"application/rdf+xml":["rdf","owl"],"application/reginfo+xml":["rif"],"application/relax-ng-compact-syntax":["rnc"],"application/resource-lists+xml":["rl"],"application/resource-lists-diff+xml":["rld"],"application/rls-services+xml":["rs"],"application/route-apd+xml":["rapd"],"application/route-s-tsid+xml":["sls"],"application/route-usd+xml":["rusd"],"application/rpki-ghostbusters":["gbr"],"application/rpki-manifest":["mft"],"application/rpki-roa":["roa"],"application/rsd+xml":["rsd"],"application/rss+xml":["rss"],"application/rtf":["rtf"],"application/sbml+xml":["sbml"],"application/scvp-cv-request":["scq"],"application/scvp-cv-response":["scs"],"application/scvp-vp-request":["spq"],"application/scvp-vp-response":["spp"],"application/sdp":["sdp"],"application/senml+xml":["senmlx"],"application/sensml+xml":["sensmlx"],"application/set-payment-initiation":["setpay"],"application/set-registration-initiation":["setreg"],"application/shf+xml":["shf"],"application/sieve":["siv","sieve"],"application/smil+xml":["smi","smil"],"application/sparql-query":["rq"],"application/sparql-results+xml":["srx"],"application/srgs":["gram"],"application/srgs+xml":["grxml"],"application/sru+xml":["sru"],"application/ssdl+xml":["ssdl"],"application/ssml+xml":["ssml"],"application/swid+xml":["swidtag"],"application/tei+xml":["tei","teicorpus"],"application/thraud+xml":["tfi"],"application/timestamped-data":["tsd"],"application/toml":["toml"],"application/trig":["trig"],"application/ttml+xml":["ttml"],"application/ubjson":["ubj"],"application/urc-ressheet+xml":["rsheet"],"application/urc-targetdesc+xml":["td"],"application/voicexml+xml":["vxml"],"application/wasm":["wasm"],"application/widget":["wgt"],"application/winhlp":["hlp"],"application/wsdl+xml":["wsdl"],"application/wspolicy+xml":["wspolicy"],"application/xaml+xml":["xaml"],"application/xcap-att+xml":["xav"],"application/xcap-caps+xml":["xca"],"application/xcap-diff+xml":["xdf"],"application/xcap-el+xml":["xel"],"application/xcap-ns+xml":["xns"],"application/xenc+xml":["xenc"],"application/xhtml+xml":["xhtml","xht"],"application/xliff+xml":["xlf"],"application/xml":["xml","xsl","xsd","rng"],"application/xml-dtd":["dtd"],"application/xop+xml":["xop"],"application/xproc+xml":["xpl"],"application/xslt+xml":["*xsl","xslt"],"application/xspf+xml":["xspf"],"application/xv+xml":["mxml","xhvml","xvml","xvm"],"application/yang":["yang"],"application/yin+xml":["yin"],"application/zip":["zip"],"audio/3gpp":["*3gpp"],"audio/adpcm":["adp"],"audio/amr":["amr"],"audio/basic":["au","snd"],"audio/midi":["mid","midi","kar","rmi"],"audio/mobile-xmf":["mxmf"],"audio/mp3":["*mp3"],"audio/mp4":["m4a","mp4a"],"audio/mpeg":["mpga","mp2","mp2a","mp3","m2a","m3a"],"audio/ogg":["oga","ogg","spx","opus"],"audio/s3m":["s3m"],"audio/silk":["sil"],"audio/wav":["wav"],"audio/wave":["*wav"],"audio/webm":["weba"],"audio/xm":["xm"],"font/collection":["ttc"],"font/otf":["otf"],"font/ttf":["ttf"],"font/woff":["woff"],"font/woff2":["woff2"],"image/aces":["exr"],"image/apng":["apng"],"image/avif":["avif"],"image/bmp":["bmp"],"image/cgm":["cgm"],"image/dicom-rle":["drle"],"image/emf":["emf"],"image/fits":["fits"],"image/g3fax":["g3"],"image/gif":["gif"],"image/heic":["heic"],"image/heic-sequence":["heics"],"image/heif":["heif"],"image/heif-sequence":["heifs"],"image/hej2k":["hej2"],"image/hsj2":["hsj2"],"image/ief":["ief"],"image/jls":["jls"],"image/jp2":["jp2","jpg2"],"image/jpeg":["jpeg","jpg","jpe"],"image/jph":["jph"],"image/jphc":["jhc"],"image/jpm":["jpm"],"image/jpx":["jpx","jpf"],"image/jxr":["jxr"],"image/jxra":["jxra"],"image/jxrs":["jxrs"],"image/jxs":["jxs"],"image/jxsc":["jxsc"],"image/jxsi":["jxsi"],"image/jxss":["jxss"],"image/ktx":["ktx"],"image/ktx2":["ktx2"],"image/png":["png"],"image/sgi":["sgi"],"image/svg+xml":["svg","svgz"],"image/t38":["t38"],"image/tiff":["tif","tiff"],"image/tiff-fx":["tfx"],"image/webp":["webp"],"image/wmf":["wmf"],"message/disposition-notification":["disposition-notification"],"message/global":["u8msg"],"message/global-delivery-status":["u8dsn"],"message/global-disposition-notification":["u8mdn"],"message/global-headers":["u8hdr"],"message/rfc822":["eml","mime"],"model/3mf":["3mf"],"model/gltf+json":["gltf"],"model/gltf-binary":["glb"],"model/iges":["igs","iges"],"model/mesh":["msh","mesh","silo"],"model/mtl":["mtl"],"model/obj":["obj"],"model/step+xml":["stpx"],"model/step+zip":["stpz"],"model/step-xml+zip":["stpxz"],"model/stl":["stl"],"model/vrml":["wrl","vrml"],"model/x3d+binary":["*x3db","x3dbz"],"model/x3d+fastinfoset":["x3db"],"model/x3d+vrml":["*x3dv","x3dvz"],"model/x3d+xml":["x3d","x3dz"],"model/x3d-vrml":["x3dv"],"text/cache-manifest":["appcache","manifest"],"text/calendar":["ics","ifb"],"text/coffeescript":["coffee","litcoffee"],"text/css":["css"],"text/csv":["csv"],"text/html":["html","htm","shtml"],"text/jade":["jade"],"text/jsx":["jsx"],"text/less":["less"],"text/markdown":["markdown","md"],"text/mathml":["mml"],"text/mdx":["mdx"],"text/n3":["n3"],"text/plain":["txt","text","conf","def","list","log","in","ini"],"text/richtext":["rtx"],"text/rtf":["*rtf"],"text/sgml":["sgml","sgm"],"text/shex":["shex"],"text/slim":["slim","slm"],"text/spdx":["spdx"],"text/stylus":["stylus","styl"],"text/tab-separated-values":["tsv"],"text/troff":["t","tr","roff","man","me","ms"],"text/turtle":["ttl"],"text/uri-list":["uri","uris","urls"],"text/vcard":["vcard"],"text/vtt":["vtt"],"text/xml":["*xml"],"text/yaml":["yaml","yml"],"video/3gpp":["3gp","3gpp"],"video/3gpp2":["3g2"],"video/h261":["h261"],"video/h263":["h263"],"video/h264":["h264"],"video/iso.segment":["m4s"],"video/jpeg":["jpgv"],"video/jpm":["*jpm","jpgm"],"video/mj2":["mj2","mjp2"],"video/mp2t":["ts"],"video/mp4":["mp4","mp4v","mpg4"],"video/mpeg":["mpeg","mpg","mpe","m1v","m2v"],"video/ogg":["ogv"],"video/quicktime":["qt","mov"],"video/webm":["webm"]};let Mime=Mime_1;var lite=new Mime(standard),mime=getDefaultExportFromCjs(lite),HorizontalAlign,HorizontalAlign2,VerticalAlign,VerticalAlign2,BlendMode,BlendMode2;function srcOver(d,m,g=1){d.a*=g;const w=m.a+d.a-m.a*d.a;return{r:(d.r*d.a+m.r*m.a*(1-d.a))/w,g:(d.g*d.a+m.g*m.a*(1-d.a))/w,b:(d.b*d.a+m.b*m.a*(1-d.a))/w,a:w}}function dstOver(d,m,g=1){d.a*=g;const w=m.a+d.a-m.a*d.a;return{r:(m.r*m.a+d.r*d.a*(1-m.a))/w,g:(m.g*m.a+d.g*d.a*(1-m.a))/w,b:(m.b*m.a+d.b*d.a*(1-m.a))/w,a:w}}function multiply$1(d,m,g=1){d.a*=g;const w=m.a+d.a-m.a*d.a,I=d.r*d.a,P=d.g*d.a,F=d.b*d.a,D=m.r*m.a,U=m.g*m.a,Z=m.b*m.a;return{r:(I*D+I*(1-m.a)+D*(1-d.a))/w,g:(P*U+P*(1-m.a)+U*(1-d.a))/w,b:(F*Z+F*(1-m.a)+Z*(1-d.a))/w,a:w}}function add(d,m,g=1){d.a*=g;const w=m.a+d.a-m.a*d.a,I=d.r*d.a,P=d.g*d.a,F=d.b*d.a;return{r:(I+m.r*m.a)/w,g:(P+m.g*m.a)/w,b:(F+m.b*m.a)/w,a:w}}function screen(d,m,g=1){d.a*=g;const w=m.a+d.a-m.a*d.a,I=d.r*d.a,P=d.g*d.a,F=d.b*d.a,D=m.r*m.a,U=m.g*m.a,Z=m.b*m.a;return{r:(I*m.a+D*d.a-I*D+I*(1-m.a)+D*(1-d.a))/w,g:(P*m.a+U*d.a-P*U+P*(1-m.a)+U*(1-d.a))/w,b:(F*m.a+Z*d.a-F*Z+F*(1-m.a)+Z*(1-d.a))/w,a:w}}function overlay(d,m,g=1){d.a*=g;const w=m.a+d.a-m.a*d.a,I=d.r*d.a,P=d.g*d.a,F=d.b*d.a,D=m.r*m.a,U=m.g*m.a,Z=m.b*m.a;return{r:(2*D<=m.a?2*I*D+I*(1-m.a)+D*(1-d.a):I*(1+m.a)+D*(1+d.a)-2*D*I-m.a*d.a)/w,g:(2*U<=m.a?2*P*U+P*(1-m.a)+U*(1-d.a):P*(1+m.a)+U*(1+d.a)-2*U*P-m.a*d.a)/w,b:(2*Z<=m.a?2*F*Z+F*(1-m.a)+Z*(1-d.a):F*(1+m.a)+Z*(1+d.a)-2*Z*F-m.a*d.a)/w,a:w}}function darken(d,m,g=1){d.a*=g;const w=m.a+d.a-m.a*d.a,I=d.r*d.a,P=d.g*d.a,F=d.b*d.a,D=m.r*m.a,U=m.g*m.a,Z=m.b*m.a;return{r:(Math.min(I*m.a,D*d.a)+I*(1-m.a)+D*(1-d.a))/w,g:(Math.min(P*m.a,U*d.a)+P*(1-m.a)+U*(1-d.a))/w,b:(Math.min(F*m.a,Z*d.a)+F*(1-m.a)+Z*(1-d.a))/w,a:w}}function lighten(d,m,g=1){d.a*=g;const w=m.a+d.a-m.a*d.a,I=d.r*d.a,P=d.g*d.a,F=d.b*d.a,D=m.r*m.a,U=m.g*m.a,Z=m.b*m.a;return{r:(Math.max(I*m.a,D*d.a)+I*(1-m.a)+D*(1-d.a))/w,g:(Math.max(P*m.a,U*d.a)+P*(1-m.a)+U*(1-d.a))/w,b:(Math.max(F*m.a,Z*d.a)+F*(1-m.a)+Z*(1-d.a))/w,a:w}}function hardLight(d,m,g=1){d.a*=g;const w=m.a+d.a-m.a*d.a,I=d.r*d.a,P=d.g*d.a,F=d.b*d.a,D=m.r*m.a,U=m.g*m.a,Z=m.b*m.a;return{r:(2*I<=d.a?2*I*D+I*(1-m.a)+D*(1-d.a):I*(1+m.a)+D*(1+d.a)-2*D*I-m.a*d.a)/w,g:(2*P<=d.a?2*P*U+P*(1-m.a)+U*(1-d.a):P*(1+m.a)+U*(1+d.a)-2*U*P-m.a*d.a)/w,b:(2*F<=d.a?2*F*Z+F*(1-m.a)+Z*(1-d.a):F*(1+m.a)+Z*(1+d.a)-2*Z*F-m.a*d.a)/w,a:w}}function difference(d,m,g=1){d.a*=g;const w=m.a+d.a-m.a*d.a,I=d.r*d.a,P=d.g*d.a,F=d.b*d.a,D=m.r*m.a,U=m.g*m.a,Z=m.b*m.a;return{r:(I+D-2*Math.min(I*m.a,D*d.a))/w,g:(P+U-2*Math.min(P*m.a,U*d.a))/w,b:(F+Z-2*Math.min(F*m.a,Z*d.a))/w,a:w}}function exclusion(d,m,g=1){d.a*=g;const w=m.a+d.a-m.a*d.a,I=d.r*d.a,P=d.g*d.a,F=d.b*d.a,D=m.r*m.a,U=m.g*m.a,Z=m.b*m.a;return{r:(I*m.a+D*d.a-2*I*D+I*(1-m.a)+D*(1-d.a))/w,g:(P*m.a+U*d.a-2*P*U+P*(1-m.a)+U*(1-d.a))/w,b:(F*m.a+Z*d.a-2*F*Z+F*(1-m.a)+Z*(1-d.a))/w,a:w}}HorizontalAlign2=HorizontalAlign||(HorizontalAlign={}),HorizontalAlign2[HorizontalAlign2.LEFT=1]="LEFT",HorizontalAlign2[HorizontalAlign2.CENTER=2]="CENTER",HorizontalAlign2[HorizontalAlign2.RIGHT=4]="RIGHT",VerticalAlign2=VerticalAlign||(VerticalAlign={}),VerticalAlign2[VerticalAlign2.TOP=8]="TOP",VerticalAlign2[VerticalAlign2.MIDDLE=16]="MIDDLE",VerticalAlign2[VerticalAlign2.BOTTOM=32]="BOTTOM",BlendMode2=BlendMode||(BlendMode={}),BlendMode2.SRC_OVER="srcOver",BlendMode2.DST_OVER="dstOver",BlendMode2.MULTIPLY="multiply",BlendMode2.ADD="add",BlendMode2.SCREEN="screen",BlendMode2.OVERLAY="overlay",BlendMode2.DARKEN="darken",BlendMode2.LIGHTEN="lighten",BlendMode2.HARD_LIGHT="hardLight",BlendMode2.DIFFERENCE="difference",BlendMode2.EXCLUSION="exclusion";const names=[srcOver,dstOver,multiply$1,add,screen,overlay,darken,lighten,hardLight,difference,exclusion];var compositeModes=Object.freeze({__proto__:null,add,darken,difference,dstOver,exclusion,hardLight,lighten,multiply:multiply$1,names,overlay,screen,srcOver});function composite(d,m,g=0,w=0,I={}){if(!(m instanceof d.constructor))throw new Error("The source must be a Jimp image");if(typeof g!="number"||typeof w!="number")throw new Error("x and y must be numbers");const{mode:P=BlendMode.SRC_OVER}=I;let{opacitySource:F=1,opacityDest:D=1}=I;(typeof F!="number"||F<0||F>1)&&(F=1),(typeof D!="number"||D<0||D>1)&&(D=1);const U=compositeModes[P];return g=Math.round(g),w=Math.round(w),D!==1&&d.scan((Z,$,j)=>{const H=d.bitmap.data[j+3]*D;d.bitmap.data[j+3]=H}),m.scan((Z,$,j)=>{const H=d.getPixelIndex(g+Z,w+$,Edge.CROP);if(H===-1)return;const W=U({r:m.bitmap.data[j+0]/255,g:m.bitmap.data[j+1]/255,b:m.bitmap.data[j+2]/255,a:m.bitmap.data[j+3]/255},{r:d.bitmap.data[H+0]/255,g:d.bitmap.data[H+1]/255,b:d.bitmap.data[H+2]/255,a:d.bitmap.data[H+3]/255},F);d.bitmap.data[H+0]=limit255(255*W.r),d.bitmap.data[H+1]=limit255(255*W.g),d.bitmap.data[H+2]=limit255(255*W.b),d.bitmap.data[H+3]=limit255(255*W.a)}),d}var jpeg$1={parseSections:function(d,m){var g,w;for(d.setBigEndian(!0);d.remainingLength()>0&&w!==218;){if(d.nextUInt8()!==255)throw new Error("Invalid JPEG section offset");g=(w=d.nextUInt8())>=208&&w<=217||w===218?0:d.nextUInt16()-2,m(w,d.branch(0,g)),d.skip(g)}},getSizeFromSOFSection:function(d){return d.skip(1),{height:d.nextUInt16(),width:d.nextUInt16()}},getSectionName:function(d){var m,g;switch(d){case 216:m="SOI";break;case 196:m="DHT";break;case 219:m="DQT";break;case 221:m="DRI";break;case 218:m="SOS";break;case 254:m="COM";break;case 217:m="EOI";break;default:d>=224&&d<=239?(m="APP",g=d-224):d>=192&&d<=207&&d!==196&&d!==200&&d!==204?(m="SOF",g=d-192):d>=208&&d<=215&&(m="RST",g=d-208)}var w={name:m};return typeof g=="number"&&(w.index=g),w}};function readExifValue(d,m){switch(d){case 1:return m.nextUInt8();case 3:case 8:return m.nextUInt16();case 4:case 9:return m.nextUInt32();case 5:return[m.nextUInt32(),m.nextUInt32()];case 6:return m.nextInt8();case 10:return[m.nextInt32(),m.nextInt32()];case 11:return m.nextFloat();case 12:return m.nextDouble();default:throw new Error("Invalid format while decoding: "+d)}}function getBytesPerComponent(d){switch(d){case 1:case 2:case 6:case 7:return 1;case 3:case 8:return 2;case 4:case 9:case 11:return 4;case 5:case 10:case 12:return 8;default:return 0}}function readExifTag(d,m){var g,w,I=m.nextUInt16(),P=m.nextUInt16(),F=getBytesPerComponent(P),D=m.nextUInt32(),U=F*D;if(U>4&&(m=d.openWithOffset(m.nextUInt32())),P===2){var Z=(g=m.nextString(D)).indexOf("\0");Z!==-1&&(g=g.substr(0,Z))}else if(P===7)g=m.nextBuffer(D);else if(P!==0)for(g=[],w=0;w<D;++w)g.push(readExifValue(P,m));return U<4&&m.skip(4-U),[I,g,P]}function readIFDSection(d,m,g){var w,I,P=m.nextUInt16();for(I=0;I<P;++I)g((w=readExifTag(d,m))[0],w[1],w[2])}function readHeader(d){if(d.nextString(6)!=="Exif\0\0")throw new Error("Invalid EXIF header");var m=d.mark(),g=d.nextUInt16();if(g===18761)d.setBigEndian(!1);else{if(g!==19789)throw new Error("Invalid TIFF header");d.setBigEndian(!0)}if(d.nextUInt16()!==42)throw new Error("Invalid TIFF data");return m}var exif$2={IFD0:1,IFD1:2,GPSIFD:3,SubIFD:4,InteropIFD:5,parseTags:function(d,m){var g,w,I,P;try{g=readHeader(d)}catch{return!1}var F=g.openWithOffset(d.nextUInt32()),D=this.IFD0;readIFDSection(g,F,function(V,Q,K){switch(V){case 34853:I=Q[0];break;case 34665:w=Q[0];break;default:m(D,V,Q,K)}});var U=F.nextUInt32();if(U!==0){var Z=g.openWithOffset(U);readIFDSection(g,Z,m.bind(null,this.IFD1))}if(I){var $=g.openWithOffset(I);readIFDSection(g,$,m.bind(null,this.GPSIFD))}if(w){var j=g.openWithOffset(w),H=this.InteropIFD;readIFDSection(g,j,function(V,Q,K){V===40965?P=Q[0]:m(H,V,Q,K)})}if(P){var W=g.openWithOffset(P);readIFDSection(g,W,m.bind(null,this.InteropIFD))}return!0}};function parseNumber(d){return parseInt(d,10)}var hours=3600,minutes=60;function parseDateTimeParts(d,m){d=d.map(parseNumber),m=m.map(parseNumber);var g=d[0],w=d[1]-1,I=d[2],P=m[0],F=m[1],D=m[2];return Date.UTC(g,w,I,P,F,D,0)/1e3}function parseDateWithTimezoneFormat(d){var m=d.substr(0,10).split("-"),g=d.substr(11,8).split(":"),w=d.substr(19,6).split(":").map(parseNumber),I=w[0]*hours+w[1]*minutes,P=parseDateTimeParts(m,g);if(typeof(P-=I)=="number"&&!isNaN(P))return P}function parseDateWithSpecFormat(d){var m=d.split(" "),g=parseDateTimeParts(m[0].split(":"),m[1].split(":"));if(typeof g=="number"&&!isNaN(g))return g}function parseExifDate(d){var m=d.length===19&&d.charAt(4)===":";return d.length===25&&d.charAt(10)==="T"?parseDateWithTimezoneFormat(d):m?parseDateWithSpecFormat(d):void 0}var date$1={parseDateWithSpecFormat,parseDateWithTimezoneFormat,parseExifDate},exif$1=exif$2,date=date$1,degreeTags=[{section:exif$1.GPSIFD,type:2,name:"GPSLatitude",refType:1,refName:"GPSLatitudeRef",posVal:"N"},{section:exif$1.GPSIFD,type:4,name:"GPSLongitude",refType:3,refName:"GPSLongitudeRef",posVal:"E"}],dateTags=[{section:exif$1.SubIFD,type:306,name:"ModifyDate"},{section:exif$1.SubIFD,type:36867,name:"DateTimeOriginal"},{section:exif$1.SubIFD,type:36868,name:"CreateDate"},{section:exif$1.SubIFD,type:306,name:"ModifyDate"}],simplify$1={castDegreeValues:function(d,m){degreeTags.forEach(function(g){var w=d(g);if(w){var I=d({section:g.section,type:g.refType,name:g.refName})===g.posVal?1:-1,P=(w[0]+w[1]/60+w[2]/3600)*I;m(g,P)}})},castDateValues:function(d,m){dateTags.forEach(function(g){var w=d(g);if(w){var I=date.parseExifDate(w);I!==void 0&&m(g,I)}})},simplifyValue:function(d,m){return Array.isArray(d)&&(d=d.map(function(g){return m===10||m===5?g[0]/g[1]:g})).length===1&&(d=d[0]),d}},exifTags,hasRequiredExifTags;function requireExifTags(){return hasRequiredExifTags?exifTags:(hasRequiredExifTags=1,exifTags={exif:{1:"InteropIndex",2:"InteropVersion",11:"ProcessingSoftware",254:"SubfileType",255:"OldSubfileType",256:"ImageWidth",257:"ImageHeight",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",263:"Thresholding",264:"CellWidth",265:"CellLength",266:"FillOrder",269:"DocumentName",270:"ImageDescription",271:"Make",272:"Model",273:"StripOffsets",274:"Orientation",277:"SamplesPerPixel",278:"RowsPerStrip",279:"StripByteCounts",280:"MinSampleValue",281:"MaxSampleValue",282:"XResolution",283:"YResolution",284:"PlanarConfiguration",285:"PageName",286:"XPosition",287:"YPosition",288:"FreeOffsets",289:"FreeByteCounts",290:"GrayResponseUnit",291:"GrayResponseCurve",292:"T4Options",293:"T6Options",296:"ResolutionUnit",297:"PageNumber",300:"ColorResponseUnit",301:"TransferFunction",305:"Software",306:"ModifyDate",315:"Artist",316:"HostComputer",317:"Predictor",318:"WhitePoint",319:"PrimaryChromaticities",320:"ColorMap",321:"HalftoneHints",322:"TileWidth",323:"TileLength",324:"TileOffsets",325:"TileByteCounts",326:"BadFaxLines",327:"CleanFaxData",328:"ConsecutiveBadFaxLines",330:"SubIFD",332:"InkSet",333:"InkNames",334:"NumberofInks",336:"DotRange",337:"TargetPrinter",338:"ExtraSamples",339:"SampleFormat",340:"SMinSampleValue",341:"SMaxSampleValue",342:"TransferRange",343:"ClipPath",344:"XClipPathUnits",345:"YClipPathUnits",346:"Indexed",347:"JPEGTables",351:"OPIProxy",400:"GlobalParametersIFD",401:"ProfileType",402:"FaxProfile",403:"CodingMethods",404:"VersionYear",405:"ModeNumber",433:"Decode",434:"DefaultImageColor",435:"T82Options",437:"JPEGTables",512:"JPEGProc",513:"ThumbnailOffset",514:"ThumbnailLength",515:"JPEGRestartInterval",517:"JPEGLosslessPredictors",518:"JPEGPointTransforms",519:"JPEGQTables",520:"JPEGDCTables",521:"JPEGACTables",529:"YCbCrCoefficients",530:"YCbCrSubSampling",531:"YCbCrPositioning",532:"ReferenceBlackWhite",559:"StripRowCounts",700:"ApplicationNotes",999:"USPTOMiscellaneous",4096:"RelatedImageFileFormat",4097:"RelatedImageWidth",4098:"RelatedImageHeight",18246:"Rating",18247:"XP_DIP_XML",18248:"StitchInfo",18249:"RatingPercent",32781:"ImageID",32931:"WangTag1",32932:"WangAnnotation",32933:"WangTag3",32934:"WangTag4",32995:"Matteing",32996:"DataType",32997:"ImageDepth",32998:"TileDepth",33405:"Model2",33421:"CFARepeatPatternDim",33422:"CFAPattern2",33423:"BatteryLevel",33424:"KodakIFD",33432:"Copyright",33434:"ExposureTime",33437:"FNumber",33445:"MDFileTag",33446:"MDScalePixel",33447:"MDColorTable",33448:"MDLabName",33449:"MDSampleInfo",33450:"MDPrepDate",33451:"MDPrepTime",33452:"MDFileUnits",33550:"PixelScale",33589:"AdventScale",33590:"AdventRevision",33628:"UIC1Tag",33629:"UIC2Tag",33630:"UIC3Tag",33631:"UIC4Tag",33723:"IPTC-NAA",33918:"IntergraphPacketData",33919:"IntergraphFlagRegisters",33920:"IntergraphMatrix",33921:"INGRReserved",33922:"ModelTiePoint",34016:"Site",34017:"ColorSequence",34018:"IT8Header",34019:"RasterPadding",34020:"BitsPerRunLength",34021:"BitsPerExtendedRunLength",34022:"ColorTable",34023:"ImageColorIndicator",34024:"BackgroundColorIndicator",34025:"ImageColorValue",34026:"BackgroundColorValue",34027:"PixelIntensityRange",34028:"TransparencyIndicator",34029:"ColorCharacterization",34030:"HCUsage",34031:"TrapIndicator",34032:"CMYKEquivalent",34118:"SEMInfo",34152:"AFCP_IPTC",34232:"PixelMagicJBIGOptions",34264:"ModelTransform",34306:"WB_GRGBLevels",34310:"LeafData",34377:"PhotoshopSettings",34665:"ExifOffset",34675:"ICC_Profile",34687:"TIFF_FXExtensions",34688:"MultiProfiles",34689:"SharedData",34690:"T88Options",34732:"ImageLayer",34735:"GeoTiffDirectory",34736:"GeoTiffDoubleParams",34737:"GeoTiffAsciiParams",34850:"ExposureProgram",34852:"SpectralSensitivity",34853:"GPSInfo",34855:"ISO",34856:"Opto-ElectricConvFactor",34857:"Interlace",34858:"TimeZoneOffset",34859:"SelfTimerMode",34864:"SensitivityType",34865:"StandardOutputSensitivity",34866:"RecommendedExposureIndex",34867:"ISOSpeed",34868:"ISOSpeedLatitudeyyy",34869:"ISOSpeedLatitudezzz",34908:"FaxRecvParams",34909:"FaxSubAddress",34910:"FaxRecvTime",34954:"LeafSubIFD",36864:"ExifVersion",36867:"DateTimeOriginal",36868:"CreateDate",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureCompensation",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37386:"FocalLength",37387:"FlashEnergy",37388:"SpatialFrequencyResponse",37389:"Noise",37390:"FocalPlaneXResolution",37391:"FocalPlaneYResolution",37392:"FocalPlaneResolutionUnit",37393:"ImageNumber",37394:"SecurityClassification",37395:"ImageHistory",37396:"SubjectArea",37397:"ExposureIndex",37398:"TIFF-EPStandardID",37399:"SensingMethod",37434:"CIP3DataFile",37435:"CIP3Sheet",37436:"CIP3Side",37439:"StoNits",37500:"MakerNote",37510:"UserComment",37520:"SubSecTime",37521:"SubSecTimeOriginal",37522:"SubSecTimeDigitized",37679:"MSDocumentText",37680:"MSPropertySetStorage",37681:"MSDocumentTextPosition",37724:"ImageSourceData",40091:"XPTitle",40092:"XPComment",40093:"XPAuthor",40094:"XPKeywords",40095:"XPSubject",40960:"FlashpixVersion",40961:"ColorSpace",40962:"ExifImageWidth",40963:"ExifImageHeight",40964:"RelatedSoundFile",40965:"InteropOffset",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41485:"Noise",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41489:"ImageNumber",41490:"SecurityClassification",41491:"ImageHistory",41492:"SubjectLocation",41493:"ExposureIndex",41494:"TIFF-EPStandardID",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRatio",41989:"FocalLengthIn35mmFormat",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",42016:"ImageUniqueID",42032:"OwnerName",42033:"SerialNumber",42034:"LensInfo",42035:"LensMake",42036:"LensModel",42037:"LensSerialNumber",42112:"GDALMetadata",42113:"GDALNoData",42240:"Gamma",44992:"ExpandSoftware",44993:"ExpandLens",44994:"ExpandFilm",44995:"ExpandFilterLens",44996:"ExpandScanner",44997:"ExpandFlashLamp",48129:"PixelFormat",48130:"Transformation",48131:"Uncompressed",48132:"ImageType",48256:"ImageWidth",48257:"ImageHeight",48258:"WidthResolution",48259:"HeightResolution",48320:"ImageOffset",48321:"ImageByteCount",48322:"AlphaOffset",48323:"AlphaByteCount",48324:"ImageDataDiscard",48325:"AlphaDataDiscard",50215:"OceScanjobDesc",50216:"OceApplicationSelector",50217:"OceIDNumber",50218:"OceImageLogic",50255:"Annotations",50341:"PrintIM",50560:"USPTOOriginalContentType",50706:"DNGVersion",50707:"DNGBackwardVersion",50708:"UniqueCameraModel",50709:"LocalizedCameraModel",50710:"CFAPlaneColor",50711:"CFALayout",50712:"LinearizationTable",50713:"BlackLevelRepeatDim",50714:"BlackLevel",50715:"BlackLevelDeltaH",50716:"BlackLevelDeltaV",50717:"WhiteLevel",50718:"DefaultScale",50719:"DefaultCropOrigin",50720:"DefaultCropSize",50721:"ColorMatrix1",50722:"ColorMatrix2",50723:"CameraCalibration1",50724:"CameraCalibration2",50725:"ReductionMatrix1",50726:"ReductionMatrix2",50727:"AnalogBalance",50728:"AsShotNeutral",50729:"AsShotWhiteXY",50730:"BaselineExposure",50731:"BaselineNoise",50732:"BaselineSharpness",50733:"BayerGreenSplit",50734:"LinearResponseLimit",50735:"CameraSerialNumber",50736:"DNGLensInfo",50737:"ChromaBlurRadius",50738:"AntiAliasStrength",50739:"ShadowScale",50740:"DNGPrivateData",50741:"MakerNoteSafety",50752:"RawImageSegmentation",50778:"CalibrationIlluminant1",50779:"CalibrationIlluminant2",50780:"BestQualityScale",50781:"RawDataUniqueID",50784:"AliasLayerMetadata",50827:"OriginalRawFileName",50828:"OriginalRawFileData",50829:"ActiveArea",50830:"MaskedAreas",50831:"AsShotICCProfile",50832:"AsShotPreProfileMatrix",50833:"CurrentICCProfile",50834:"CurrentPreProfileMatrix",50879:"ColorimetricReference",50898:"PanasonicTitle",50899:"PanasonicTitle2",50931:"CameraCalibrationSig",50932:"ProfileCalibrationSig",50933:"ProfileIFD",50934:"AsShotProfileName",50935:"NoiseReductionApplied",50936:"ProfileName",50937:"ProfileHueSatMapDims",50938:"ProfileHueSatMapData1",50939:"ProfileHueSatMapData2",50940:"ProfileToneCurve",50941:"ProfileEmbedPolicy",50942:"ProfileCopyright",50964:"ForwardMatrix1",50965:"ForwardMatrix2",50966:"PreviewApplicationName",50967:"PreviewApplicationVersion",50968:"PreviewSettingsName",50969:"PreviewSettingsDigest",50970:"PreviewColorSpace",50971:"PreviewDateTime",50972:"RawImageDigest",50973:"OriginalRawFileDigest",50974:"SubTileBlockSize",50975:"RowInterleaveFactor",50981:"ProfileLookTableDims",50982:"ProfileLookTableData",51008:"OpcodeList1",51009:"OpcodeList2",51022:"OpcodeList3",51041:"NoiseProfile",51043:"TimeCodes",51044:"FrameRate",51058:"TStop",51081:"ReelName",51089:"OriginalDefaultFinalSize",51090:"OriginalBestQualitySize",51091:"OriginalDefaultCropSize",51105:"CameraLabel",51107:"ProfileHueSatMapEncoding",51108:"ProfileLookTableEncoding",51109:"BaselineExposureOffset",51110:"DefaultBlackRender",51111:"NewRawImageDigest",51112:"RawToPreviewGain",51125:"DefaultUserCrop",59932:"Padding",59933:"OffsetSchema",65e3:"OwnerName",65001:"SerialNumber",65002:"Lens",65024:"KDC_IFD",65100:"RawFile",65101:"Converter",65102:"WhiteBalance",65105:"Exposure",65106:"Shadows",65107:"Brightness",65108:"Contrast",65109:"Saturation",65110:"Sharpness",65111:"Smoothness",65112:"MoireFilter"},gps:{0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential",31:"GPSHPositioningError"}})}var jpeg=jpeg$1,exif=exif$2,simplify=simplify$1;function ExifResult(d,m,g,w,I,P,F){this.startMarker=d,this.tags=m,this.imageSize=g,this.thumbnailOffset=w,this.thumbnailLength=I,this.thumbnailType=P,this.app1Offset=F}function Parser$1(d){this.stream=d,this.flags={readBinaryTags:!1,resolveTagNames:!0,simplifyValues:!0,imageSize:!0,hidePointers:!0,returnTags:!0}}ExifResult.prototype={hasThumbnail:function(d){return!(!this.thumbnailOffset||!this.thumbnailLength)&&(typeof d!="string"||(d.toLowerCase().trim()==="image/jpeg"?this.thumbnailType===6:d.toLowerCase().trim()==="image/tiff"&&this.thumbnailType===1))},getThumbnailOffset:function(){return this.app1Offset+6+this.thumbnailOffset},getThumbnailLength:function(){return this.thumbnailLength},getThumbnailBuffer:function(){return this._getThumbnailStream().nextBuffer(this.thumbnailLength)},_getThumbnailStream:function(){return this.startMarker.openWithOffset(this.getThumbnailOffset())},getImageSize:function(){return this.imageSize},getThumbnailSize:function(){var d,m=this._getThumbnailStream();return jpeg.parseSections(m,function(g,w){jpeg.getSectionName(g).name==="SOF"&&(d=jpeg.getSizeFromSOFSection(w))}),d}},Parser$1.prototype={enableBinaryFields:function(d){return this.flags.readBinaryTags=!!d,this},enablePointers:function(d){return this.flags.hidePointers=!d,this},enableTagNames:function(d){return this.flags.resolveTagNames=!!d,this},enableImageSize:function(d){return this.flags.imageSize=!!d,this},enableReturnTags:function(d){return this.flags.returnTags=!!d,this},enableSimpleValues:function(d){return this.flags.simplifyValues=!!d,this},parse:function(){var d,m,g,w,I,P,F,D,U,Z=this.stream.mark(),$=Z.openWithOffset(0),j=this.flags;return j.resolveTagNames&&(F=requireExifTags()),j.resolveTagNames?(d={},D=function(H){return d[H.name]},U=function(H,W){d[H.name]=W}):(d=[],D=function(H){var W;for(W=0;W<d.length;++W)if(d[W].type===H.type&&d[W].section===H.section)return d.value},U=function(H,W){var V;for(V=0;V<d.length;++V)if(d[V].type===H.type&&d[V].section===H.section)return void(d.value=W)}),jpeg.parseSections($,function(H,W){var V=W.offsetFrom(Z);H===225?exif.parseTags(W,function(Q,K,q,et){if(j.readBinaryTags||et!==7){if(K===513){if(g=q[0],j.hidePointers)return}else if(K===514){if(w=q[0],j.hidePointers)return}else if(K===259&&(I=q[0],j.hidePointers))return;if(j.returnTags)if(j.simplifyValues&&(q=simplify.simplifyValue(q,et)),j.resolveTagNames){var X=(Q===exif.GPSIFD?F.gps:F.exif)[K];X||(X=F.exif[K]),d.hasOwnProperty(X)||(d[X]=q)}else d.push({section:Q,type:K,value:q})}})&&(P=V):j.imageSize&&jpeg.getSectionName(H).name==="SOF"&&(m=jpeg.getSizeFromSOFSection(W))}),j.simplifyValues&&(simplify.castDegreeValues(D,U),simplify.castDateValues(D,U)),new ExifResult(Z,d,m,g,w,I,P)}};var parser=Parser$1,domBufferstream,hasRequiredDomBufferstream,bufferstream,hasRequiredBufferstream;function requireDomBufferstream(){if(hasRequiredDomBufferstream)return domBufferstream;function d(m,g,w,I,P,F){this.global=P,g=g||0,w=w||m.byteLength-g,this.arrayBuffer=m.slice(g,g+w),this.view=new P.DataView(this.arrayBuffer,0,this.arrayBuffer.byteLength),this.setBigEndian(I),this.offset=0,this.parentOffset=(F||0)+g}return hasRequiredDomBufferstream=1,d.prototype={setBigEndian:function(m){this.littleEndian=!m},nextUInt8:function(){var m=this.view.getUint8(this.offset);return this.offset+=1,m},nextInt8:function(){var m=this.view.getInt8(this.offset);return this.offset+=1,m},nextUInt16:function(){var m=this.view.getUint16(this.offset,this.littleEndian);return this.offset+=2,m},nextUInt32:function(){var m=this.view.getUint32(this.offset,this.littleEndian);return this.offset+=4,m},nextInt16:function(){var m=this.view.getInt16(this.offset,this.littleEndian);return this.offset+=2,m},nextInt32:function(){var m=this.view.getInt32(this.offset,this.littleEndian);return this.offset+=4,m},nextFloat:function(){var m=this.view.getFloat32(this.offset,this.littleEndian);return this.offset+=4,m},nextDouble:function(){var m=this.view.getFloat64(this.offset,this.littleEndian);return this.offset+=8,m},nextBuffer:function(m){var g=this.arrayBuffer.slice(this.offset,this.offset+m);return this.offset+=m,g},remainingLength:function(){return this.arrayBuffer.byteLength-this.offset},nextString:function(m){var g=this.arrayBuffer.slice(this.offset,this.offset+m);return g=String.fromCharCode.apply(null,new this.global.Uint8Array(g)),this.offset+=m,g},mark:function(){var m=this;return{openWithOffset:function(g){return g=(g||0)+this.offset,new d(m.arrayBuffer,g,m.arrayBuffer.byteLength-g,!m.littleEndian,m.global,m.parentOffset)},offset:this.offset,getParentOffset:function(){return m.parentOffset}}},offsetFrom:function(m){return this.parentOffset+this.offset-(m.offset+m.getParentOffset())},skip:function(m){this.offset+=m},branch:function(m,g){return g=typeof g=="number"?g:this.arrayBuffer.byteLength-(this.offset+m),new d(this.arrayBuffer,this.offset+m,g,!this.littleEndian,this.global,this.parentOffset)}},domBufferstream=d}function requireBufferstream(){if(hasRequiredBufferstream)return bufferstream;function d(m,g,w,I){this.buffer=m,this.offset=g||0,w=typeof w=="number"?w:m.length,this.endPosition=this.offset+w,this.setBigEndian(I)}return hasRequiredBufferstream=1,d.prototype={setBigEndian:function(m){this.bigEndian=!!m},nextUInt8:function(){var m=this.buffer.readUInt8(this.offset);return this.offset+=1,m},nextInt8:function(){var m=this.buffer.readInt8(this.offset);return this.offset+=1,m},nextUInt16:function(){var m=this.bigEndian?this.buffer.readUInt16BE(this.offset):this.buffer.readUInt16LE(this.offset);return this.offset+=2,m},nextUInt32:function(){var m=this.bigEndian?this.buffer.readUInt32BE(this.offset):this.buffer.readUInt32LE(this.offset);return this.offset+=4,m},nextInt16:function(){var m=this.bigEndian?this.buffer.readInt16BE(this.offset):this.buffer.readInt16LE(this.offset);return this.offset+=2,m},nextInt32:function(){var m=this.bigEndian?this.buffer.readInt32BE(this.offset):this.buffer.readInt32LE(this.offset);return this.offset+=4,m},nextFloat:function(){var m=this.bigEndian?this.buffer.readFloatBE(this.offset):this.buffer.readFloatLE(this.offset);return this.offset+=4,m},nextDouble:function(){var m=this.bigEndian?this.buffer.readDoubleBE(this.offset):this.buffer.readDoubleLE(this.offset);return this.offset+=8,m},nextBuffer:function(m){var g=this.buffer.slice(this.offset,this.offset+m);return this.offset+=m,g},remainingLength:function(){return this.endPosition-this.offset},nextString:function(m){var g=this.buffer.toString("utf8",this.offset,this.offset+m);return this.offset+=m,g},mark:function(){var m=this;return{openWithOffset:function(g){return g=(g||0)+this.offset,new d(m.buffer,g,m.endPosition-g,m.bigEndian)},offset:this.offset}},offsetFrom:function(m){return this.offset-m.offset},skip:function(m){this.offset+=m},branch:function(m,g){return g=typeof g=="number"?g:this.endPosition-(this.offset+m),new d(this.buffer,this.offset+m,g,this.bigEndian)}},bufferstream=d}var Parser=parser;function getGlobal(){return(0,eval)("this")}var exifParser={create:function(d,m){if(d instanceof(m=m||getGlobal()).ArrayBuffer){var g=requireDomBufferstream();return new Parser(new g(d,0,d.byteLength,!0,m))}var w=requireBufferstream();return new Parser(new w(d,0,d.length,!0))}},EXIFParser=getDefaultExportFromCjs(exifParser);function getExifOrientation(d){const m=d._exif;return m&&m.tags&&m.tags.Orientation||1}function getExifOrientationTransformation(d){const m=d.bitmap.width,g=d.bitmap.height;switch(getExifOrientation(d)){case 1:default:return null;case 2:return function(w,I){return[m-w-1,I]};case 3:return function(w,I){return[m-w-1,g-I-1]};case 4:return function(w,I){return[w,g-I-1]};case 5:return function(w,I){return[I,w]};case 6:return function(w,I){return[I,g-w-1]};case 7:return function(w,I){return[m-I-1,g-w-1]};case 8:return function(w,I){return[m-I-1,w]}}}function transformBitmap(d,m,g,w){const I=d.bitmap.data,P=d.bitmap.width,F=Buffer$2.alloc(I.length);for(let D=0;D<m;D++)for(let U=0;U<g;U++){const[Z,$]=w(D,U),j=m*U+D<<2,H=P*$+Z<<2,W=I.readUInt32BE(H);F.writeUInt32BE(W,j)}d.bitmap.data=F,d.bitmap.width=m,d.bitmap.height=g,d._exif.tags.Orientation=1}function exifRotate(d){if(getExifOrientation(d)<2)return;const m=getExifOrientationTransformation(d),g=getExifOrientation(d)>4,w=g?d.bitmap.height:d.bitmap.width,I=g?d.bitmap.width:d.bitmap.height;m&&transformBitmap(d,w,I,m)}async function attemptExifRotate(d,m){try{d._exif=EXIFParser.create(m).parse(),exifRotate(d)}catch{}}var __defProp$2=Object.defineProperty,__defNormalProp$2=(d,m,g)=>m in d?__defProp$2(d,m,{enumerable:!0,configurable:!0,writable:!0,value:g}):d[m]=g,__publicField$2=(d,m,g)=>__defNormalProp$2(d,typeof m!="symbol"?m+"":m,g);const emptyBitmap={data:Buffer$2.alloc(0),width:0,height:0};function bufferFromArrayBuffer(d){const m=Buffer$2.alloc(d.byteLength),g=new Uint8Array(d);for(let w=0;w<m.length;++w)m[w]=g[w];return m}function createJimp({plugins:d,formats:m}={}){const g=d||[],w=(m||[]).map(P=>P()),I=class{constructor(P=emptyBitmap){if(__publicField$2(this,"bitmap",emptyBitmap),__publicField$2(this,"background",0),__publicField$2(this,"formats",[]),__publicField$2(this,"mime"),this.formats=w,"data"in P)this.bitmap=P;else if(this.bitmap={data:Buffer$2.alloc(P.width*P.height*4),width:P.width,height:P.height},P.color){this.background=typeof P.color=="string"?cssColorToHex(P.color):P.color;for(let F=0;F<this.bitmap.data.length;F+=4)this.bitmap.data.writeUInt32BE(this.background,F)}for(const F of g)for(const D in F)this[D]=(...U)=>{const Z=F[D]?.(this,...U);return typeof Z=="object"&&"bitmap"in Z?(this.bitmap=Z.bitmap,this):Z}}static async read(P,F){if(Buffer$2.isBuffer(P)||P instanceof ArrayBuffer)return this.fromBuffer(P);const[D,U]=await to(fetch(P));if(D)throw new Error(`Could not load Buffer from URL: ${P}`);if(!U.ok)throw new Error(`HTTP Status ${U.status} for url ${P}`);const[Z,$]=await to(U.arrayBuffer());if(Z)throw new Error(`Could not load Buffer from ${P}`);const j=bufferFromArrayBuffer($);return this.fromBuffer(j,F)}static fromBitmap(P){let F;if(P.data instanceof Buffer$2&&(F=Buffer$2.from(P.data)),(P.data instanceof Uint8Array||P.data instanceof Uint8ClampedArray)&&(F=Buffer$2.from(P.data.buffer)),Array.isArray(P.data)&&(F=Buffer$2.concat(P.data.map(D=>Buffer$2.from(D.toString(16).padStart(8,"0"),"hex")))),!F)throw new Error("data must be a Buffer");if(typeof P.height!="number"||typeof P.width!="number")throw new Error("bitmap must have width and height");return new I({height:P.height,width:P.width,data:F})}static async fromBuffer(P,F){const D=P instanceof ArrayBuffer?bufferFromArrayBuffer(P):P,U=await fileType$1.fromBuffer(D);if(!U||!U.mime)throw new Error("Could not find MIME for Buffer");const Z=w.find(j=>j.mime===U.mime);if(!Z||!Z.decode)throw new Error(`Mime type ${U.mime} does not support decoding`);const $=new I(await Z.decode(D,F?.[Z.mime]));return $.mime=U.mime,attemptExifRotate($,D),$}inspect(){return"<Jimp "+(this.bitmap===emptyBitmap?"pending...":this.bitmap.width+"x"+this.bitmap.height)+">"}toString(){return"[object Jimp]"}get width(){return this.bitmap.width}get height(){return this.bitmap.height}async getBuffer(P,F){const D=this.formats.find(Z=>Z.mime===P);if(!D||!D.encode)throw new Error(`Unsupported MIME type: ${P}`);let U;return D.hasAlpha?U=this:(U=new I({width:this.bitmap.width,height:this.bitmap.height,color:this.background}),composite(U,this)),D.encode(U.bitmap,F)}async getBase64(P,F){return"data:"+P+";base64,"+(await this.getBuffer(P,F)).toString("base64")}async write(P,F){const D=mime.getType(P);await writeFile(P,await this.getBuffer(D,F))}clone(){return new I({...this.bitmap,data:Buffer$2.from(this.bitmap.data)})}getPixelIndex(P,F,D){let U,Z;if(D||(D=Edge.EXTEND),typeof P!="number"||typeof F!="number")throw new Error("x and y must be numbers");U=P=Math.round(P),Z=F=Math.round(F),D===Edge.EXTEND&&(P<0&&(U=0),P>=this.bitmap.width&&(U=this.bitmap.width-1),F<0&&(Z=0),F>=this.bitmap.height&&(Z=this.bitmap.height-1)),D===Edge.WRAP&&(P<0&&(U=this.bitmap.width+P),P>=this.bitmap.width&&(U=P%this.bitmap.width),F<0&&(Z=this.bitmap.height+F),F>=this.bitmap.height&&(Z=F%this.bitmap.height));let $=this.bitmap.width*Z+U<<2;return(U<0||U>=this.bitmap.width)&&($=-1),(Z<0||Z>=this.bitmap.height)&&($=-1),$}getPixelColor(P,F){if(typeof P!="number"||typeof F!="number")throw new Error("x and y must be numbers");const D=this.getPixelIndex(P,F);return this.bitmap.data.readUInt32BE(D)}setPixelColor(P,F,D){if(typeof P!="number"||typeof F!="number"||typeof D!="number")throw new Error("hex, x and y must be numbers");const U=this.getPixelIndex(F,D);return this.bitmap.data.writeUInt32BE(P,U),this}hasAlpha(){const{width:P,height:F,data:D}=this.bitmap,U=P*F<<2;for(let Z=3;Z<U;Z+=4)if(D[Z]!==255)return!0;return!1}composite(P,F=0,D=0,U={}){return composite(this,P,F,D,U)}scan(P,F,D,U,Z){return scan(this,P,F,D,U,Z)}scanIterator(P=0,F=0,D=this.bitmap.width,U=this.bitmap.height){if(typeof P!="number"||typeof F!="number")throw new Error("x and y must be numbers");if(typeof D!="number"||typeof U!="number")throw new Error("w and h must be numbers");return scanIterator(this,P,F,D,U)}};return I}var ResizeStrategy,ResizeStrategy2;function Resize(d,m,g,w,I,P,F){this.widthOriginal=Math.abs(Math.floor(d)||0),this.heightOriginal=Math.abs(Math.floor(m)||0),this.targetWidth=Math.abs(Math.floor(g)||0),this.targetHeight=Math.abs(Math.floor(w)||0),this.colorChannels=I?4:3,this.interpolationPass=!!P,this.resizeCallback=typeof F=="function"?F:function(){},this.targetWidthMultipliedByChannels=this.targetWidth*this.colorChannels,this.originalWidthMultipliedByChannels=this.widthOriginal*this.colorChannels,this.originalHeightMultipliedByChannels=this.heightOriginal*this.colorChannels,this.widthPassResultSize=this.targetWidthMultipliedByChannels*this.heightOriginal,this.finalResultSize=this.targetWidthMultipliedByChannels*this.targetHeight,this.initialize()}ResizeStrategy2=ResizeStrategy||(ResizeStrategy={}),ResizeStrategy2.NEAREST_NEIGHBOR="nearestNeighbor",ResizeStrategy2.BILINEAR="bilinearInterpolation",ResizeStrategy2.BICUBIC="bicubicInterpolation",ResizeStrategy2.HERMITE="hermiteInterpolation",ResizeStrategy2.BEZIER="bezierInterpolation",Resize.prototype.initialize=function(){if(!(this.widthOriginal>0&&this.heightOriginal>0&&this.targetWidth>0&&this.targetHeight>0))throw console.log(this),new Error("Invalid settings specified for the resizer.");this.configurePasses()},Resize.prototype.configurePasses=function(){this.widthOriginal===this.targetWidth?this.resizeWidth=this.bypassResizer:(this.ratioWeightWidthPass=this.widthOriginal/this.targetWidth,this.ratioWeightWidthPass<1&&this.interpolationPass?(this.initializeFirstPassBuffers(!0),this.resizeWidth=this.colorChannels===4?this.resizeWidthInterpolatedRGBA:this.resizeWidthInterpolatedRGB):(this.initializeFirstPassBuffers(!1),this.resizeWidth=this.colorChannels===4?this.resizeWidthRGBA:this.resizeWidthRGB)),this.heightOriginal===this.targetHeight?this.resizeHeight=this.bypassResizer:(this.ratioWeightHeightPass=this.heightOriginal/this.targetHeight,this.ratioWeightHeightPass<1&&this.interpolationPass?(this.initializeSecondPassBuffers(!0),this.resizeHeight=this.resizeHeightInterpolated):(this.initializeSecondPassBuffers(!1),this.resizeHeight=this.colorChannels===4?this.resizeHeightRGBA:this.resizeHeightRGB))},Resize.prototype._resizeWidthInterpolatedRGBChannels=function(d,m){const g=m?4:3,w=this.ratioWeightWidthPass,I=this.widthBuffer;let P,F,D=0,U=0,Z=0,$=0,j=0;for(P=0;D<1/3;P+=g,D+=w)for(U=P,Z=0;U<this.widthPassResultSize;Z+=this.originalWidthMultipliedByChannels,U+=this.targetWidthMultipliedByChannels)I[U]=d[Z],I[U+1]=d[Z+1],I[U+2]=d[Z+2],m&&(I[U+3]=d[Z+3]);for(D-=1/3,F=this.widthOriginal-1;D<F;P+=g,D+=w)for(j=D%1,$=1-j,U=P,Z=Math.floor(D)*g;U<this.widthPassResultSize;Z+=this.originalWidthMultipliedByChannels,U+=this.targetWidthMultipliedByChannels)I[U+0]=d[Z+0]*$+d[Z+g+0]*j,I[U+1]=d[Z+1]*$+d[Z+g+1]*j,I[U+2]=d[Z+2]*$+d[Z+g+2]*j,m&&(I[U+3]=d[Z+3]*$+d[Z+g+3]*j);for(F=this.originalWidthMultipliedByChannels-g;P<this.targetWidthMultipliedByChannels;P+=g)for(U=P,Z=F;U<this.widthPassResultSize;Z+=this.originalWidthMultipliedByChannels,U+=this.targetWidthMultipliedByChannels)I[U]=d[Z],I[U+1]=d[Z+1],I[U+2]=d[Z+2],m&&(I[U+3]=d[Z+3]);return I},Resize.prototype._resizeWidthRGBChannels=function(d,m){const g=m?4:3,w=this.ratioWeightWidthPass,I=1/w,P=this.originalWidthMultipliedByChannels-g+1,F=this.targetWidthMultipliedByChannels-g+1,D=this.outputWidthWorkBench,U=this.widthBuffer,Z=this.outputWidthWorkBenchOpaquePixelsCount;let $=0,j=0,H=0,W=0,V=0,Q=0,K=0,q=1,et=0,X=0,tt=0,rt=0;do{for(V=0;V<this.originalHeightMultipliedByChannels;)D[V++]=0,D[V++]=0,D[V++]=0,m&&(D[V++]=0,Z[V/g-1]=0);$=w;do{for(j=1+H-W,q=Math.min($,j),V=0,Q=H;V<this.originalHeightMultipliedByChannels;Q+=P)et=d[Q],X=d[++Q],tt=d[++Q],rt=m?d[++Q]:255,D[V++]+=(rt?et:0)*q,D[V++]+=(rt?X:0)*q,D[V++]+=(rt?tt:0)*q,m&&(D[V++]+=rt*q,Z[V/g-1]+=rt?q:0);if(!($>=j)){W+=$;break}H+=g,W=H,$-=j}while($>0&&H<this.originalWidthMultipliedByChannels);for(V=0,Q=K;V<this.originalHeightMultipliedByChannels;Q+=F)$=m?Z[V/g]:1,q=m?$?1/$:0:I,U[Q]=D[V++]*q,U[++Q]=D[V++]*q,U[++Q]=D[V++]*q,m&&(U[++Q]=D[V++]*I);K+=g}while(K<this.targetWidthMultipliedByChannels);return U},Resize.prototype._resizeHeightRGBChannels=function(d,m){const g=this.ratioWeightHeightPass,w=1/g,I=this.outputHeightWorkBench,P=this.heightBuffer,F=this.outputHeightWorkBenchOpaquePixelsCount;let D=0,U=0,Z=0,$=0,j=0,H=0,W=0,V=1,Q=0,K=0,q=0,et=0;do{for(j=0;j<this.targetWidthMultipliedByChannels;)I[j++]=0,I[j++]=0,I[j++]=0,m&&(I[j++]=0,F[j/4-1]=0);D=g;do{for(U=1+Z-$,V=Math.min(D,U),W=Z,j=0;j<this.targetWidthMultipliedByChannels;)Q=d[W++],K=d[W++],q=d[W++],et=m?d[W++]:255,I[j++]+=(et?Q:0)*V,I[j++]+=(et?K:0)*V,I[j++]+=(et?q:0)*V,m&&(I[j++]+=et*V,F[j/4-1]+=et?V:0);if(!(D>=U)){$+=D;break}Z=W,$=Z,D-=U}while(D>0&&Z<this.widthPassResultSize);for(j=0;j<this.targetWidthMultipliedByChannels;)D=m?F[j/4]:1,V=m?D?1/D:0:w,P[H++]=Math.round(I[j++]*V),P[H++]=Math.round(I[j++]*V),P[H++]=Math.round(I[j++]*V),m&&(P[H++]=Math.round(I[j++]*w))}while(H<this.finalResultSize);return P},Resize.prototype.resizeWidthInterpolatedRGB=function(d){return this._resizeWidthInterpolatedRGBChannels(d,!1)},Resize.prototype.resizeWidthInterpolatedRGBA=function(d){return this._resizeWidthInterpolatedRGBChannels(d,!0)},Resize.prototype.resizeWidthRGB=function(d){return this._resizeWidthRGBChannels(d,!1)},Resize.prototype.resizeWidthRGBA=function(d){return this._resizeWidthRGBChannels(d,!0)},Resize.prototype.resizeHeightInterpolated=function(d){const m=this.ratioWeightHeightPass,g=this.heightBuffer;let w,I=0,P=0,F=0,D=0,U=0,Z=0,$=0;for(;I<1/3;I+=m)for(F=0;F<this.targetWidthMultipliedByChannels;)g[P++]=Math.round(d[F++]);for(I-=1/3,w=this.heightOriginal-1;I<w;I+=m)for($=I%1,Z=1-$,D=Math.floor(I)*this.targetWidthMultipliedByChannels,U=D+this.targetWidthMultipliedByChannels,F=0;F<this.targetWidthMultipliedByChannels;++F)g[P++]=Math.round(d[D++]*Z+d[U++]*$);for(;P<this.finalResultSize;)for(F=0,D=w*this.targetWidthMultipliedByChannels;F<this.targetWidthMultipliedByChannels;++F)g[P++]=Math.round(d[D++]);return g},Resize.prototype.resizeHeightRGB=function(d){return this._resizeHeightRGBChannels(d,!1)},Resize.prototype.resizeHeightRGBA=function(d){return this._resizeHeightRGBChannels(d,!0)},Resize.prototype.resize=function(d){this.resizeCallback(this.resizeHeight(this.resizeWidth(d)))},Resize.prototype.bypassResizer=function(d){return d},Resize.prototype.initializeFirstPassBuffers=function(d){this.widthBuffer=this.generateFloatBuffer(this.widthPassResultSize),d||(this.outputWidthWorkBench=this.generateFloatBuffer(this.originalHeightMultipliedByChannels),this.colorChannels>3&&(this.outputWidthWorkBenchOpaquePixelsCount=this.generateFloat64Buffer(this.heightOriginal)))},Resize.prototype.initializeSecondPassBuffers=function(d){this.heightBuffer=this.generateUint8Buffer(this.finalResultSize),d||(this.outputHeightWorkBench=this.generateFloatBuffer(this.targetWidthMultipliedByChannels),this.colorChannels>3&&(this.outputHeightWorkBenchOpaquePixelsCount=this.generateFloat64Buffer(this.targetWidth)))},Resize.prototype.generateFloatBuffer=function(d){try{return new Float32Array(d)}catch(m){return console.error(m),[]}},Resize.prototype.generateFloat64Buffer=function(d){try{return new Float64Array(d)}catch(m){return console.error(m),[]}},Resize.prototype.generateUint8Buffer=function(d){try{return new Uint8Array(d)}catch(m){return console.error(m),[]}};const operations={nearestNeighbor(d,m){const g=d.width,w=d.height,I=m.width,P=m.height,F=d.data,D=m.data;for(let U=0;U<P;U++)for(let Z=0;Z<I;Z++){let $=4*(U*I+Z),j=4*(Math.floor(U*w/P)*g+Math.floor(Z*g/I));D[$++]=F[j++],D[$++]=F[j++],D[$++]=F[j++],D[$++]=F[j++]}},bilinearInterpolation(d,m){const g=d.width,w=d.height,I=m.width,P=m.height,F=d.data,D=m.data,U=function($,j,H,W,V){return j===W?H:Math.round(($-j)*V+(W-$)*H)},Z=function($,j,H,W,V,Q,K,q){let et=4*(K*g+W)+j,X=4*(K*g+V)+j;const tt=U(H,W,F[et],V,F[X]);if(q===K)D[$+j]=tt;else{et=4*(q*g+W)+j,X=4*(q*g+V)+j;const rt=U(H,W,F[et],V,F[X]);D[$+j]=U(Q,K,tt,q,rt)}};for(let $=0;$<P;$++)for(let j=0;j<I;j++){const H=4*($*I+j),W=j*g/I,V=Math.floor(W),Q=Math.min(Math.ceil(W),g-1),K=$*w/P,q=Math.floor(K),et=Math.min(Math.ceil(K),w-1);Z(H,0,W,V,Q,K,q,et),Z(H,1,W,V,Q,K,q,et),Z(H,2,W,V,Q,K,q,et),Z(H,3,W,V,Q,K,q,et)}},_interpolate2D(d,m,g,w){const I=d.data,P=m.data,F=d.width,D=d.height,U=m.width,Z=m.height,$=Math.max(1,Math.floor(F/U)),j=U*$,H=Math.max(1,Math.floor(D/Z)),W=Z*H,V=Buffer$2.alloc(j*D*4);for(let q=0;q<D;q++)for(let et=0;et<j;et++){const X=et*(F-1)/j,tt=Math.floor(X),rt=X-tt,ot=4*(q*F+tt),J=4*(q*j+et);for(let lt=0;lt<4;lt++){const st=ot+lt,ut=tt>0?I[st-4]:2*I[st]-I[st+4],it=I[st],ct=I[st+4],At=tt<F-2?I[st+8]:2*I[st+4]-I[st];V[J+lt]=w(ut,it,ct,At,rt)}}const Q=Buffer$2.alloc(j*W*4);for(let q=0;q<W;q++)for(let et=0;et<j;et++){const X=q*(D-1)/W,tt=Math.floor(X),rt=X-tt,ot=4*(tt*j+et),J=4*(q*j+et);for(let lt=0;lt<4;lt++){const st=ot+lt,ut=tt>0?V[st-4*j]:2*V[st]-V[st+4*j],it=V[st],ct=V[st+4*j],At=tt<D-2?V[st+8*j]:2*V[st+4*j]-V[st];Q[J+lt]=w(ut,it,ct,At,rt)}}const K=$*H;if(K>1)for(let q=0;q<Z;q++)for(let et=0;et<U;et++){let X=0,tt=0,rt=0,ot=0,J=0;for(let st=0;st<H;st++){const ut=q*H+st;for(let it=0;it<$;it++){const ct=4*(ut*j+(et*$+it)),At=Q[ct+3];At&&(X+=Q[ct],tt+=Q[ct+1],rt+=Q[ct+2],J++),ot+=At}}const lt=4*(q*U+et);P[lt]=J?Math.round(X/J):0,P[lt+1]=J?Math.round(tt/J):0,P[lt+2]=J?Math.round(rt/J):0,P[lt+3]=Math.round(ot/K)}else m.data=Q},bicubicInterpolation(d,m,g){return this._interpolate2D(d,m,g,function(w,I,P,F,D){const U=F-P-w+I,Z=w-I-U,$=P-w,j=I;return Math.max(0,Math.min(255,U*(D*D*D)+Z*(D*D)+$*D+j))})},hermiteInterpolation(d,m,g){return this._interpolate2D(d,m,g,function(w,I,P,F,D){const U=I,Z=.5*(P-w),$=w-2.5*I+2*P-.5*F,j=.5*(F-w)+1.5*(I-P);return Math.max(0,Math.min(255,Math.round(((j*D+$)*D+Z)*D+U)))})},bezierInterpolation(d,m,g){return this._interpolate2D(d,m,g,function(w,I,P,F,D){const U=1-D,Z=I*U*U*U,$=3*(I+(P-w)/4)*U*U*D,j=3*(P-(F-I)/4)*U*D*D,H=P*D*D*D;return Math.max(0,Math.min(255,Math.round(Z+$+j+H)))})}},ResizeOptionsSchema=z.union([z.object({w:z.number().min(0),h:z.number().min(0).optional(),mode:z.nativeEnum(ResizeStrategy).optional()}),z.object({w:z.number().min(0).optional(),h:z.number().min(0),mode:z.nativeEnum(ResizeStrategy).optional()})]),ScaleToFitOptionsSchema=z.object({w:z.number().min(0),h:z.number().min(0),mode:z.nativeEnum(ResizeStrategy).optional()}),ScaleComplexOptionsSchema=z.object({f:z.number().min(0),mode:z.nativeEnum(ResizeStrategy).optional()}),methods$d={resize(d,m){const{mode:g}=ResizeOptionsSchema.parse(m);let w,I;if(typeof m.w=="number")w=m.w,I=m.h??d.bitmap.height*(w/d.bitmap.width);else{if(typeof m.h!="number")throw new Error("w must be a number");I=m.h,w=m.w??d.bitmap.width*(I/d.bitmap.height)}if(w=Math.round(w)||1,I=Math.round(I)||1,g&&typeof operations[g]=="function"){const P={data:Buffer$2.alloc(w*I*4),width:w,height:I};operations[g](d.bitmap,P),d.bitmap=P}else new Resize(d.bitmap.width,d.bitmap.height,w,I,!0,!0,P=>{d.bitmap.data=Buffer$2.from(P),d.bitmap.width=w,d.bitmap.height=I}).resize(d.bitmap.data);return d},scale(d,m){const{f:g,mode:w}=typeof m=="number"?{f:m}:ScaleComplexOptionsSchema.parse(m),I=d.bitmap.width*g,P=d.bitmap.height*g;return this.resize(d,{w:I,h:P,mode:w})},scaleToFit(d,m){const{h:g,w,mode:I}=ScaleToFitOptionsSchema.parse(m),P=w/g>d.bitmap.width/d.bitmap.height?g/d.bitmap.height:w/d.bitmap.width;return this.scale(d,{f:P,mode:I})}},ContainOptionsSchema=z.object({w:z.number(),h:z.number(),align:z.number().optional(),mode:z.nativeEnum(ResizeStrategy).optional()}),methods$c={contain(d,m){const{w:g,h:w,align:I=HorizontalAlign.CENTER|VerticalAlign.MIDDLE,mode:P}=ContainOptionsSchema.parse(m),F=7&I,D=I>>3;if((F===0||F&F-1)&&(D===0||D&D-1))throw new Error("only use one flag per alignment direction");const U=F>>1,Z=D>>1,$=g/w>d.bitmap.width/d.bitmap.height?w/d.bitmap.height:g/d.bitmap.width,j=methods$d.scale(clone(d),{f:$,mode:P});return(d=methods$d.resize(d,{w:g,h:w,mode:P})).scan((H,W,V)=>{d.bitmap.data.writeUInt32BE(d.background,V)}),d=methods$h.blit(d,{src:j,x:(d.bitmap.width-j.bitmap.width)/2*U,y:(d.bitmap.height-j.bitmap.height)/2*Z})}},CropOptionsSchema=z.object({x:z.number(),y:z.number(),w:z.number(),h:z.number()}),AutocropComplexOptionsSchema=z.object({tolerance:z.number().min(0).max(1).optional(),cropOnlyFrames:z.boolean().optional(),cropSymmetric:z.boolean().optional(),leaveBorder:z.number().optional(),ignoreSides:z.object({north:z.boolean().optional(),south:z.boolean().optional(),east:z.boolean().optional(),west:z.boolean().optional()}).optional()}),methods$b={crop(d,m){let{x:g,y:w,w:I,h:P}=CropOptionsSchema.parse(m);if(g=Math.round(g),w=Math.round(w),I=Math.round(I),P=Math.round(P),g===0&&I===d.bitmap.width){const F=I*w+g<<2,D=F+(P*I<<2);d.bitmap.data=d.bitmap.data.slice(F,D)}else{const F=Buffer$2.allocUnsafe(I*P*4);let D=0;scan(d,g,w,I,P,function(U,Z,$){const j=d.bitmap.data.readUInt32BE($);F.writeUInt32BE(j,D),D+=4}),d.bitmap.data=F}return d.bitmap.width=I,d.bitmap.height=P,d},autocrop(d,m={}){const{tolerance:g=2e-4,cropOnlyFrames:w=!0,cropSymmetric:I=!1,leaveBorder:P=0,ignoreSides:F}=typeof m=="number"?{tolerance:m}:AutocropComplexOptionsSchema.parse(m),D=d.bitmap.width,U=d.bitmap.height,Z={north:!1,south:!1,east:!1,west:!1,...F};let $=d.getPixelColor(0,0);const j=intToRGBA$1($);let H=0,W=0,V=0,Q=0;if($=d.getPixelColor(0,0),!Z.north)t:for(let X=0;X<U-1;X++){for(let tt=0;tt<D;tt++)if(colorDiff(j,intToRGBA$1(d.getPixelColor(tt,X)))>g)break t;H++}if($=d.getPixelColor(D,0),!Z.west)t:for(let X=0;X<D-1;X++){for(let tt=0+H;tt<U;tt++)if(colorDiff(j,intToRGBA$1(d.getPixelColor(X,tt)))>g)break t;Q++}if($=d.getPixelColor(0,U),!Z.south)t:for(let X=U-1;X>=H+1;X--){for(let tt=D-W-1;tt>=0;tt--)if(colorDiff(j,intToRGBA$1(d.getPixelColor(tt,X)))>g)break t;V++}if($=d.getPixelColor(D,U),!Z.east)t:for(let X=D-1;X>=0+Q+1;X--){for(let tt=U-1;tt>=0+H;tt--)if(colorDiff(j,intToRGBA$1(d.getPixelColor(X,tt)))>g)break t;W++}let K=!1;if(Q-=P,W-=P,H-=P,V-=P,I){const X=Math.min(W,Q),tt=Math.min(H,V);Q=X,W=X,H=tt,V=tt}Q=Q>=0?Q:0,W=W>=0?W:0,H=H>=0?H:0,V=V>=0?V:0;const q=D-(Q+W),et=U-(V+H);return K=w?W!==0&&H!==0&&Q!==0&&V!==0:W!==0||H!==0||Q!==0||V!==0,K&&this.crop(d,{x:Q,y:H,w:q,h:et}),d}},CoverOptionsSchema=z.object({w:z.number(),h:z.number(),align:z.number().optional(),mode:z.nativeEnum(ResizeStrategy).optional()}),methods$a={cover(d,m){const{w:g,h:w,align:I=HorizontalAlign.CENTER|VerticalAlign.MIDDLE,mode:P}=CoverOptionsSchema.parse(m),F=7&I,D=I>>3;if((F===0||F&F-1)&&(D===0||D&D-1))throw new Error("only use one flag per alignment direction");const U=F>>1,Z=D>>1,$=g/w>d.bitmap.width/d.bitmap.height?g/d.bitmap.width:w/d.bitmap.height;return d=methods$d.scale(d,{f:$,mode:P}),d=methods$b.crop(d,{x:(d.bitmap.width-g)/2*U,y:(d.bitmap.height-w)/2*Z,w:g,h:w})}},DisplaceOptionsSchema=z.object({map:JimpClassSchema,offset:z.number()}),methods$9={displace(d,m){const{map:g,offset:w}=DisplaceOptionsSchema.parse(m),I=clone(d);return d.scan((P,F,D)=>{let U=g.bitmap.data[D]/256*w;U=Math.round(U);const Z=d.getPixelIndex(P+U,F);d.bitmap.data[Z]=I.bitmap.data[D],d.bitmap.data[Z+1]=I.bitmap.data[D+1],d.bitmap.data[Z+2]=I.bitmap.data[D+2]}),d}},methods$8={dither(d){const m=[1,9,3,11,13,5,15,7,4,12,2,10,16,8,14,6];return d.scan((g,w,I)=>{const P=m[((3&w)<<2)+g%4];d.bitmap.data[I]=Math.min(d.bitmap.data[I]+P,255),d.bitmap.data[I+1]=Math.min(d.bitmap.data[I+1]+P,255),d.bitmap.data[I+2]=Math.min(d.bitmap.data[I+2]+P,255)}),d}},FisheyeOptionsSchema=z.object({radius:z.number().min(0).optional()}),methods$7={fisheye(d,m={}){const{radius:g=2.5}=FisheyeOptionsSchema.parse(m),w=clone(d),{width:I,height:P}=w.bitmap;return w.scan((F,D)=>{const U=F/I,Z=D/P,$=Math.sqrt(Math.pow(U-.5,2)+Math.pow(Z-.5,2)),j=2*Math.pow($,g),H=(U-.5)/$,W=(Z-.5)/$,V=Math.round((j*H+.5)*I),Q=Math.round((j*W+.5)*P),K=w.getPixelColor(V,Q);d.setPixelColor(K,F,D)}),d.setPixelColor(w.getPixelColor(I/2,P/2),I/2,P/2),d}},FlipOptionsSchema=z.object({horizontal:z.boolean().optional(),vertical:z.boolean().optional()}),methods$6={flip(d,m){const{horizontal:g,vertical:w}=FlipOptionsSchema.parse(m),I=Buffer$2.alloc(d.bitmap.data.length);return d.scan((P,F,D)=>{const U=g?d.bitmap.width-1-P:P,Z=w?d.bitmap.height-1-F:F,$=d.bitmap.width*Z+U<<2,j=d.bitmap.data.readUInt32BE(D);I.writeUInt32BE(j,$)}),d.bitmap.data=Buffer$2.from(I),d}};function Converter$1(d,m){if(!(d&&m&&d.length&&m.length))throw new Error("Bad alphabet");this.srcAlphabet=d,this.dstAlphabet=m}Converter$1.prototype.convert=function(d){var m,g,w,I={},P=this.srcAlphabet.length,F=this.dstAlphabet.length,D=d.length,U=typeof d=="string"?"":[];if(!this.isValid(d))throw new Error('Number "'+d+'" contains of non-alphabetic digits ('+this.srcAlphabet+")");if(this.srcAlphabet===this.dstAlphabet)return d;for(m=0;m<D;m++)I[m]=this.srcAlphabet.indexOf(d[m]);do{for(g=0,w=0,m=0;m<D;m++)(g=g*P+I[m])>=F?(I[w++]=parseInt(g/F,10),g%=F):w>0&&(I[w++]=0);D=w,U=this.dstAlphabet.slice(g,g+1).concat(U)}while(w!==0);return U},Converter$1.prototype.isValid=function(d){for(var m=0;m<d.length;++m)if(this.srcAlphabet.indexOf(d[m])===-1)return!1;return!0};var converter=Converter$1,Converter=converter;function anyBase(d,m){var g=new Converter(d,m);return function(w){return g.convert(w)}}anyBase.BIN="01",anyBase.OCT="01234567",anyBase.DEC="0123456789",anyBase.HEX="0123456789abcdef";var anyBase_1=anyBase,anyBase$1=getDefaultExportFromCjs(anyBase_1),__defProp$1=Object.defineProperty,__defNormalProp$1=(d,m,g)=>m in d?__defProp$1(d,m,{enumerable:!0,configurable:!0,writable:!0,value:g}):d[m]=g,__publicField$1=(d,m,g)=>__defNormalProp$1(d,typeof m!="symbol"?m+"":m,g);class ImagePHash{constructor(m,g){__publicField$1(this,"size"),__publicField$1(this,"smallerSize"),this.size=m||32,this.smallerSize=g||8,initCoefficients(this.size)}distance(m,g){let w=0;for(let I=0;I<m.length;I++)m[I]!==g[I]&&w++;return w/m.length}getHash(m){m=methods$d.resize(clone(m),{w:this.size,h:this.size}),m=methods$e.greyscale(m);const g=[];for(let D=0;D<m.bitmap.width;D++){const U=[];for(let Z=0;Z<m.bitmap.height;Z++)U[Z]=intToRGBA(m.getPixelColor(D,Z)).b;g[D]=U}const w=applyDCT(g,this.size);let I=0;for(let D=0;D<this.smallerSize;D++)for(let U=0;U<this.smallerSize;U++)I+=w[D][U];const P=I/(this.smallerSize*this.smallerSize);let F="";for(let D=0;D<this.smallerSize;D++)for(let U=0;U<this.smallerSize;U++)F+=w[D][U]>P?"1":"0";return F}}function intToRGBA(d){const m=255&d,g=255&(d>>>=8),w=255&(d>>>=8);return{r:255&(d>>>=8),g:w,b:g,a:m}}const c$1=[];function initCoefficients(d){for(let m=1;m<d;m++)c$1[m]=1;c$1[0]=1/Math.sqrt(2)}function applyDCT(d,m){const g=m,w=[];for(let I=0;I<g;I++){const P=[];for(let F=0;F<g;F++){let D=0;for(let U=0;U<g;U++)for(let Z=0;Z<g;Z++)D+=Math.cos((2*U+1)/(2*g)*I*Math.PI)*Math.cos((2*Z+1)/(2*g)*F*Math.PI)*d[U][Z];D*=c$1[I]*c$1[F]/4,P[F]=D,w[I]=P}}return w}const alphabet="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ$_",maxHashLength=[NaN,NaN];for(let d=2;d<65;d++){const m=anyBase$1(anyBase$1.BIN,alphabet.slice(0,d))(new Array(65).join("1"));maxHashLength.push(m.length)}const methods$5={pHash:d=>new ImagePHash().getHash(d),hash(d,m=64){if(m<2||m>64)throw new Error("base must be a number between 2 and 64");const g=alphabet.slice(0,m),w=this.pHash(d),I=maxHashLength[m];return anyBase$1(anyBase$1.BIN,g)(w).padStart(I,"0")},distanceFromHash(d,m){const g=new ImagePHash,w=g.getHash(d);return g.distance(w,m)}},MaskOptionsObjectSchema=z.object({src:JimpClassSchema,x:z.number().optional(),y:z.number().optional()}),MaskOptionsSchema=z.union([JimpClassSchema,MaskOptionsObjectSchema]),methods$4={mask(d,m){let g,w,I;MaskOptionsSchema.parse(m),"bitmap"in m?(g=m,w=0,I=0):(g=m.src,w=m.x??0,I=m.y??0),w=Math.round(w),I=Math.round(I);const P=d.bitmap.width,F=d.bitmap.height;return g.scan(function(D,U,Z){const $=w+D,j=I+U;if($>=0&&j>=0&&$<P&&j<F){const H=d.getPixelIndex($,j),{data:W}=g.bitmap,V=(W[Z+0]+W[Z+1]+W[Z+2])/3;d.bitmap.data[H+3]*=V/255}}),d}};function measureText(d,m){let g=0;for(let w=0;w<m.length;w++){const I=m[w],P=d.chars[I];if(P){const F=d.kernings[I],D=m[w+1],U=F&&D&&F[D]&&F[D]||0;g+=(P.xadvance||0)+U}}return g}function splitLines(d,m,g){const w=m.replace(/[\r\n]+/g,` 
`).split(" "),I=[];let P=[],F=0;return w.forEach(D=>{if(measureText(d,D+(w.length>1?" ":""))>g){const $=D[Symbol.iterator]();let j="";for(const H of $){const W=[...P,j+H].join(" "),V=measureText(d,W);V<g?j+=H:V>g?(I.push([...P,j]),P=[],j=H):(I.push([...P,j+H]),P=[],j="")}return}const U=[...P,D].join(" "),Z=measureText(d,U);Z<=g&&!D.includes(`
`)?(Z>F&&(F=Z),P.push(D)):(I.push(P),P=[D.replace(`
`,"")])}),I.push(P),{lines:I,longestLine:F}}function measureTextHeight(d,m,g){const{lines:w}=splitLines(d,m,g);return w.length*d.common.lineHeight}const PrintOptionsSchema=z.object({x:z.number(),y:z.number(),text:z.union([z.union([z.string(),z.number()]),z.object({text:z.union([z.string(),z.number()]),alignmentX:z.nativeEnum(HorizontalAlign).optional(),alignmentY:z.nativeEnum(VerticalAlign).optional()})]),maxWidth:z.number().optional(),maxHeight:z.number().optional(),cb:z.function(z.tuple([z.object({x:z.number(),y:z.number()})])).optional()});function xOffsetBasedOnAlignment(d,m,g,w){return w===HorizontalAlign.LEFT?0:w===HorizontalAlign.CENTER?(g-measureText(d,m))/2:g-measureText(d,m)}function drawCharacter(d,m,g,w,I){if(I.width>0&&I.height>0){const P=m.pages[I.page];P&&(d=methods$h.blit(d,{src:P,x:g+I.xoffset,y:w+I.yoffset,srcX:I.x,srcY:I.y,srcW:I.width,srcH:I.height}))}return d}function printText(d,m,g,w,I,P){for(let F=0;F<I.length;F++){const D=I[F];let U;U=m.chars[D]?D:/\s/.test(D)?"":"?";const Z=m.chars[U]||{xadvance:void 0},$=m.kernings[U];Z&&drawCharacter(d,m,g,w,Z);const j=I[F+1];g+=($&&j&&$[j]&&$[j]||0)+(Z.xadvance||P)}}const methods$3={print(d,{font:m,...g}){let w,I,{x:P,y:F,text:D,maxWidth:U=1/0,maxHeight:Z=1/0,cb:$=()=>{}}=PrintOptionsSchema.parse(g);typeof D=="object"&&D.text!==null&&D.text!==void 0?(w=D.alignmentX||HorizontalAlign.LEFT,I=D.alignmentY||VerticalAlign.TOP,{text:D}=D):(w=HorizontalAlign.LEFT,I=VerticalAlign.TOP,D=D.toString()),typeof D=="number"&&(D=D.toString()),Z!==1/0&&I===VerticalAlign.BOTTOM?F+=Z-measureTextHeight(m,D,U):Z!==1/0&&I===VerticalAlign.MIDDLE&&(F+=Z/2-measureTextHeight(m,D,U)/2);const j=Object.entries(m.chars).find(V=>V[1].xadvance)?.[1].xadvance;if(typeof j!="number")throw new Error("Could not find default character width");const{lines:H,longestLine:W}=splitLines(m,D,U);return H.forEach(V=>{const Q=V.join(" "),K=xOffsetBasedOnAlignment(m,Q,U,w);printText(d,m,P+K,F,Q,j),F+=m.common.lineHeight}),$.bind(d)({x:P+W,y:F}),d}},RotateOptionsSchema=z.union([z.number(),z.object({deg:z.number(),mode:z.union([z.boolean(),z.nativeEnum(ResizeStrategy)]).optional()})]);function createIdxTranslationFunction(d){return function(m,g){return g*d+m<<2}}function matrixRotate(d,m){if(Math.abs(m)%90!=0)throw new Error("Unsupported matrix rotation degree");const g=d.bitmap.width,w=d.bitmap.height;let I;switch(m){case 90:case-270:I=90;break;case 180:case-180:I=180;break;case 270:case-90:I=-90;break;default:throw new Error("Unsupported matrix rotation degree")}const P=I===180?g:w,F=I===180?w:g,D=Buffer$2.alloc(d.bitmap.data.length),U=createIdxTranslationFunction(g),Z=createIdxTranslationFunction(P);for(let $=0;$<g;$++)for(let j=0;j<w;j++){const H=U($,j),W=d.bitmap.data.readUInt32BE(H);let V;switch(I){case 90:V=Z(j,g-$-1);break;case-90:V=Z(w-j-1,$);break;case 180:V=Z(g-$-1,w-j-1);break;default:throw new Error("Unsupported matrix rotation angle")}D.writeUInt32BE(W,V)}d.bitmap.data=D,d.bitmap.width=P,d.bitmap.height=F}function createTranslationFunction(d,m){return function(g,w){return{x:g+d,y:w+m}}}function advancedRotate(d,m,g){const w=m*Math.PI/180,I=Math.cos(w),P=Math.sin(w);let F=d.bitmap.width,D=d.bitmap.height;if(g===!0||typeof g=="string"){F=Math.ceil(Math.abs(d.bitmap.width*I)+Math.abs(d.bitmap.height*P))+1,D=Math.ceil(Math.abs(d.bitmap.width*P)+Math.abs(d.bitmap.height*I))+1,F%2!=0&&F++,D%2!=0&&D++;const W=clone(d);d.scan((Q,K,q)=>{d.bitmap.data.writeUInt32BE(d.background,q)});const V=Math.max(F,D,d.bitmap.width,d.bitmap.height);d=composite(d=methods$d.resize(d,{h:V,w:V,mode:g===!0?void 0:g}),W,d.bitmap.width/2-W.bitmap.width/2,d.bitmap.height/2-W.bitmap.height/2)}const U=d.bitmap.width,Z=d.bitmap.height,$=Buffer$2.alloc(d.bitmap.data.length),j=createTranslationFunction(-U/2,-Z/2),H=createTranslationFunction(U/2+.5,Z/2+.5);for(let W=1;W<=Z;W++)for(let V=1;V<=U;V++){const Q=j(V,W),K=H(I*Q.x-P*Q.y,I*Q.y+P*Q.x),q=U*(W-1)+V-1<<2;if(K.x>=0&&K.x<U&&K.y>=0&&K.y<Z){const et=U*(0|K.y)+K.x<<2,X=d.bitmap.data.readUInt32BE(et);$.writeUInt32BE(X,q)}else $.writeUInt32BE(d.background,q)}if(d.bitmap.data=$,g===!0||typeof g=="string"){const W=Math.max(U/2-F/2,0),V=Math.max(Z/2-D/2,0);d=methods$b.crop(d,{x:W,y:V,w:F,h:D})}}const methods$2={rotate(d,m){const g=RotateOptionsSchema.parse(m),w=typeof g=="number"?{deg:g}:g,{mode:I=!0}=w;let{deg:P}=w;return P%=360,P%360==0||(P%90==0&&(I||d.bitmap.width===d.bitmap.height||P%180==0)?matrixRotate(d,P):advancedRotate(d,P,I)),d}},ThresholdOptionsSchema=z.object({max:z.number().min(0).max(255),replace:z.number().min(0).max(255).optional(),autoGreyscale:z.boolean().optional()}),methods$1={threshold(d,m){let{max:g,replace:w=255,autoGreyscale:I=!0}=ThresholdOptionsSchema.parse(m);return g=limit255(g),w=limit255(w),I&&methods$e.greyscale(d),d.scan((P,F,D)=>{const U=d.bitmap.data[D]<g?d.bitmap.data[D]:w;d.bitmap.data[D]=U,d.bitmap.data[D+1]=U,d.bitmap.data[D+2]=U}),d}};var __defProp=Object.defineProperty,__defNormalProp=(d,m,g)=>m in d?__defProp(d,m,{enumerable:!0,configurable:!0,writable:!0,value:g}):d[m]=g,__export=(d,m)=>{for(var g in m)__defProp(d,g,{get:m[g],enumerable:!0})},__publicField=(d,m,g)=>(__defNormalProp(d,typeof m!="symbol"?m+"":m,g),g),constants_exports={};__export(constants_exports,{bt709:()=>bt709_exports});var bt709_exports={};__export(bt709_exports,{Y:()=>Y,x:()=>x$1,y:()=>y$1});var Y=(d=>(d[d.RED=.2126]="RED",d[d.GREEN=.7152]="GREEN",d[d.BLUE=.0722]="BLUE",d[d.WHITE=1]="WHITE",d))(Y||{}),x$1=(d=>(d[d.RED=.64]="RED",d[d.GREEN=.3]="GREEN",d[d.BLUE=.15]="BLUE",d[d.WHITE=.3127]="WHITE",d))(x$1||{}),y$1=(d=>(d[d.RED=.33]="RED",d[d.GREEN=.6]="GREEN",d[d.BLUE=.06]="BLUE",d[d.WHITE=.329]="WHITE",d))(y$1||{}),conversion_exports={};function correctGamma(d){return d>.04045?((d+.055)/1.055)**2.4:d/12.92}function rgb2xyz(d,m,g){return{x:.4124*(d=correctGamma(d/255))+.3576*(m=correctGamma(m/255))+.1805*(g=correctGamma(g/255)),y:.2126*d+.7152*m+.0722*g,z:.0193*d+.1192*m+.9505*g}}__export(conversion_exports,{lab2rgb:()=>lab2rgb,lab2xyz:()=>lab2xyz,rgb2hsl:()=>rgb2hsl,rgb2lab:()=>rgb2lab,rgb2xyz:()=>rgb2xyz,xyz2lab:()=>xyz2lab,xyz2rgb:()=>xyz2rgb});var arithmetic_exports={};function degrees2radians(d){return d*(Math.PI/180)}function max3(d,m,g){let w=d;return w<m&&(w=m),w<g&&(w=g),w}function min3(d,m,g){let w=d;return w>m&&(w=m),w>g&&(w=g),w}function intInRange(d,m,g){return d>g&&(d=g),d<m&&(d=m),0|d}function inRange0to255Rounded(d){return(d=Math.round(d))>255?d=255:d<0&&(d=0),d}function inRange0to255(d){return d>255?d=255:d<0&&(d=0),d}function stableSort(d,m){const g=typeof d[0];let w;if(g==="number"||g==="string"){const I=Object.create(null);for(let P=0,F=d.length;P<F;P++){const D=d[P];I[D]||I[D]===0||(I[D]=P)}w=d.sort((P,F)=>m(P,F)||I[P]-I[F])}else{const I=d.slice(0);w=d.sort((P,F)=>m(P,F)||I.indexOf(P)-I.indexOf(F))}return w}function rgb2hsl(d,m,g){const w=min3(d,m,g),I=max3(d,m,g),P=I-w,F=(w+I)/510;let D=0;F>0&&F<1&&(D=P/(F<.5?I+w:510-I-w));let U=0;return P>0&&(U=I===d?(m-g)/P:I===m?2+(g-d)/P:4+(d-m)/P,U*=60,U<0&&(U+=360)),{h:U,s:D,l:F}}__export(arithmetic_exports,{degrees2radians:()=>degrees2radians,inRange0to255:()=>inRange0to255,inRange0to255Rounded:()=>inRange0to255Rounded,intInRange:()=>intInRange,max3:()=>max3,min3:()=>min3,stableSort:()=>stableSort});var refX=.95047,refY=1,refZ=1.08883;function pivot(d){return d>.008856?d**(1/3):7.787*d+16/116}function xyz2lab(d,m,g){if(d=pivot(d/refX),m=pivot(m/refY),g=pivot(g/refZ),116*m-16<0)throw new Error("xxx");return{L:Math.max(0,116*m-16),a:500*(d-m),b:200*(m-g)}}function rgb2lab(d,m,g){const w=rgb2xyz(d,m,g);return xyz2lab(w.x,w.y,w.z)}var refX2=.95047,refY2=1,refZ2=1.08883;function pivot2(d){return d>.206893034?d**3:(d-16/116)/7.787}function lab2xyz(d,m,g){const w=(d+16)/116,I=w-g/200;return{x:refX2*pivot2(m/500+w),y:refY2*pivot2(w),z:refZ2*pivot2(I)}}function correctGamma2(d){return d>.0031308?1.055*d**(1/2.4)-.055:12.92*d}function xyz2rgb(d,m,g){const w=correctGamma2(3.2406*d+-1.5372*m+-.4986*g),I=correctGamma2(-.9689*d+1.8758*m+.0415*g),P=correctGamma2(.0557*d+-.204*m+1.057*g);return{r:inRange0to255Rounded(255*w),g:inRange0to255Rounded(255*I),b:inRange0to255Rounded(255*P)}}function lab2rgb(d,m,g){const w=lab2xyz(d,m,g);return xyz2rgb(w.x,w.y,w.z)}var distance_exports={};__export(distance_exports,{AbstractDistanceCalculator:()=>AbstractDistanceCalculator,AbstractEuclidean:()=>AbstractEuclidean,AbstractManhattan:()=>AbstractManhattan,CIE94GraphicArts:()=>CIE94GraphicArts,CIE94Textiles:()=>CIE94Textiles,CIEDE2000:()=>CIEDE2000,CMetric:()=>CMetric,Euclidean:()=>Euclidean,EuclideanBT709:()=>EuclideanBT709,EuclideanBT709NoAlpha:()=>EuclideanBT709NoAlpha,Manhattan:()=>Manhattan,ManhattanBT709:()=>ManhattanBT709,ManhattanNommyde:()=>ManhattanNommyde,PNGQuant:()=>PNGQuant});var AbstractDistanceCalculator=class{constructor(){__publicField(this,"_maxDistance"),__publicField(this,"_whitePoint"),this._setDefaults(),this.setWhitePoint(255,255,255,255)}setWhitePoint(d,m,g,w){this._whitePoint={r:d>0?255/d:0,g:m>0?255/m:0,b:g>0?255/g:0,a:w>0?255/w:0},this._maxDistance=this.calculateRaw(d,m,g,w,0,0,0,0)}calculateNormalized(d,m){return this.calculateRaw(d.r,d.g,d.b,d.a,m.r,m.g,m.b,m.a)/this._maxDistance}},AbstractCIE94=class extends AbstractDistanceCalculator{calculateRaw(d,m,g,w,I,P,F,D){const U=rgb2lab(inRange0to255(d*this._whitePoint.r),inRange0to255(m*this._whitePoint.g),inRange0to255(g*this._whitePoint.b)),Z=rgb2lab(inRange0to255(I*this._whitePoint.r),inRange0to255(P*this._whitePoint.g),inRange0to255(F*this._whitePoint.b)),$=U.L-Z.L,j=U.a-Z.a,H=U.b-Z.b,W=Math.sqrt(U.a*U.a+U.b*U.b),V=W-Math.sqrt(Z.a*Z.a+Z.b*Z.b);let Q=j*j+H*H-V*V;Q=Q<0?0:Math.sqrt(Q);const K=(D-w)*this._whitePoint.a*this._kA;return Math.sqrt(($/this._Kl)**2+(V/(1+this._K1*W))**2+(Q/(1+this._K2*W))**2+K**2)}},CIE94Textiles=class extends AbstractCIE94{_setDefaults(){this._Kl=2,this._K1=.048,this._K2=.014,this._kA=12.5/255}},CIE94GraphicArts=class extends AbstractCIE94{_setDefaults(){this._Kl=1,this._K1=.045,this._K2=.015,this._kA=25/255}},_CIEDE2000=class extends AbstractDistanceCalculator{_setDefaults(){}static _calculatehp(d,m){const g=Math.atan2(d,m);return g>=0?g:g+_CIEDE2000._deg360InRad}static _calculateRT(d,m){const g=m**7,w=2*Math.sqrt(g/(g+_CIEDE2000._pow25to7)),I=_CIEDE2000._deg30InRad*Math.exp(-(((d-_CIEDE2000._deg275InRad)/_CIEDE2000._deg25InRad)**2));return-Math.sin(2*I)*w}static _calculateT(d){return 1-.17*Math.cos(d-_CIEDE2000._deg30InRad)+.24*Math.cos(2*d)+.32*Math.cos(3*d+_CIEDE2000._deg6InRad)-.2*Math.cos(4*d-_CIEDE2000._deg63InRad)}static _calculate_ahp(d,m,g,w){const I=g+w;return d===0?I:m<=_CIEDE2000._deg180InRad?I/2:I<_CIEDE2000._deg360InRad?(I+_CIEDE2000._deg360InRad)/2:(I-_CIEDE2000._deg360InRad)/2}static _calculate_dHp(d,m,g,w){let I;return I=d===0?0:m<=_CIEDE2000._deg180InRad?g-w:g<=w?g-w+_CIEDE2000._deg360InRad:g-w-_CIEDE2000._deg360InRad,2*Math.sqrt(d)*Math.sin(I/2)}calculateRaw(d,m,g,w,I,P,F,D){const U=rgb2lab(inRange0to255(d*this._whitePoint.r),inRange0to255(m*this._whitePoint.g),inRange0to255(g*this._whitePoint.b)),Z=rgb2lab(inRange0to255(I*this._whitePoint.r),inRange0to255(P*this._whitePoint.g),inRange0to255(F*this._whitePoint.b)),$=(D-w)*this._whitePoint.a*_CIEDE2000._kA,j=this.calculateRawInLab(U,Z);return Math.sqrt(j+$*$)}calculateRawInLab(d,m){const g=d.L,w=d.a,I=d.b,P=m.L,F=m.a,D=m.b,U=((Math.sqrt(w*w+I*I)+Math.sqrt(F*F+D*D))/2)**7,Z=.5*(1-Math.sqrt(U/(U+_CIEDE2000._pow25to7))),$=(1+Z)*w,j=(1+Z)*F,H=Math.sqrt($*$+I*I),W=Math.sqrt(j*j+D*D),V=H*W,Q=_CIEDE2000._calculatehp(I,$),K=_CIEDE2000._calculatehp(D,j),q=Math.abs(Q-K),et=P-g,X=W-H,tt=_CIEDE2000._calculate_dHp(V,q,K,Q),rt=_CIEDE2000._calculate_ahp(V,q,Q,K),ot=(H+W)/2,J=((g+P)/2-50)**2,lt=X/(1+.045*ot),st=tt/(1+.015*_CIEDE2000._calculateT(rt)*ot);return(et/(1+.015*J/Math.sqrt(20+J)))**2+lt**2+st**2+_CIEDE2000._calculateRT(rt,ot)*lt*st}},CIEDE2000=_CIEDE2000;__publicField(CIEDE2000,"_kA",25/255),__publicField(CIEDE2000,"_pow25to7",25**7),__publicField(CIEDE2000,"_deg360InRad",degrees2radians(360)),__publicField(CIEDE2000,"_deg180InRad",degrees2radians(180)),__publicField(CIEDE2000,"_deg30InRad",degrees2radians(30)),__publicField(CIEDE2000,"_deg6InRad",degrees2radians(6)),__publicField(CIEDE2000,"_deg63InRad",degrees2radians(63)),__publicField(CIEDE2000,"_deg275InRad",degrees2radians(275)),__publicField(CIEDE2000,"_deg25InRad",degrees2radians(25));var CMetric=class extends AbstractDistanceCalculator{calculateRaw(d,m,g,w,I,P,F,D){const U=(d+I)/2*this._whitePoint.r,Z=(d-I)*this._whitePoint.r,$=(m-P)*this._whitePoint.g,j=(g-F)*this._whitePoint.b,H=((512+U)*Z*Z>>8)+4*$*$+((767-U)*j*j>>8),W=(D-w)*this._whitePoint.a;return Math.sqrt(H+W*W)}_setDefaults(){}},AbstractEuclidean=class extends AbstractDistanceCalculator{calculateRaw(d,m,g,w,I,P,F,D){const U=I-d,Z=P-m,$=F-g,j=D-w;return Math.sqrt(this._kR*U*U+this._kG*Z*Z+this._kB*$*$+this._kA*j*j)}},Euclidean=class extends AbstractEuclidean{_setDefaults(){this._kR=1,this._kG=1,this._kB=1,this._kA=1}},EuclideanBT709=class extends AbstractEuclidean{_setDefaults(){this._kR=.2126,this._kG=.7152,this._kB=.0722,this._kA=1}},EuclideanBT709NoAlpha=class extends AbstractEuclidean{_setDefaults(){this._kR=.2126,this._kG=.7152,this._kB=.0722,this._kA=0}},AbstractManhattan=class extends AbstractDistanceCalculator{calculateRaw(d,m,g,w,I,P,F,D){let U=I-d,Z=P-m,$=F-g,j=D-w;return U<0&&(U=0-U),Z<0&&(Z=0-Z),$<0&&($=0-$),j<0&&(j=0-j),this._kR*U+this._kG*Z+this._kB*$+this._kA*j}},Manhattan=class extends AbstractManhattan{_setDefaults(){this._kR=1,this._kG=1,this._kB=1,this._kA=1}},ManhattanNommyde=class extends AbstractManhattan{_setDefaults(){this._kR=.4984,this._kG=.8625,this._kB=.2979,this._kA=1}},ManhattanBT709=class extends AbstractManhattan{_setDefaults(){this._kR=.2126,this._kG=.7152,this._kB=.0722,this._kA=1}},PNGQuant=class extends AbstractDistanceCalculator{calculateRaw(d,m,g,w,I,P,F,D){const U=(D-w)*this._whitePoint.a;return this._colordifferenceCh(d*this._whitePoint.r,I*this._whitePoint.r,U)+this._colordifferenceCh(m*this._whitePoint.g,P*this._whitePoint.g,U)+this._colordifferenceCh(g*this._whitePoint.b,F*this._whitePoint.b,U)}_colordifferenceCh(d,m,g){const w=d-m,I=w+g;return w*w+I*I}_setDefaults(){}},palette_exports={};__export(palette_exports,{AbstractPaletteQuantizer:()=>AbstractPaletteQuantizer,ColorHistogram:()=>ColorHistogram,NeuQuant:()=>NeuQuant,NeuQuantFloat:()=>NeuQuantFloat,RGBQuant:()=>RGBQuant,WuColorCube:()=>WuColorCube,WuQuant:()=>WuQuant});var AbstractPaletteQuantizer=class{quantizeSync(){for(const d of this.quantize())if(d.palette)return d.palette;throw new Error("unreachable")}},Point=class{constructor(){__publicField(this,"r"),__publicField(this,"g"),__publicField(this,"b"),__publicField(this,"a"),__publicField(this,"uint32"),__publicField(this,"rgba"),this.uint32=-1>>>0,this.r=this.g=this.b=this.a=0,this.rgba=new Array(4),this.rgba[0]=0,this.rgba[1]=0,this.rgba[2]=0,this.rgba[3]=0}static createByQuadruplet(d){const m=new Point;return m.r=0|d[0],m.g=0|d[1],m.b=0|d[2],m.a=0|d[3],m._loadUINT32(),m._loadQuadruplet(),m}static createByRGBA(d,m,g,w){const I=new Point;return I.r=0|d,I.g=0|m,I.b=0|g,I.a=0|w,I._loadUINT32(),I._loadQuadruplet(),I}static createByUint32(d){const m=new Point;return m.uint32=d>>>0,m._loadRGBA(),m._loadQuadruplet(),m}from(d){this.r=d.r,this.g=d.g,this.b=d.b,this.a=d.a,this.uint32=d.uint32,this.rgba[0]=d.r,this.rgba[1]=d.g,this.rgba[2]=d.b,this.rgba[3]=d.a}getLuminosity(d){let m=this.r,g=this.g,w=this.b;return d&&(m=Math.min(255,255-this.a+this.a*m/255),g=Math.min(255,255-this.a+this.a*g/255),w=Math.min(255,255-this.a+this.a*w/255)),.2126*m+.7152*g+.0722*w}_loadUINT32(){this.uint32=(this.a<<24|this.b<<16|this.g<<8|this.r)>>>0}_loadRGBA(){this.r=255&this.uint32,this.g=this.uint32>>>8&255,this.b=this.uint32>>>16&255,this.a=this.uint32>>>24&255}_loadQuadruplet(){this.rgba[0]=this.r,this.rgba[1]=this.g,this.rgba[2]=this.b,this.rgba[3]=this.a}},PointContainer=class{constructor(){__publicField(this,"_pointArray"),__publicField(this,"_width"),__publicField(this,"_height"),this._width=0,this._height=0,this._pointArray=[]}getWidth(){return this._width}getHeight(){return this._height}setWidth(d){this._width=d}setHeight(d){this._height=d}getPointArray(){return this._pointArray}clone(){const d=new PointContainer;d._width=this._width,d._height=this._height;for(let m=0,g=this._pointArray.length;m<g;m++)d._pointArray[m]=Point.createByUint32(0|this._pointArray[m].uint32);return d}toUint32Array(){const d=this._pointArray.length,m=new Uint32Array(d);for(let g=0;g<d;g++)m[g]=this._pointArray[g].uint32;return m}toUint8Array(){return new Uint8Array(this.toUint32Array().buffer)}static fromHTMLImageElement(d){const m=d.naturalWidth,g=d.naturalHeight,w=document.createElement("canvas");return w.width=m,w.height=g,w.getContext("2d").drawImage(d,0,0,m,g,0,0,m,g),PointContainer.fromHTMLCanvasElement(w)}static fromHTMLCanvasElement(d){const m=d.width,g=d.height,w=d.getContext("2d").getImageData(0,0,m,g);return PointContainer.fromImageData(w)}static fromImageData(d){const m=d.width,g=d.height;return PointContainer.fromUint8Array(d.data,m,g)}static fromUint8Array(d,m,g){switch(Object.prototype.toString.call(d)){case"[object Uint8ClampedArray]":case"[object Uint8Array]":break;default:d=new Uint8Array(d)}const w=new Uint32Array(d.buffer);return PointContainer.fromUint32Array(w,m,g)}static fromUint32Array(d,m,g){const w=new PointContainer;w._width=m,w._height=g;for(let I=0,P=d.length;I<P;I++)w._pointArray[I]=Point.createByUint32(0|d[I]);return w}static fromBuffer(d,m,g){const w=new Uint32Array(d.buffer,d.byteOffset,d.byteLength/Uint32Array.BYTES_PER_ELEMENT);return PointContainer.fromUint32Array(w,m,g)}},hueGroups=10;function hueGroup(d,m){const g=360/m;for(let w=1,I=g-g/2;w<m;w++,I+=g)if(d>=I&&d<I+g)return w;return 0}var Palette=class{constructor(){__publicField(this,"_pointContainer"),__publicField(this,"_pointArray",[]),__publicField(this,"_i32idx",{}),this._pointContainer=new PointContainer,this._pointContainer.setHeight(1),this._pointArray=this._pointContainer.getPointArray()}add(d){this._pointArray.push(d),this._pointContainer.setWidth(this._pointArray.length)}has(d){for(let m=this._pointArray.length-1;m>=0;m--)if(d.uint32===this._pointArray[m].uint32)return!0;return!1}getNearestColor(d,m){return this._pointArray[0|this._getNearestIndex(d,m)]}getPointContainer(){return this._pointContainer}_nearestPointFromCache(d){return typeof this._i32idx[d]=="number"?this._i32idx[d]:-1}_getNearestIndex(d,m){let g=this._nearestPointFromCache(""+m.uint32);if(g>=0)return g;let w=Number.MAX_VALUE;g=0;for(let I=0,P=this._pointArray.length;I<P;I++){const F=this._pointArray[I],D=d.calculateRaw(m.r,m.g,m.b,m.a,F.r,F.g,F.b,F.a);D<w&&(w=D,g=I)}return this._i32idx[m.uint32]=g,g}sort(){this._i32idx={},this._pointArray.sort((d,m)=>{const g=rgb2hsl(d.r,d.g,d.b),w=rgb2hsl(m.r,m.g,m.b),I=d.r===d.g&&d.g===d.b?0:1+hueGroup(g.h,hueGroups),P=(m.r===m.g&&m.g===m.b?0:1+hueGroup(w.h,hueGroups))-I;if(P)return-P;const F=d.getLuminosity(!0),D=m.getLuminosity(!0);if(D-F!=0)return D-F;const U=(100*w.s|0)-(100*g.s|0);return U?-U:0})}},utils_exports={};__export(utils_exports,{HueStatistics:()=>HueStatistics,Palette:()=>Palette,Point:()=>Point,PointContainer:()=>PointContainer,ProgressTracker:()=>ProgressTracker,arithmetic:()=>arithmetic_exports});var HueGroup=class{constructor(){__publicField(this,"num",0),__publicField(this,"cols",[])}},HueStatistics=class{constructor(d,m){__publicField(this,"_numGroups"),__publicField(this,"_minCols"),__publicField(this,"_stats"),__publicField(this,"_groupsFull"),this._numGroups=d,this._minCols=m,this._stats=[];for(let g=0;g<=d;g++)this._stats[g]=new HueGroup;this._groupsFull=0}check(d){this._groupsFull===this._numGroups+1&&(this.check=()=>{});const m=255&d,g=d>>>8&255,w=d>>>16&255,I=m===g&&g===w?0:1+hueGroup(rgb2hsl(m,g,w).h,this._numGroups),P=this._stats[I],F=this._minCols;P.num++,P.num>F||(P.num===F&&this._groupsFull++,P.num<=F&&this._stats[I].cols.push(d))}injectIntoDictionary(d){for(let m=0;m<=this._numGroups;m++)this._stats[m].num<=this._minCols&&this._stats[m].cols.forEach(g=>{d[g]?d[g]++:d[g]=1})}injectIntoArray(d){for(let m=0;m<=this._numGroups;m++)this._stats[m].num<=this._minCols&&this._stats[m].cols.forEach(g=>{d.indexOf(g)===-1&&d.push(g)})}},_ProgressTracker=class{constructor(d,m){__publicField(this,"progress"),__publicField(this,"_step"),__publicField(this,"_range"),__publicField(this,"_last"),__publicField(this,"_progressRange"),this._range=d,this._progressRange=m,this._step=Math.max(1,this._range/(_ProgressTracker.steps+1)|0),this._last=-this._step,this.progress=0}shouldNotify(d){return d-this._last>=this._step&&(this._last=d,this.progress=Math.min(this._progressRange*this._last/this._range,this._progressRange),!0)}},ProgressTracker=_ProgressTracker;__publicField(ProgressTracker,"steps",100);var networkBiasShift=3,Neuron=class{constructor(d){__publicField(this,"r"),__publicField(this,"g"),__publicField(this,"b"),__publicField(this,"a"),this.r=this.g=this.b=this.a=d}toPoint(){return Point.createByRGBA(this.r>>networkBiasShift,this.g>>networkBiasShift,this.b>>networkBiasShift,this.a>>networkBiasShift)}subtract(d,m,g,w){this.r-=0|d,this.g-=0|m,this.b-=0|g,this.a-=0|w}},_NeuQuant=class extends AbstractPaletteQuantizer{constructor(d,m=256){super(),__publicField(this,"_pointArray"),__publicField(this,"_networkSize"),__publicField(this,"_network"),__publicField(this,"_sampleFactor"),__publicField(this,"_radPower"),__publicField(this,"_freq"),__publicField(this,"_bias"),__publicField(this,"_distance"),this._distance=d,this._pointArray=[],this._sampleFactor=1,this._networkSize=m,this._distance.setWhitePoint(255<<networkBiasShift,255<<networkBiasShift,255<<networkBiasShift,255<<networkBiasShift)}sample(d){this._pointArray=this._pointArray.concat(d.getPointArray())}*quantize(){this._init(),yield*this._learn(),yield{palette:this._buildPalette(),progress:100}}_init(){this._freq=[],this._bias=[],this._radPower=[],this._network=[];for(let d=0;d<this._networkSize;d++)this._network[d]=new Neuron((d<<networkBiasShift+8)/this._networkSize|0),this._freq[d]=_NeuQuant._initialBias/this._networkSize|0,this._bias[d]=0}*_learn(){let d=this._sampleFactor;const m=this._pointArray.length;m<_NeuQuant._minpicturebytes&&(d=1);const g=30+(d-1)/3|0,w=m/d|0;let I,P=w/_NeuQuant._nCycles|0,F=_NeuQuant._initAlpha,D=(this._networkSize>>3)*_NeuQuant._radiusBias,U=D>>_NeuQuant._radiusBiasShift;U<=1&&(U=0);for(let $=0;$<U;$++)this._radPower[$]=F*((U*U-$*$)*_NeuQuant._radBias/(U*U))>>>0;I=m<_NeuQuant._minpicturebytes?1:m%_NeuQuant._prime1!=0?_NeuQuant._prime1:m%_NeuQuant._prime2!=0?_NeuQuant._prime2:m%_NeuQuant._prime3!=0?_NeuQuant._prime3:_NeuQuant._prime4;const Z=new ProgressTracker(w,99);for(let $=0,j=0;$<w;){Z.shouldNotify($)&&(yield{progress:Z.progress});const H=this._pointArray[j],W=H.b<<networkBiasShift,V=H.g<<networkBiasShift,Q=H.r<<networkBiasShift,K=H.a<<networkBiasShift,q=this._contest(W,V,Q,K);if(this._alterSingle(F,q,W,V,Q,K),U!==0&&this._alterNeighbour(U,q,W,V,Q,K),j+=I,j>=m&&(j-=m),$++,P===0&&(P=1),$%P==0){F-=F/g|0,D-=D/_NeuQuant._radiusDecrease|0,U=D>>_NeuQuant._radiusBiasShift,U<=1&&(U=0);for(let et=0;et<U;et++)this._radPower[et]=F*((U*U-et*et)*_NeuQuant._radBias/(U*U))>>>0}}}_buildPalette(){const d=new Palette;return this._network.forEach(m=>{d.add(m.toPoint())}),d.sort(),d}_alterNeighbour(d,m,g,w,I,P){let F=m-d;F<-1&&(F=-1);let D=m+d;D>this._networkSize&&(D=this._networkSize);let U=m+1,Z=m-1,$=1;for(;U<D||Z>F;){const j=this._radPower[$++]/_NeuQuant._alphaRadBias;if(U<D){const H=this._network[U++];H.subtract(j*(H.r-I),j*(H.g-w),j*(H.b-g),j*(H.a-P))}if(Z>F){const H=this._network[Z--];H.subtract(j*(H.r-I),j*(H.g-w),j*(H.b-g),j*(H.a-P))}}}_alterSingle(d,m,g,w,I,P){d/=_NeuQuant._initAlpha;const F=this._network[m];F.subtract(d*(F.r-I),d*(F.g-w),d*(F.b-g),d*(F.a-P))}_contest(d,m,g,w){const I=1020<<networkBiasShift;let P=2147483647,F=P,D=-1,U=D;for(let Z=0;Z<this._networkSize;Z++){const $=this._network[Z],j=this._distance.calculateNormalized($,{r:g,g:m,b:d,a:w})*I|0;j<P&&(P=j,D=Z);const H=j-(this._bias[Z]>>_NeuQuant._initialBiasShift-networkBiasShift);H<F&&(F=H,U=Z);const W=this._freq[Z]>>_NeuQuant._betaShift;this._freq[Z]-=W,this._bias[Z]+=W<<_NeuQuant._gammaShift}return this._freq[D]+=_NeuQuant._beta,this._bias[D]-=_NeuQuant._betaGamma,U}},NeuQuant=_NeuQuant;__publicField(NeuQuant,"_prime1",499),__publicField(NeuQuant,"_prime2",491),__publicField(NeuQuant,"_prime3",487),__publicField(NeuQuant,"_prime4",503),__publicField(NeuQuant,"_minpicturebytes",_NeuQuant._prime4),__publicField(NeuQuant,"_nCycles",100),__publicField(NeuQuant,"_initialBiasShift",16),__publicField(NeuQuant,"_initialBias",1<<_NeuQuant._initialBiasShift),__publicField(NeuQuant,"_gammaShift",10),__publicField(NeuQuant,"_betaShift",10),__publicField(NeuQuant,"_beta",_NeuQuant._initialBias>>_NeuQuant._betaShift),__publicField(NeuQuant,"_betaGamma",_NeuQuant._initialBias<<_NeuQuant._gammaShift-_NeuQuant._betaShift),__publicField(NeuQuant,"_radiusBiasShift",6),__publicField(NeuQuant,"_radiusBias",1<<_NeuQuant._radiusBiasShift),__publicField(NeuQuant,"_radiusDecrease",30),__publicField(NeuQuant,"_alphaBiasShift",10),__publicField(NeuQuant,"_initAlpha",1<<_NeuQuant._alphaBiasShift),__publicField(NeuQuant,"_radBiasShift",8),__publicField(NeuQuant,"_radBias",1<<_NeuQuant._radBiasShift),__publicField(NeuQuant,"_alphaRadBiasShift",_NeuQuant._alphaBiasShift+_NeuQuant._radBiasShift),__publicField(NeuQuant,"_alphaRadBias",1<<_NeuQuant._alphaRadBiasShift);var networkBiasShift2=3,NeuronFloat=class{constructor(d){__publicField(this,"r"),__publicField(this,"g"),__publicField(this,"b"),__publicField(this,"a"),this.r=this.g=this.b=this.a=d}toPoint(){return Point.createByRGBA(this.r>>networkBiasShift2,this.g>>networkBiasShift2,this.b>>networkBiasShift2,this.a>>networkBiasShift2)}subtract(d,m,g,w){this.r-=d,this.g-=m,this.b-=g,this.a-=w}},_NeuQuantFloat=class extends AbstractPaletteQuantizer{constructor(d,m=256){super(),__publicField(this,"_pointArray"),__publicField(this,"_networkSize"),__publicField(this,"_network"),__publicField(this,"_sampleFactor"),__publicField(this,"_radPower"),__publicField(this,"_freq"),__publicField(this,"_bias"),__publicField(this,"_distance"),this._distance=d,this._pointArray=[],this._sampleFactor=1,this._networkSize=m,this._distance.setWhitePoint(255<<networkBiasShift2,255<<networkBiasShift2,255<<networkBiasShift2,255<<networkBiasShift2)}sample(d){this._pointArray=this._pointArray.concat(d.getPointArray())}*quantize(){this._init(),yield*this._learn(),yield{palette:this._buildPalette(),progress:100}}_init(){this._freq=[],this._bias=[],this._radPower=[],this._network=[];for(let d=0;d<this._networkSize;d++)this._network[d]=new NeuronFloat((d<<networkBiasShift2+8)/this._networkSize),this._freq[d]=_NeuQuantFloat._initialBias/this._networkSize,this._bias[d]=0}*_learn(){let d=this._sampleFactor;const m=this._pointArray.length;m<_NeuQuantFloat._minpicturebytes&&(d=1);const g=30+(d-1)/3,w=m/d;let I,P=w/_NeuQuantFloat._nCycles|0,F=_NeuQuantFloat._initAlpha,D=(this._networkSize>>3)*_NeuQuantFloat._radiusBias,U=D>>_NeuQuantFloat._radiusBiasShift;U<=1&&(U=0);for(let $=0;$<U;$++)this._radPower[$]=F*((U*U-$*$)*_NeuQuantFloat._radBias/(U*U));I=m<_NeuQuantFloat._minpicturebytes?1:m%_NeuQuantFloat._prime1!=0?_NeuQuantFloat._prime1:m%_NeuQuantFloat._prime2!=0?_NeuQuantFloat._prime2:m%_NeuQuantFloat._prime3!=0?_NeuQuantFloat._prime3:_NeuQuantFloat._prime4;const Z=new ProgressTracker(w,99);for(let $=0,j=0;$<w;){Z.shouldNotify($)&&(yield{progress:Z.progress});const H=this._pointArray[j],W=H.b<<networkBiasShift2,V=H.g<<networkBiasShift2,Q=H.r<<networkBiasShift2,K=H.a<<networkBiasShift2,q=this._contest(W,V,Q,K);if(this._alterSingle(F,q,W,V,Q,K),U!==0&&this._alterNeighbour(U,q,W,V,Q,K),j+=I,j>=m&&(j-=m),$++,P===0&&(P=1),$%P==0){F-=F/g,D-=D/_NeuQuantFloat._radiusDecrease,U=D>>_NeuQuantFloat._radiusBiasShift,U<=1&&(U=0);for(let et=0;et<U;et++)this._radPower[et]=F*((U*U-et*et)*_NeuQuantFloat._radBias/(U*U))}}}_buildPalette(){const d=new Palette;return this._network.forEach(m=>{d.add(m.toPoint())}),d.sort(),d}_alterNeighbour(d,m,g,w,I,P){let F=m-d;F<-1&&(F=-1);let D=m+d;D>this._networkSize&&(D=this._networkSize);let U=m+1,Z=m-1,$=1;for(;U<D||Z>F;){const j=this._radPower[$++]/_NeuQuantFloat._alphaRadBias;if(U<D){const H=this._network[U++];H.subtract(j*(H.r-I),j*(H.g-w),j*(H.b-g),j*(H.a-P))}if(Z>F){const H=this._network[Z--];H.subtract(j*(H.r-I),j*(H.g-w),j*(H.b-g),j*(H.a-P))}}}_alterSingle(d,m,g,w,I,P){d/=_NeuQuantFloat._initAlpha;const F=this._network[m];F.subtract(d*(F.r-I),d*(F.g-w),d*(F.b-g),d*(F.a-P))}_contest(d,m,g,w){const I=1020<<networkBiasShift2;let P=2147483647,F=P,D=-1,U=D;for(let Z=0;Z<this._networkSize;Z++){const $=this._network[Z],j=this._distance.calculateNormalized($,{r:g,g:m,b:d,a:w})*I;j<P&&(P=j,D=Z);const H=j-(this._bias[Z]>>_NeuQuantFloat._initialBiasShift-networkBiasShift2);H<F&&(F=H,U=Z);const W=this._freq[Z]>>_NeuQuantFloat._betaShift;this._freq[Z]-=W,this._bias[Z]+=W<<_NeuQuantFloat._gammaShift}return this._freq[D]+=_NeuQuantFloat._beta,this._bias[D]-=_NeuQuantFloat._betaGamma,U}},NeuQuantFloat=_NeuQuantFloat;__publicField(NeuQuantFloat,"_prime1",499),__publicField(NeuQuantFloat,"_prime2",491),__publicField(NeuQuantFloat,"_prime3",487),__publicField(NeuQuantFloat,"_prime4",503),__publicField(NeuQuantFloat,"_minpicturebytes",_NeuQuantFloat._prime4),__publicField(NeuQuantFloat,"_nCycles",100),__publicField(NeuQuantFloat,"_initialBiasShift",16),__publicField(NeuQuantFloat,"_initialBias",1<<_NeuQuantFloat._initialBiasShift),__publicField(NeuQuantFloat,"_gammaShift",10),__publicField(NeuQuantFloat,"_betaShift",10),__publicField(NeuQuantFloat,"_beta",_NeuQuantFloat._initialBias>>_NeuQuantFloat._betaShift),__publicField(NeuQuantFloat,"_betaGamma",_NeuQuantFloat._initialBias<<_NeuQuantFloat._gammaShift-_NeuQuantFloat._betaShift),__publicField(NeuQuantFloat,"_radiusBiasShift",6),__publicField(NeuQuantFloat,"_radiusBias",1<<_NeuQuantFloat._radiusBiasShift),__publicField(NeuQuantFloat,"_radiusDecrease",30),__publicField(NeuQuantFloat,"_alphaBiasShift",10),__publicField(NeuQuantFloat,"_initAlpha",1<<_NeuQuantFloat._alphaBiasShift),__publicField(NeuQuantFloat,"_radBiasShift",8),__publicField(NeuQuantFloat,"_radBias",1<<_NeuQuantFloat._radBiasShift),__publicField(NeuQuantFloat,"_alphaRadBiasShift",_NeuQuantFloat._alphaBiasShift+_NeuQuantFloat._radBiasShift),__publicField(NeuQuantFloat,"_alphaRadBias",1<<_NeuQuantFloat._alphaRadBiasShift);var _ColorHistogram=class{constructor(d,m){__publicField(this,"_method"),__publicField(this,"_hueStats"),__publicField(this,"_histogram"),__publicField(this,"_initColors"),__publicField(this,"_minHueCols"),this._method=d,this._minHueCols=m<<2,this._initColors=m<<2,this._hueStats=new HueStatistics(_ColorHistogram._hueGroups,this._minHueCols),this._histogram=Object.create(null)}sample(d){switch(this._method){case 1:this._colorStats1D(d);break;case 2:this._colorStats2D(d)}}getImportanceSortedColorsIDXI32(){const d=stableSort(Object.keys(this._histogram),(g,w)=>this._histogram[w]-this._histogram[g]);if(d.length===0)return[];let m;switch(this._method){case 1:const g=Math.min(d.length,this._initColors),w=d[g-1],I=this._histogram[w];m=d.slice(0,g);let P=g;const F=d.length;for(;P<F&&this._histogram[d[P]]===I;)m.push(d[P++]);this._hueStats.injectIntoArray(m);break;case 2:m=d;break;default:throw new Error("Incorrect method")}return m.map(g=>+g)}_colorStats1D(d){const m=this._histogram,g=d.getPointArray(),w=g.length;for(let I=0;I<w;I++){const P=g[I].uint32;this._hueStats.check(P),P in m?m[P]++:m[P]=1}}_colorStats2D(d){const m=d.getWidth(),g=d.getHeight(),w=d.getPointArray(),I=_ColorHistogram._boxSize[0],P=_ColorHistogram._boxSize[1],F=I*P,D=this._makeBoxes(m,g,I,P),U=this._histogram;D.forEach(Z=>{let $=Math.round(Z.w*Z.h/F)*_ColorHistogram._boxPixels;$<2&&($=2);const j={};this._iterateBox(Z,m,H=>{const W=w[H].uint32;this._hueStats.check(W),W in U?U[W]++:W in j?++j[W]>=$&&(U[W]=j[W]):j[W]=1})}),this._hueStats.injectIntoDictionary(U)}_iterateBox(d,m,g){const w=d,I=w.y*m+w.x,P=(w.y+w.h-1)*m+(w.x+w.w-1),F=m-w.w+1;let D=0,U=I;do g.call(this,U),U+=++D%w.w==0?F:1;while(U<=P)}_makeBoxes(d,m,g,w){const I=d%g,P=m%w,F=d-I,D=m-P,U=[];for(let Z=0;Z<m;Z+=w)for(let $=0;$<d;$+=g)U.push({x:$,y:Z,w:$===F?I:g,h:Z===D?P:w});return U}},ColorHistogram=_ColorHistogram;__publicField(ColorHistogram,"_boxSize",[64,64]),__publicField(ColorHistogram,"_boxPixels",2),__publicField(ColorHistogram,"_hueGroups",10);var RemovedColor=class{constructor(d,m,g){__publicField(this,"index"),__publicField(this,"color"),__publicField(this,"distance"),this.index=d,this.color=m,this.distance=g}},RGBQuant=class extends AbstractPaletteQuantizer{constructor(d,m=256,g=2){super(),__publicField(this,"_colors"),__publicField(this,"_initialDistance"),__publicField(this,"_distanceIncrement"),__publicField(this,"_histogram"),__publicField(this,"_distance"),this._distance=d,this._colors=m,this._histogram=new ColorHistogram(g,m),this._initialDistance=.01,this._distanceIncrement=.005}sample(d){this._histogram.sample(d)}*quantize(){const d=this._histogram.getImportanceSortedColorsIDXI32();if(d.length===0)throw new Error("No colors in image");yield*this._buildPalette(d)}*_buildPalette(d){const m=new Palette,g=m.getPointContainer().getPointArray(),w=new Array(d.length);for(let $=0;$<d.length;$++)g.push(Point.createByUint32(d[$])),w[$]=1;const I=g.length,P=[];let F=I,D=this._initialDistance;const U=new ProgressTracker(F-this._colors,99);for(;F>this._colors;){P.length=0;for(let $=0;$<I;$++){if(U.shouldNotify(I-F)&&(yield{progress:U.progress}),w[$]===0)continue;const j=g[$];for(let H=$+1;H<I;H++){if(w[H]===0)continue;const W=g[H],V=this._distance.calculateNormalized(j,W);V<D&&(P.push(new RemovedColor(H,W,V)),w[H]=0,F--)}}D+=F>3*this._colors?this._initialDistance:this._distanceIncrement}if(F<this._colors){stableSort(P,(j,H)=>H.distance-j.distance);let $=0;for(;F<this._colors&&$<P.length;)w[P[$].index]=1,F++,$++}let Z=g.length;for(let $=Z-1;$>=0;$--)w[$]===0&&($!==Z-1&&(g[$]=g[Z-1]),--Z);g.length=Z,m.sort(),yield{palette:m,progress:100}}};function createArray1D(d){const m=[];for(let g=0;g<d;g++)m[g]=0;return m}function createArray4D(d,m,g,w){const I=new Array(d);for(let P=0;P<d;P++){I[P]=new Array(m);for(let F=0;F<m;F++){I[P][F]=new Array(g);for(let D=0;D<g;D++){I[P][F][D]=new Array(w);for(let U=0;U<w;U++)I[P][F][D][U]=0}}}return I}function createArray3D(d,m,g){const w=new Array(d);for(let I=0;I<d;I++){w[I]=new Array(m);for(let P=0;P<m;P++){w[I][P]=new Array(g);for(let F=0;F<g;F++)w[I][P][F]=0}}return w}function fillArray3D(d,m,g,w,I){for(let P=0;P<m;P++){d[P]=[];for(let F=0;F<g;F++){d[P][F]=[];for(let D=0;D<w;D++)d[P][F][D]=I}}}function fillArray1D(d,m,g){for(let w=0;w<m;w++)d[w]=g}var WuColorCube=class{constructor(){__publicField(this,"redMinimum"),__publicField(this,"redMaximum"),__publicField(this,"greenMinimum"),__publicField(this,"greenMaximum"),__publicField(this,"blueMinimum"),__publicField(this,"blueMaximum"),__publicField(this,"volume"),__publicField(this,"alphaMinimum"),__publicField(this,"alphaMaximum")}},_WuQuant=class extends AbstractPaletteQuantizer{constructor(d,m=256,g=5){super(),__publicField(this,"_reds"),__publicField(this,"_greens"),__publicField(this,"_blues"),__publicField(this,"_alphas"),__publicField(this,"_sums"),__publicField(this,"_weights"),__publicField(this,"_momentsRed"),__publicField(this,"_momentsGreen"),__publicField(this,"_momentsBlue"),__publicField(this,"_momentsAlpha"),__publicField(this,"_moments"),__publicField(this,"_table"),__publicField(this,"_pixels"),__publicField(this,"_cubes"),__publicField(this,"_colors"),__publicField(this,"_significantBitsPerChannel"),__publicField(this,"_maxSideIndex"),__publicField(this,"_alphaMaxSideIndex"),__publicField(this,"_sideSize"),__publicField(this,"_alphaSideSize"),__publicField(this,"_distance"),this._distance=d,this._setQuality(g),this._initialize(m)}sample(d){const m=d.getPointArray();for(let g=0,w=m.length;g<w;g++)this._addColor(m[g]);this._pixels=this._pixels.concat(m)}*quantize(){yield*this._preparePalette();const d=new Palette;for(let m=0;m<this._colors;m++)if(this._sums[m]>0){const g=this._sums[m],w=this._reds[m]/g,I=this._greens[m]/g,P=this._blues[m]/g,F=this._alphas[m]/g,D=Point.createByRGBA(0|w,0|I,0|P,0|F);d.add(D)}d.sort(),yield{palette:d,progress:100}}*_preparePalette(){yield*this._calculateMoments();let d=0;const m=createArray1D(this._colors);for(let F=1;F<this._colors;++F){this._cut(this._cubes[d],this._cubes[F])?(m[d]=this._cubes[d].volume>1?this._calculateVariance(this._cubes[d]):0,m[F]=this._cubes[F].volume>1?this._calculateVariance(this._cubes[F]):0):(m[d]=0,F--),d=0;let D=m[0];for(let U=1;U<=F;++U)m[U]>D&&(D=m[U],d=U);if(D<=0){this._colors=F+1;break}}const g=[],w=[],I=[],P=[];for(let F=0;F<this._colors;++F){const D=_WuQuant._volume(this._cubes[F],this._weights);D>0?(g[F]=_WuQuant._volume(this._cubes[F],this._momentsRed)/D|0,w[F]=_WuQuant._volume(this._cubes[F],this._momentsGreen)/D|0,I[F]=_WuQuant._volume(this._cubes[F],this._momentsBlue)/D|0,P[F]=_WuQuant._volume(this._cubes[F],this._momentsAlpha)/D|0):(g[F]=0,w[F]=0,I[F]=0,P[F]=0)}this._reds=createArray1D(this._colors+1),this._greens=createArray1D(this._colors+1),this._blues=createArray1D(this._colors+1),this._alphas=createArray1D(this._colors+1),this._sums=createArray1D(this._colors+1);for(let F=0,D=this._pixels.length;F<D;F++){const U=this._pixels[F];let Z=-1,$=Number.MAX_VALUE;for(let j=0;j<this._colors;j++){const H=g[j],W=w[j],V=I[j],Q=P[j],K=this._distance.calculateRaw(H,W,V,Q,U.r,U.g,U.b,U.a);K<$&&($=K,Z=j)}this._reds[Z]+=U.r,this._greens[Z]+=U.g,this._blues[Z]+=U.b,this._alphas[Z]+=U.a,this._sums[Z]++}}_addColor(d){const m=8-this._significantBitsPerChannel,g=1+(d.r>>m),w=1+(d.g>>m),I=1+(d.b>>m),P=1+(d.a>>m);this._weights[P][g][w][I]++,this._momentsRed[P][g][w][I]+=d.r,this._momentsGreen[P][g][w][I]+=d.g,this._momentsBlue[P][g][w][I]+=d.b,this._momentsAlpha[P][g][w][I]+=d.a,this._moments[P][g][w][I]+=this._table[d.r]+this._table[d.g]+this._table[d.b]+this._table[d.a]}*_calculateMoments(){const d=[],m=[],g=[],w=[],I=[],P=[],F=createArray3D(this._sideSize,this._sideSize,this._sideSize),D=createArray3D(this._sideSize,this._sideSize,this._sideSize),U=createArray3D(this._sideSize,this._sideSize,this._sideSize),Z=createArray3D(this._sideSize,this._sideSize,this._sideSize),$=createArray3D(this._sideSize,this._sideSize,this._sideSize),j=createArray3D(this._sideSize,this._sideSize,this._sideSize);let H=0;const W=new ProgressTracker(this._alphaMaxSideIndex*this._maxSideIndex,99);for(let V=1;V<=this._alphaMaxSideIndex;++V){fillArray3D(F,this._sideSize,this._sideSize,this._sideSize,0),fillArray3D(D,this._sideSize,this._sideSize,this._sideSize,0),fillArray3D(U,this._sideSize,this._sideSize,this._sideSize,0),fillArray3D(Z,this._sideSize,this._sideSize,this._sideSize,0),fillArray3D($,this._sideSize,this._sideSize,this._sideSize,0),fillArray3D(j,this._sideSize,this._sideSize,this._sideSize,0);for(let Q=1;Q<=this._maxSideIndex;++Q,++H){W.shouldNotify(H)&&(yield{progress:W.progress}),fillArray1D(d,this._sideSize,0),fillArray1D(m,this._sideSize,0),fillArray1D(g,this._sideSize,0),fillArray1D(w,this._sideSize,0),fillArray1D(I,this._sideSize,0),fillArray1D(P,this._sideSize,0);for(let K=1;K<=this._maxSideIndex;++K){let q=0,et=0,X=0,tt=0,rt=0,ot=0;for(let J=1;J<=this._maxSideIndex;++J)q+=this._weights[V][Q][K][J],et+=this._momentsRed[V][Q][K][J],X+=this._momentsGreen[V][Q][K][J],tt+=this._momentsBlue[V][Q][K][J],rt+=this._momentsAlpha[V][Q][K][J],ot+=this._moments[V][Q][K][J],d[J]+=q,m[J]+=et,g[J]+=X,w[J]+=tt,I[J]+=rt,P[J]+=ot,F[Q][K][J]=F[Q-1][K][J]+d[J],D[Q][K][J]=D[Q-1][K][J]+m[J],U[Q][K][J]=U[Q-1][K][J]+g[J],Z[Q][K][J]=Z[Q-1][K][J]+w[J],$[Q][K][J]=$[Q-1][K][J]+I[J],j[Q][K][J]=j[Q-1][K][J]+P[J],this._weights[V][Q][K][J]=this._weights[V-1][Q][K][J]+F[Q][K][J],this._momentsRed[V][Q][K][J]=this._momentsRed[V-1][Q][K][J]+D[Q][K][J],this._momentsGreen[V][Q][K][J]=this._momentsGreen[V-1][Q][K][J]+U[Q][K][J],this._momentsBlue[V][Q][K][J]=this._momentsBlue[V-1][Q][K][J]+Z[Q][K][J],this._momentsAlpha[V][Q][K][J]=this._momentsAlpha[V-1][Q][K][J]+$[Q][K][J],this._moments[V][Q][K][J]=this._moments[V-1][Q][K][J]+j[Q][K][J]}}}}static _volumeFloat(d,m){return m[d.alphaMaximum][d.redMaximum][d.greenMaximum][d.blueMaximum]-m[d.alphaMaximum][d.redMaximum][d.greenMinimum][d.blueMaximum]-m[d.alphaMaximum][d.redMinimum][d.greenMaximum][d.blueMaximum]+m[d.alphaMaximum][d.redMinimum][d.greenMinimum][d.blueMaximum]-m[d.alphaMinimum][d.redMaximum][d.greenMaximum][d.blueMaximum]+m[d.alphaMinimum][d.redMaximum][d.greenMinimum][d.blueMaximum]+m[d.alphaMinimum][d.redMinimum][d.greenMaximum][d.blueMaximum]-m[d.alphaMinimum][d.redMinimum][d.greenMinimum][d.blueMaximum]-(m[d.alphaMaximum][d.redMaximum][d.greenMaximum][d.blueMinimum]-m[d.alphaMinimum][d.redMaximum][d.greenMaximum][d.blueMinimum]-m[d.alphaMaximum][d.redMaximum][d.greenMinimum][d.blueMinimum]+m[d.alphaMinimum][d.redMaximum][d.greenMinimum][d.blueMinimum]-m[d.alphaMaximum][d.redMinimum][d.greenMaximum][d.blueMinimum]+m[d.alphaMinimum][d.redMinimum][d.greenMaximum][d.blueMinimum]+m[d.alphaMaximum][d.redMinimum][d.greenMinimum][d.blueMinimum]-m[d.alphaMinimum][d.redMinimum][d.greenMinimum][d.blueMinimum])}static _volume(d,m){return 0|_WuQuant._volumeFloat(d,m)}static _top(d,m,g,w){let I;switch(m){case _WuQuant._alpha:I=w[g][d.redMaximum][d.greenMaximum][d.blueMaximum]-w[g][d.redMaximum][d.greenMinimum][d.blueMaximum]-w[g][d.redMinimum][d.greenMaximum][d.blueMaximum]+w[g][d.redMinimum][d.greenMinimum][d.blueMaximum]-(w[g][d.redMaximum][d.greenMaximum][d.blueMinimum]-w[g][d.redMaximum][d.greenMinimum][d.blueMinimum]-w[g][d.redMinimum][d.greenMaximum][d.blueMinimum]+w[g][d.redMinimum][d.greenMinimum][d.blueMinimum]);break;case _WuQuant._red:I=w[d.alphaMaximum][g][d.greenMaximum][d.blueMaximum]-w[d.alphaMaximum][g][d.greenMinimum][d.blueMaximum]-w[d.alphaMinimum][g][d.greenMaximum][d.blueMaximum]+w[d.alphaMinimum][g][d.greenMinimum][d.blueMaximum]-(w[d.alphaMaximum][g][d.greenMaximum][d.blueMinimum]-w[d.alphaMaximum][g][d.greenMinimum][d.blueMinimum]-w[d.alphaMinimum][g][d.greenMaximum][d.blueMinimum]+w[d.alphaMinimum][g][d.greenMinimum][d.blueMinimum]);break;case _WuQuant._green:I=w[d.alphaMaximum][d.redMaximum][g][d.blueMaximum]-w[d.alphaMaximum][d.redMinimum][g][d.blueMaximum]-w[d.alphaMinimum][d.redMaximum][g][d.blueMaximum]+w[d.alphaMinimum][d.redMinimum][g][d.blueMaximum]-(w[d.alphaMaximum][d.redMaximum][g][d.blueMinimum]-w[d.alphaMaximum][d.redMinimum][g][d.blueMinimum]-w[d.alphaMinimum][d.redMaximum][g][d.blueMinimum]+w[d.alphaMinimum][d.redMinimum][g][d.blueMinimum]);break;case _WuQuant._blue:I=w[d.alphaMaximum][d.redMaximum][d.greenMaximum][g]-w[d.alphaMaximum][d.redMaximum][d.greenMinimum][g]-w[d.alphaMaximum][d.redMinimum][d.greenMaximum][g]+w[d.alphaMaximum][d.redMinimum][d.greenMinimum][g]-(w[d.alphaMinimum][d.redMaximum][d.greenMaximum][g]-w[d.alphaMinimum][d.redMaximum][d.greenMinimum][g]-w[d.alphaMinimum][d.redMinimum][d.greenMaximum][g]+w[d.alphaMinimum][d.redMinimum][d.greenMinimum][g]);break;default:throw new Error("impossible")}return 0|I}static _bottom(d,m,g){switch(m){case _WuQuant._alpha:return-g[d.alphaMinimum][d.redMaximum][d.greenMaximum][d.blueMaximum]+g[d.alphaMinimum][d.redMaximum][d.greenMinimum][d.blueMaximum]+g[d.alphaMinimum][d.redMinimum][d.greenMaximum][d.blueMaximum]-g[d.alphaMinimum][d.redMinimum][d.greenMinimum][d.blueMaximum]-(-g[d.alphaMinimum][d.redMaximum][d.greenMaximum][d.blueMinimum]+g[d.alphaMinimum][d.redMaximum][d.greenMinimum][d.blueMinimum]+g[d.alphaMinimum][d.redMinimum][d.greenMaximum][d.blueMinimum]-g[d.alphaMinimum][d.redMinimum][d.greenMinimum][d.blueMinimum]);case _WuQuant._red:return-g[d.alphaMaximum][d.redMinimum][d.greenMaximum][d.blueMaximum]+g[d.alphaMaximum][d.redMinimum][d.greenMinimum][d.blueMaximum]+g[d.alphaMinimum][d.redMinimum][d.greenMaximum][d.blueMaximum]-g[d.alphaMinimum][d.redMinimum][d.greenMinimum][d.blueMaximum]-(-g[d.alphaMaximum][d.redMinimum][d.greenMaximum][d.blueMinimum]+g[d.alphaMaximum][d.redMinimum][d.greenMinimum][d.blueMinimum]+g[d.alphaMinimum][d.redMinimum][d.greenMaximum][d.blueMinimum]-g[d.alphaMinimum][d.redMinimum][d.greenMinimum][d.blueMinimum]);case _WuQuant._green:return-g[d.alphaMaximum][d.redMaximum][d.greenMinimum][d.blueMaximum]+g[d.alphaMaximum][d.redMinimum][d.greenMinimum][d.blueMaximum]+g[d.alphaMinimum][d.redMaximum][d.greenMinimum][d.blueMaximum]-g[d.alphaMinimum][d.redMinimum][d.greenMinimum][d.blueMaximum]-(-g[d.alphaMaximum][d.redMaximum][d.greenMinimum][d.blueMinimum]+g[d.alphaMaximum][d.redMinimum][d.greenMinimum][d.blueMinimum]+g[d.alphaMinimum][d.redMaximum][d.greenMinimum][d.blueMinimum]-g[d.alphaMinimum][d.redMinimum][d.greenMinimum][d.blueMinimum]);case _WuQuant._blue:return-g[d.alphaMaximum][d.redMaximum][d.greenMaximum][d.blueMinimum]+g[d.alphaMaximum][d.redMaximum][d.greenMinimum][d.blueMinimum]+g[d.alphaMaximum][d.redMinimum][d.greenMaximum][d.blueMinimum]-g[d.alphaMaximum][d.redMinimum][d.greenMinimum][d.blueMinimum]-(-g[d.alphaMinimum][d.redMaximum][d.greenMaximum][d.blueMinimum]+g[d.alphaMinimum][d.redMaximum][d.greenMinimum][d.blueMinimum]+g[d.alphaMinimum][d.redMinimum][d.greenMaximum][d.blueMinimum]-g[d.alphaMinimum][d.redMinimum][d.greenMinimum][d.blueMinimum]);default:return 0}}_calculateVariance(d){const m=_WuQuant._volume(d,this._momentsRed),g=_WuQuant._volume(d,this._momentsGreen),w=_WuQuant._volume(d,this._momentsBlue),I=_WuQuant._volume(d,this._momentsAlpha);return _WuQuant._volumeFloat(d,this._moments)-(m*m+g*g+w*w+I*I)/_WuQuant._volume(d,this._weights)}_maximize(d,m,g,w,I,P,F,D,U){const Z=0|_WuQuant._bottom(d,m,this._momentsRed),$=0|_WuQuant._bottom(d,m,this._momentsGreen),j=0|_WuQuant._bottom(d,m,this._momentsBlue),H=0|_WuQuant._bottom(d,m,this._momentsAlpha),W=0|_WuQuant._bottom(d,m,this._weights);let V=0,Q=-1;for(let K=g;K<w;++K){let q=Z+_WuQuant._top(d,m,K,this._momentsRed),et=$+_WuQuant._top(d,m,K,this._momentsGreen),X=j+_WuQuant._top(d,m,K,this._momentsBlue),tt=H+_WuQuant._top(d,m,K,this._momentsAlpha),rt=W+_WuQuant._top(d,m,K,this._weights);if(rt!==0){let ot=q*q+et*et+X*X+tt*tt,J=ot/rt;q=I-q,et=P-et,X=F-X,tt=D-tt,rt=U-rt,rt!==0&&(ot=q*q+et*et+X*X+tt*tt,J+=ot/rt,J>V&&(V=J,Q=K))}}return{max:V,position:Q}}_cut(d,m){let g;const w=_WuQuant._volume(d,this._momentsRed),I=_WuQuant._volume(d,this._momentsGreen),P=_WuQuant._volume(d,this._momentsBlue),F=_WuQuant._volume(d,this._momentsAlpha),D=_WuQuant._volume(d,this._weights),U=this._maximize(d,_WuQuant._red,d.redMinimum+1,d.redMaximum,w,I,P,F,D),Z=this._maximize(d,_WuQuant._green,d.greenMinimum+1,d.greenMaximum,w,I,P,F,D),$=this._maximize(d,_WuQuant._blue,d.blueMinimum+1,d.blueMaximum,w,I,P,F,D),j=this._maximize(d,_WuQuant._alpha,d.alphaMinimum+1,d.alphaMaximum,w,I,P,F,D);if(j.max>=U.max&&j.max>=Z.max&&j.max>=$.max){if(g=_WuQuant._alpha,j.position<0)return!1}else g=U.max>=j.max&&U.max>=Z.max&&U.max>=$.max?_WuQuant._red:Z.max>=j.max&&Z.max>=U.max&&Z.max>=$.max?_WuQuant._green:_WuQuant._blue;switch(m.redMaximum=d.redMaximum,m.greenMaximum=d.greenMaximum,m.blueMaximum=d.blueMaximum,m.alphaMaximum=d.alphaMaximum,g){case _WuQuant._red:m.redMinimum=d.redMaximum=U.position,m.greenMinimum=d.greenMinimum,m.blueMinimum=d.blueMinimum,m.alphaMinimum=d.alphaMinimum;break;case _WuQuant._green:m.greenMinimum=d.greenMaximum=Z.position,m.redMinimum=d.redMinimum,m.blueMinimum=d.blueMinimum,m.alphaMinimum=d.alphaMinimum;break;case _WuQuant._blue:m.blueMinimum=d.blueMaximum=$.position,m.redMinimum=d.redMinimum,m.greenMinimum=d.greenMinimum,m.alphaMinimum=d.alphaMinimum;break;case _WuQuant._alpha:m.alphaMinimum=d.alphaMaximum=j.position,m.blueMinimum=d.blueMinimum,m.redMinimum=d.redMinimum,m.greenMinimum=d.greenMinimum}return d.volume=(d.redMaximum-d.redMinimum)*(d.greenMaximum-d.greenMinimum)*(d.blueMaximum-d.blueMinimum)*(d.alphaMaximum-d.alphaMinimum),m.volume=(m.redMaximum-m.redMinimum)*(m.greenMaximum-m.greenMinimum)*(m.blueMaximum-m.blueMinimum)*(m.alphaMaximum-m.alphaMinimum),!0}_initialize(d){this._colors=d,this._cubes=[];for(let m=0;m<d;m++)this._cubes[m]=new WuColorCube;this._cubes[0].redMinimum=0,this._cubes[0].greenMinimum=0,this._cubes[0].blueMinimum=0,this._cubes[0].alphaMinimum=0,this._cubes[0].redMaximum=this._maxSideIndex,this._cubes[0].greenMaximum=this._maxSideIndex,this._cubes[0].blueMaximum=this._maxSideIndex,this._cubes[0].alphaMaximum=this._alphaMaxSideIndex,this._weights=createArray4D(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._momentsRed=createArray4D(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._momentsGreen=createArray4D(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._momentsBlue=createArray4D(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._momentsAlpha=createArray4D(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._moments=createArray4D(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._table=[];for(let m=0;m<256;++m)this._table[m]=m*m;this._pixels=[]}_setQuality(d=5){this._significantBitsPerChannel=d,this._maxSideIndex=1<<this._significantBitsPerChannel,this._alphaMaxSideIndex=this._maxSideIndex,this._sideSize=this._maxSideIndex+1,this._alphaSideSize=this._alphaMaxSideIndex+1}},WuQuant=_WuQuant;__publicField(WuQuant,"_alpha",3),__publicField(WuQuant,"_red",2),__publicField(WuQuant,"_green",1),__publicField(WuQuant,"_blue",0);var image_exports={};__export(image_exports,{AbstractImageQuantizer:()=>AbstractImageQuantizer,ErrorDiffusionArray:()=>ErrorDiffusionArray,ErrorDiffusionArrayKernel:()=>ErrorDiffusionArrayKernel,ErrorDiffusionRiemersma:()=>ErrorDiffusionRiemersma,NearestColor:()=>NearestColor});var AbstractImageQuantizer=class{quantizeSync(d,m){for(const g of this.quantize(d,m))if(g.pointContainer)return g.pointContainer;throw new Error("unreachable")}},NearestColor=class extends AbstractImageQuantizer{constructor(d){super(),__publicField(this,"_distance"),this._distance=d}*quantize(d,m){const g=d.getPointArray(),w=d.getWidth(),I=d.getHeight(),P=new ProgressTracker(I,99);for(let F=0;F<I;F++){P.shouldNotify(F)&&(yield{progress:P.progress});for(let D=0,U=F*w;D<w;D++,U++){const Z=g[U];Z.from(m.getNearestColor(this._distance,Z))}}yield{pointContainer:d,progress:100}}},ErrorDiffusionArrayKernel=(d=>(d[d.FloydSteinberg=0]="FloydSteinberg",d[d.FalseFloydSteinberg=1]="FalseFloydSteinberg",d[d.Stucki=2]="Stucki",d[d.Atkinson=3]="Atkinson",d[d.Jarvis=4]="Jarvis",d[d.Burkes=5]="Burkes",d[d.Sierra=6]="Sierra",d[d.TwoSierra=7]="TwoSierra",d[d.SierraLite=8]="SierraLite",d))(ErrorDiffusionArrayKernel||{}),ErrorDiffusionArray=class extends AbstractImageQuantizer{constructor(d,m,g=!0,w=0,I=!1){super(),__publicField(this,"_minColorDistance"),__publicField(this,"_serpentine"),__publicField(this,"_kernel"),__publicField(this,"_calculateErrorLikeGIMP"),__publicField(this,"_distance"),this._setKernel(m),this._distance=d,this._minColorDistance=w,this._serpentine=g,this._calculateErrorLikeGIMP=I}*quantize(d,m){const g=d.getPointArray(),w=new Point,I=d.getWidth(),P=d.getHeight(),F=[];let D=1,U=1;for(const $ of this._kernel){const j=$[2]+1;U<j&&(U=j)}for(let $=0;$<U;$++)this._fillErrorLine(F[$]=[],I);const Z=new ProgressTracker(P,99);for(let $=0;$<P;$++){Z.shouldNotify($)&&(yield{progress:Z.progress}),this._serpentine&&(D*=-1);const j=$*I,H=D===1?0:I-1,W=D===1?I:-1;this._fillErrorLine(F[0],I),F.push(F.shift());const V=F[0];for(let Q=H,K=j+H;Q!==W;Q+=D,K+=D){const q=g[K],et=V[Q];w.from(q);const X=Point.createByRGBA(inRange0to255Rounded(q.r+et[0]),inRange0to255Rounded(q.g+et[1]),inRange0to255Rounded(q.b+et[2]),inRange0to255Rounded(q.a+et[3])),tt=m.getNearestColor(this._distance,X);if(q.from(tt),this._minColorDistance&&this._distance.calculateNormalized(w,tt)<this._minColorDistance)continue;let rt,ot,J,lt;this._calculateErrorLikeGIMP?(rt=X.r-tt.r,ot=X.g-tt.g,J=X.b-tt.b,lt=X.a-tt.a):(rt=w.r-tt.r,ot=w.g-tt.g,J=w.b-tt.b,lt=w.a-tt.a);const st=D===1?0:this._kernel.length-1,ut=D===1?this._kernel.length:-1;for(let it=st;it!==ut;it+=D){const ct=this._kernel[it][1]*D,At=this._kernel[it][2];if(ct+Q>=0&&ct+Q<I&&At+$>=0&&At+$<P){const Et=this._kernel[it][0],gt=F[At][ct+Q];gt[0]+=rt*Et,gt[1]+=ot*Et,gt[2]+=J*Et,gt[3]+=lt*Et}}}}yield{pointContainer:d,progress:100}}_fillErrorLine(d,m){d.length>m&&(d.length=m);const g=d.length;for(let w=0;w<g;w++){const I=d[w];I[0]=I[1]=I[2]=I[3]=0}for(let w=g;w<m;w++)d[w]=[0,0,0,0]}_setKernel(d){switch(d){case 0:this._kernel=[[7/16,1,0],[3/16,-1,1],[5/16,0,1],[1/16,1,1]];break;case 1:this._kernel=[[3/8,1,0],[3/8,0,1],[2/8,1,1]];break;case 2:this._kernel=[[8/42,1,0],[4/42,2,0],[2/42,-2,1],[4/42,-1,1],[8/42,0,1],[4/42,1,1],[2/42,2,1],[1/42,-2,2],[2/42,-1,2],[4/42,0,2],[2/42,1,2],[1/42,2,2]];break;case 3:this._kernel=[[1/8,1,0],[1/8,2,0],[1/8,-1,1],[1/8,0,1],[1/8,1,1],[1/8,0,2]];break;case 4:this._kernel=[[7/48,1,0],[5/48,2,0],[3/48,-2,1],[5/48,-1,1],[7/48,0,1],[5/48,1,1],[3/48,2,1],[1/48,-2,2],[3/48,-1,2],[5/48,0,2],[3/48,1,2],[1/48,2,2]];break;case 5:this._kernel=[[.25,1,0],[4/32,2,0],[2/32,-2,1],[4/32,-1,1],[.25,0,1],[4/32,1,1],[2/32,2,1]];break;case 6:this._kernel=[[5/32,1,0],[3/32,2,0],[2/32,-2,1],[4/32,-1,1],[5/32,0,1],[4/32,1,1],[2/32,2,1],[2/32,-1,2],[3/32,0,2],[2/32,1,2]];break;case 7:this._kernel=[[.25,1,0],[3/16,2,0],[1/16,-2,1],[2/16,-1,1],[3/16,0,1],[2/16,1,1],[1/16,2,1]];break;case 8:this._kernel=[[.5,1,0],[1/4,-1,1],[1/4,0,1]];break;default:throw new Error(`ErrorDiffusionArray: unknown kernel = ${d}`)}}};function*hilbertCurve(d,m,g){const w=Math.max(d,m),I={width:d,height:m,level:Math.floor(Math.log(w)/Math.log(2)+1),callback:g,tracker:new ProgressTracker(d*m,99),index:0,x:0,y:0};yield*walkHilbert(I,1),visit(I,0)}function*walkHilbert(d,m){if(!(d.level<1)){switch(d.tracker.shouldNotify(d.index)&&(yield{progress:d.tracker.progress}),d.level--,m){case 2:yield*walkHilbert(d,1),visit(d,3),yield*walkHilbert(d,2),visit(d,4),yield*walkHilbert(d,2),visit(d,2),yield*walkHilbert(d,4);break;case 3:yield*walkHilbert(d,4),visit(d,2),yield*walkHilbert(d,3),visit(d,1),yield*walkHilbert(d,3),visit(d,3),yield*walkHilbert(d,1);break;case 1:yield*walkHilbert(d,2),visit(d,4),yield*walkHilbert(d,1),visit(d,3),yield*walkHilbert(d,1),visit(d,1),yield*walkHilbert(d,3);break;case 4:yield*walkHilbert(d,3),visit(d,1),yield*walkHilbert(d,4),visit(d,2),yield*walkHilbert(d,4),visit(d,4),yield*walkHilbert(d,2)}d.level++}}function visit(d,m){switch(d.x>=0&&d.x<d.width&&d.y>=0&&d.y<d.height&&(d.callback(d.x,d.y),d.index++),m){case 2:d.x--;break;case 3:d.x++;break;case 1:d.y--;break;case 4:d.y++}}var ErrorDiffusionRiemersma=class extends AbstractImageQuantizer{constructor(d,m=16,g=1){super(),__publicField(this,"_distance"),__publicField(this,"_weights"),__publicField(this,"_errorQueueSize"),this._distance=d,this._errorQueueSize=m,this._weights=ErrorDiffusionRiemersma._createWeights(g,m)}*quantize(d,m){const g=d.getPointArray(),w=d.getWidth(),I=d.getHeight(),P=[];let F=0;for(let D=0;D<this._errorQueueSize;D++)P[D]={r:0,g:0,b:0,a:0};yield*hilbertCurve(w,I,(D,U)=>{const Z=g[D+U*w];let{r:$,g:j,b:H,a:W}=Z;for(let q=0;q<this._errorQueueSize;q++){const et=this._weights[q],X=P[(q+F)%this._errorQueueSize];$+=X.r*et,j+=X.g*et,H+=X.b*et,W+=X.a*et}const V=Point.createByRGBA(inRange0to255Rounded($),inRange0to255Rounded(j),inRange0to255Rounded(H),inRange0to255Rounded(W)),Q=m.getNearestColor(this._distance,V);F=(F+1)%this._errorQueueSize;const K=(F+this._errorQueueSize-1)%this._errorQueueSize;P[K].r=Z.r-Q.r,P[K].g=Z.g-Q.g,P[K].b=Z.b-Q.b,P[K].a=Z.a-Q.a,Z.from(Q)}),yield{pointContainer:d,progress:100}}static _createWeights(d,m){const g=[],w=Math.exp(Math.log(m)/(m-1));for(let I=0,P=1;I<m;I++)g[I]=(P+.5|0)/m*d,P*=w;return g}},quality_exports={};__export(quality_exports,{ssim:()=>ssim});var K1=.01,K2=.03;function ssim(d,m){if(d.getHeight()!==m.getHeight()||d.getWidth()!==m.getWidth())throw new Error("Images have different sizes!");const g=(255*K1)**2,w=(255*K2)**2;let I=0,P=0;return iterate(d,m,(F,D,U,Z)=>{let $=0,j=0,H=0;for(let V=0;V<F.length;V++)j+=(F[V]-U)**2,H+=(D[V]-Z)**2,$+=(F[V]-U)*(D[V]-Z);const W=F.length-1;j/=W,H/=W,$/=W,P+=(2*U*Z+g)*(2*$+w)/((U**2+Z**2+g)*(j+H+w)),I++}),P/I}function iterate(d,m,g){const w=d.getWidth(),I=d.getHeight();for(let P=0;P<I;P+=8)for(let F=0;F<w;F+=8){const D=Math.min(8,w-F),U=Math.min(8,I-P),Z=calculateLumaValuesForWindow(d,F,P,D,U),$=calculateLumaValuesForWindow(m,F,P,D,U);g(Z,$,calculateAverageLuma(Z),calculateAverageLuma($))}}function calculateLumaValuesForWindow(d,m,g,w,I){const P=d.getPointArray(),F=[];let D=0;for(let U=g;U<g+I;U++){const Z=U*d.getWidth();for(let $=m;$<m+w;$++){const j=P[Z+$];F[D]=.2126*j.r+.7152*j.g+.0722*j.b,D++}}return F}function calculateAverageLuma(d){let m=0;for(const g of d)m+=g;return m/d.length}function buildPaletteSync(d,{colorDistanceFormula:m,paletteQuantization:g,colors:w}={}){const I=paletteQuantizationToPaletteQuantizer(colorDistanceFormulaToColorDistance(m),g,w);return d.forEach(P=>I.sample(P)),I.quantizeSync()}function applyPaletteSync(d,m,{colorDistanceFormula:g,imageQuantization:w}={}){return imageQuantizationToImageQuantizer(colorDistanceFormulaToColorDistance(g),w).quantizeSync(d,m)}function colorDistanceFormulaToColorDistance(d="euclidean-bt709"){switch(d){case"cie94-graphic-arts":return new CIE94GraphicArts;case"cie94-textiles":return new CIE94Textiles;case"ciede2000":return new CIEDE2000;case"color-metric":return new CMetric;case"euclidean":return new Euclidean;case"euclidean-bt709":return new EuclideanBT709;case"euclidean-bt709-noalpha":return new EuclideanBT709NoAlpha;case"manhattan":return new Manhattan;case"manhattan-bt709":return new ManhattanBT709;case"manhattan-nommyde":return new ManhattanNommyde;case"pngquant":return new PNGQuant;default:throw new Error(`Unknown colorDistanceFormula ${d}`)}}function imageQuantizationToImageQuantizer(d,m="floyd-steinberg"){switch(m){case"nearest":return new NearestColor(d);case"riemersma":return new ErrorDiffusionRiemersma(d);case"floyd-steinberg":return new ErrorDiffusionArray(d,0);case"false-floyd-steinberg":return new ErrorDiffusionArray(d,1);case"stucki":return new ErrorDiffusionArray(d,2);case"atkinson":return new ErrorDiffusionArray(d,3);case"jarvis":return new ErrorDiffusionArray(d,4);case"burkes":return new ErrorDiffusionArray(d,5);case"sierra":return new ErrorDiffusionArray(d,6);case"two-sierra":return new ErrorDiffusionArray(d,7);case"sierra-lite":return new ErrorDiffusionArray(d,8);default:throw new Error(`Unknown imageQuantization ${m}`)}}function paletteQuantizationToPaletteQuantizer(d,m="wuquant",g=256){switch(m){case"neuquant":return new NeuQuant(d,g);case"rgbquant":return new RGBQuant(d,g);case"wuquant":return new WuQuant(d,g);case"neuquant-float":return new NeuQuantFloat(d,g);default:throw new Error(`Unknown paletteQuantization ${m}`)}}/**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * cie94.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * ciede2000.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * cmetric.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * common.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * constants.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * ditherErrorDiffusionArray.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * euclidean.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * helper.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * hueStatistics.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * iq.ts - Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * lab2rgb.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * lab2xyz.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * manhattanNeuQuant.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * nearestColor.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * palette.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * pngQuant.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * point.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * pointContainer.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * rgb2hsl.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * rgb2lab.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * rgb2xyz.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * ssim.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * wuQuant.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * xyz2lab.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * xyz2rgb.ts - part of Image Quantization Library
 *//**
 * @preserve
 * MIT License
 *
 * Copyright 2015-2018 Igor Bezkrovnyi
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL
 * THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * riemersma.ts - part of Image Quantization Library
 *//**
 * @preserve TypeScript port:
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * colorHistogram.ts - part of Image Quantization Library
 *//**
 * @preserve TypeScript port:
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * neuquant.ts - part of Image Quantization Library
 *//**
 * @preserve TypeScript port:
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * rgbquant.ts - part of Image Quantization Library
 */typeof setImmediate=="function"?setImmediate:typeof process<"u"&&process?.nextTick;const QuantizeOptionsSchema=z.object({colors:z.number().optional(),colorDistanceFormula:z.union([z.literal("cie94-textiles"),z.literal("cie94-graphic-arts"),z.literal("ciede2000"),z.literal("color-metric"),z.literal("euclidean"),z.literal("euclidean-bt709-noalpha"),z.literal("euclidean-bt709"),z.literal("manhattan"),z.literal("manhattan-bt709"),z.literal("manhattan-nommyde"),z.literal("pngquant")]).optional(),paletteQuantization:z.union([z.literal("neuquant"),z.literal("neuquant-float"),z.literal("rgbquant"),z.literal("wuquant")]).optional(),imageQuantization:z.union([z.literal("nearest"),z.literal("riemersma"),z.literal("floyd-steinberg"),z.literal("false-floyd-steinberg"),z.literal("stucki"),z.literal("atkinson"),z.literal("jarvis"),z.literal("burkes"),z.literal("sierra"),z.literal("two-sierra"),z.literal("sierra-lite")]).optional()}),methods={quantize(d,m){const{colors:g,colorDistanceFormula:w,paletteQuantization:I,imageQuantization:P}=QuantizeOptionsSchema.parse(m),F=utils_exports.PointContainer.fromUint8Array(d.bitmap.data,d.bitmap.width,d.bitmap.height),D=applyPaletteSync(F,buildPaletteSync([F],{colors:g,colorDistanceFormula:w,paletteQuantization:I}),{colorDistanceFormula:w,imageQuantization:P});return d.bitmap.data=Buffer$2.from(D.toUint8Array()),d}};var parseBmfontAscii=function(d){if(!d)throw new Error("no data provided");var m={pages:[],chars:[],kernings:[]},g=(d=d.toString().trim()).split(/\r\n?|\n/g);if(g.length===0)throw new Error("no data in BMFont file");for(var w=0;w<g.length;w++){var I=splitLine(g[w],w);if(I)if(I.key==="page"){if(typeof I.data.id!="number")throw new Error("malformed file at line "+w+" -- needs page id=N");if(typeof I.data.file!="string")throw new Error("malformed file at line "+w+' -- needs page file="path"');m.pages[I.data.id]=I.data.file}else I.key==="chars"||I.key==="kernings"||(I.key==="char"?m.chars.push(I.data):I.key==="kerning"?m.kernings.push(I.data):m[I.key]=I.data)}return m};function splitLine(d,m){if(!(d=d.replace(/\t+/g," ").trim()))return null;var g=d.indexOf(" ");if(g===-1)throw new Error("no named row at line "+m);var w=d.substring(0,g);d=(d=(d=(d=d.substring(g+1)).replace(/letter=[\'\"]\S+[\'\"]/gi,"")).split("=")).map(function(U){return U.trim().match(/(".*?"|[^"\s]+)+(?=\s*|\s*$)/g)});for(var I=[],P=0;P<d.length;P++){var F=d[P];P===0?I.push({key:F[0],data:""}):P===d.length-1?I[I.length-1].data=parseData(F[0]):(I[I.length-1].data=parseData(F[0]),I.push({key:F[1],data:""}))}var D={key:w,data:{}};return I.forEach(function(U){D.data[U.key]=U.data}),D}function parseData(d){return d&&d.length!==0?d.indexOf('"')===0||d.indexOf("'")===0?d.substring(1,d.length-1):d.indexOf(",")!==-1?parseIntList$1(d):parseInt(d,10):""}function parseIntList$1(d){return d.split(",").map(function(m){return parseInt(m,10)})}getDefaultExportFromCjs(parseBmfontAscii);var GLYPH_DESIGNER_ERROR="chasrset",parseAttribs=function(d){for(var m in d=Object.assign({},d),GLYPH_DESIGNER_ERROR in d&&(d.charset=d[GLYPH_DESIGNER_ERROR],delete d[GLYPH_DESIGNER_ERROR]),d)m!=="face"&&m!=="charset"&&(d[m]=m==="padding"||m==="spacing"?parseIntList(d[m]):parseInt(d[m],10));return d};function parseIntList(d){return d.split(",").map(function(m){return parseInt(m,10)})}var xmlParseFromString=self.DOMParser!==void 0?function(d){return new self.DOMParser().parseFromString(d,"application/xml")}:self.ActiveXObject!==void 0&&new self.ActiveXObject("Microsoft.XMLDOM")?function(d){var m=new self.ActiveXObject("Microsoft.XMLDOM");return m.async="false",m.loadXML(d),m}:function(d){var m=document.createElement("div");return m.innerHTML=d,m},parseAttributes=parseAttribs,parseFromString=xmlParseFromString,NAME_MAP={scaleh:"scaleH",scalew:"scaleW",stretchh:"stretchH",lineheight:"lineHeight",alphachnl:"alphaChnl",redchnl:"redChnl",greenchnl:"greenChnl",bluechnl:"blueChnl"},browser=function(d){d=d.toString();var m=parseFromString(d),g={pages:[],chars:[],kernings:[]};["info","common"].forEach(function(Z){var $=m.getElementsByTagName(Z)[0];$&&(g[Z]=parseAttributes(getAttribs($)))});var w=m.getElementsByTagName("pages")[0];if(!w)throw new Error("malformed file -- no <pages> element");for(var I=w.getElementsByTagName("page"),P=0;P<I.length;P++){var F=I[P],D=parseInt(F.getAttribute("id"),10),U=F.getAttribute("file");if(isNaN(D))throw new Error('malformed file -- page "id" attribute is NaN');if(!U)throw new Error('malformed file -- needs page "file" attribute');g.pages[parseInt(D,10)]=U}return["chars","kernings"].forEach(function(Z){var $=m.getElementsByTagName(Z)[0];if($)for(var j=Z.substring(0,Z.length-1),H=$.getElementsByTagName(j),W=0;W<H.length;W++){var V=H[W];g[Z].push(parseAttributes(getAttribs(V)))}}),g};function getAttribs(d){return getAttribList(d).reduce(function(m,g){return m[mapName(g.nodeName)]=g.nodeValue,m},{})}function getAttribList(d){for(var m=[],g=0;g<d.attributes.length;g++)m.push(d.attributes[g]);return m}function mapName(d){return NAME_MAP[d.toLowerCase()]||d}getDefaultExportFromCjs(browser);var HEADER$1=[66,77,70],parseBmfontBinary=function(d){if(d.length<6)throw new Error("invalid buffer length for BMFont");var m=HEADER$1.every(function(P,F){return d.readUInt8(F)===P});if(!m)throw new Error("BMFont missing BMF byte header");var g=3;if(d.readUInt8(g++)>3)throw new Error("Only supports BMFont Binary v3 (BMFont App v1.10)");for(var w={kernings:[],chars:[]},I=0;I<5;I++)g+=readBlock(w,d,g);return w};function readBlock(d,m,g){if(g>m.length-1)return 0;var w=m.readUInt8(g++),I=m.readInt32LE(g);switch(g+=4,w){case 1:d.info=readInfo(m,g);break;case 2:d.common=readCommon(m,g);break;case 3:d.pages=readPages(m,g,I);break;case 4:d.chars=readChars(m,g,I);break;case 5:d.kernings=readKernings(m,g,I)}return 5+I}function readInfo(d,m){var g={};g.size=d.readInt16LE(m);var w=d.readUInt8(m+2);return g.smooth=w>>7&1,g.unicode=w>>6&1,g.italic=w>>5&1,g.bold=w>>4&1,w>>3&1&&(g.fixedHeight=1),g.charset=d.readUInt8(m+3)||"",g.stretchH=d.readUInt16LE(m+4),g.aa=d.readUInt8(m+6),g.padding=[d.readInt8(m+7),d.readInt8(m+8),d.readInt8(m+9),d.readInt8(m+10)],g.spacing=[d.readInt8(m+11),d.readInt8(m+12)],g.outline=d.readUInt8(m+13),g.face=readStringNT(d,m+14),g}function readCommon(d,m){var g={};return g.lineHeight=d.readUInt16LE(m),g.base=d.readUInt16LE(m+2),g.scaleW=d.readUInt16LE(m+4),g.scaleH=d.readUInt16LE(m+6),g.pages=d.readUInt16LE(m+8),d.readUInt8(m+10),g.packed=0,g.alphaChnl=d.readUInt8(m+11),g.redChnl=d.readUInt8(m+12),g.greenChnl=d.readUInt8(m+13),g.blueChnl=d.readUInt8(m+14),g}function readPages(d,m,g){for(var w=[],I=readNameNT(d,m),P=I.length+1,F=g/P,D=0;D<F;D++)w[D]=d.slice(m,m+I.length).toString("utf8"),m+=P;return w}function readChars(d,m,g){for(var w=[],I=g/20,P=0;P<I;P++){var F={},D=20*P;F.id=d.readUInt32LE(m+0+D),F.x=d.readUInt16LE(m+4+D),F.y=d.readUInt16LE(m+6+D),F.width=d.readUInt16LE(m+8+D),F.height=d.readUInt16LE(m+10+D),F.xoffset=d.readInt16LE(m+12+D),F.yoffset=d.readInt16LE(m+14+D),F.xadvance=d.readInt16LE(m+16+D),F.page=d.readUInt8(m+18+D),F.chnl=d.readUInt8(m+19+D),w[P]=F}return w}function readKernings(d,m,g){for(var w=[],I=g/10,P=0;P<I;P++){var F={},D=10*P;F.first=d.readUInt32LE(m+0+D),F.second=d.readUInt32LE(m+4+D),F.amount=d.readInt16LE(m+8+D),w[P]=F}return w}function readNameNT(d,m){for(var g=m;g<d.length&&d[g]!==0;g++);return d.slice(m,g)}function readStringNT(d,m){return readNameNT(d,m).toString("utf8")}getDefaultExportFromCjs(parseBmfontBinary);function e(d){return d&&d.__esModule&&Object.prototype.hasOwnProperty.call(d,"default")?d.default:d}const t=d=>{if(!d)return null;const m={};switch(d.type){case"ELEMENT":{let g={};const w=E(d.value.attributes),I=t(d.value.children);if(w&&(g=Object.assign(g,w)),I){const P=r(d.value.children);g=Object.assign(g,P)}m[d.value.type]=g;break}case"ATTRIBUTE":{const g=d.value;m[g.name]=g.value;break}case"CONTENT":return{content:d.value}}return m},r=d=>d&&Array.isArray(d)&&d.length!==0?n(d)?{content:d[0].value}:{children:d.map(t)}:null,n=d=>d&&Array.isArray(d)&&d.length===1&&d[0].type==="CONTENT",E=d=>d&&Array.isArray(d)?d.map(t).reduce((m,g)=>Object.assign(m,g),{}):null;var s={convert:d=>t(d.value.children[0])},a={Token:(d,m)=>({type:d,value:m}),TOKEN_TYPE:{OPEN_BRACKET:"OPEN_BRACKET",ELEMENT_TYPE:"ELEMENT_TYPE",CLOSE_ELEMENT:"CLOSE_ELEMENT",ATTRIB_NAME:"ATTRIB_NAME",ATTRIB_VALUE:"ATTRIB_VALUE",ASSIGN:"ASSIGN",CLOSE_BRACKET:"CLOSE_BRACKET",CONTENT:"CONTENT",EOF:"EOF"}};const{Token:T,TOKEN_TYPE:u}=a,c=T("EOF"),l=d=>d===" "||d===`
`||d==="\r"||d==="	",o=d=>d.replace(/'/g,'"');var N={createLexer:function(d){let m=null,g=(j=>{let H=0;for(;H<j.length&&l(j[H]);)H++;return((W,V)=>{if(W.startsWith("<?xml",V)){const Q=W.length;for(;V<Q;)if(W[V]!=="?")V++;else{if(W[V+1]===">")return V+2;V++}}return V})(j,H)})(d),w=[];const I=()=>d[g],P=()=>m!==c&&g<d.length,F=j=>j==='"'||j==="'",D=()=>{for(;P()&&l(d[g]);)g++},U=j=>{if(P()){if(d[g]==="<"){let H="<";return g++,P()&&d[g]==="/"?(g++,H="</"):P()&&d[g]==="!"&&d[g+1]==="-"&&d[g+2]==="-"&&(g++,g++,g++,H="<!--"),H}if(I()==="/"){let H="/";return g++,P()&&I()===">"&&(g++,H="/>"),H}if(d[g]==="="||d[g]===">"){const H=d[g];return g++,H}}return Z(!!j)},Z=j=>{const H=j?/[^>=<]/u:/[a-zA-Z0-9_:-]/;let W=g;for(;P()&&d[g].match(H);)g++;return o(d.substring(W,g))},$=()=>{const j=g;D();const H=g-j;if(P())if(m&&m.type===u.OPEN_BRACKET){D();const W=U(!1);m=T(u.ELEMENT_TYPE,W),w.push(W)}else if(m&&m.type===u.ASSIGN){P()&&F(I())&&g++;let W=g;for(;P()&&!F(I());)g++;const V=o(d.substring(W,g));g++,m=T(u.ATTRIB_VALUE,V)}else{D();let W=U(!0);switch(W){case"=":m=m.type===u.ATTRIB_NAME?T(u.ASSIGN):T(u.CONTENT,W);break;case"</":{const V=g;for(;d[g]!==">";)g++;m=T(u.CLOSE_ELEMENT,d.substring(V,g)),g++,w.pop();break}case"/>":{const V=w.pop();m=T(u.CLOSE_ELEMENT,V);break}case"<!--":{const V=["!","-","-"];for(;P()&&(V[2]!==">"||V[1]!=="-"||V[0]!=="-");)V.shift(),V.push(d[g]),g++;return $()}case">":m=T(u.CLOSE_BRACKET);break;case"<":m=T(u.OPEN_BRACKET);break;default:if(W&&W.length>0){if(m.type===u.CLOSE_BRACKET){let V="";I()!=="<"&&(V=Z(!0)),m=T(u.CONTENT,W+V)}else if(m.type!==u.ATTRIB_NAME&&m.type!==u.CONTENT)m.type===u.CLOSE_ELEMENT?(W=" ".repeat(H)+W,m=T(u.CONTENT,W)):m=T(u.ATTRIB_NAME,W);else{const V=" ".repeat(H)+W;m=T(u.CONTENT,V)}break}{const V='Unknown Syntax : "'+d[g]+'"';throw new Error(V)}}}else m=c;return m};return{peek:I,next:$,hasNext:P}}};const{createLexer:i}=N,{Token:p,TOKEN_TYPE:O}=a,[A$1,f,C,h]=["ROOT","ELEMENT","ATTRIBUTE","CONTENT"],_=(d,m)=>({type:d,value:m}),L=d=>_(h,d),y=(d,m,g)=>_(f,{type:d,attributes:m,children:g}),v=(d,m)=>_(C,{name:d,value:m}),S=(d,m)=>{const g=[];for(;d.hasNext();){const w=d.next();switch(w.type){case O.OPEN_BRACKET:{const I=d.next(),[P,F]=R$1(d);let D=[];F.type!==O.CLOSE_ELEMENT&&(D=S(d,I)),D&&D.length>0&&D[0].type===O.CONTENT&&(D=b(D)),g.push(y(I.value,P,D));break}case O.CLOSE_ELEMENT:if(w.value===m.value)return g;break;case O.CONTENT:g.push(L(w.value));break;case O.EOF:return g;default:throw new Error(`Unknown Lexem type: ${w.type} "${w.value}, scoping element: ${m.value}"`)}}return g},R$1=d=>{const m=[];let g=d.peek();if(!d.hasNext()||g&&g.type===O.CLOSE_BRACKET||g&&g.type===O.CLOSE_ELEMENT)return[m,g];for(g=d.next();d.hasNext()&&g&&g.type!==O.CLOSE_BRACKET&&g.type!==O.CLOSE_ELEMENT;){const w=g;d.next();const I=d.next(),P=v(w.value,I.value);m.push(P),g=d.next()}return[m,g]};function b(d){let m=[],g="";return d.forEach(w=>{w.type===O.CONTENT?g+=w.value:(g.length&&(m.push(L(g)),g=""),m.push(w))}),g.length&&m.push(L(g)),m}var B$1={transpile:function(d,m){const g=(w=>_(A$1,{children:S(w,p(A$1,"ROOT"))}))(i(d));return m?m.convert(g):g}};const M=s,{transpile:x}=B$1;var k=e({convertXML:function(d,m){return x(d,m||M)},createAST:function(d){return x(d)}}),simpleXmlToJson_min=k,xmlPackage=getDefaultExportFromCjs(simpleXmlToJson_min);const{convertXML}=xmlPackage;createJimp({formats:[png]});Buffer$2.from([66,77,70,3]);var pixelmatch_1=pixelmatch;const defaultOptions={threshold:.1,includeAA:!1,alpha:.1,aaColor:[255,255,0],diffColor:[255,0,0],diffColorAlt:null,diffMask:!1};function pixelmatch(d,m,g,w,I,P){if(!isPixelData(d)||!isPixelData(m)||g&&!isPixelData(g))throw new Error("Image data: Uint8Array, Uint8ClampedArray or Buffer expected.");if(d.length!==m.length||g&&g.length!==d.length)throw new Error("Image sizes do not match.");if(d.length!==w*I*4)throw new Error("Image data size does not match width/height.");P=Object.assign({},defaultOptions,P);const F=w*I,D=new Uint32Array(d.buffer,d.byteOffset,F),U=new Uint32Array(m.buffer,m.byteOffset,F);let Z=!0;for(let H=0;H<F;H++)if(D[H]!==U[H]){Z=!1;break}if(Z){if(g&&!P.diffMask)for(let H=0;H<F;H++)drawGrayPixel(d,4*H,P.alpha,g);return 0}const $=35215*P.threshold*P.threshold;let j=0;for(let H=0;H<I;H++)for(let W=0;W<w;W++){const V=4*(H*w+W),Q=colorDelta(d,m,V,V);Math.abs(Q)>$?P.includeAA||!antialiased(d,W,H,w,I,m)&&!antialiased(m,W,H,w,I,d)?(g&&drawPixel(g,V,...Q<0&&P.diffColorAlt||P.diffColor),j++):g&&!P.diffMask&&drawPixel(g,V,...P.aaColor):g&&(P.diffMask||drawGrayPixel(d,V,P.alpha,g))}return j}function isPixelData(d){return ArrayBuffer.isView(d)&&d.constructor.BYTES_PER_ELEMENT===1}function antialiased(d,m,g,w,I,P){const F=Math.max(m-1,0),D=Math.max(g-1,0),U=Math.min(m+1,w-1),Z=Math.min(g+1,I-1),$=4*(g*w+m);let j,H,W,V,Q=m===F||m===U||g===D||g===Z?1:0,K=0,q=0;for(let et=F;et<=U;et++)for(let X=D;X<=Z;X++){if(et===m&&X===g)continue;const tt=colorDelta(d,d,$,4*(X*w+et),!0);if(tt===0){if(Q++,Q>2)return!1}else tt<K?(K=tt,j=et,H=X):tt>q&&(q=tt,W=et,V=X)}return K!==0&&q!==0&&(hasManySiblings(d,j,H,w,I)&&hasManySiblings(P,j,H,w,I)||hasManySiblings(d,W,V,w,I)&&hasManySiblings(P,W,V,w,I))}function hasManySiblings(d,m,g,w,I){const P=Math.max(m-1,0),F=Math.max(g-1,0),D=Math.min(m+1,w-1),U=Math.min(g+1,I-1),Z=4*(g*w+m);let $=m===P||m===D||g===F||g===U?1:0;for(let j=P;j<=D;j++)for(let H=F;H<=U;H++){if(j===m&&H===g)continue;const W=4*(H*w+j);if(d[Z]===d[W]&&d[Z+1]===d[W+1]&&d[Z+2]===d[W+2]&&d[Z+3]===d[W+3]&&$++,$>2)return!0}return!1}function colorDelta(d,m,g,w,I){let P=d[g+0],F=d[g+1],D=d[g+2],U=d[g+3],Z=m[w+0],$=m[w+1],j=m[w+2],H=m[w+3];if(U===H&&P===Z&&F===$&&D===j)return 0;U<255&&(U/=255,P=blend(P,U),F=blend(F,U),D=blend(D,U)),H<255&&(H/=255,Z=blend(Z,H),$=blend($,H),j=blend(j,H));const W=rgb2y(P,F,D),V=rgb2y(Z,$,j),Q=W-V;if(I)return Q;const K=rgb2i(P,F,D)-rgb2i(Z,$,j),q=rgb2q(P,F,D)-rgb2q(Z,$,j),et=.5053*Q*Q+.299*K*K+.1957*q*q;return W>V?-et:et}function rgb2y(d,m,g){return .29889531*d+.58662247*m+.11448223*g}function rgb2i(d,m,g){return .59597799*d-.2741761*m-.32180189*g}function rgb2q(d,m,g){return .21147017*d-.52261711*m+.31114694*g}function blend(d,m){return 255+(d-255)*m}function drawPixel(d,m,g,w,I){d[m+0]=g,d[m+1]=w,d[m+2]=I,d[m+3]=255}function drawGrayPixel(d,m,g,w){const I=blend(rgb2y(d[m+0],d[m+1],d[m+2]),g*d[m+3]/255);drawPixel(w,m,I,I,I)}getDefaultExportFromCjs(pixelmatch_1);const defaultPlugins=[methods$h,methods$g,methods$f,methods$e,methods$c,methods$a,methods$b,methods$9,methods$8,methods$7,methods$6,methods$5,methods$4,methods$3,methods$d,methods$2,methods$1,methods],defaultFormats=[bmp,msBmp,gif,jpeg$2,png,tiff];bmp().mime,gif().mime,jpeg$2().mime,png().mime,tiff().mime;const Jimp=createJimp({formats:defaultFormats,plugins:defaultPlugins});function rgb24ToPng(d,m,g){const w=rgb24ToRgba8(d);return rgba8ToPng(w,m,g)}function rgb24ToRgba8(d){const m=new Uint8Array(d.length/3*4);for(let g=0,w=0;g<d.length;g+=3,w+=4)m[w+0]=d[g+0],m[w+1]=d[g+1],m[w+2]=d[g+2],m[w+3]=255;return m}function argb16ToRgba8(d){const m=new Uint8Array(d.length*4);for(let g=0;g<d.length;g++){const w=d[g],I=w>>15&1?255:0,P=(w>>10&31)*255/31,F=(w>>5&31)*255/31,D=(w&31)*255/31;m[g*4+0]=P,m[g*4+1]=F,m[g*4+2]=D,m[g*4+3]=I}return m}function rgba8ToPng(d,m,g){const w=new browserExports$1.PNG({width:m,height:g});return console.log("Setting PNG data with length:",d.length),console.log("PNG dimensions:",m,"x",g),w.data.set(d),browserExports$1.PNG.sync.write(w)}async function pngToRgba8(d){const m=await Jimp.fromBuffer(d);return{data:m.bitmap.data,width:m.width,height:m.height}}function argb16ToPng(d,m,g){const w=argb16ToRgba8(d);return rgba8ToPng(w,m,g)}class Matrix4{data;constructor(){this.data=new Float32Array(16),this.identity()}identity(){return this.data.fill(0),this.data[0]=this.data[5]=this.data[10]=this.data[15]=1,this}setTranslation(m,g,w){return this.data[12]=m,this.data[13]=g,this.data[14]=w,this}invert(){const m=new Matrix4,g=this.data,w=m.data;w[0]=g[5]*g[10]*g[15]-g[5]*g[11]*g[14]-g[9]*g[6]*g[15]+g[9]*g[7]*g[14]+g[13]*g[6]*g[11]-g[13]*g[7]*g[10],w[4]=-g[4]*g[10]*g[15]+g[4]*g[11]*g[14]+g[8]*g[6]*g[15]-g[8]*g[7]*g[14]-g[12]*g[6]*g[11]+g[12]*g[7]*g[10],w[8]=g[4]*g[9]*g[15]-g[4]*g[11]*g[13]-g[8]*g[5]*g[15]+g[8]*g[7]*g[13]+g[12]*g[5]*g[11]-g[12]*g[7]*g[9],w[12]=-g[4]*g[9]*g[14]+g[4]*g[10]*g[13]+g[8]*g[5]*g[14]-g[8]*g[6]*g[13]-g[12]*g[5]*g[10]+g[12]*g[6]*g[9],w[1]=-g[1]*g[10]*g[15]+g[1]*g[11]*g[14]+g[9]*g[2]*g[15]-g[9]*g[3]*g[14]-g[13]*g[2]*g[11]+g[13]*g[3]*g[10],w[5]=g[0]*g[10]*g[15]-g[0]*g[11]*g[14]-g[8]*g[2]*g[15]+g[8]*g[3]*g[14]+g[12]*g[2]*g[11]-g[12]*g[3]*g[10],w[9]=-g[0]*g[9]*g[15]+g[0]*g[11]*g[13]+g[8]*g[1]*g[15]-g[8]*g[3]*g[13]-g[12]*g[1]*g[11]+g[12]*g[3]*g[9],w[13]=g[0]*g[9]*g[14]-g[0]*g[10]*g[13]-g[8]*g[1]*g[14]+g[8]*g[2]*g[13]+g[12]*g[1]*g[10]-g[12]*g[2]*g[9],w[2]=g[1]*g[6]*g[15]-g[1]*g[7]*g[14]-g[5]*g[2]*g[15]+g[5]*g[3]*g[14]+g[13]*g[2]*g[7]-g[13]*g[3]*g[6],w[6]=-g[0]*g[6]*g[15]+g[0]*g[7]*g[14]+g[4]*g[2]*g[15]-g[4]*g[3]*g[14]-g[12]*g[2]*g[7]+g[12]*g[3]*g[6],w[10]=g[0]*g[5]*g[15]-g[0]*g[7]*g[13]-g[4]*g[1]*g[15]+g[4]*g[3]*g[13]+g[12]*g[1]*g[7]-g[12]*g[3]*g[5],w[14]=-g[0]*g[5]*g[14]+g[0]*g[6]*g[13]+g[4]*g[1]*g[14]-g[4]*g[2]*g[13]-g[12]*g[1]*g[6]+g[12]*g[2]*g[5],w[3]=-g[1]*g[6]*g[11]+g[1]*g[7]*g[10]+g[5]*g[2]*g[11]-g[5]*g[3]*g[10]-g[9]*g[2]*g[7]+g[9]*g[3]*g[6],w[7]=g[0]*g[6]*g[11]-g[0]*g[7]*g[10]-g[4]*g[2]*g[11]+g[4]*g[3]*g[10]+g[8]*g[2]*g[7]-g[8]*g[3]*g[6],w[11]=-g[0]*g[5]*g[11]+g[0]*g[7]*g[9]+g[4]*g[1]*g[11]-g[4]*g[3]*g[9]-g[8]*g[1]*g[7]+g[8]*g[3]*g[5],w[15]=g[0]*g[5]*g[10]-g[0]*g[6]*g[9]-g[4]*g[1]*g[10]+g[4]*g[2]*g[9]+g[8]*g[1]*g[6]-g[8]*g[2]*g[5];const I=g[0]*w[0]+g[1]*w[4]+g[2]*w[8]+g[3]*w[12];if(I===0)return console.warn("Matrix is not invertible"),m.identity();const P=1/I;for(let F=0;F<16;F++)w[F]*=P;return m}}function calculateLocalTransform(d,m){if(console.log(`Calculating local transform for bone "${d.name}" (parentBone: ${d.parentBone})`),console.log(`  Bone absolute coords: [${d.coordX}, ${d.coordY}, ${d.coordZ}]`),d.parentBone>=0&&d.parentBone<m.length){const g=m[d.parentBone];console.log(`  Parent "${g.name}" coords: [${g.coordX}, ${g.coordY}, ${g.coordZ}]`);const w=[d.coordX-g.coordX,d.coordY-g.coordY,d.coordZ-g.coordZ];return console.log(`  Calculated local transform: [${w.map(I=>I.toFixed(2)).join(", ")}]`),w}return console.log(`  Root bone local transform: [${d.coordX}, ${d.coordY}, ${d.coordZ}]`),[d.coordX,d.coordY,d.coordZ]}function createJointNodes(d,m){return console.log("Creating joint nodes with local transforms..."),m.map((g,w)=>{const I=d.createNode(g.name),P=calculateLocalTransform(g,m);return I.setTranslation(P),console.log(`  Joint ${w}: "${g.name}" at local [${P.map(F=>F.toFixed(2)).join(", ")}]`),I})}function buildJointHierarchy(d,m,g){if(console.log("Building joint hierarchy..."),d.length!==m.length){console.error(`Mismatch: ${d.length} joints vs ${m.length} bones`);return}const w=[];if(m.some(P=>P.parentBone>=0&&P.parentBone<m.length))m.forEach((P,F)=>{const D=d[F];if(P.parentBone>=0&&P.parentBone<m.length){const U=d[P.parentBone];U&&D?(U.addChild(D),console.log(`  ${P.name} -> child of ${m[P.parentBone].name}`)):(g.addChild(D),w.push(P.name),console.log(`  ${P.name} -> root joint (parent not found)`))}else g.addChild(D),w.push(P.name),console.log(`  ${P.name} -> root joint`)});else{console.log("No valid parent bone data found, building simple hierarchy based on bone names");const P={Torso:"Pelvis",Chest:"Torso",Head:"Chest",RightHip:"Pelvis",LeftHip:"Pelvis",RightKnee:"RightHip",LeftKnee:"LeftHip",RightFoot:"RightKnee",LeftFoot:"LeftKnee",RtShoulder:"Chest",LeftShoulder:"Chest",RightElbow:"RtShoulder",LeftElbow:"LeftShoulder",RightHand:"RightElbow","Left Hand":"LeftElbow"};d.forEach((F,D)=>{g.addChild(F),w.push(m[D].name)}),m.forEach((F,D)=>{const U=d[D],Z=P[F.name];if(Z){const $=m.findIndex(j=>j.name===Z);if($>=0&&$<d.length){const j=d[$];if(j&&U)try{g.removeChild(U),j.addChild(U);const H=w.indexOf(F.name);H>=0&&w.splice(H,1),console.log(`  ${F.name} -> child of ${Z}`)}catch(H){console.log(`  Warning: Failed to add ${F.name} as child of ${Z}:`,H)}else console.log(`  Warning: Parent joint ${j?"found":"null"} or joint ${U?"found":"null"} for ${F.name} -> ${Z}`)}else console.log(`  Warning: Parent index ${$} out of range for ${F.name} -> ${Z}`)}})}console.log(`Hierarchy complete: ${w.length} root joints [${w.join(", ")}]`)}function calculateInverseBindMatrices(d){const m=new Float32Array(d.length*16);return d.forEach((g,w)=>{const P=new Matrix4().setTranslation(g.coordX,g.coordY,g.coordZ).invert(),F=w*16;for(let D=0;D<16;D++)m[F+D]=P.data[D]}),m}function createSkin(d,m,g){console.log("Creating skin...");const w=d.createSkin("skeleton");m.forEach(D=>w.addJoint(D));const I=calculateInverseBindMatrices(g),P=d.getRoot().listBuffers()[0],F=d.createAccessor().setType("MAT4").setArray(I).setBuffer(P);return w.setInverseBindMatrices(F),console.log(`Skin created with ${m.length} joints`),w}function hasVariation(d,m=.001){if(d.length<2)return!1;const g=d[0];return d.some(w=>Math.abs(w-g)>m)}function processOttoAnimations(d,m){return console.log("Processing Otto animations..."),d.map(g=>{const w=[];let I=0;return console.log(`  Processing animation "${g.name}"`),Object.entries(g.keyframes).forEach(([P,F])=>{const D=parseInt(P);if(D>=0&&D<m.length&&F.length>0){const U=m[D],Z=F.map(W=>W.tick/30);I=Math.max(I,...Z);const $=F.map(W=>[W.coordX,W.coordY,W.coordZ]).flat();hasVariation($)&&w.push({boneIndex:D,path:"translation",times:[...Z],values:$});const j=F.map(W=>[W.rotationX,W.rotationY,W.rotationZ]).flat();hasVariation(j)&&w.push({boneIndex:D,path:"rotation",times:[...Z],values:j});const H=F.map(W=>[W.scaleX,W.scaleY,W.scaleZ]).flat();hasVariation(H)&&w.push({boneIndex:D,path:"scale",times:[...Z],values:H}),console.log(`    Bone ${U.name}: ${F.length} keyframes, ${Z[Z.length-1].toFixed(2)}s`)}}),console.log(`  Animation "${g.name}": ${w.length} channels, ${I.toFixed(2)}s duration`),{name:g.name,duration:I,channels:w}})}function createGltfAnimations(d,m,g){console.log("Creating glTF animations...");const w=d.getRoot().listBuffers()[0],I=g.filter(P=>P.channels.length>0);return console.log(`Creating ${I.length} animations (filtered from ${g.length})`),I.map(P=>{const F=d.createAnimation(P.name);return console.log(`  Creating animation "${P.name}" with ${P.channels.length} channels`),P.channels.forEach(D=>{const U=m[D.boneIndex];if(!D.times||D.times.length===0){console.warn(`Skipping channel for joint ${U?.getName()} path ${D.path}: no time data`);return}if(!D.values||D.values.length===0){console.warn(`Skipping channel for joint ${U?.getName()} path ${D.path}: no value data`);return}if(!U){console.warn(`Skipping channel for path ${D.path}: joint not found (index ${D.boneIndex})`);return}let Z;try{if(Z=d.createAccessor().setType("SCALAR").setArray(new Float32Array(D.times)).setBuffer(w),!Z){console.warn(`Failed to create time accessor for joint ${U.getName()} path ${D.path}`);return}}catch(V){console.warn(`Error creating time accessor for joint ${U.getName()} path ${D.path}:`,V);return}let $;switch(D.path){case"translation":case"scale":$="VEC3";break;case"rotation":$="VEC3";break;default:$="VEC3"}let j;try{if(j=d.createAccessor().setType($).setArray(new Float32Array(D.values)).setBuffer(w),!j){console.warn(`Failed to create value accessor for joint ${U.getName()} path ${D.path}`);return}}catch(V){console.warn(`Error creating value accessor for joint ${U.getName()} path ${D.path}:`,V);return}let H;try{if(H=d.createAnimationSampler().setInput(Z).setOutput(j).setInterpolation("LINEAR"),!H){console.warn(`Failed to create sampler for joint ${U.getName()} path ${D.path}`);return}}catch(V){console.warn(`Error creating sampler for joint ${U.getName()} path ${D.path}:`,V);return}let W;try{if(W=d.createAnimationChannel().setTargetNode(U).setTargetPath(D.path).setSampler(H),!W){console.warn(`Failed to create channel for joint ${U.getName()} path ${D.path}`);return}}catch(V){console.warn(`Error creating channel for joint ${U.getName()} path ${D.path}:`,V);return}try{F.addChannel(W),console.log(`    Added channel: ${U.getName()}.${D.path}`)}catch(V){console.warn(`Error adding channel for joint ${U.getName()} path ${D.path}:`,V)}}),F})}function createSkeletonSystem(d,m){console.log("=== Creating Skeleton System (Rebuilt Implementation) ==="),console.log(`Bones: ${m.bones.length}, Animations: ${m.animations.length}`);const g=d.getRoot().getDefaultScene();if(!g){console.log("No default scene found, creating one...");const D=d.createScene("default");if(d.getRoot().setDefaultScene(D),!d.getRoot().getDefaultScene())throw new Error("Failed to create default scene in glTF document");return createSkeletonSystem(d,m)}const w=createJointNodes(d,m.bones);try{buildJointHierarchy(w,m.bones,g)}catch(D){console.error("Error building joint hierarchy:",D),w.forEach(U=>g.addChild(U))}const I=createSkin(d,w,m.bones),P=processOttoAnimations(m.animations,m.bones),F=createGltfAnimations(d,w,P);return console.log("=== Skeleton System Complete ==="),console.log(`Result: ${w.length} joints, ${F.length} animations`),{skin:I,animations:F}}function extractAnimationsFromGLTF(d){return d.getRoot().listAnimations().map(g=>({name:g.getName()||"Unknown",numAnimEvents:0,events:[],keyframes:{}}))}class EventDispatcher{constructor(){this._listeners={}}addEventListener(m,g){const w=this._listeners;return w[m]===void 0&&(w[m]=[]),w[m].indexOf(g)===-1&&w[m].push(g),this}removeEventListener(m,g){const I=this._listeners[m];if(I!==void 0){const P=I.indexOf(g);P!==-1&&I.splice(P,1)}return this}dispatchEvent(m){const w=this._listeners[m.type];if(w!==void 0){const I=w.slice(0);for(let P=0,F=I.length;P<F;P++)I[P].call(this,m)}return this}dispose(){for(const m in this._listeners)delete this._listeners[m]}}class GraphEdge{constructor(m,g,w,I={}){if(this._name=void 0,this._parent=void 0,this._child=void 0,this._attributes=void 0,this._disposed=!1,this._name=m,this._parent=g,this._child=w,this._attributes=I,!g.isOnGraph(w))throw new Error("Cannot connect disconnected graphs.")}getName(){return this._name}getParent(){return this._parent}getChild(){return this._child}setChild(m){return this._child=m,this}getAttributes(){return this._attributes}dispose(){this._disposed||(this._parent._destroyRef(this),this._disposed=!0)}isDisposed(){return this._disposed}}class Graph extends EventDispatcher{constructor(...m){super(...m),this._emptySet=new Set,this._edges=new Set,this._parentEdges=new Map,this._childEdges=new Map}listEdges(){return Array.from(this._edges)}listParentEdges(m){return Array.from(this._childEdges.get(m)||this._emptySet)}listParents(m){const g=new Set;for(const w of this.listParentEdges(m))g.add(w.getParent());return Array.from(g)}listChildEdges(m){return Array.from(this._parentEdges.get(m)||this._emptySet)}listChildren(m){const g=new Set;for(const w of this.listChildEdges(m))g.add(w.getChild());return Array.from(g)}disconnectParents(m,g){for(const w of this.listParentEdges(m))(!g||g(w.getParent()))&&w.dispose();return this}_createEdge(m,g,w,I){const P=new GraphEdge(m,g,w,I);this._edges.add(P);const F=P.getParent();this._parentEdges.has(F)||this._parentEdges.set(F,new Set),this._parentEdges.get(F).add(P);const D=P.getChild();return this._childEdges.has(D)||this._childEdges.set(D,new Set),this._childEdges.get(D).add(P),P}_destroyEdge(m){return this._edges.delete(m),this._parentEdges.get(m.getParent()).delete(m),this._childEdges.get(m.getChild()).delete(m),this}}function _extends$1(){return _extends$1=Object.assign||function(d){for(var m=1;m<arguments.length;m++){var g=arguments[m];for(var w in g)Object.prototype.hasOwnProperty.call(g,w)&&(d[w]=g[w])}return d},_extends$1.apply(this,arguments)}class RefList{constructor(m){if(this.list=[],m)for(const g of m)this.list.push(g)}add(m){this.list.push(m)}remove(m){const g=this.list.indexOf(m);g>=0&&this.list.splice(g,1)}removeChild(m){const g=[];for(const w of this.list)w.getChild()===m&&g.push(w);for(const w of g)this.remove(w);return g}listRefsByChild(m){const g=[];for(const w of this.list)w.getChild()===m&&g.push(w);return g}values(){return this.list}}class RefSet{constructor(m){if(this.set=new Set,this.map=new Map,m)for(const g of m)this.add(g)}add(m){const g=m.getChild();this.removeChild(g),this.set.add(m),this.map.set(g,m)}remove(m){this.set.delete(m),this.map.delete(m.getChild())}removeChild(m){const g=this.map.get(m)||null;return g&&this.remove(g),g}getRefByChild(m){return this.map.get(m)||null}values(){return Array.from(this.set)}}class RefMap{constructor(m){this.map={},m&&Object.assign(this.map,m)}set(m,g){this.map[m]=g}delete(m){delete this.map[m]}get(m){return this.map[m]||null}keys(){return Object.keys(this.map)}values(){return Object.values(this.map)}}const $attributes=Symbol("attributes"),$immutableKeys=Symbol("immutableKeys");class GraphNode extends EventDispatcher{constructor(m){super(),this._disposed=!1,this.graph=void 0,this[$attributes]=void 0,this[$immutableKeys]=void 0,this.graph=m,this[$immutableKeys]=new Set,this[$attributes]=this._createAttributes()}getDefaults(){return{}}_createAttributes(){const m=this.getDefaults(),g={};for(const w in m){const I=m[w];if(I instanceof GraphNode){const P=this.graph._createEdge(w,this,I);this[$immutableKeys].add(w),g[w]=P}else g[w]=I}return g}isOnGraph(m){return this.graph===m.graph}isDisposed(){return this._disposed}dispose(){this._disposed||(this.graph.listChildEdges(this).forEach(m=>m.dispose()),this.graph.disconnectParents(this),this._disposed=!0,this.dispatchEvent({type:"dispose"}))}detach(){return this.graph.disconnectParents(this),this}swap(m,g){for(const w in this[$attributes]){const I=this[$attributes][w];if(I instanceof GraphEdge){const P=I;P.getChild()===m&&this.setRef(w,g,P.getAttributes())}else if(I instanceof RefList)for(const P of I.listRefsByChild(m)){const F=P.getAttributes();this.removeRef(w,m),this.addRef(w,g,F)}else if(I instanceof RefSet){const P=I.getRefByChild(m);if(P){const F=P.getAttributes();this.removeRef(w,m),this.addRef(w,g,F)}}else if(I instanceof RefMap)for(const P of I.keys()){const F=I.get(P);F.getChild()===m&&this.setRefMap(w,P,g,F.getAttributes())}}return this}get(m){return this[$attributes][m]}set(m,g){return this[$attributes][m]=g,this.dispatchEvent({type:"change",attribute:m})}getRef(m){const g=this[$attributes][m];return g?g.getChild():null}setRef(m,g,w){if(this[$immutableKeys].has(m))throw new Error(`Cannot overwrite immutable attribute, "${m}".`);const I=this[$attributes][m];if(I&&I.dispose(),!g)return this;const P=this.graph._createEdge(m,this,g,w);return this[$attributes][m]=P,this.dispatchEvent({type:"change",attribute:m})}listRefs(m){return this.assertRefList(m).values().map(w=>w.getChild())}addRef(m,g,w){const I=this.graph._createEdge(m,this,g,w);return this.assertRefList(m).add(I),this.dispatchEvent({type:"change",attribute:m})}removeRef(m,g){const w=this.assertRefList(m);if(w instanceof RefList)for(const I of w.listRefsByChild(g))I.dispose();else{const I=w.getRefByChild(g);I&&I.dispose()}return this}assertRefList(m){const g=this[$attributes][m];if(g instanceof RefList||g instanceof RefSet)return g;throw new Error(`Expected RefList or RefSet for attribute "${m}"`)}listRefMapKeys(m){return this.assertRefMap(m).keys()}listRefMapValues(m){return this.assertRefMap(m).values().map(g=>g.getChild())}getRefMap(m,g){const I=this.assertRefMap(m).get(g);return I?I.getChild():null}setRefMap(m,g,w,I){const P=this.assertRefMap(m),F=P.get(g);if(F&&F.dispose(),!w)return this;I=Object.assign(I||{},{key:g});const D=this.graph._createEdge(m,this,w,_extends$1({},I,{key:g}));return P.set(g,D),this.dispatchEvent({type:"change",attribute:m,key:g})}assertRefMap(m){const g=this[$attributes][m];if(g instanceof RefMap)return g;throw new Error(`Expected RefMap for attribute "${m}"`)}dispatchEvent(m){return super.dispatchEvent(_extends$1({},m,{target:this})),this.graph.dispatchEvent(_extends$1({},m,{target:this,type:`node:${m.type}`})),this}_destroyRef(m){const g=m.getName();if(this[$attributes][g]===m)this[$attributes][g]=null,this[$immutableKeys].has(g)&&m.getChild().dispose();else if(this[$attributes][g]instanceof RefList)this[$attributes][g].remove(m);else if(this[$attributes][g]instanceof RefSet)this[$attributes][g].remove(m);else if(this[$attributes][g]instanceof RefMap){const w=this[$attributes][g];for(const I of w.keys())w.get(I)===m&&w.delete(I)}else return;this.graph._destroyEdge(m),this.dispatchEvent({type:"change",attribute:g})}}const VERSION="v4.2.0",GLB_BUFFER="@glb.bin";var PropertyType;(function(d){d.ACCESSOR="Accessor",d.ANIMATION="Animation",d.ANIMATION_CHANNEL="AnimationChannel",d.ANIMATION_SAMPLER="AnimationSampler",d.BUFFER="Buffer",d.CAMERA="Camera",d.MATERIAL="Material",d.MESH="Mesh",d.PRIMITIVE="Primitive",d.PRIMITIVE_TARGET="PrimitiveTarget",d.NODE="Node",d.ROOT="Root",d.SCENE="Scene",d.SKIN="Skin",d.TEXTURE="Texture",d.TEXTURE_INFO="TextureInfo"})(PropertyType||(PropertyType={}));var VertexLayout;(function(d){d.INTERLEAVED="interleaved",d.SEPARATE="separate"})(VertexLayout||(VertexLayout={}));var BufferViewUsage$1;(function(d){d.ARRAY_BUFFER="ARRAY_BUFFER",d.ELEMENT_ARRAY_BUFFER="ELEMENT_ARRAY_BUFFER",d.INVERSE_BIND_MATRICES="INVERSE_BIND_MATRICES",d.OTHER="OTHER",d.SPARSE="SPARSE"})(BufferViewUsage$1||(BufferViewUsage$1={}));var TextureChannel;(function(d){d[d.R=4096]="R",d[d.G=256]="G",d[d.B=16]="B",d[d.A=1]="A"})(TextureChannel||(TextureChannel={}));var Format;(function(d){d.GLTF="GLTF",d.GLB="GLB"})(Format||(Format={}));const ComponentTypeToTypedArray={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};var ARRAY_TYPE=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var d=0,m=arguments.length;m--;)d+=arguments[m]*arguments[m];return Math.sqrt(d)});function create(){var d=new ARRAY_TYPE(3);return ARRAY_TYPE!=Float32Array&&(d[0]=0,d[1]=0,d[2]=0),d}function length(d){var m=d[0],g=d[1],w=d[2];return Math.hypot(m,g,w)}(function(){var d=create();return function(m,g,w,I,P,F){var D,U;for(g||(g=3),w||(w=0),I?U=Math.min(I*g+w,m.length):U=m.length,D=w;D<U;D+=g)d[0]=m[D],d[1]=m[D+1],d[2]=m[D+2],P(d,d,F),m[D]=d[0],m[D+1]=d[1],m[D+2]=d[2];return m}})();class BufferUtils{static createBufferFromDataURI(m){if(typeof Buffer>"u"){const g=atob(m.split(",")[1]),w=new Uint8Array(g.length);for(let I=0;I<g.length;I++)w[I]=g.charCodeAt(I);return w}else{const g=m.split(",")[1],w=m.indexOf("base64")>=0;return Buffer.from(g,w?"base64":"utf8")}}static encodeText(m){return new TextEncoder().encode(m)}static decodeText(m){return new TextDecoder().decode(m)}static concat(m){let g=0;for(const P of m)g+=P.byteLength;const w=new Uint8Array(g);let I=0;for(const P of m)w.set(P,I),I+=P.byteLength;return w}static pad(m,g=0){const w=this.padNumber(m.byteLength);if(w===m.byteLength)return m;const I=new Uint8Array(w);if(I.set(m),g!==0)for(let P=m.byteLength;P<w;P++)I[P]=g;return I}static padNumber(m){return Math.ceil(m/4)*4}static equals(m,g){if(m===g)return!0;if(m.byteLength!==g.byteLength)return!1;let w=m.byteLength;for(;w--;)if(m[w]!==g[w])return!1;return!0}static toView(m,g=0,w=1/0){return new Uint8Array(m.buffer,m.byteOffset+g,Math.min(m.byteLength,w))}static assertView(m){if(m&&!ArrayBuffer.isView(m))throw new Error(`Method requires Uint8Array parameter; received "${typeof m}".`);return m}}class JPEGImageUtils{match(m){return m.length>=3&&m[0]===255&&m[1]===216&&m[2]===255}getSize(m){let g=new DataView(m.buffer,m.byteOffset+4),w,I;for(;g.byteLength;){if(w=g.getUint16(0,!1),validateJPEGBuffer(g,w),I=g.getUint8(w+1),I===192||I===193||I===194)return[g.getUint16(w+7,!1),g.getUint16(w+5,!1)];g=new DataView(m.buffer,g.byteOffset+w+2)}throw new TypeError("Invalid JPG, no size found")}getChannels(m){return 3}}class PNGImageUtils{match(m){return m.length>=8&&m[0]===137&&m[1]===80&&m[2]===78&&m[3]===71&&m[4]===13&&m[5]===10&&m[6]===26&&m[7]===10}getSize(m){const g=new DataView(m.buffer,m.byteOffset);return BufferUtils.decodeText(m.slice(12,16))===PNGImageUtils.PNG_FRIED_CHUNK_NAME?[g.getUint32(32,!1),g.getUint32(36,!1)]:[g.getUint32(16,!1),g.getUint32(20,!1)]}getChannels(m){return 4}}PNGImageUtils.PNG_FRIED_CHUNK_NAME="CgBI";class ImageUtils{static registerFormat(m,g){this.impls[m]=g}static getMimeType(m){for(const g in this.impls)if(this.impls[g].match(m))return g;return null}static getSize(m,g){return this.impls[g]?this.impls[g].getSize(m):null}static getChannels(m,g){return this.impls[g]?this.impls[g].getChannels(m):null}static getVRAMByteLength(m,g){if(!this.impls[g])return null;if(this.impls[g].getVRAMByteLength)return this.impls[g].getVRAMByteLength(m);let w=0;const I=4,P=this.getSize(m,g);if(!P)return null;for(;P[0]>1||P[1]>1;)w+=P[0]*P[1]*I,P[0]=Math.max(Math.floor(P[0]/2),1),P[1]=Math.max(Math.floor(P[1]/2),1);return w+=1*1*I,w}static mimeTypeToExtension(m){return m==="image/jpeg"?"jpg":m.split("/").pop()}static extensionToMimeType(m){return m==="jpg"?"image/jpeg":m?`image/${m}`:""}}ImageUtils.impls={"image/jpeg":new JPEGImageUtils,"image/png":new PNGImageUtils};function validateJPEGBuffer(d,m){if(m>d.byteLength)throw new TypeError("Corrupt JPG, exceeded buffer limits");if(d.getUint8(m)!==255)throw new TypeError("Invalid JPG, marker table corrupted");return d}class FileUtils{static basename(m){const g=m.split(/[\\/]/).pop();return g.substring(0,g.lastIndexOf("."))}static extension(m){if(m.startsWith("data:image/")){const g=m.match(/data:(image\/\w+)/)[1];return ImageUtils.mimeTypeToExtension(g)}else{if(m.startsWith("data:model/gltf+json"))return"gltf";if(m.startsWith("data:model/gltf-binary"))return"glb";if(m.startsWith("data:application/"))return"bin"}return m.split(/[\\/]/).pop().split(/[.]/).pop()}}function isObject(d){return Object.prototype.toString.call(d)==="[object Object]"}function isPlainObject(d){if(isObject(d)===!1)return!1;const m=d.constructor;if(m===void 0)return!0;const g=m.prototype;return!(isObject(g)===!1||Object.prototype.hasOwnProperty.call(g,"isPrototypeOf")===!1)}var _Logger,Verbosity;(function(d){d[d.SILENT=4]="SILENT",d[d.ERROR=3]="ERROR",d[d.WARN=2]="WARN",d[d.INFO=1]="INFO",d[d.DEBUG=0]="DEBUG"})(Verbosity||(Verbosity={}));class Logger{constructor(m){this.verbosity=void 0,this.verbosity=m}debug(m){this.verbosity<=Logger.Verbosity.DEBUG&&console.debug(m)}info(m){this.verbosity<=Logger.Verbosity.INFO&&console.info(m)}warn(m){this.verbosity<=Logger.Verbosity.WARN&&console.warn(m)}error(m){this.verbosity<=Logger.Verbosity.ERROR&&console.error(m)}}_Logger=Logger;Logger.Verbosity=Verbosity;Logger.DEFAULT_INSTANCE=new _Logger(_Logger.Verbosity.INFO);function determinant(d){var m=d[0],g=d[1],w=d[2],I=d[3],P=d[4],F=d[5],D=d[6],U=d[7],Z=d[8],$=d[9],j=d[10],H=d[11],W=d[12],V=d[13],Q=d[14],K=d[15],q=m*F-g*P,et=m*D-w*P,X=m*U-I*P,tt=g*D-w*F,rt=g*U-I*F,ot=w*U-I*D,J=Z*V-$*W,lt=Z*Q-j*W,st=Z*K-H*W,ut=$*Q-j*V,it=$*K-H*V,ct=j*K-H*Q;return q*ct-et*it+X*ut+tt*st-rt*lt+ot*J}function multiply(d,m,g){var w=m[0],I=m[1],P=m[2],F=m[3],D=m[4],U=m[5],Z=m[6],$=m[7],j=m[8],H=m[9],W=m[10],V=m[11],Q=m[12],K=m[13],q=m[14],et=m[15],X=g[0],tt=g[1],rt=g[2],ot=g[3];return d[0]=X*w+tt*D+rt*j+ot*Q,d[1]=X*I+tt*U+rt*H+ot*K,d[2]=X*P+tt*Z+rt*W+ot*q,d[3]=X*F+tt*$+rt*V+ot*et,X=g[4],tt=g[5],rt=g[6],ot=g[7],d[4]=X*w+tt*D+rt*j+ot*Q,d[5]=X*I+tt*U+rt*H+ot*K,d[6]=X*P+tt*Z+rt*W+ot*q,d[7]=X*F+tt*$+rt*V+ot*et,X=g[8],tt=g[9],rt=g[10],ot=g[11],d[8]=X*w+tt*D+rt*j+ot*Q,d[9]=X*I+tt*U+rt*H+ot*K,d[10]=X*P+tt*Z+rt*W+ot*q,d[11]=X*F+tt*$+rt*V+ot*et,X=g[12],tt=g[13],rt=g[14],ot=g[15],d[12]=X*w+tt*D+rt*j+ot*Q,d[13]=X*I+tt*U+rt*H+ot*K,d[14]=X*P+tt*Z+rt*W+ot*q,d[15]=X*F+tt*$+rt*V+ot*et,d}function getScaling(d,m){var g=m[0],w=m[1],I=m[2],P=m[4],F=m[5],D=m[6],U=m[8],Z=m[9],$=m[10];return d[0]=Math.hypot(g,w,I),d[1]=Math.hypot(P,F,D),d[2]=Math.hypot(U,Z,$),d}function getRotation(d,m){var g=new ARRAY_TYPE(3);getScaling(g,m);var w=1/g[0],I=1/g[1],P=1/g[2],F=m[0]*w,D=m[1]*I,U=m[2]*P,Z=m[4]*w,$=m[5]*I,j=m[6]*P,H=m[8]*w,W=m[9]*I,V=m[10]*P,Q=F+$+V,K=0;return Q>0?(K=Math.sqrt(Q+1)*2,d[3]=.25*K,d[0]=(j-W)/K,d[1]=(H-U)/K,d[2]=(D-Z)/K):F>$&&F>V?(K=Math.sqrt(1+F-$-V)*2,d[3]=(j-W)/K,d[0]=.25*K,d[1]=(D+Z)/K,d[2]=(H+U)/K):$>V?(K=Math.sqrt(1+$-F-V)*2,d[3]=(H-U)/K,d[0]=(D+Z)/K,d[1]=.25*K,d[2]=(j+W)/K):(K=Math.sqrt(1+V-F-$)*2,d[3]=(D-Z)/K,d[0]=(H+U)/K,d[1]=(j+W)/K,d[2]=.25*K),d}class MathUtils{static identity(m){return m}static eq(m,g,w=1e-5){if(m.length!==g.length)return!1;for(let I=0;I<m.length;I++)if(Math.abs(m[I]-g[I])>w)return!1;return!0}static clamp(m,g,w){return m<g?g:m>w?w:m}static decodeNormalizedInt(m,g){switch(g){case 5126:return m;case 5123:return m/65535;case 5121:return m/255;case 5122:return Math.max(m/32767,-1);case 5120:return Math.max(m/127,-1);default:throw new Error("Invalid component type.")}}static encodeNormalizedInt(m,g){switch(g){case 5126:return m;case 5123:return Math.round(MathUtils.clamp(m,0,1)*65535);case 5121:return Math.round(MathUtils.clamp(m,0,1)*255);case 5122:return Math.round(MathUtils.clamp(m,-1,1)*32767);case 5120:return Math.round(MathUtils.clamp(m,-1,1)*127);default:throw new Error("Invalid component type.")}}static decompose(m,g,w,I){let P=length([m[0],m[1],m[2]]);const F=length([m[4],m[5],m[6]]),D=length([m[8],m[9],m[10]]);determinant(m)<0&&(P=-P),g[0]=m[12],g[1]=m[13],g[2]=m[14];const Z=m.slice(),$=1/P,j=1/F,H=1/D;Z[0]*=$,Z[1]*=$,Z[2]*=$,Z[4]*=j,Z[5]*=j,Z[6]*=j,Z[8]*=H,Z[9]*=H,Z[10]*=H,getRotation(w,Z),I[0]=P,I[1]=F,I[2]=D}static compose(m,g,w,I){const P=I,F=g[0],D=g[1],U=g[2],Z=g[3],$=F+F,j=D+D,H=U+U,W=F*$,V=F*j,Q=F*H,K=D*j,q=D*H,et=U*H,X=Z*$,tt=Z*j,rt=Z*H,ot=w[0],J=w[1],lt=w[2];return P[0]=(1-(K+et))*ot,P[1]=(V+rt)*ot,P[2]=(Q-tt)*ot,P[3]=0,P[4]=(V-rt)*J,P[5]=(1-(W+et))*J,P[6]=(q+X)*J,P[7]=0,P[8]=(Q+tt)*lt,P[9]=(q-X)*lt,P[10]=(1-(W+K))*lt,P[11]=0,P[12]=m[0],P[13]=m[1],P[14]=m[2],P[15]=1,P}}function equalsRef(d,m){if(!!d!=!!m)return!1;const g=d.getChild(),w=m.getChild();return g===w||g.equals(w)}function equalsRefSet(d,m){if(!!d!=!!m)return!1;const g=d.values(),w=m.values();if(g.length!==w.length)return!1;for(let I=0;I<g.length;I++){const P=g[I],F=w[I];if(P.getChild()!==F.getChild()&&!P.getChild().equals(F.getChild()))return!1}return!0}function equalsRefMap(d,m){if(!!d!=!!m)return!1;const g=d.keys(),w=m.keys();if(g.length!==w.length)return!1;for(const I of g){const P=d.get(I),F=m.get(I);if(!!P!=!!F)return!1;const D=P.getChild(),U=F.getChild();if(D!==U&&!D.equals(U))return!1}return!0}function equalsArray(d,m){if(d===m)return!0;if(!!d!=!!m||!d||!m||d.length!==m.length)return!1;for(let g=0;g<d.length;g++)if(d[g]!==m[g])return!1;return!0}function equalsObject(d,m){if(d===m)return!0;if(!!d!=!!m)return!1;if(!isPlainObject(d)||!isPlainObject(m))return d===m;const g=d,w=m;let I=0,P=0,F;for(F in g)I++;for(F in w)P++;if(I!==P)return!1;for(F in g){const D=g[F],U=w[F];if(isArray(D)&&isArray(U)){if(!equalsArray(D,U))return!1}else if(isPlainObject(D)&&isPlainObject(U)){if(!equalsObject(D,U))return!1}else if(D!==U)return!1}return!0}function isArray(d){return Array.isArray(d)||ArrayBuffer.isView(d)}const ALPHABET="23456789abdegjkmnpqrvwxyzABDEGJKMNPQRVWXYZ",UNIQUE_RETRIES=999,ID_LENGTH=6,previousIDs=new Set,generateOne=function d(){let m="";for(let g=0;g<ID_LENGTH;g++)m+=ALPHABET.charAt(Math.floor(Math.random()*ALPHABET.length));return m},uuid=function d(){for(let m=0;m<UNIQUE_RETRIES;m++){const g=generateOne();if(!previousIDs.has(g))return previousIDs.add(g),g}return""},NULL_DOMAIN="https://null.example";class HTTPUtils{static dirname(m){const g=m.lastIndexOf("/");return g===-1?"./":m.substring(0,g+1)}static basename(m){return FileUtils.basename(new URL(m,NULL_DOMAIN).pathname)}static extension(m){return FileUtils.extension(new URL(m,NULL_DOMAIN).pathname)}static resolve(m,g){if(!this.isRelativePath(g))return g;const w=m.split("/"),I=g.split("/");w.pop();for(let P=0;P<I.length;P++)I[P]!=="."&&(I[P]===".."?w.pop():w.push(I[P]));return w.join("/")}static isAbsoluteURL(m){return this.PROTOCOL_REGEXP.test(m)}static isRelativePath(m){return!/^(?:[a-zA-Z]+:)?\//.test(m)}}HTTPUtils.DEFAULT_INIT={};HTTPUtils.PROTOCOL_REGEXP=/^[a-zA-Z]+:\/\//;const COPY_IDENTITY=d=>d,EMPTY_SET=new Set;class Property extends GraphNode{constructor(m,g=""){super(m),this[$attributes].name=g,this.init(),this.dispatchEvent({type:"create"})}getGraph(){return this.graph}getDefaults(){return Object.assign(super.getDefaults(),{name:"",extras:{}})}set(m,g){return Array.isArray(g)&&(g=g.slice()),super.set(m,g)}getName(){return this.get("name")}setName(m){return this.set("name",m)}getExtras(){return this.get("extras")}setExtras(m){return this.set("extras",m)}clone(){const m=this.constructor;return new m(this.graph).copy(this,COPY_IDENTITY)}copy(m,g=COPY_IDENTITY){for(const w in this[$attributes]){const I=this[$attributes][w];if(I instanceof GraphEdge)this[$immutableKeys].has(w)||I.dispose();else if(I instanceof RefList||I instanceof RefSet)for(const P of I.values())P.dispose();else if(I instanceof RefMap)for(const P of I.values())P.dispose()}for(const w in m[$attributes]){const I=this[$attributes][w],P=m[$attributes][w];if(P instanceof GraphEdge)this[$immutableKeys].has(w)?I.getChild().copy(g(P.getChild()),g):this.setRef(w,g(P.getChild()),P.getAttributes());else if(P instanceof RefSet||P instanceof RefList)for(const F of P.values())this.addRef(w,g(F.getChild()),F.getAttributes());else if(P instanceof RefMap)for(const F of P.keys()){const D=P.get(F);this.setRefMap(w,F,g(D.getChild()),D.getAttributes())}else isPlainObject(P)?this[$attributes][w]=JSON.parse(JSON.stringify(P)):Array.isArray(P)||P instanceof ArrayBuffer||ArrayBuffer.isView(P)?this[$attributes][w]=P.slice():this[$attributes][w]=P}return this}equals(m,g=EMPTY_SET){if(this===m)return!0;if(this.propertyType!==m.propertyType)return!1;for(const w in this[$attributes]){if(g.has(w))continue;const I=this[$attributes][w],P=m[$attributes][w];if(I instanceof GraphEdge||P instanceof GraphEdge){if(!equalsRef(I,P))return!1}else if(I instanceof RefSet||P instanceof RefSet||I instanceof RefList||P instanceof RefList){if(!equalsRefSet(I,P))return!1}else if(I instanceof RefMap||P instanceof RefMap){if(!equalsRefMap(I,P))return!1}else if(isPlainObject(I)||isPlainObject(P)){if(!equalsObject(I,P))return!1}else if(isArray(I)||isArray(P)){if(!equalsArray(I,P))return!1}else if(I!==P)return!1}return!0}detach(){return this.graph.disconnectParents(this,m=>m.propertyType!=="Root"),this}listParents(){return this.graph.listParents(this)}}class ExtensibleProperty extends Property{getDefaults(){return Object.assign(super.getDefaults(),{extensions:new RefMap})}getExtension(m){return this.getRefMap("extensions",m)}setExtension(m,g){return g&&g._validateParent(this),this.setRefMap("extensions",m,g)}listExtensions(){return this.listRefMapValues("extensions")}}class Accessor extends ExtensibleProperty{init(){this.propertyType=PropertyType.ACCESSOR}getDefaults(){return Object.assign(super.getDefaults(),{array:null,type:Accessor.Type.SCALAR,componentType:Accessor.ComponentType.FLOAT,normalized:!1,sparse:!1,buffer:null})}static getElementSize(m){switch(m){case Accessor.Type.SCALAR:return 1;case Accessor.Type.VEC2:return 2;case Accessor.Type.VEC3:return 3;case Accessor.Type.VEC4:return 4;case Accessor.Type.MAT2:return 4;case Accessor.Type.MAT3:return 9;case Accessor.Type.MAT4:return 16;default:throw new Error("Unexpected type: "+m)}}static getComponentSize(m){switch(m){case Accessor.ComponentType.BYTE:return 1;case Accessor.ComponentType.UNSIGNED_BYTE:return 1;case Accessor.ComponentType.SHORT:return 2;case Accessor.ComponentType.UNSIGNED_SHORT:return 2;case Accessor.ComponentType.UNSIGNED_INT:return 4;case Accessor.ComponentType.FLOAT:return 4;default:throw new Error("Unexpected component type: "+m)}}getMinNormalized(m){const g=this.getNormalized(),w=this.getElementSize(),I=this.getComponentType();if(this.getMin(m),g)for(let P=0;P<w;P++)m[P]=MathUtils.decodeNormalizedInt(m[P],I);return m}getMin(m){const g=this.getArray(),w=this.getCount(),I=this.getElementSize();for(let P=0;P<I;P++)m[P]=1/0;for(let P=0;P<w*I;P+=I)for(let F=0;F<I;F++){const D=g[P+F];Number.isFinite(D)&&(m[F]=Math.min(m[F],D))}return m}getMaxNormalized(m){const g=this.getNormalized(),w=this.getElementSize(),I=this.getComponentType();if(this.getMax(m),g)for(let P=0;P<w;P++)m[P]=MathUtils.decodeNormalizedInt(m[P],I);return m}getMax(m){const g=this.get("array"),w=this.getCount(),I=this.getElementSize();for(let P=0;P<I;P++)m[P]=-1/0;for(let P=0;P<w*I;P+=I)for(let F=0;F<I;F++){const D=g[P+F];Number.isFinite(D)&&(m[F]=Math.max(m[F],D))}return m}getCount(){const m=this.get("array");return m?m.length/this.getElementSize():0}getType(){return this.get("type")}setType(m){return this.set("type",m)}getElementSize(){return Accessor.getElementSize(this.get("type"))}getComponentSize(){return this.get("array").BYTES_PER_ELEMENT}getComponentType(){return this.get("componentType")}getNormalized(){return this.get("normalized")}setNormalized(m){return this.set("normalized",m)}getScalar(m){const g=this.getElementSize(),w=this.getComponentType(),I=this.getArray();return this.getNormalized()?MathUtils.decodeNormalizedInt(I[m*g],w):I[m*g]}setScalar(m,g){const w=this.getElementSize(),I=this.getComponentType(),P=this.getArray();return this.getNormalized()?P[m*w]=MathUtils.encodeNormalizedInt(g,I):P[m*w]=g,this}getElement(m,g){const w=this.getNormalized(),I=this.getElementSize(),P=this.getComponentType(),F=this.getArray();for(let D=0;D<I;D++)w?g[D]=MathUtils.decodeNormalizedInt(F[m*I+D],P):g[D]=F[m*I+D];return g}setElement(m,g){const w=this.getNormalized(),I=this.getElementSize(),P=this.getComponentType(),F=this.getArray();for(let D=0;D<I;D++)w?F[m*I+D]=MathUtils.encodeNormalizedInt(g[D],P):F[m*I+D]=g[D];return this}getSparse(){return this.get("sparse")}setSparse(m){return this.set("sparse",m)}getBuffer(){return this.getRef("buffer")}setBuffer(m){return this.setRef("buffer",m)}getArray(){return this.get("array")}setArray(m){return this.set("componentType",m?arrayToComponentType(m):Accessor.ComponentType.FLOAT),this.set("array",m),this}getByteLength(){const m=this.get("array");return m?m.byteLength:0}}Accessor.Type={SCALAR:"SCALAR",VEC2:"VEC2",VEC3:"VEC3",VEC4:"VEC4",MAT2:"MAT2",MAT3:"MAT3",MAT4:"MAT4"};Accessor.ComponentType={BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,UNSIGNED_INT:5125,FLOAT:5126};function arrayToComponentType(d){switch(d.constructor){case Float32Array:return Accessor.ComponentType.FLOAT;case Uint32Array:return Accessor.ComponentType.UNSIGNED_INT;case Uint16Array:return Accessor.ComponentType.UNSIGNED_SHORT;case Uint8Array:return Accessor.ComponentType.UNSIGNED_BYTE;case Int16Array:return Accessor.ComponentType.SHORT;case Int8Array:return Accessor.ComponentType.BYTE;default:throw new Error("Unknown accessor componentType.")}}class Animation extends ExtensibleProperty{init(){this.propertyType=PropertyType.ANIMATION}getDefaults(){return Object.assign(super.getDefaults(),{channels:new RefSet,samplers:new RefSet})}addChannel(m){return this.addRef("channels",m)}removeChannel(m){return this.removeRef("channels",m)}listChannels(){return this.listRefs("channels")}addSampler(m){return this.addRef("samplers",m)}removeSampler(m){return this.removeRef("samplers",m)}listSamplers(){return this.listRefs("samplers")}}class AnimationChannel extends ExtensibleProperty{init(){this.propertyType=PropertyType.ANIMATION_CHANNEL}getDefaults(){return Object.assign(super.getDefaults(),{targetPath:null,targetNode:null,sampler:null})}getTargetPath(){return this.get("targetPath")}setTargetPath(m){return this.set("targetPath",m)}getTargetNode(){return this.getRef("targetNode")}setTargetNode(m){return this.setRef("targetNode",m)}getSampler(){return this.getRef("sampler")}setSampler(m){return this.setRef("sampler",m)}}AnimationChannel.TargetPath={TRANSLATION:"translation",ROTATION:"rotation",SCALE:"scale",WEIGHTS:"weights"};class AnimationSampler extends ExtensibleProperty{init(){this.propertyType=PropertyType.ANIMATION_SAMPLER}getDefaultAttributes(){return Object.assign(super.getDefaults(),{interpolation:AnimationSampler.Interpolation.LINEAR,input:null,output:null})}getInterpolation(){return this.get("interpolation")}setInterpolation(m){return this.set("interpolation",m)}getInput(){return this.getRef("input")}setInput(m){return this.setRef("input",m,{usage:BufferViewUsage$1.OTHER})}getOutput(){return this.getRef("output")}setOutput(m){return this.setRef("output",m,{usage:BufferViewUsage$1.OTHER})}}AnimationSampler.Interpolation={LINEAR:"LINEAR",STEP:"STEP",CUBICSPLINE:"CUBICSPLINE"};class Buffer$1 extends ExtensibleProperty{init(){this.propertyType=PropertyType.BUFFER}getDefaults(){return Object.assign(super.getDefaults(),{uri:""})}getURI(){return this.get("uri")}setURI(m){return this.set("uri",m)}}class Camera extends ExtensibleProperty{init(){this.propertyType=PropertyType.CAMERA}getDefaults(){return Object.assign(super.getDefaults(),{type:Camera.Type.PERSPECTIVE,znear:.1,zfar:100,aspectRatio:null,yfov:Math.PI*2*50/360,xmag:1,ymag:1})}getType(){return this.get("type")}setType(m){return this.set("type",m)}getZNear(){return this.get("znear")}setZNear(m){return this.set("znear",m)}getZFar(){return this.get("zfar")}setZFar(m){return this.set("zfar",m)}getAspectRatio(){return this.get("aspectRatio")}setAspectRatio(m){return this.set("aspectRatio",m)}getYFov(){return this.get("yfov")}setYFov(m){return this.set("yfov",m)}getXMag(){return this.get("xmag")}setXMag(m){return this.set("xmag",m)}getYMag(){return this.get("ymag")}setYMag(m){return this.set("ymag",m)}}Camera.Type={PERSPECTIVE:"perspective",ORTHOGRAPHIC:"orthographic"};class ExtensionProperty extends Property{_validateParent(m){if(!this.parentTypes.includes(m.propertyType))throw new Error(`Parent "${m.propertyType}" invalid for child "${this.propertyType}".`)}}ExtensionProperty.EXTENSION_NAME=void 0;class TextureInfo extends ExtensibleProperty{init(){this.propertyType=PropertyType.TEXTURE_INFO}getDefaults(){return Object.assign(super.getDefaults(),{texCoord:0,magFilter:null,minFilter:null,wrapS:TextureInfo.WrapMode.REPEAT,wrapT:TextureInfo.WrapMode.REPEAT})}getTexCoord(){return this.get("texCoord")}setTexCoord(m){return this.set("texCoord",m)}getMagFilter(){return this.get("magFilter")}setMagFilter(m){return this.set("magFilter",m)}getMinFilter(){return this.get("minFilter")}setMinFilter(m){return this.set("minFilter",m)}getWrapS(){return this.get("wrapS")}setWrapS(m){return this.set("wrapS",m)}getWrapT(){return this.get("wrapT")}setWrapT(m){return this.set("wrapT",m)}}TextureInfo.WrapMode={CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,REPEAT:10497};TextureInfo.MagFilter={NEAREST:9728,LINEAR:9729};TextureInfo.MinFilter={NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987};const{R,G,B,A}=TextureChannel;class Material extends ExtensibleProperty{init(){this.propertyType=PropertyType.MATERIAL}getDefaults(){return Object.assign(super.getDefaults(),{alphaMode:Material.AlphaMode.OPAQUE,alphaCutoff:.5,doubleSided:!1,baseColorFactor:[1,1,1,1],baseColorTexture:null,baseColorTextureInfo:new TextureInfo(this.graph,"baseColorTextureInfo"),emissiveFactor:[0,0,0],emissiveTexture:null,emissiveTextureInfo:new TextureInfo(this.graph,"emissiveTextureInfo"),normalScale:1,normalTexture:null,normalTextureInfo:new TextureInfo(this.graph,"normalTextureInfo"),occlusionStrength:1,occlusionTexture:null,occlusionTextureInfo:new TextureInfo(this.graph,"occlusionTextureInfo"),roughnessFactor:1,metallicFactor:1,metallicRoughnessTexture:null,metallicRoughnessTextureInfo:new TextureInfo(this.graph,"metallicRoughnessTextureInfo")})}getDoubleSided(){return this.get("doubleSided")}setDoubleSided(m){return this.set("doubleSided",m)}getAlpha(){return this.get("baseColorFactor")[3]}setAlpha(m){const g=this.get("baseColorFactor").slice();return g[3]=m,this.set("baseColorFactor",g)}getAlphaMode(){return this.get("alphaMode")}setAlphaMode(m){return this.set("alphaMode",m)}getAlphaCutoff(){return this.get("alphaCutoff")}setAlphaCutoff(m){return this.set("alphaCutoff",m)}getBaseColorFactor(){return this.get("baseColorFactor")}setBaseColorFactor(m){return this.set("baseColorFactor",m)}getBaseColorTexture(){return this.getRef("baseColorTexture")}getBaseColorTextureInfo(){return this.getRef("baseColorTexture")?this.getRef("baseColorTextureInfo"):null}setBaseColorTexture(m){return this.setRef("baseColorTexture",m,{channels:R|G|B|A,isColor:!0})}getEmissiveFactor(){return this.get("emissiveFactor")}setEmissiveFactor(m){return this.set("emissiveFactor",m)}getEmissiveTexture(){return this.getRef("emissiveTexture")}getEmissiveTextureInfo(){return this.getRef("emissiveTexture")?this.getRef("emissiveTextureInfo"):null}setEmissiveTexture(m){return this.setRef("emissiveTexture",m,{channels:R|G|B,isColor:!0})}getNormalScale(){return this.get("normalScale")}setNormalScale(m){return this.set("normalScale",m)}getNormalTexture(){return this.getRef("normalTexture")}getNormalTextureInfo(){return this.getRef("normalTexture")?this.getRef("normalTextureInfo"):null}setNormalTexture(m){return this.setRef("normalTexture",m,{channels:R|G|B})}getOcclusionStrength(){return this.get("occlusionStrength")}setOcclusionStrength(m){return this.set("occlusionStrength",m)}getOcclusionTexture(){return this.getRef("occlusionTexture")}getOcclusionTextureInfo(){return this.getRef("occlusionTexture")?this.getRef("occlusionTextureInfo"):null}setOcclusionTexture(m){return this.setRef("occlusionTexture",m,{channels:R})}getRoughnessFactor(){return this.get("roughnessFactor")}setRoughnessFactor(m){return this.set("roughnessFactor",m)}getMetallicFactor(){return this.get("metallicFactor")}setMetallicFactor(m){return this.set("metallicFactor",m)}getMetallicRoughnessTexture(){return this.getRef("metallicRoughnessTexture")}getMetallicRoughnessTextureInfo(){return this.getRef("metallicRoughnessTexture")?this.getRef("metallicRoughnessTextureInfo"):null}setMetallicRoughnessTexture(m){return this.setRef("metallicRoughnessTexture",m,{channels:G|B})}}Material.AlphaMode={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};class Mesh extends ExtensibleProperty{init(){this.propertyType=PropertyType.MESH}getDefaults(){return Object.assign(super.getDefaults(),{weights:[],primitives:new RefSet})}addPrimitive(m){return this.addRef("primitives",m)}removePrimitive(m){return this.removeRef("primitives",m)}listPrimitives(){return this.listRefs("primitives")}getWeights(){return this.get("weights")}setWeights(m){return this.set("weights",m)}}class Node extends ExtensibleProperty{init(){this.propertyType=PropertyType.NODE}getDefaults(){return Object.assign(super.getDefaults(),{translation:[0,0,0],rotation:[0,0,0,1],scale:[1,1,1],weights:[],camera:null,mesh:null,skin:null,children:new RefSet})}copy(m,g=COPY_IDENTITY){if(g===COPY_IDENTITY)throw new Error("Node cannot be copied.");return super.copy(m,g)}getTranslation(){return this.get("translation")}getRotation(){return this.get("rotation")}getScale(){return this.get("scale")}setTranslation(m){return this.set("translation",m)}setRotation(m){return this.set("rotation",m)}setScale(m){return this.set("scale",m)}getMatrix(){return MathUtils.compose(this.get("translation"),this.get("rotation"),this.get("scale"),[])}setMatrix(m){const g=this.get("translation").slice(),w=this.get("rotation").slice(),I=this.get("scale").slice();return MathUtils.decompose(m,g,w,I),this.set("translation",g).set("rotation",w).set("scale",I)}getWorldTranslation(){const m=[0,0,0];return MathUtils.decompose(this.getWorldMatrix(),m,[0,0,0,1],[1,1,1]),m}getWorldRotation(){const m=[0,0,0,1];return MathUtils.decompose(this.getWorldMatrix(),[0,0,0],m,[1,1,1]),m}getWorldScale(){const m=[1,1,1];return MathUtils.decompose(this.getWorldMatrix(),[0,0,0],[0,0,0,1],m),m}getWorldMatrix(){const m=[];for(let I=this;I!=null;I=I.getParentNode())m.push(I);let g;const w=m.pop().getMatrix();for(;g=m.pop();)multiply(w,w,g.getMatrix());return w}addChild(m){const g=m.getParentNode();g&&g.removeChild(m);for(const w of m.listParents())w.propertyType===PropertyType.SCENE&&w.removeChild(m);return this.addRef("children",m)}removeChild(m){return this.removeRef("children",m)}listChildren(){return this.listRefs("children")}getParentNode(){for(const m of this.listParents())if(m.propertyType===PropertyType.NODE)return m;return null}getMesh(){return this.getRef("mesh")}setMesh(m){return this.setRef("mesh",m)}getCamera(){return this.getRef("camera")}setCamera(m){return this.setRef("camera",m)}getSkin(){return this.getRef("skin")}setSkin(m){return this.setRef("skin",m)}getWeights(){return this.get("weights")}setWeights(m){return this.set("weights",m)}traverse(m){m(this);for(const g of this.listChildren())g.traverse(m);return this}}class Primitive extends ExtensibleProperty{init(){this.propertyType=PropertyType.PRIMITIVE}getDefaults(){return Object.assign(super.getDefaults(),{mode:Primitive.Mode.TRIANGLES,material:null,indices:null,attributes:new RefMap,targets:new RefSet})}getIndices(){return this.getRef("indices")}setIndices(m){return this.setRef("indices",m,{usage:BufferViewUsage$1.ELEMENT_ARRAY_BUFFER})}getAttribute(m){return this.getRefMap("attributes",m)}setAttribute(m,g){return this.setRefMap("attributes",m,g,{usage:BufferViewUsage$1.ARRAY_BUFFER})}listAttributes(){return this.listRefMapValues("attributes")}listSemantics(){return this.listRefMapKeys("attributes")}getMaterial(){return this.getRef("material")}setMaterial(m){return this.setRef("material",m)}getMode(){return this.get("mode")}setMode(m){return this.set("mode",m)}listTargets(){return this.listRefs("targets")}addTarget(m){return this.addRef("targets",m)}removeTarget(m){return this.removeRef("targets",m)}}Primitive.Mode={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};class PrimitiveTarget extends Property{init(){this.propertyType=PropertyType.PRIMITIVE_TARGET}getDefaults(){return Object.assign(super.getDefaults(),{attributes:new RefMap})}getAttribute(m){return this.getRefMap("attributes",m)}setAttribute(m,g){return this.setRefMap("attributes",m,g,{usage:BufferViewUsage$1.ARRAY_BUFFER})}listAttributes(){return this.listRefMapValues("attributes")}listSemantics(){return this.listRefMapKeys("attributes")}}function _extends(){return _extends=Object.assign?Object.assign.bind():function(d){for(var m=1;m<arguments.length;m++){var g=arguments[m];for(var w in g)({}).hasOwnProperty.call(g,w)&&(d[w]=g[w])}return d},_extends.apply(null,arguments)}class Scene extends ExtensibleProperty{init(){this.propertyType=PropertyType.SCENE}getDefaults(){return Object.assign(super.getDefaults(),{children:new RefSet})}copy(m,g=COPY_IDENTITY){if(g===COPY_IDENTITY)throw new Error("Scene cannot be copied.");return super.copy(m,g)}addChild(m){const g=m.getParentNode();return g&&g.removeChild(m),this.addRef("children",m)}removeChild(m){return this.removeRef("children",m)}listChildren(){return this.listRefs("children")}traverse(m){for(const g of this.listChildren())g.traverse(m);return this}}class Skin extends ExtensibleProperty{init(){this.propertyType=PropertyType.SKIN}getDefaults(){return Object.assign(super.getDefaults(),{skeleton:null,inverseBindMatrices:null,joints:new RefSet})}getSkeleton(){return this.getRef("skeleton")}setSkeleton(m){return this.setRef("skeleton",m)}getInverseBindMatrices(){return this.getRef("inverseBindMatrices")}setInverseBindMatrices(m){return this.setRef("inverseBindMatrices",m,{usage:BufferViewUsage$1.INVERSE_BIND_MATRICES})}addJoint(m){return this.addRef("joints",m)}removeJoint(m){return this.removeRef("joints",m)}listJoints(){return this.listRefs("joints")}}class Texture extends ExtensibleProperty{init(){this.propertyType=PropertyType.TEXTURE}getDefaults(){return Object.assign(super.getDefaults(),{image:null,mimeType:"",uri:""})}getMimeType(){return this.get("mimeType")||ImageUtils.extensionToMimeType(FileUtils.extension(this.get("uri")))}setMimeType(m){return this.set("mimeType",m)}getURI(){return this.get("uri")}setURI(m){this.set("uri",m);const g=ImageUtils.extensionToMimeType(FileUtils.extension(m));return g&&this.set("mimeType",g),this}getImage(){return this.get("image")}setImage(m){return this.set("image",BufferUtils.assertView(m))}getSize(){const m=this.get("image");return m?ImageUtils.getSize(m,this.getMimeType()):null}}class Root extends ExtensibleProperty{init(){this.propertyType=PropertyType.ROOT}getDefaults(){return Object.assign(super.getDefaults(),{asset:{generator:`glTF-Transform ${VERSION}`,version:"2.0"},defaultScene:null,accessors:new RefSet,animations:new RefSet,buffers:new RefSet,cameras:new RefSet,materials:new RefSet,meshes:new RefSet,nodes:new RefSet,scenes:new RefSet,skins:new RefSet,textures:new RefSet})}constructor(m){super(m),this._extensions=new Set,m.addEventListener("node:create",g=>{this._addChildOfRoot(g.target)})}clone(){throw new Error("Root cannot be cloned.")}copy(m,g=COPY_IDENTITY){if(g===COPY_IDENTITY)throw new Error("Root cannot be copied.");this.set("asset",_extends({},m.get("asset"))),this.setName(m.getName()),this.setExtras(_extends({},m.getExtras())),this.setDefaultScene(m.getDefaultScene()?g(m.getDefaultScene()):null);for(const w of m.listRefMapKeys("extensions")){const I=m.getExtension(w);this.setExtension(w,g(I))}return this}_addChildOfRoot(m){return m instanceof Scene?this.addRef("scenes",m):m instanceof Node?this.addRef("nodes",m):m instanceof Camera?this.addRef("cameras",m):m instanceof Skin?this.addRef("skins",m):m instanceof Mesh?this.addRef("meshes",m):m instanceof Material?this.addRef("materials",m):m instanceof Texture?this.addRef("textures",m):m instanceof Animation?this.addRef("animations",m):m instanceof Accessor?this.addRef("accessors",m):m instanceof Buffer$1&&this.addRef("buffers",m),this}getAsset(){return this.get("asset")}listExtensionsUsed(){return Array.from(this._extensions)}listExtensionsRequired(){return this.listExtensionsUsed().filter(m=>m.isRequired())}_enableExtension(m){return this._extensions.add(m),this}_disableExtension(m){return this._extensions.delete(m),this}listScenes(){return this.listRefs("scenes")}setDefaultScene(m){return this.setRef("defaultScene",m)}getDefaultScene(){return this.getRef("defaultScene")}listNodes(){return this.listRefs("nodes")}listCameras(){return this.listRefs("cameras")}listSkins(){return this.listRefs("skins")}listMeshes(){return this.listRefs("meshes")}listMaterials(){return this.listRefs("materials")}listTextures(){return this.listRefs("textures")}listAnimations(){return this.listRefs("animations")}listAccessors(){return this.listRefs("accessors")}listBuffers(){return this.listRefs("buffers")}}class Document{static fromGraph(m){return Document._GRAPH_DOCUMENTS.get(m)||null}constructor(){this._graph=new Graph,this._root=new Root(this._graph),this._logger=Logger.DEFAULT_INSTANCE,Document._GRAPH_DOCUMENTS.set(this._graph,this)}getRoot(){return this._root}getGraph(){return this._graph}getLogger(){return this._logger}setLogger(m){return this._logger=m,this}clone(){throw new Error("Use 'cloneDocument(source)' from '@gltf-transform/functions'.")}merge(m){throw new Error("Use 'mergeDocuments(target, source)' from '@gltf-transform/functions'.")}async transform(...m){const g=m.map(w=>w.name);for(const w of m)await w(this,{stack:g});return this}createExtension(m){const g=m.EXTENSION_NAME;return this.getRoot().listExtensionsUsed().find(I=>I.extensionName===g)||new m(this)}createScene(m=""){return new Scene(this._graph,m)}createNode(m=""){return new Node(this._graph,m)}createCamera(m=""){return new Camera(this._graph,m)}createSkin(m=""){return new Skin(this._graph,m)}createMesh(m=""){return new Mesh(this._graph,m)}createPrimitive(){return new Primitive(this._graph)}createPrimitiveTarget(m=""){return new PrimitiveTarget(this._graph,m)}createMaterial(m=""){return new Material(this._graph,m)}createTexture(m=""){return new Texture(this._graph,m)}createAnimation(m=""){return new Animation(this._graph,m)}createAnimationChannel(m=""){return new AnimationChannel(this._graph,m)}createAnimationSampler(m=""){return new AnimationSampler(this._graph,m)}createAccessor(m="",g=null){return g||(g=this.getRoot().listBuffers()[0]),new Accessor(this._graph,m).setBuffer(g)}createBuffer(m=""){return new Buffer$1(this._graph,m)}}Document._GRAPH_DOCUMENTS=new WeakMap;class ReaderContext{constructor(m){this.jsonDoc=void 0,this.buffers=[],this.bufferViews=[],this.bufferViewBuffers=[],this.accessors=[],this.textures=[],this.textureInfos=new Map,this.materials=[],this.meshes=[],this.cameras=[],this.nodes=[],this.skins=[],this.animations=[],this.scenes=[],this.jsonDoc=m}setTextureInfo(m,g){this.textureInfos.set(m,g),g.texCoord!==void 0&&m.setTexCoord(g.texCoord),g.extras!==void 0&&m.setExtras(g.extras);const w=this.jsonDoc.json.textures[g.index];if(w.sampler===void 0)return;const I=this.jsonDoc.json.samplers[w.sampler];I.magFilter!==void 0&&m.setMagFilter(I.magFilter),I.minFilter!==void 0&&m.setMinFilter(I.minFilter),I.wrapS!==void 0&&m.setWrapS(I.wrapS),I.wrapT!==void 0&&m.setWrapT(I.wrapT)}}const DEFAULT_OPTIONS={logger:Logger.DEFAULT_INSTANCE,extensions:[],dependencies:{}},SUPPORTED_PREREAD_TYPES=new Set([PropertyType.BUFFER,PropertyType.TEXTURE,PropertyType.MATERIAL,PropertyType.MESH,PropertyType.PRIMITIVE,PropertyType.NODE,PropertyType.SCENE]);class GLTFReader{static read(m,g=DEFAULT_OPTIONS){const w=_extends({},DEFAULT_OPTIONS,g),{json:I}=m,P=new Document().setLogger(w.logger);this.validate(m,w);const F=new ReaderContext(m),D=I.asset,U=P.getRoot().getAsset();D.copyright&&(U.copyright=D.copyright),D.extras&&(U.extras=D.extras),I.extras!==void 0&&P.getRoot().setExtras(_extends({},I.extras));const Z=I.extensionsUsed||[],$=I.extensionsRequired||[];w.extensions.sort((J,lt)=>J.EXTENSION_NAME>lt.EXTENSION_NAME?1:-1);for(const J of w.extensions)if(Z.includes(J.EXTENSION_NAME)){const lt=P.createExtension(J).setRequired($.includes(J.EXTENSION_NAME)),st=lt.prereadTypes.filter(ut=>!SUPPORTED_PREREAD_TYPES.has(ut));st.length&&w.logger.warn(`Preread hooks for some types (${st.join()}), requested by extension ${lt.extensionName}, are unsupported. Please file an issue or a PR.`);for(const ut of lt.readDependencies)lt.install(ut,w.dependencies[ut])}const j=I.buffers||[];P.getRoot().listExtensionsUsed().filter(J=>J.prereadTypes.includes(PropertyType.BUFFER)).forEach(J=>J.preread(F,PropertyType.BUFFER)),F.buffers=j.map(J=>{const lt=P.createBuffer(J.name);return J.extras&&lt.setExtras(J.extras),J.uri&&J.uri.indexOf("__")!==0&&lt.setURI(J.uri),lt});const H=I.bufferViews||[];F.bufferViewBuffers=H.map((J,lt)=>{if(!F.bufferViews[lt]){const st=m.json.buffers[J.buffer],ut=st.uri?m.resources[st.uri]:m.resources[GLB_BUFFER],it=J.byteOffset||0;F.bufferViews[lt]=BufferUtils.toView(ut,it,J.byteLength)}return F.buffers[J.buffer]});const W=I.accessors||[];F.accessors=W.map(J=>{const lt=F.bufferViewBuffers[J.bufferView],st=P.createAccessor(J.name,lt).setType(J.type);return J.extras&&st.setExtras(J.extras),J.normalized!==void 0&&st.setNormalized(J.normalized),J.bufferView===void 0||st.setArray(getAccessorArray(J,F)),st});const V=I.images||[],Q=I.textures||[];P.getRoot().listExtensionsUsed().filter(J=>J.prereadTypes.includes(PropertyType.TEXTURE)).forEach(J=>J.preread(F,PropertyType.TEXTURE)),F.textures=V.map(J=>{const lt=P.createTexture(J.name);if(J.extras&&lt.setExtras(J.extras),J.bufferView!==void 0){const st=I.bufferViews[J.bufferView],ut=m.json.buffers[st.buffer],it=ut.uri?m.resources[ut.uri]:m.resources[GLB_BUFFER],ct=st.byteOffset||0,At=st.byteLength,Et=it.slice(ct,ct+At);lt.setImage(Et)}else J.uri!==void 0&&(lt.setImage(m.resources[J.uri]),J.uri.indexOf("__")!==0&&lt.setURI(J.uri));if(J.mimeType!==void 0)lt.setMimeType(J.mimeType);else if(J.uri){const st=FileUtils.extension(J.uri);lt.setMimeType(ImageUtils.extensionToMimeType(st))}return lt}),P.getRoot().listExtensionsUsed().filter(J=>J.prereadTypes.includes(PropertyType.MATERIAL)).forEach(J=>J.preread(F,PropertyType.MATERIAL));const K=I.materials||[];F.materials=K.map(J=>{const lt=P.createMaterial(J.name);J.extras&&lt.setExtras(J.extras),J.alphaMode!==void 0&&lt.setAlphaMode(J.alphaMode),J.alphaCutoff!==void 0&&lt.setAlphaCutoff(J.alphaCutoff),J.doubleSided!==void 0&&lt.setDoubleSided(J.doubleSided);const st=J.pbrMetallicRoughness||{};if(st.baseColorFactor!==void 0&&lt.setBaseColorFactor(st.baseColorFactor),J.emissiveFactor!==void 0&&lt.setEmissiveFactor(J.emissiveFactor),st.metallicFactor!==void 0&&lt.setMetallicFactor(st.metallicFactor),st.roughnessFactor!==void 0&&lt.setRoughnessFactor(st.roughnessFactor),st.baseColorTexture!==void 0){const ut=st.baseColorTexture,it=F.textures[Q[ut.index].source];lt.setBaseColorTexture(it),F.setTextureInfo(lt.getBaseColorTextureInfo(),ut)}if(J.emissiveTexture!==void 0){const ut=J.emissiveTexture,it=F.textures[Q[ut.index].source];lt.setEmissiveTexture(it),F.setTextureInfo(lt.getEmissiveTextureInfo(),ut)}if(J.normalTexture!==void 0){const ut=J.normalTexture,it=F.textures[Q[ut.index].source];lt.setNormalTexture(it),F.setTextureInfo(lt.getNormalTextureInfo(),ut),J.normalTexture.scale!==void 0&&lt.setNormalScale(J.normalTexture.scale)}if(J.occlusionTexture!==void 0){const ut=J.occlusionTexture,it=F.textures[Q[ut.index].source];lt.setOcclusionTexture(it),F.setTextureInfo(lt.getOcclusionTextureInfo(),ut),J.occlusionTexture.strength!==void 0&&lt.setOcclusionStrength(J.occlusionTexture.strength)}if(st.metallicRoughnessTexture!==void 0){const ut=st.metallicRoughnessTexture,it=F.textures[Q[ut.index].source];lt.setMetallicRoughnessTexture(it),F.setTextureInfo(lt.getMetallicRoughnessTextureInfo(),ut)}return lt}),P.getRoot().listExtensionsUsed().filter(J=>J.prereadTypes.includes(PropertyType.MESH)).forEach(J=>J.preread(F,PropertyType.MESH));const q=I.meshes||[];P.getRoot().listExtensionsUsed().filter(J=>J.prereadTypes.includes(PropertyType.PRIMITIVE)).forEach(J=>J.preread(F,PropertyType.PRIMITIVE)),F.meshes=q.map(J=>{const lt=P.createMesh(J.name);return J.extras&&lt.setExtras(J.extras),J.weights!==void 0&&lt.setWeights(J.weights),(J.primitives||[]).forEach(ut=>{const it=P.createPrimitive();ut.extras&&it.setExtras(ut.extras),ut.material!==void 0&&it.setMaterial(F.materials[ut.material]),ut.mode!==void 0&&it.setMode(ut.mode);for(const[Et,gt]of Object.entries(ut.attributes||{}))it.setAttribute(Et,F.accessors[gt]);ut.indices!==void 0&&it.setIndices(F.accessors[ut.indices]);const ct=J.extras&&J.extras.targetNames||[];(ut.targets||[]).forEach((Et,gt)=>{const pt=ct[gt]||gt.toString(),vt=P.createPrimitiveTarget(pt);for(const[Tt,It]of Object.entries(Et))vt.setAttribute(Tt,F.accessors[It]);it.addTarget(vt)}),lt.addPrimitive(it)}),lt});const et=I.cameras||[];F.cameras=et.map(J=>{const lt=P.createCamera(J.name).setType(J.type);if(J.extras&&lt.setExtras(J.extras),J.type===Camera.Type.PERSPECTIVE){const st=J.perspective;lt.setYFov(st.yfov),lt.setZNear(st.znear),st.zfar!==void 0&&lt.setZFar(st.zfar),st.aspectRatio!==void 0&&lt.setAspectRatio(st.aspectRatio)}else{const st=J.orthographic;lt.setZNear(st.znear).setZFar(st.zfar).setXMag(st.xmag).setYMag(st.ymag)}return lt});const X=I.nodes||[];P.getRoot().listExtensionsUsed().filter(J=>J.prereadTypes.includes(PropertyType.NODE)).forEach(J=>J.preread(F,PropertyType.NODE)),F.nodes=X.map(J=>{const lt=P.createNode(J.name);if(J.extras&&lt.setExtras(J.extras),J.translation!==void 0&&lt.setTranslation(J.translation),J.rotation!==void 0&&lt.setRotation(J.rotation),J.scale!==void 0&&lt.setScale(J.scale),J.matrix!==void 0){const st=[0,0,0],ut=[0,0,0,1],it=[1,1,1];MathUtils.decompose(J.matrix,st,ut,it),lt.setTranslation(st),lt.setRotation(ut),lt.setScale(it)}return J.weights!==void 0&&lt.setWeights(J.weights),lt});const tt=I.skins||[];F.skins=tt.map(J=>{const lt=P.createSkin(J.name);J.extras&&lt.setExtras(J.extras),J.inverseBindMatrices!==void 0&&lt.setInverseBindMatrices(F.accessors[J.inverseBindMatrices]),J.skeleton!==void 0&&lt.setSkeleton(F.nodes[J.skeleton]);for(const st of J.joints)lt.addJoint(F.nodes[st]);return lt}),X.map((J,lt)=>{const st=F.nodes[lt];(J.children||[]).forEach(it=>st.addChild(F.nodes[it])),J.mesh!==void 0&&st.setMesh(F.meshes[J.mesh]),J.camera!==void 0&&st.setCamera(F.cameras[J.camera]),J.skin!==void 0&&st.setSkin(F.skins[J.skin])});const rt=I.animations||[];F.animations=rt.map(J=>{const lt=P.createAnimation(J.name);J.extras&&lt.setExtras(J.extras);const ut=(J.samplers||[]).map(ct=>{const At=P.createAnimationSampler().setInput(F.accessors[ct.input]).setOutput(F.accessors[ct.output]).setInterpolation(ct.interpolation||AnimationSampler.Interpolation.LINEAR);return ct.extras&&At.setExtras(ct.extras),lt.addSampler(At),At});return(J.channels||[]).forEach(ct=>{const At=P.createAnimationChannel().setSampler(ut[ct.sampler]).setTargetPath(ct.target.path);ct.target.node!==void 0&&At.setTargetNode(F.nodes[ct.target.node]),ct.extras&&At.setExtras(ct.extras),lt.addChannel(At)}),lt});const ot=I.scenes||[];return P.getRoot().listExtensionsUsed().filter(J=>J.prereadTypes.includes(PropertyType.SCENE)).forEach(J=>J.preread(F,PropertyType.SCENE)),F.scenes=ot.map(J=>{const lt=P.createScene(J.name);return J.extras&&lt.setExtras(J.extras),(J.nodes||[]).map(ut=>F.nodes[ut]).forEach(ut=>lt.addChild(ut)),lt}),I.scene!==void 0&&P.getRoot().setDefaultScene(F.scenes[I.scene]),P.getRoot().listExtensionsUsed().forEach(J=>J.read(F)),W.forEach((J,lt)=>{const st=F.accessors[lt],ut=!!J.sparse,it=!J.bufferView&&!st.getArray();(ut||it)&&st.setSparse(!0).setArray(getSparseArray(J,F))}),P}static validate(m,g){const w=m.json;if(w.asset.version!=="2.0")throw new Error(`Unsupported glTF version, "${w.asset.version}".`);if(w.extensionsRequired){for(const I of w.extensionsRequired)if(!g.extensions.find(P=>P.EXTENSION_NAME===I))throw new Error(`Missing required extension, "${I}".`)}if(w.extensionsUsed)for(const I of w.extensionsUsed)g.extensions.find(P=>P.EXTENSION_NAME===I)||g.logger.warn(`Missing optional extension, "${I}".`)}}function getInterleavedArray(d,m){const g=m.jsonDoc,w=m.bufferViews[d.bufferView],I=g.json.bufferViews[d.bufferView],P=ComponentTypeToTypedArray[d.componentType],F=Accessor.getElementSize(d.type),D=P.BYTES_PER_ELEMENT,U=d.byteOffset||0,Z=new P(d.count*F),$=new DataView(w.buffer,w.byteOffset,w.byteLength),j=I.byteStride;for(let H=0;H<d.count;H++)for(let W=0;W<F;W++){const V=U+H*j+W*D;let Q;switch(d.componentType){case Accessor.ComponentType.FLOAT:Q=$.getFloat32(V,!0);break;case Accessor.ComponentType.UNSIGNED_INT:Q=$.getUint32(V,!0);break;case Accessor.ComponentType.UNSIGNED_SHORT:Q=$.getUint16(V,!0);break;case Accessor.ComponentType.UNSIGNED_BYTE:Q=$.getUint8(V);break;case Accessor.ComponentType.SHORT:Q=$.getInt16(V,!0);break;case Accessor.ComponentType.BYTE:Q=$.getInt8(V);break;default:throw new Error(`Unexpected componentType "${d.componentType}".`)}Z[H*F+W]=Q}return Z}function getAccessorArray(d,m){const g=m.jsonDoc,w=m.bufferViews[d.bufferView],I=g.json.bufferViews[d.bufferView],P=ComponentTypeToTypedArray[d.componentType],F=Accessor.getElementSize(d.type),D=P.BYTES_PER_ELEMENT,U=F*D;if(I.byteStride!==void 0&&I.byteStride!==U)return getInterleavedArray(d,m);const Z=w.byteOffset+(d.byteOffset||0),$=d.count*F*D;return new P(w.buffer.slice(Z,Z+$))}function getSparseArray(d,m){const g=ComponentTypeToTypedArray[d.componentType],w=Accessor.getElementSize(d.type);let I;d.bufferView!==void 0?I=getAccessorArray(d,m):I=new g(d.count*w);const P=d.sparse;if(!P)return I;const F=P.count,D=_extends({},d,P.indices,{count:F,type:"SCALAR"}),U=_extends({},d,P.values,{count:F}),Z=getAccessorArray(D,m),$=getAccessorArray(U,m);for(let j=0;j<D.count;j++)for(let H=0;H<w;H++)I[Z[j]*w+H]=$[j*w+H];return I}var BufferViewTarget;(function(d){d[d.ARRAY_BUFFER=34962]="ARRAY_BUFFER",d[d.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER"})(BufferViewTarget||(BufferViewTarget={}));class WriterContext{constructor(m,g,w){this._doc=void 0,this.jsonDoc=void 0,this.options=void 0,this.accessorIndexMap=new Map,this.animationIndexMap=new Map,this.bufferIndexMap=new Map,this.cameraIndexMap=new Map,this.skinIndexMap=new Map,this.materialIndexMap=new Map,this.meshIndexMap=new Map,this.nodeIndexMap=new Map,this.imageIndexMap=new Map,this.textureDefIndexMap=new Map,this.textureInfoDefMap=new Map,this.samplerDefIndexMap=new Map,this.sceneIndexMap=new Map,this.imageBufferViews=[],this.otherBufferViews=new Map,this.otherBufferViewsIndexMap=new Map,this.extensionData={},this.bufferURIGenerator=void 0,this.imageURIGenerator=void 0,this.logger=void 0,this._accessorUsageMap=new Map,this.accessorUsageGroupedByParent=new Set(["ARRAY_BUFFER"]),this.accessorParents=new Map,this._doc=m,this.jsonDoc=g,this.options=w;const I=m.getRoot(),P=I.listBuffers().length,F=I.listTextures().length;this.bufferURIGenerator=new UniqueURIGenerator(P>1,()=>w.basename||"buffer"),this.imageURIGenerator=new UniqueURIGenerator(F>1,D=>getSlot(m,D)||w.basename||"texture"),this.logger=m.getLogger()}createTextureInfoDef(m,g){const w={magFilter:g.getMagFilter()||void 0,minFilter:g.getMinFilter()||void 0,wrapS:g.getWrapS(),wrapT:g.getWrapT()},I=JSON.stringify(w);this.samplerDefIndexMap.has(I)||(this.samplerDefIndexMap.set(I,this.jsonDoc.json.samplers.length),this.jsonDoc.json.samplers.push(w));const P={source:this.imageIndexMap.get(m),sampler:this.samplerDefIndexMap.get(I)},F=JSON.stringify(P);this.textureDefIndexMap.has(F)||(this.textureDefIndexMap.set(F,this.jsonDoc.json.textures.length),this.jsonDoc.json.textures.push(P));const D={index:this.textureDefIndexMap.get(F)};return g.getTexCoord()!==0&&(D.texCoord=g.getTexCoord()),Object.keys(g.getExtras()).length>0&&(D.extras=g.getExtras()),this.textureInfoDefMap.set(g,D),D}createPropertyDef(m){const g={};return m.getName()&&(g.name=m.getName()),Object.keys(m.getExtras()).length>0&&(g.extras=m.getExtras()),g}createAccessorDef(m){const g=this.createPropertyDef(m);return g.type=m.getType(),g.componentType=m.getComponentType(),g.count=m.getCount(),this._doc.getGraph().listParentEdges(m).some(I=>I.getName()==="attributes"&&I.getAttributes().key==="POSITION"||I.getName()==="input")&&(g.max=m.getMax([]).map(Math.fround),g.min=m.getMin([]).map(Math.fround)),m.getNormalized()&&(g.normalized=m.getNormalized()),g}createImageData(m,g,w){if(this.options.format===Format.GLB)this.imageBufferViews.push(g),m.bufferView=this.jsonDoc.json.bufferViews.length,this.jsonDoc.json.bufferViews.push({buffer:0,byteOffset:-1,byteLength:g.byteLength});else{const I=ImageUtils.mimeTypeToExtension(w.getMimeType());m.uri=this.imageURIGenerator.createURI(w,I),this.assignResourceURI(m.uri,g,!1)}}assignResourceURI(m,g,w){const I=this.jsonDoc.resources;if(!(m in I)){I[m]=g;return}if(g===I[m]){this.logger.warn(`Duplicate resource URI, "${m}".`);return}const P=`Resource URI "${m}" already assigned to different data.`;if(!w){this.logger.warn(P);return}throw new Error(P)}getAccessorUsage(m){const g=this._accessorUsageMap.get(m);if(g)return g;if(m.getSparse())return BufferViewUsage$1.SPARSE;for(const w of this._doc.getGraph().listParentEdges(m)){const{usage:I}=w.getAttributes();if(I)return I;w.getParent().propertyType!==PropertyType.ROOT&&this.logger.warn(`Missing attribute ".usage" on edge, "${w.getName()}".`)}return BufferViewUsage$1.OTHER}addAccessorToUsageGroup(m,g){const w=this._accessorUsageMap.get(m);if(w&&w!==g)throw new Error(`Accessor with usage "${w}" cannot be reused as "${g}".`);return this._accessorUsageMap.set(m,g),this}}WriterContext.BufferViewTarget=BufferViewTarget;WriterContext.BufferViewUsage=BufferViewUsage$1;WriterContext.USAGE_TO_TARGET={[BufferViewUsage$1.ARRAY_BUFFER]:BufferViewTarget.ARRAY_BUFFER,[BufferViewUsage$1.ELEMENT_ARRAY_BUFFER]:BufferViewTarget.ELEMENT_ARRAY_BUFFER};class UniqueURIGenerator{constructor(m,g){this.multiple=void 0,this.basename=void 0,this.counter={},this.multiple=m,this.basename=g}createURI(m,g){if(m.getURI())return m.getURI();if(this.multiple){const w=this.basename(m);return this.counter[w]=this.counter[w]||1,`${w}_${this.counter[w]++}.${g}`}else return`${this.basename(m)}.${g}`}}function getSlot(d,m){const g=d.getGraph().listParentEdges(m).find(w=>w.getParent()!==d.getRoot());return g?g.getName().replace(/texture$/i,""):""}const{BufferViewUsage}=WriterContext,{UNSIGNED_INT,UNSIGNED_SHORT,UNSIGNED_BYTE}=Accessor.ComponentType,SUPPORTED_PREWRITE_TYPES=new Set([PropertyType.ACCESSOR,PropertyType.BUFFER,PropertyType.MATERIAL,PropertyType.MESH]);class GLTFWriter{static write(m,g){const w=m.getGraph(),I=m.getRoot(),P={asset:_extends({generator:`glTF-Transform ${VERSION}`},I.getAsset()),extras:_extends({},I.getExtras())},F={json:P,resources:{}},D=new WriterContext(m,F,g),U=g.logger||Logger.DEFAULT_INSTANCE,Z=new Set(g.extensions.map(q=>q.EXTENSION_NAME)),$=m.getRoot().listExtensionsUsed().filter(q=>Z.has(q.extensionName)).sort((q,et)=>q.extensionName>et.extensionName?1:-1),j=m.getRoot().listExtensionsRequired().filter(q=>Z.has(q.extensionName)).sort((q,et)=>q.extensionName>et.extensionName?1:-1);$.length<m.getRoot().listExtensionsUsed().length&&U.warn("Some extensions were not registered for I/O, and will not be written.");for(const q of $){const et=q.prewriteTypes.filter(X=>!SUPPORTED_PREWRITE_TYPES.has(X));et.length&&U.warn(`Prewrite hooks for some types (${et.join()}), requested by extension ${q.extensionName}, are unsupported. Please file an issue or a PR.`);for(const X of q.writeDependencies)q.install(X,g.dependencies[X])}function H(q,et,X,tt){const rt=[];let ot=0;for(const st of q){const ut=D.createAccessorDef(st);ut.bufferView=P.bufferViews.length;const it=st.getArray(),ct=BufferUtils.pad(BufferUtils.toView(it));ut.byteOffset=ot,ot+=ct.byteLength,rt.push(ct),D.accessorIndexMap.set(st,P.accessors.length),P.accessors.push(ut)}const J=BufferUtils.concat(rt),lt={buffer:et,byteOffset:X,byteLength:J.byteLength};return tt&&(lt.target=tt),P.bufferViews.push(lt),{buffers:rt,byteLength:ot}}function W(q,et,X){const tt=q[0].getCount();let rt=0;for(const ut of q){const it=D.createAccessorDef(ut);it.bufferView=P.bufferViews.length,it.byteOffset=rt;const ct=ut.getElementSize(),At=ut.getComponentSize();rt+=BufferUtils.padNumber(ct*At),D.accessorIndexMap.set(ut,P.accessors.length),P.accessors.push(it)}const ot=tt*rt,J=new ArrayBuffer(ot),lt=new DataView(J);for(let ut=0;ut<tt;ut++){let it=0;for(const ct of q){const At=ct.getElementSize(),Et=ct.getComponentSize(),gt=ct.getComponentType(),pt=ct.getArray();for(let vt=0;vt<At;vt++){const Tt=ut*rt+it+vt*Et,It=pt[ut*At+vt];switch(gt){case Accessor.ComponentType.FLOAT:lt.setFloat32(Tt,It,!0);break;case Accessor.ComponentType.BYTE:lt.setInt8(Tt,It);break;case Accessor.ComponentType.SHORT:lt.setInt16(Tt,It,!0);break;case Accessor.ComponentType.UNSIGNED_BYTE:lt.setUint8(Tt,It);break;case Accessor.ComponentType.UNSIGNED_SHORT:lt.setUint16(Tt,It,!0);break;case Accessor.ComponentType.UNSIGNED_INT:lt.setUint32(Tt,It,!0);break;default:throw new Error("Unexpected component type: "+gt)}}it+=BufferUtils.padNumber(At*Et)}}const st={buffer:et,byteOffset:X,byteLength:ot,byteStride:rt,target:WriterContext.BufferViewTarget.ARRAY_BUFFER};return P.bufferViews.push(st),{byteLength:ot,buffers:[new Uint8Array(J)]}}function V(q,et,X){const tt=[];let rt=0;const ot=new Map;let J=-1/0,lt=!1;for(const gt of q){const pt=D.createAccessorDef(gt);P.accessors.push(pt),D.accessorIndexMap.set(gt,P.accessors.length-1);const vt=[],Tt=[],It=[],$t=new Array(gt.getElementSize()).fill(0);for(let Nt=0,Pt=gt.getCount();Nt<Pt;Nt++)if(gt.getElement(Nt,It),!MathUtils.eq(It,$t,0)){J=Math.max(Nt,J),vt.push(Nt);for(let Ut=0;Ut<It.length;Ut++)Tt.push(It[Ut])}const Bt=vt.length,zt={accessorDef:pt,count:Bt};if(ot.set(gt,zt),Bt===0)continue;Bt>gt.getCount()/2&&(lt=!0);const Ot=ComponentTypeToTypedArray[gt.getComponentType()];zt.indices=vt,zt.values=new Ot(Tt)}if(!Number.isFinite(J))return{buffers:tt,byteLength:rt};lt&&U.warn("Some sparse accessors have >50% non-zero elements, which may increase file size.");const st=J<255?Uint8Array:J<65535?Uint16Array:Uint32Array,ut=J<255?UNSIGNED_BYTE:J<65535?UNSIGNED_SHORT:UNSIGNED_INT,it={buffer:et,byteOffset:X+rt,byteLength:0};for(const gt of q){const pt=ot.get(gt);if(pt.count===0)continue;pt.indicesByteOffset=it.byteLength;const vt=BufferUtils.pad(BufferUtils.toView(new st(pt.indices)));tt.push(vt),rt+=vt.byteLength,it.byteLength+=vt.byteLength}P.bufferViews.push(it);const ct=P.bufferViews.length-1,At={buffer:et,byteOffset:X+rt,byteLength:0};for(const gt of q){const pt=ot.get(gt);if(pt.count===0)continue;pt.valuesByteOffset=At.byteLength;const vt=BufferUtils.pad(BufferUtils.toView(pt.values));tt.push(vt),rt+=vt.byteLength,At.byteLength+=vt.byteLength}P.bufferViews.push(At);const Et=P.bufferViews.length-1;for(const gt of q){const pt=ot.get(gt);pt.count!==0&&(pt.accessorDef.sparse={count:pt.count,indices:{bufferView:ct,byteOffset:pt.indicesByteOffset,componentType:ut},values:{bufferView:Et,byteOffset:pt.valuesByteOffset}})}return{buffers:tt,byteLength:rt}}if(P.accessors=[],P.bufferViews=[],P.samplers=[],P.textures=[],P.images=I.listTextures().map((q,et)=>{const X=D.createPropertyDef(q);q.getMimeType()&&(X.mimeType=q.getMimeType());const tt=q.getImage();return tt&&D.createImageData(X,tt,q),D.imageIndexMap.set(q,et),X}),$.filter(q=>q.prewriteTypes.includes(PropertyType.ACCESSOR)).forEach(q=>q.prewrite(D,PropertyType.ACCESSOR)),I.listAccessors().forEach(q=>{const et=D.accessorUsageGroupedByParent,X=D.accessorParents;if(D.accessorIndexMap.has(q))return;const tt=D.getAccessorUsage(q);if(D.addAccessorToUsageGroup(q,tt),et.has(tt)){const rt=w.listParents(q).find(ot=>ot.propertyType!==PropertyType.ROOT);X.set(q,rt)}}),$.filter(q=>q.prewriteTypes.includes(PropertyType.BUFFER)).forEach(q=>q.prewrite(D,PropertyType.BUFFER)),(I.listAccessors().length>0||D.otherBufferViews.size>0||I.listTextures().length>0&&g.format===Format.GLB)&&I.listBuffers().length===0)throw new Error("Buffer required for Document resources, but none was found.");P.buffers=[],I.listBuffers().forEach((q,et)=>{const X=D.createPropertyDef(q),tt=D.accessorUsageGroupedByParent,rt=q.listParents().filter(At=>At instanceof Accessor),ot=new Set(rt.map(At=>D.accessorParents.get(At))),J=new Map(Array.from(ot).map((At,Et)=>[At,Et])),lt={};for(const At of rt){var st;if(D.accessorIndexMap.has(At))continue;const Et=D.getAccessorUsage(At);let gt=Et;if(tt.has(Et)){const pt=D.accessorParents.get(At);gt+=`:${J.get(pt)}`}lt[st=gt]||(lt[st]={usage:Et,accessors:[]}),lt[gt].accessors.push(At)}const ut=[],it=P.buffers.length;let ct=0;for(const{usage:At,accessors:Et}of Object.values(lt))if(At===BufferViewUsage.ARRAY_BUFFER&&g.vertexLayout===VertexLayout.INTERLEAVED){const gt=W(Et,it,ct);ct+=gt.byteLength;for(const pt of gt.buffers)ut.push(pt)}else if(At===BufferViewUsage.ARRAY_BUFFER)for(const gt of Et){const pt=W([gt],it,ct);ct+=pt.byteLength;for(const vt of pt.buffers)ut.push(vt)}else if(At===BufferViewUsage.SPARSE){const gt=V(Et,it,ct);ct+=gt.byteLength;for(const pt of gt.buffers)ut.push(pt)}else if(At===BufferViewUsage.ELEMENT_ARRAY_BUFFER){const gt=WriterContext.BufferViewTarget.ELEMENT_ARRAY_BUFFER,pt=H(Et,it,ct,gt);ct+=pt.byteLength;for(const vt of pt.buffers)ut.push(vt)}else{const gt=H(Et,it,ct);ct+=gt.byteLength;for(const pt of gt.buffers)ut.push(pt)}if(D.imageBufferViews.length&&et===0){for(let At=0;At<D.imageBufferViews.length;At++)if(P.bufferViews[P.images[At].bufferView].byteOffset=ct,ct+=D.imageBufferViews[At].byteLength,ut.push(D.imageBufferViews[At]),ct%8){const Et=8-ct%8;ct+=Et,ut.push(new Uint8Array(Et))}}if(D.otherBufferViews.has(q))for(const At of D.otherBufferViews.get(q))P.bufferViews.push({buffer:it,byteOffset:ct,byteLength:At.byteLength}),D.otherBufferViewsIndexMap.set(At,P.bufferViews.length-1),ct+=At.byteLength,ut.push(At);if(ct){let At;g.format===Format.GLB?At=GLB_BUFFER:(At=D.bufferURIGenerator.createURI(q,"bin"),X.uri=At),X.byteLength=ct,D.assignResourceURI(At,BufferUtils.concat(ut),!0)}P.buffers.push(X),D.bufferIndexMap.set(q,et)}),I.listAccessors().find(q=>!q.getBuffer())&&U.warn("Skipped writing one or more Accessors: no Buffer assigned."),$.filter(q=>q.prewriteTypes.includes(PropertyType.MATERIAL)).forEach(q=>q.prewrite(D,PropertyType.MATERIAL)),P.materials=I.listMaterials().map((q,et)=>{const X=D.createPropertyDef(q);if(q.getAlphaMode()!==Material.AlphaMode.OPAQUE&&(X.alphaMode=q.getAlphaMode()),q.getAlphaMode()===Material.AlphaMode.MASK&&(X.alphaCutoff=q.getAlphaCutoff()),q.getDoubleSided()&&(X.doubleSided=!0),X.pbrMetallicRoughness={},MathUtils.eq(q.getBaseColorFactor(),[1,1,1,1])||(X.pbrMetallicRoughness.baseColorFactor=q.getBaseColorFactor()),MathUtils.eq(q.getEmissiveFactor(),[0,0,0])||(X.emissiveFactor=q.getEmissiveFactor()),q.getRoughnessFactor()!==1&&(X.pbrMetallicRoughness.roughnessFactor=q.getRoughnessFactor()),q.getMetallicFactor()!==1&&(X.pbrMetallicRoughness.metallicFactor=q.getMetallicFactor()),q.getBaseColorTexture()){const tt=q.getBaseColorTexture(),rt=q.getBaseColorTextureInfo();X.pbrMetallicRoughness.baseColorTexture=D.createTextureInfoDef(tt,rt)}if(q.getEmissiveTexture()){const tt=q.getEmissiveTexture(),rt=q.getEmissiveTextureInfo();X.emissiveTexture=D.createTextureInfoDef(tt,rt)}if(q.getNormalTexture()){const tt=q.getNormalTexture(),rt=q.getNormalTextureInfo(),ot=D.createTextureInfoDef(tt,rt);q.getNormalScale()!==1&&(ot.scale=q.getNormalScale()),X.normalTexture=ot}if(q.getOcclusionTexture()){const tt=q.getOcclusionTexture(),rt=q.getOcclusionTextureInfo(),ot=D.createTextureInfoDef(tt,rt);q.getOcclusionStrength()!==1&&(ot.strength=q.getOcclusionStrength()),X.occlusionTexture=ot}if(q.getMetallicRoughnessTexture()){const tt=q.getMetallicRoughnessTexture(),rt=q.getMetallicRoughnessTextureInfo();X.pbrMetallicRoughness.metallicRoughnessTexture=D.createTextureInfoDef(tt,rt)}return D.materialIndexMap.set(q,et),X}),$.filter(q=>q.prewriteTypes.includes(PropertyType.MESH)).forEach(q=>q.prewrite(D,PropertyType.MESH)),P.meshes=I.listMeshes().map((q,et)=>{const X=D.createPropertyDef(q);let tt=null;return X.primitives=q.listPrimitives().map(rt=>{const ot={attributes:{}};ot.mode=rt.getMode();const J=rt.getMaterial();J&&(ot.material=D.materialIndexMap.get(J)),Object.keys(rt.getExtras()).length&&(ot.extras=rt.getExtras());const lt=rt.getIndices();lt&&(ot.indices=D.accessorIndexMap.get(lt));for(const st of rt.listSemantics())ot.attributes[st]=D.accessorIndexMap.get(rt.getAttribute(st));for(const st of rt.listTargets()){const ut={};for(const it of st.listSemantics())ut[it]=D.accessorIndexMap.get(st.getAttribute(it));ot.targets=ot.targets||[],ot.targets.push(ut)}return rt.listTargets().length&&!tt&&(tt=rt.listTargets().map(st=>st.getName())),ot}),q.getWeights().length&&(X.weights=q.getWeights()),tt&&(X.extras=X.extras||{},X.extras.targetNames=tt),D.meshIndexMap.set(q,et),X}),P.cameras=I.listCameras().map((q,et)=>{const X=D.createPropertyDef(q);if(X.type=q.getType(),X.type===Camera.Type.PERSPECTIVE){X.perspective={znear:q.getZNear(),zfar:q.getZFar(),yfov:q.getYFov()};const tt=q.getAspectRatio();tt!==null&&(X.perspective.aspectRatio=tt)}else X.orthographic={znear:q.getZNear(),zfar:q.getZFar(),xmag:q.getXMag(),ymag:q.getYMag()};return D.cameraIndexMap.set(q,et),X}),P.nodes=I.listNodes().map((q,et)=>{const X=D.createPropertyDef(q);return MathUtils.eq(q.getTranslation(),[0,0,0])||(X.translation=q.getTranslation()),MathUtils.eq(q.getRotation(),[0,0,0,1])||(X.rotation=q.getRotation()),MathUtils.eq(q.getScale(),[1,1,1])||(X.scale=q.getScale()),q.getWeights().length&&(X.weights=q.getWeights()),D.nodeIndexMap.set(q,et),X}),P.skins=I.listSkins().map((q,et)=>{const X=D.createPropertyDef(q),tt=q.getInverseBindMatrices();tt&&(X.inverseBindMatrices=D.accessorIndexMap.get(tt));const rt=q.getSkeleton();return rt&&(X.skeleton=D.nodeIndexMap.get(rt)),X.joints=q.listJoints().map(ot=>D.nodeIndexMap.get(ot)),D.skinIndexMap.set(q,et),X}),I.listNodes().forEach((q,et)=>{const X=P.nodes[et],tt=q.getMesh();tt&&(X.mesh=D.meshIndexMap.get(tt));const rt=q.getCamera();rt&&(X.camera=D.cameraIndexMap.get(rt));const ot=q.getSkin();ot&&(X.skin=D.skinIndexMap.get(ot)),q.listChildren().length>0&&(X.children=q.listChildren().map(J=>D.nodeIndexMap.get(J)))}),P.animations=I.listAnimations().map((q,et)=>{const X=D.createPropertyDef(q),tt=new Map;return X.samplers=q.listSamplers().map((rt,ot)=>{const J=D.createPropertyDef(rt);return J.input=D.accessorIndexMap.get(rt.getInput()),J.output=D.accessorIndexMap.get(rt.getOutput()),J.interpolation=rt.getInterpolation(),tt.set(rt,ot),J}),X.channels=q.listChannels().map(rt=>{const ot=D.createPropertyDef(rt);return ot.sampler=tt.get(rt.getSampler()),ot.target={node:D.nodeIndexMap.get(rt.getTargetNode()),path:rt.getTargetPath()},ot}),D.animationIndexMap.set(q,et),X}),P.scenes=I.listScenes().map((q,et)=>{const X=D.createPropertyDef(q);return X.nodes=q.listChildren().map(tt=>D.nodeIndexMap.get(tt)),D.sceneIndexMap.set(q,et),X});const K=I.getDefaultScene();return K&&(P.scene=I.listScenes().indexOf(K)),P.extensionsUsed=$.map(q=>q.extensionName),P.extensionsRequired=j.map(q=>q.extensionName),$.forEach(q=>q.write(D)),clean(P),F}}function clean(d){const m=[];for(const g in d){const w=d[g];(Array.isArray(w)&&w.length===0||w===null||w===""||w&&typeof w=="object"&&Object.keys(w).length===0)&&m.push(g)}for(const g of m)delete d[g]}var ChunkType;(function(d){d[d.JSON=1313821514]="JSON",d[d.BIN=5130562]="BIN"})(ChunkType||(ChunkType={}));class PlatformIO{constructor(){this._logger=Logger.DEFAULT_INSTANCE,this._extensions=new Set,this._dependencies={},this._vertexLayout=VertexLayout.INTERLEAVED,this.lastReadBytes=0,this.lastWriteBytes=0}setLogger(m){return this._logger=m,this}registerExtensions(m){for(const g of m)this._extensions.add(g),g.register();return this}registerDependencies(m){return Object.assign(this._dependencies,m),this}setVertexLayout(m){return this._vertexLayout=m,this}async read(m){return await this.readJSON(await this.readAsJSON(m))}async readAsJSON(m){const g=await this.readURI(m,"view");this.lastReadBytes=g.byteLength;const w=isGLB(g)?this._binaryToJSON(g):{json:JSON.parse(BufferUtils.decodeText(g)),resources:{}};return await this._readResourcesExternal(w,this.dirname(m)),this._readResourcesInternal(w),w}async readJSON(m){return m=this._copyJSON(m),this._readResourcesInternal(m),GLTFReader.read(m,{extensions:Array.from(this._extensions),dependencies:this._dependencies,logger:this._logger})}async binaryToJSON(m){const g=this._binaryToJSON(BufferUtils.assertView(m));this._readResourcesInternal(g);const w=g.json;if(w.buffers&&w.buffers.some(I=>isExternalBuffer(g,I)))throw new Error("Cannot resolve external buffers with binaryToJSON().");if(w.images&&w.images.some(I=>isExternalImage(g,I)))throw new Error("Cannot resolve external images with binaryToJSON().");return g}async readBinary(m){return this.readJSON(await this.binaryToJSON(BufferUtils.assertView(m)))}async writeJSON(m,g={}){if(g.format===Format.GLB&&m.getRoot().listBuffers().length>1)throw new Error("GLB must have 0–1 buffers.");return GLTFWriter.write(m,{format:g.format||Format.GLTF,basename:g.basename||"",logger:this._logger,vertexLayout:this._vertexLayout,dependencies:_extends({},this._dependencies),extensions:Array.from(this._extensions)})}async writeBinary(m){const{json:g,resources:w}=await this.writeJSON(m,{format:Format.GLB}),I=new Uint32Array([1179937895,2,12]),P=JSON.stringify(g),F=BufferUtils.pad(BufferUtils.encodeText(P),32),D=BufferUtils.toView(new Uint32Array([F.byteLength,1313821514])),U=BufferUtils.concat([D,F]);I[I.length-1]+=U.byteLength;const Z=Object.values(w)[0];if(!Z||!Z.byteLength)return BufferUtils.concat([BufferUtils.toView(I),U]);const $=BufferUtils.pad(Z,0),j=BufferUtils.toView(new Uint32Array([$.byteLength,5130562])),H=BufferUtils.concat([j,$]);return I[I.length-1]+=H.byteLength,BufferUtils.concat([BufferUtils.toView(I),U,H])}async _readResourcesExternal(m,g){var w=this;const I=m.json.images||[],P=m.json.buffers||[],F=[...I,...P].map(async function(D){const U=D.uri;if(!U||U.match(/data:/))return Promise.resolve();m.resources[U]=await w.readURI(w.resolve(g,U),"view"),w.lastReadBytes+=m.resources[U].byteLength});await Promise.all(F)}_readResourcesInternal(m){function g(P){if(P.uri){if(P.uri in m.resources){BufferUtils.assertView(m.resources[P.uri]);return}if(P.uri.match(/data:/)){const F=`__${uuid()}.${FileUtils.extension(P.uri)}`;m.resources[F]=BufferUtils.createBufferFromDataURI(P.uri),P.uri=F}}}(m.json.images||[]).forEach(P=>{if(P.bufferView===void 0&&P.uri===void 0)throw new Error("Missing resource URI or buffer view.");g(P)}),(m.json.buffers||[]).forEach(g)}_copyJSON(m){const{images:g,buffers:w}=m.json;return m={json:_extends({},m.json),resources:_extends({},m.resources)},g&&(m.json.images=g.map(I=>_extends({},I))),w&&(m.json.buffers=w.map(I=>_extends({},I))),m}_binaryToJSON(m){if(!isGLB(m))throw new Error("Invalid glTF 2.0 binary.");const g=new Uint32Array(m.buffer,m.byteOffset+12,2);if(g[1]!==ChunkType.JSON)throw new Error("Missing required GLB JSON chunk.");const w=20,I=g[0],P=BufferUtils.decodeText(BufferUtils.toView(m,w,I)),F=JSON.parse(P),D=w+I;if(m.byteLength<=D)return{json:F,resources:{}};const U=new Uint32Array(m.buffer,m.byteOffset+D,2);if(U[1]!==ChunkType.BIN)return{json:F,resources:{}};const Z=U[0],$=BufferUtils.toView(m,D+8,Z);return{json:F,resources:{[GLB_BUFFER]:$}}}}function isExternalBuffer(d,m){return m.uri!==void 0&&!(m.uri in d.resources)}function isExternalImage(d,m){return m.uri!==void 0&&!(m.uri in d.resources)&&m.bufferView===void 0}function isGLB(d){if(d.byteLength<3*Uint32Array.BYTES_PER_ELEMENT)return!1;const m=new Uint32Array(d.buffer,d.byteOffset,3);return m[0]===1179937895&&m[1]===2}class WebIO extends PlatformIO{constructor(m=HTTPUtils.DEFAULT_INIT){super(),this._fetchConfig=void 0,this._fetchConfig=m}async readURI(m,g){const w=await fetch(m,this._fetchConfig);switch(g){case"view":return new Uint8Array(await w.arrayBuffer());case"text":return w.text()}}resolve(m,g){return HTTPUtils.resolve(m,g)}dirname(m){return HTTPUtils.dirname(m)}}function bg3dParsedToGLTF(d){const m=new Document,g=m.createBuffer("MainBuffer");console.log("=== Starting BG3D to glTF Conversion ===");const w=d.materials.map(($,j)=>{const H=m.createMaterial("BG3DMaterial");return H.setName(`Material_${j.toString().padStart(4,"0")}`),H.setBaseColorFactor($.diffuseColor),H.setExtras({flags:$.flags}),H});d.materials.forEach(($,j)=>{$.textures&&$.textures.length>0&&$.textures.forEach((H,W)=>{let V;try{if(H.srcPixelFormat===PixelFormatSrc.GL_UNSIGNED_SHORT_1_5_5_5_REV){const K=new Uint16Array(H.pixels.buffer,H.pixels.byteOffset,H.pixels.byteLength/2),q=new Uint16Array(K.length);for(let et=0;et<K.length;et++){const X=K[et];q[et]=(X&255)<<8|X>>8&255}V=argb16ToPng(q,H.width,H.height)}else H.srcPixelFormat===PixelFormatSrc.GL_RGB?V=rgb24ToPng(H.pixels,H.width,H.height):H.srcPixelFormat===PixelFormatSrc.GL_RGBA?V=rgba8ToPng(H.pixels,H.width,H.height):V=H.pixels}catch{V=H.pixels}const Q=m.createTexture();Q.setMimeType("image/png"),Q.setImage(V),Q.setExtras({width:H.width,height:H.height,srcPixelFormat:H.srcPixelFormat,dstPixelFormat:H.dstPixelFormat,bufferSize:H.bufferSize}),W===0&&w[j].setBaseColorTexture(Q)})});const I=m.createScene("Scene");let P=null,F=[];if(d.skeleton){console.log("Creating skeleton system with new implementation...");const $=createSkeletonSystem(m,d.skeleton);P=$.skin,F=$.animations,console.log(`Skeleton system created: ${P.listJoints().length} joints, ${F.length} animations`)}function D($){const j=[];function H(W){if(Array.isArray(W.children))for(const V of W.children)Array.isArray(V.children)?H(V):j.push(V)}for(const W of $)H(W);return j}const U=D(d.groups);console.log(`Processing ${U.length} geometries`);const Z=[];return U.forEach(($,j)=>{const H=m.createMesh();H.setName(`Item_${j.toString().padStart(4,"0")}`);const W=$.vertices?m.createAccessor().setType("VEC3").setArray(new Float32Array($.vertices.flat())).setBuffer(g):null,V=$.normals?m.createAccessor().setType("VEC3").setArray(new Float32Array($.normals.flat())).setBuffer(g):null,Q=$.uvs?m.createAccessor().setType("VEC2").setArray(new Float32Array($.uvs.flat())).setBuffer(g):null,K=$.colors?m.createAccessor().setType("VEC4").setArray(new Uint8Array($.colors.flat())).setBuffer(g):null,q=$.triangles?m.createAccessor().setType("SCALAR").setArray(new Uint32Array($.triangles.flat())).setBuffer(g):null;let et=null,X=null;if(d.skeleton&&P&&$.vertices){const rt=$.vertices.length,ot=new Uint16Array(rt*4),J=new Float32Array(rt*4);for(let lt=0;lt<rt;lt++)ot[lt*4]=0,J[lt*4]=1;d.skeleton.bones.forEach((lt,st)=>{lt.pointIndices&&lt.pointIndices.forEach(ut=>{if(ut<rt){const it=ut*4;for(let ct=0;ct<4;ct++)if(J[it+ct]===0){ot[it+ct]=st,J[it+ct]=1;break}}})});for(let lt=0;lt<rt;lt++){const st=lt*4;let ut=0;for(let it=0;it<4;it++)ut+=J[st+it];if(ut>0)for(let it=0;it<4;it++)J[st+it]/=ut}et=m.createAccessor().setType("VEC4").setArray(ot).setBuffer(g),X=m.createAccessor().setType("VEC4").setArray(J).setBuffer(g)}const tt=m.createPrimitive();W&&tt.setAttribute("POSITION",W),V&&tt.setAttribute("NORMAL",V),Q&&tt.setAttribute("TEXCOORD_0",Q),K&&tt.setAttribute("COLOR_0",K),q&&tt.setIndices(q),et&&tt.setAttribute("JOINTS_0",et),X&&tt.setAttribute("WEIGHTS_0",X),typeof $.layerMaterialNum=="number"&&$.layerMaterialNum<w.length?tt.setMaterial(w[$.layerMaterialNum]):Array.isArray($.layerMaterialNum)&&$.layerMaterialNum[0]<w.length&&tt.setMaterial(w[$.layerMaterialNum[0]]),tt.setExtras({layerMaterialNum:$.layerMaterialNum,boundingBox:$.boundingBox}),H.addPrimitive(tt),Z.push(H)}),d.groups.forEach(($,j)=>{const H=m.createNode();H.setName(`Group_${j.toString().padStart(4,"0")}`);function W(V,Q){if(Array.isArray(Q.children))for(const K of Q.children)if(Array.isArray(K.children)){const q=m.createNode();q.setName(`Subgroup_${V.listChildren().length}`),W(q,K),V.addChild(q)}else{const q=K,et=U.indexOf(q);if(et>=0&&et<Z.length){const X=m.createNode();X.setName(`Mesh_${et.toString().padStart(4,"0")}`),X.setMesh(Z[et]),P&&X.setSkin(P),V.addChild(X)}}}W(H,$),I.addChild(H)}),F.forEach($=>{m.getRoot().listAnimations().push($)}),console.log("=== BG3D to glTF Conversion Complete ==="),m}async function gltfToBG3D(d){console.log("=== Starting glTF to BG3D Conversion ===");const m=d.getRoot().listMaterials(),g=await Promise.all(m.map(async $=>{const j=$.getExtras()??{};let H=[1,1,1,1];const W=$.getBaseColorFactor();Array.isArray(W)&&W.length===4&&(H=[W[0],W[1],W[2],W[3]]);const V=typeof j.flags=="number"?j.flags:0;let Q=[];const K=$.getBaseColorTexture();if(K){const q=K.getImage();if(q instanceof Uint8Array){const et=await pngToRgba8(q.buffer);Q.push({pixels:et.data,width:et.width,height:et.height,srcPixelFormat:PixelFormatSrc.GL_RGBA,dstPixelFormat:PixelFormatDst.GL_UNSIGNED_SHORT_5_5_5_1,bufferSize:et.data.byteLength})}}return{diffuseColor:H,flags:V,textures:Q}}));let w;const I=d.getRoot().getExtras()||{};if(I.bg3dFields?.skeleton)w=I.bg3dFields.skeleton,console.log("Restored skeleton from extras:",{numBones:w?.bones?.length,numAnimations:w?.animations?.length});else{const $=d.getRoot().listSkins();if($.length>0){const H=$[0].listJoints();if(H.length>0){const W=H.map((V,Q)=>{const K=V.getTranslation()||[0,0,0],q=V.getParent?.();return{parentBone:q?H.indexOf(q):-1,name:V.getName()||`bone_${Q}`,coordX:K[0],coordY:K[1],coordZ:K[2],numPointsAttachedToBone:0,numNormalsAttachedToBone:0,pointIndices:[],normalIndices:[]}});w={version:272,numAnims:0,numJoints:W.length,num3DMFLimbs:0,bones:W,animations:extractAnimationsFromGLTF(d)}}}}function P($){const H=$.listPrimitives()[0],W=H.getExtras()||{},V=H.getAttribute("POSITION");let Q;if(V){const ut=Array.from(V.getArray());Q=[];for(let it=0;it<ut.length;it+=3)Q.push([ut[it],ut[it+1],ut[it+2]])}const K=H.getAttribute("NORMAL");let q;if(K){const ut=Array.from(K.getArray());q=[];for(let it=0;it<ut.length;it+=3)q.push([ut[it],ut[it+1],ut[it+2]])}const et=H.getAttribute("TEXCOORD_0");let X;if(et){const ut=Array.from(et.getArray());X=[];for(let it=0;it<ut.length;it+=2)X.push([ut[it],ut[it+1]])}const tt=H.getAttribute("COLOR_0");let rt;if(tt){const ut=Array.from(tt.getArray());rt=[];for(let it=0;it<ut.length;it+=4)rt.push([ut[it],ut[it+1],ut[it+2],ut[it+3]])}const ot=H.getIndices();let J;if(ot){const ut=Array.from(ot.getArray());J=[];for(let it=0;it<ut.length;it+=3)J.push([ut[it],ut[it+1],ut[it+2]])}const lt=H.getMaterial();let st=0;return lt&&(st=m.indexOf(lt),st<0&&(st=0)),{vertices:Q,normals:q,uvs:X,colors:rt,triangles:J,layerMaterialNum:[st,0,0,0],flags:typeof W.flags=="number"?W.flags:0,boundingBox:W.boundingBox,numMaterials:1,type:typeof W.type=="number"?W.type:0,numPoints:Q?Q.length:0,numTriangles:J?J.length:0}}function F($){const j=$.getMesh();if(j)return P(j);const H=[],W=$.listChildren();for(const V of W)H.push(F(V));return{children:H}}const Z=d.getRoot().listScenes()[0].listChildren().map($=>F($));return console.log("=== glTF to BG3D Conversion Complete ==="),{materials:g,groups:Z,skeleton:w}}function parseBG3DWithSkeletonResource(d,m){return parseBG3D(d,m)}self.onmessage=async d=>{const m=d.data;try{if(m.type==="bg3d-to-glb"){console.log("Converting BG3D to GLB");const g=parseBG3D(m.buffer);console.log("Parsed BG3D:",g);const w=bg3dParsedToGLTF(g);console.log("Converting parsed BG3D to GLTF document"),console.log("GLTF Document:",w);const P=await new WebIO().writeBinary(w),D={type:"bg3d-to-glb",result:new Uint8Array(P).buffer,parsed:g};self.postMessage.call(self,D)}else if(m.type==="bg3d-with-skeleton-to-glb"){console.log("Converting BG3D with skeleton to GLB");const g=parseBG3DWithSkeletonResource(m.bg3dBuffer,m.skeletonData);console.log("Parsed BG3D with skeleton:",g);const w=bg3dParsedToGLTF(g);console.log("Converting parsed BG3D with skeleton to GLTF document");const P=await new WebIO().writeBinary(w),D={type:"bg3d-with-skeleton-to-glb",result:new Uint8Array(P).buffer,parsed:g};self.postMessage.call(self,D)}else if(m.type==="bg3d-parsed-to-glb"){console.log("Converting parsed BG3D to GLB");const g=bg3dParsedToGLTF(m.parsed),I=await new WebIO().writeBinary(g),F={type:"bg3d-parsed-to-glb",result:new Uint8Array(I).buffer};self.postMessage.call(self,F)}else if(m.type==="bg3d-parsed-to-bg3d"){console.log("Converting parsed BG3D back to BG3D binary");const w={type:"bg3d-parsed-to-bg3d",result:bg3dParsedToBG3D(m.parsed)};self.postMessage.call(self,w)}else if(m.type==="glb-to-bg3d"){const w=await new WebIO().readBinary(new Uint8Array(m.buffer)),I=gltfToBG3D(w),F={type:"glb-to-bg3d",result:bg3dParsedToBG3D(await I)};self.postMessage.call(self,F)}else if(m.type==="glb-to-bg3d-with-skeleton"){const w=await new WebIO().readBinary(new Uint8Array(m.buffer)),I=gltfToBG3D(w),P=bg3dParsedToBG3D(await I);let F;(await I).skeleton&&(await I).skeleton.animations.length>0&&console.log("Skeleton generation from glTF not yet implemented");const D={type:"glb-to-bg3d-with-skeleton",bg3dResult:P,skeletonResult:F};self.postMessage.call(self,D)}else throw new Error("Unknown conversion type")}catch(g){const w={type:"error",error:g instanceof Error?g.message:String(g)};self.postMessage(w)}}});export default Le();
